<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679506640"><span id="local-6989586621679506641"><span id="local-6989586621679506642"><span id="local-6989586621679506643"><span id="local-6989586621679506644"><span id="local-6989586621679506645"><span id="local-6989586621679506646"><span id="local-6989586621679506647"><span id="local-6989586621679506648"><span id="local-6989586621679506649"><span id="local-6989586621679506650"><span id="local-6989586621679506651"><span id="local-6989586621679506652"><span id="local-6989586621679506653"></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-comment">{- Language/Haskell/TH/Desugar/Util.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Utility functions for th-desugar package.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable, RankNTypes, ScopedTypeVariables, TupleSections #-}</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier">newUniqueName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier">impossible</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier">nameOccursIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier">allNamesIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier">mkTypeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier">mkDataName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier">mkNameWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier">isDataName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier">stripVarP_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier">extractBoundNamesStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier">concatMapM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier">mapAccumLM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier">mapMaybeM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier">expectJustM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier">stripPlainTV_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier">thirdOf3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier">splitAtList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier">extractBoundNamesDec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier">extractBoundNamesPat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier">tvbToType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier">tvbToTypeWithSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier">tvbToTANormalWithSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier">nameMatches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier">thdOf3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier">liftFst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier">liftSnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier">firstMatch</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier">unboxedSumDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier">unboxedSumNameDegree_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier">tupleDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier">tupleNameDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier">unboxedTupleDegree_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier">unboxedTupleNameDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier">splitTuple_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier">topEverywhereM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier">isInfixDataCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier">isTypeKindName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier">typeKindName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier">unSigType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier">unfoldType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallTelescope"><span class="hs-identifier">ForallTelescope</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier">FunArgs</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier">VisFunArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier">filterVisFunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier">ravelType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier">unravelType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier">TypeArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier">applyType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier">filterTANormals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier">probablyWrongUnTypeArg</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier">bindIP</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">cxt</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OS</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier">OSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Fixity</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Kind</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IP</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-65"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- TH manipulations</span><span>
</span><span id="line-67"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Like newName, but even more unique (unique across different splices),</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- and with unique @nameBase@s. Precondition: the string is a valid Haskell</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- alphanumeric identifier (could be upper- or lower-case).</span><span>
</span><span id="line-72"></span><span id="local-6989586621679507045"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-type">newUniqueName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679507045"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679507045"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-73"></span><span id="newUniqueName"><span class="annot"><span class="annottext">newUniqueName :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var hs-var">newUniqueName</span></a></span></span><span> </span><span id="local-6989586621679506518"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506518"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679506517"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506517"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506518"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506517"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | @mkNameWith lookup_fun mkName_fun str@ looks up the exact 'Name' of @str@</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- using the function @lookup_fun@. If it finds 'Just' the 'Name', meaning</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- that it is bound in the current scope, then it is returned. If it finds</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- 'Nothing', it assumes that @str@ is declared in the current module, and</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- uses @mkName_fun@ to construct the appropriate 'Name' to return.</span><span>
</span><span id="line-82"></span><span id="local-6989586621679507035"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-type">mkNameWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679507035"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679507035"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679507035"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-85"></span><span id="mkNameWith"><span class="annot"><span class="annottext">mkNameWith :: forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var hs-var">mkNameWith</span></a></span></span><span> </span><span id="local-6989586621679506506"><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
</span><a href="#local-6989586621679506506"><span class="hs-identifier hs-var">lookup_fun</span></a></span></span><span> </span><span id="local-6989586621679506505"><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><a href="#local-6989586621679506505"><span class="hs-identifier hs-var">mkName_fun</span></a></span></span><span> </span><span id="local-6989586621679506504"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506504"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679506503"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679506503"><span class="hs-identifier hs-var">m_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
</span><a href="#local-6989586621679506506"><span class="hs-identifier hs-var">lookup_fun</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506504"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679506503"><span class="hs-identifier hs-var">m_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679506502"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506502"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506502"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Loc</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">loc_package :: Loc -&gt; String
</span><span class="hs-identifier hs-var">loc_package</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679506499"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506499"><span class="hs-identifier hs-var">pkg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc_module :: Loc -&gt; String
</span><span class="hs-identifier hs-var">loc_module</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679506497"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506497"><span class="hs-identifier hs-var">modu</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Quasi m =&gt; m Loc
</span><span class="hs-identifier hs-var">qLocation</span></span><span>
</span><span id="line-91"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><a href="#local-6989586621679506505"><span class="hs-identifier hs-var">mkName_fun</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506499"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506497"><span class="hs-identifier hs-var">modu</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506504"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Like TH's @lookupTypeName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679506495"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier hs-type">mkTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679506495"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506495"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-96"></span><span id="mkTypeName"><span class="annot"><span class="annottext">mkTypeName :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier hs-var hs-var">mkTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Quasi m =&gt; Bool -&gt; String -&gt; m (Maybe Name)
</span><span class="hs-identifier hs-var">qLookupName</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_tc</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Like TH's @lookupDataName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679506490"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier hs-type">mkDataName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679506490"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506490"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-101"></span><span id="mkDataName"><span class="annot"><span class="annottext">mkDataName :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier hs-var hs-var">mkDataName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Quasi m =&gt; Bool -&gt; String -&gt; m (Maybe Name)
</span><span class="hs-identifier hs-var">qLookupName</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_d</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Is this name a data constructor name? A 'False' answer means &quot;unsure&quot;.</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-type">isDataName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-105"></span><span id="isDataName"><span class="annot"><span class="annottext">isDataName :: Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var hs-var">isDataName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">DataName</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var">isDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Extracts the name out of a variable pattern, or returns @Nothing@</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-type">stripVarP_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-110"></span><span id="stripVarP_maybe"><span class="annot"><span class="annottext">stripVarP_maybe :: Pat -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var hs-var">stripVarP_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679506482"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506482"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506482"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var">stripVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Extracts the name out of a @PlainTV@, or returns @Nothing@</span><span>
</span><span id="line-114"></span><span id="local-6989586621679507024"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier hs-type">stripPlainTV_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679507024"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-115"></span><span id="stripPlainTV_maybe"><span class="annot"><span class="annottext">stripPlainTV_maybe :: forall flag. TyVarBndr_ flag -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier hs-var hs-var">stripPlainTV_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r flag.
(Name -&gt; r) -&gt; (Name -&gt; Kind -&gt; r) -&gt; TyVarBndr_ flag -&gt; r
</span><span class="hs-identifier hs-var">elimTV</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Report that a certain TH construct is impossible</span><span>
</span><span id="line-118"></span><span id="local-6989586621679507019"><span id="local-6989586621679507020"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679507020"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679507020"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679507019"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-119"></span><span id="impossible"><span class="annot"><span class="annottext">impossible :: forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var hs-var">impossible</span></a></span></span><span> </span><span id="local-6989586621679506478"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506478"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">Fail.fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506478"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n    This should not happen in Haskell.\n    Please email rae@cs.brynmawr.edu with your code if you see this.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'Type', dropping the kind signature</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- (if it has one).</span><span>
</span><span id="line-123"></span><span id="local-6989586621679507014"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-type">tvbToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679507014"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span><span>
</span><span id="line-124"></span><span id="tvbToType"><span class="annot"><span class="annottext">tvbToType :: forall flag. TyVarBndr_ flag -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var hs-var">tvbToType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall flag. TyVarBndr_ flag -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'Type', preserving the kind signature</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- (if it has one).</span><span>
</span><span id="line-128"></span><span id="local-6989586621679506474"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-type">tvbToTypeWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679506474"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span><span>
</span><span id="line-129"></span><span id="tvbToTypeWithSig"><span class="annot"><span class="annottext">tvbToTypeWithSig :: forall flag. TyVarBndr_ flag -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var hs-var">tvbToTypeWithSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r flag.
(Name -&gt; r) -&gt; (Name -&gt; Kind -&gt; r) -&gt; TyVarBndr_ flag -&gt; r
</span><span class="hs-identifier hs-var">elimTV</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679506473"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506473"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679506472"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506472"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506473"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506472"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'TypeArg' (specifically, a 'TANormal'),</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- preserving the kind signature (if it has one).</span><span>
</span><span id="line-133"></span><span id="local-6989586621679507008"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-type">tvbToTANormalWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679507008"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span></span><span>
</span><span id="line-134"></span><span id="tvbToTANormalWithSig"><span class="annot"><span class="annottext">tvbToTANormalWithSig :: forall flag. TyVarBndr_ flag -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-var hs-var">tvbToTANormalWithSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall flag. TyVarBndr_ flag -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var">tvbToTypeWithSig</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Do two names name the same thing?</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-type">nameMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-138"></span><span id="nameMatches"><span class="annot"><span class="annottext">nameMatches :: Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var hs-var">nameMatches</span></a></span></span><span> </span><span id="local-6989586621679506469"><span class="annot"><span class="annottext">n1 :: Name
</span><a href="#local-6989586621679506469"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span id="local-6989586621679506468"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span></span><span> </span><span id="local-6989586621679506467"><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506467"><span class="hs-identifier hs-var">flav1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506466"><span class="annot"><span class="annottext">n2 :: Name
</span><a href="#local-6989586621679506466"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span id="local-6989586621679506465"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span></span><span> </span><span id="local-6989586621679506464"><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506464"><span class="hs-identifier hs-var">flav2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><span class="hs-identifier hs-var">NameS</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506467"><span class="hs-identifier hs-var">flav1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><span class="hs-identifier hs-var">NameS</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506464"><span class="hs-identifier hs-var">flav2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679506461"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506461"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506467"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679506460"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506460"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506464"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506461"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506460"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679506458"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506458"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506467"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506457"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506457"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506464"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506458"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506457"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506456"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506456"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506467"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679506455"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506455"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679506464"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506456"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679506455"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506468"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679506465"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506469"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506466"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Extract the degree of a tuple</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-type">tupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-155"></span><span id="tupleDegree_maybe"><span class="annot"><span class="annottext">tupleDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-var hs-var">tupleDegree_maybe</span></a></span></span><span> </span><span id="local-6989586621679506454"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506454"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679506453"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506453"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506454"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679506452"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506452"><span class="hs-identifier hs-var">commas</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506453"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679506445"><span class="annot"><span class="annottext">degree :: Int
</span><a href="#local-6989586621679506445"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506452"><span class="hs-identifier hs-var">commas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506452"><span class="hs-identifier hs-var">commas</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506445"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Extract the degree of a tuple name</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-type">tupleNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-165"></span><span id="tupleNameDegree_maybe"><span class="annot"><span class="annottext">tupleNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var hs-var">tupleNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-var">tupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-type">unboxedSumDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-169"></span><span id="unboxedSumDegree_maybe"><span class="annot"><span class="annottext">unboxedSumDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'|'</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum name</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-type">unboxedSumNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-173"></span><span id="unboxedSumNameDegree_maybe"><span class="annot"><span class="annottext">unboxedSumNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-var">unboxedSumDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Extract the degree of an unboxed tuple</span><span>
</span><span id="line-176"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-type">unboxedTupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-177"></span><span id="unboxedTupleDegree_maybe"><span class="annot"><span class="annottext">unboxedTupleDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedTupleDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum or tuple</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-type">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-181"></span><span id="unboxedSumTupleDegree_maybe"><span class="annot"><span class="annottext">unboxedSumTupleDegree_maybe :: Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumTupleDegree_maybe</span></a></span></span><span> </span><span id="local-6989586621679506440"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679506440"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621679506439"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506439"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679506438"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506438"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506439"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679506437"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506437"><span class="hs-identifier hs-var">seps</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679506440"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506438"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679506432"><span class="annot"><span class="annottext">degree :: Int
</span><a href="#local-6989586621679506432"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506437"><span class="hs-identifier hs-var">seps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506437"><span class="hs-identifier hs-var">seps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506432"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Extract the degree of an unboxed tuple name</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-type">unboxedTupleNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-191"></span><span id="unboxedTupleNameDegree_maybe"><span class="annot"><span class="annottext">unboxedTupleNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedTupleNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | If the argument is a tuple type, return the components</span><span>
</span><span id="line-194"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-type">splitTuple_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span id="splitTuple_maybe"><span class="annot"><span class="annottext">splitTuple_maybe :: Kind -&gt; Maybe [Kind]
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-var hs-var">splitTuple_maybe</span></a></span></span><span> </span><span id="local-6989586621679506431"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506431"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Maybe [Kind]
</span><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506431"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679506430"><span class="annot"><span class="annottext">go :: [Kind] -&gt; Kind -&gt; Maybe [Kind]
</span><a href="#local-6989586621679506430"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679506424"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506424"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506423"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506423"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span id="local-6989586621679506421"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506421"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Maybe [Kind]
</span><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506421"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506424"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506423"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506420"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506420"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506419"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506419"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`SigT`</span></span><span> </span><span id="local-6989586621679506418"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506418"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Maybe [Kind]
</span><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506420"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506419"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506417"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506417"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679506415"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506415"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679506414"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506414"><span class="hs-identifier hs-var">degree</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var">tupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506415"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506417"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506414"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506417"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506413"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506413"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679506411"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506411"><span class="hs-identifier hs-var">degree</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506413"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679506411"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506413"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><a href="#local-6989586621679506430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | The type variable binders in a @forall@. This is not used by the TH AST</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- itself, but this is used as an intermediate data type in 'FAForalls'.</span><span>
</span><span id="line-209"></span><span class="hs-keyword">data</span><span> </span><span id="ForallTelescope"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallTelescope"><span class="hs-identifier hs-var">ForallTelescope</span></a></span></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ForallVis"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- ^ A visible @forall@ (e.g., @forall a -&gt; {...}@).</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">--   These do not have any notion of specificity, so we use</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">--   '()' as a placeholder value in the 'TyVarBndr's.</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForallInvis"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrSpec</span></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- ^ An invisible @forall@ (e.g., @forall a {b} c -&gt; {...}@),</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">--   where each binder has a 'Specificity'.</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506400"><span id="local-6989586621679506407"><span class="annot"><span class="annottext">ForallTelescope -&gt; ForallTelescope -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ForallTelescope -&gt; ForallTelescope -&gt; Bool
$c/= :: ForallTelescope -&gt; ForallTelescope -&gt; Bool
== :: ForallTelescope -&gt; ForallTelescope -&gt; Bool
$c== :: ForallTelescope -&gt; ForallTelescope -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506380"><span id="local-6989586621679506382"><span id="local-6989586621679506392"><span class="annot"><span class="annottext">Int -&gt; ForallTelescope -&gt; ShowS
[ForallTelescope] -&gt; ShowS
ForallTelescope -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ForallTelescope] -&gt; ShowS
$cshowList :: [ForallTelescope] -&gt; ShowS
show :: ForallTelescope -&gt; String
$cshow :: ForallTelescope -&gt; String
showsPrec :: Int -&gt; ForallTelescope -&gt; ShowS
$cshowsPrec :: Int -&gt; ForallTelescope -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506335"><span id="local-6989586621679506337"><span id="local-6989586621679506339"><span id="local-6989586621679506341"><span id="local-6989586621679506343"><span id="local-6989586621679506345"><span id="local-6989586621679506347"><span id="local-6989586621679506349"><span id="local-6989586621679506351"><span id="local-6989586621679506353"><span id="local-6989586621679506355"><span id="local-6989586621679506357"><span id="local-6989586621679506363"><span id="local-6989586621679506370"><span class="annot"><span class="annottext">Typeable ForallTelescope
ForallTelescope -&gt; DataType
ForallTelescope -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; ForallTelescope -&gt; ForallTelescope
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallTelescope
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallTelescope -&gt; c ForallTelescope
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallTelescope)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallTelescope)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ForallTelescope -&gt; m ForallTelescope
gmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; u
$cgmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallTelescope -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallTelescope -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; ForallTelescope -&gt; ForallTelescope
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; ForallTelescope -&gt; ForallTelescope
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallTelescope)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallTelescope)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallTelescope)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallTelescope)
dataTypeOf :: ForallTelescope -&gt; DataType
$cdataTypeOf :: ForallTelescope -&gt; DataType
toConstr :: ForallTelescope -&gt; Constr
$ctoConstr :: ForallTelescope -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallTelescope
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallTelescope
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallTelescope -&gt; c ForallTelescope
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallTelescope -&gt; c ForallTelescope
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | The list of arguments in a function 'Type'.</span><span>
</span><span id="line-220"></span><span class="hs-keyword">data</span><span> </span><span id="FunArgs"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-var">FunArgs</span></a></span></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FANil"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">-- ^ No more arguments.</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FAForalls"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallTelescope"><span class="hs-identifier hs-type">ForallTelescope</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-comment">-- ^ A series of @forall@ed type variables followed by a dot (if</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-comment">--   'ForallInvis') or an arrow (if 'ForallVis'). For example,</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">--   the type variables @a1 ... an@ in @forall a1 ... an. r@.</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FACxt"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-var">FACxt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- ^ A series of constraint arguments followed by @=&gt;@. For example,</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">--   the @(c1, ..., cn)@ in @(c1, ..., cn) =&gt; r@.</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-var">FAAnon</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow. For example, the @a@</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">--   in @a -&gt; r@.</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506311"><span id="local-6989586621679506320"><span class="annot"><span class="annottext">FunArgs -&gt; FunArgs -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FunArgs -&gt; FunArgs -&gt; Bool
$c/= :: FunArgs -&gt; FunArgs -&gt; Bool
== :: FunArgs -&gt; FunArgs -&gt; Bool
$c== :: FunArgs -&gt; FunArgs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506294"><span id="local-6989586621679506296"><span id="local-6989586621679506308"><span class="annot"><span class="annottext">Int -&gt; FunArgs -&gt; ShowS
[FunArgs] -&gt; ShowS
FunArgs -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FunArgs] -&gt; ShowS
$cshowList :: [FunArgs] -&gt; ShowS
show :: FunArgs -&gt; String
$cshow :: FunArgs -&gt; String
showsPrec :: Int -&gt; FunArgs -&gt; ShowS
$cshowsPrec :: Int -&gt; FunArgs -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506249"><span id="local-6989586621679506251"><span id="local-6989586621679506253"><span id="local-6989586621679506255"><span id="local-6989586621679506257"><span id="local-6989586621679506259"><span id="local-6989586621679506261"><span id="local-6989586621679506263"><span id="local-6989586621679506265"><span id="local-6989586621679506267"><span id="local-6989586621679506269"><span id="local-6989586621679506271"><span id="local-6989586621679506280"><span id="local-6989586621679506289"><span class="annot"><span class="annottext">Typeable FunArgs
FunArgs -&gt; DataType
FunArgs -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
dataTypeOf :: FunArgs -&gt; DataType
$cdataTypeOf :: FunArgs -&gt; DataType
toConstr :: FunArgs -&gt; Constr
$ctoConstr :: FunArgs -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | A /visible/ function argument type (i.e., one that must be supplied</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- explicitly in the source code). This is in contrast to /invisible/</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- arguments (e.g., the @c@ in @c =&gt; r@), which are instantiated without</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- the need for explicit user input.</span><span>
</span><span id="line-239"></span><span class="hs-keyword">data</span><span> </span><span id="VisFunArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier hs-var">VisFunArg</span></a></span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VisFADep"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFADep"><span class="hs-identifier hs-var">VisFADep</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- ^ A visible @forall@ (e.g., @forall a -&gt; a@).</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VisFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFAAnon"><span class="hs-identifier hs-var">VisFAAnon</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow (e.g., @a -&gt; r@).</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506239"><span id="local-6989586621679506244"><span class="annot"><span class="annottext">VisFunArg -&gt; VisFunArg -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VisFunArg -&gt; VisFunArg -&gt; Bool
$c/= :: VisFunArg -&gt; VisFunArg -&gt; Bool
== :: VisFunArg -&gt; VisFunArg -&gt; Bool
$c== :: VisFunArg -&gt; VisFunArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506228"><span id="local-6989586621679506230"><span id="local-6989586621679506237"><span class="annot"><span class="annottext">Int -&gt; VisFunArg -&gt; ShowS
[VisFunArg] -&gt; ShowS
VisFunArg -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [VisFunArg] -&gt; ShowS
$cshowList :: [VisFunArg] -&gt; ShowS
show :: VisFunArg -&gt; String
$cshow :: VisFunArg -&gt; String
showsPrec :: Int -&gt; VisFunArg -&gt; ShowS
$cshowsPrec :: Int -&gt; VisFunArg -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506192"><span id="local-6989586621679506194"><span id="local-6989586621679506196"><span id="local-6989586621679506198"><span id="local-6989586621679506200"><span id="local-6989586621679506202"><span id="local-6989586621679506204"><span id="local-6989586621679506206"><span id="local-6989586621679506208"><span id="local-6989586621679506210"><span id="local-6989586621679506212"><span id="local-6989586621679506214"><span id="local-6989586621679506219"><span id="local-6989586621679506224"><span class="annot"><span class="annottext">Typeable VisFunArg
VisFunArg -&gt; DataType
VisFunArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
dataTypeOf :: VisFunArg -&gt; DataType
$cdataTypeOf :: VisFunArg -&gt; DataType
toConstr :: VisFunArg -&gt; Constr
$ctoConstr :: VisFunArg -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Filter the visible function arguments from a list of 'FunArgs'.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-type">filterVisFunArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier hs-type">VisFunArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span id="filterVisFunArgs"><span class="annot"><span class="annottext">filterVisFunArgs :: FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var hs-var">filterVisFunArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span id="local-6989586621679506191"><span class="annot"><span class="annottext">ForallTelescope
</span><a href="#local-6989586621679506191"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679506190"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506190"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForallTelescope
</span><a href="#local-6989586621679506191"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-type">ForallVis</span></a></span><span> </span><span id="local-6989586621679506189"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506189"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndrUnit -&gt; VisFunArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#VisFADep"><span class="hs-identifier hs-var">VisFADep</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506189"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[VisFunArg]
</span><a href="#local-6989586621679506188"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-type">ForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VisFunArg]
</span><a href="#local-6989586621679506188"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679506188"><span class="annot"><span class="annottext">args' :: [VisFunArg]
</span><a href="#local-6989586621679506188"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506190"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506187"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506187"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506187"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-257"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-type">FAAnon</span></a></span><span> </span><span id="local-6989586621679506186"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506186"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679506185"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506185"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">Kind -&gt; VisFunArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#VisFAAnon"><span class="hs-identifier hs-var">VisFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506186"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506185"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Reconstruct an arrow 'Type' from its argument and result types.</span><span>
</span><span id="line-261"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-type">ravelType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-262"></span><span id="ravelType"><span class="annot"><span class="annottext">ravelType :: FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var hs-var">ravelType</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span> </span><span id="local-6989586621679506184"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506184"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506184"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- We need a special case for FAForalls ForallInvis followed by FACxt so that we may</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- collapse them into a single ForallT when raveling.</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- See Note [Desugaring and sweetening ForallT] in L.H.T.Desugar.Core.</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-type">ForallInvis</span></a></span><span> </span><span id="local-6989586621679506183"><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506183"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span id="local-6989586621679506182"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506182"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679506181"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506181"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506180"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506180"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; [Kind] -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506183"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506182"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506181"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506180"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-type">ForallInvis</span></a></span><span>  </span><span id="local-6989586621679506178"><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506178"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679506177"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506177"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679506176"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506176"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; [Kind] -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506178"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506177"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506176"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-type">ForallVis</span></a></span><span>   </span><span id="local-6989586621679506175"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506175"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506174"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506174"><span class="hs-identifier hs-var">_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506173"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506173"><span class="hs-identifier hs-var">_res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span>      </span><span class="annot"><span class="annottext">[TyVarBndrUnit] -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallVisT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506175"><span class="hs-identifier hs-var">_tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506174"><span class="hs-identifier hs-var">_args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506173"><span class="hs-identifier hs-var">_res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Visible dependent quantification supported only on GHC 8.10+&quot;</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span id="local-6989586621679506171"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506171"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679506170"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506170"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506169"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506169"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; [Kind] -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506171"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506170"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506169"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-type">FAAnon</span></a></span><span> </span><span id="local-6989586621679506168"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506168"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679506167"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506167"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679506166"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506166"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506168"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506167"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506166"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Decompose a function 'Type' into its arguments (the 'FunArgs') and its</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- result type (the 'Type).</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-type">unravelType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="unravelType"><span class="annot"><span class="annottext">unravelType :: Kind -&gt; (FunArgs, Kind)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var hs-var">unravelType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679506164"><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506164"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679506163"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506163"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679506162"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506162"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506161"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506161"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506160"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506160"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (FunArgs, Kind)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506162"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallTelescope -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; ForallTelescope
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506164"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Kind] -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-var">FACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506163"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506161"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506160"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span id="local-6989586621679506159"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506159"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679506158"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506158"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506157"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506157"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506156"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506156"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (FunArgs, Kind)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506158"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-var">FAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506159"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506157"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506156"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span id="local-6989586621679506155"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506155"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679506154"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506154"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506153"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506153"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506152"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506152"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (FunArgs, Kind)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506154"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallTelescope -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndrUnit] -&gt; ForallTelescope
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679506155"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679506153"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506152"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span id="local-6989586621679506151"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506151"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506151"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Remove all of the explicit kind signatures from a 'Type'.</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-type">unSigType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-296"></span><span id="unSigType"><span class="annot"><span class="annottext">unSigType :: Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var hs-var">unSigType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679506150"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506150"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506150"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679506149"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506149"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679506148"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506148"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506149"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506148"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679506147"><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506147"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679506146"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506146"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679506145"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506145"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; [Kind] -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679506147"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-var">unSigPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621679506146"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506145"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679506142"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506142"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679506141"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506141"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679506140"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506140"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Name -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">InfixT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506142"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506141"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506140"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span id="local-6989586621679506138"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506138"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679506137"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506137"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679506136"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506136"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Name -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">UInfixT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506138"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506137"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506136"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679506134"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506134"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ParensT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506134"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679506132"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506132"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679506131"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506131"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506132"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506131"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679506129"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506129"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679506128"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506128"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ImplicitParamT</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679506129"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506128"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span id="local-6989586621679506127"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506127"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506127"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Remove all of the explicit kind signatures from a 'Pred'.</span><span>
</span><span id="line-312"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-type">unSigPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 710
</span><span id="unSigPred"><span class="annot"><span class="annottext">unSigPred :: Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-var hs-var">unSigPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">unSigPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span class="hs-identifier">unSigPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">t1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- | Decompose an applied type into its individual components. For example, this:</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- Proxy \@Type Char</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-325"></span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- would be unfolded to this:</span><span>
</span><span id="line-327"></span><span class="hs-comment">--</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- ('ConT' ''Proxy, ['TyArg' ('ConT' ''Type), 'TANormal' ('ConT' ''Char)])</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-type">unfoldType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span id="unfoldType"><span class="annot"><span class="annottext">unfoldType :: Kind -&gt; (Kind, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var hs-var">unfoldType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679506126"><span class="annot"><span class="annottext">go :: [TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679506125"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506125"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506124"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506124"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506125"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506124"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506123"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506123"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679506122"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506122"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679506121"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506121"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506121"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506123"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506122"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506120"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506120"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679506119"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506119"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506120"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506119"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506118"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506118"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679506117"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506117"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506118"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506117"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506116"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506116"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679506115"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506115"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679506114"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506114"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Kind -&gt; (Kind, [TypeArg])
</span><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506114"><span class="hs-identifier hs-var">ki</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506116"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506115"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679506126"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679506112"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506112"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679506111"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506111"><span class="hs-identifier hs-var">ty</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506111"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679506112"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | An argument to a type, either a normal type ('TANormal') or a visible</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- kind application ('TyArg').</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- 'TypeArg' is useful when decomposing an application of a 'Type' to its</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- arguments (e.g., in 'unfoldType').</span><span>
</span><span id="line-351"></span><span class="hs-keyword">data</span><span> </span><span id="TypeArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-var">TypeArg</span></a></span></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TANormal"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TyArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679506105"><span id="local-6989586621679506109"><span class="annot"><span class="annottext">TypeArg -&gt; TypeArg -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeArg -&gt; TypeArg -&gt; Bool
$c/= :: TypeArg -&gt; TypeArg -&gt; Bool
== :: TypeArg -&gt; TypeArg -&gt; Bool
$c== :: TypeArg -&gt; TypeArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506095"><span id="local-6989586621679506097"><span id="local-6989586621679506103"><span class="annot"><span class="annottext">Int -&gt; TypeArg -&gt; ShowS
[TypeArg] -&gt; ShowS
TypeArg -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeArg] -&gt; ShowS
$cshowList :: [TypeArg] -&gt; ShowS
show :: TypeArg -&gt; String
$cshow :: TypeArg -&gt; String
showsPrec :: Int -&gt; TypeArg -&gt; ShowS
$cshowsPrec :: Int -&gt; TypeArg -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679506061"><span id="local-6989586621679506063"><span id="local-6989586621679506065"><span id="local-6989586621679506067"><span id="local-6989586621679506069"><span id="local-6989586621679506071"><span id="local-6989586621679506073"><span id="local-6989586621679506075"><span id="local-6989586621679506077"><span id="local-6989586621679506079"><span id="local-6989586621679506081"><span id="local-6989586621679506083"><span id="local-6989586621679506087"><span id="local-6989586621679506091"><span class="annot"><span class="annottext">Typeable TypeArg
TypeArg -&gt; DataType
TypeArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
dataTypeOf :: TypeArg -&gt; DataType
$cdataTypeOf :: TypeArg -&gt; DataType
toConstr :: TypeArg -&gt; Constr
$ctoConstr :: TypeArg -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Apply one 'Type' to a list of arguments.</span><span>
</span><span id="line-357"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier hs-type">applyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-358"></span><span id="applyType"><span class="annot"><span class="annottext">applyType :: Kind -&gt; [TypeArg] -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier hs-var hs-var">applyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; TypeArg -&gt; Kind
</span><a href="#local-6989586621679506060"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="#local-6989586621679506060"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621679506060"><span class="annot"><span class="annottext">apply :: Kind -&gt; TypeArg -&gt; Kind
</span><a href="#local-6989586621679506060"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679506059"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506059"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679506058"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506058"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506059"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506058"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="#local-6989586621679506060"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span id="local-6989586621679506057"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679506056"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506056"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>                           </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-operator hs-var">`AppKindT`</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506056"><span class="hs-identifier hs-var">_x</span></a></span><span class="hs-cpp">
#else
</span><span>                           </span><span class="hs-comment">-- VKA isn't supported, so</span><span>
</span><span id="line-367"></span><span>                           </span><span class="hs-comment">-- conservatively drop the argument</span><span>
</span><span id="line-368"></span><span>                           </span><span class="hs-identifier">f</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Filter the normal type arguments from a list of 'TypeArg's.</span><span>
</span><span id="line-372"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-type">filterTANormals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span id="filterTANormals"><span class="annot"><span class="annottext">filterTANormals :: [TypeArg] -&gt; [Kind]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-var hs-var">filterTANormals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; Maybe Kind
</span><a href="#local-6989586621679506054"><span class="hs-identifier hs-var">getTANormal</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621679506054"><span class="hs-identifier hs-type">getTANormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679506054"><span class="annot"><span class="annottext">getTANormal :: TypeArg -&gt; Maybe Kind
</span><a href="#local-6989586621679506054"><span class="hs-identifier hs-var hs-var">getTANormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679506053"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506053"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506053"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621679506054"><span class="hs-identifier hs-var">getTANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Extract the underlying 'Type' or 'Kind' from a 'TypeArg'. This forgets</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- information about whether a type is a normal argument or not, so use with</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- caution.</span><span>
</span><span id="line-382"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-type">probablyWrongUnTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-383"></span><span id="probablyWrongUnTypeArg"><span class="annot"><span class="annottext">probablyWrongUnTypeArg :: TypeArg -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-var hs-var">probablyWrongUnTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679506052"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506052"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506052"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-var">probablyWrongUnTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679506051"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506051"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679506051"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- Free names, etc.</span><span>
</span><span id="line-388"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | Check if a name occurs anywhere within a TH tree.</span><span>
</span><span id="line-391"></span><span id="local-6989586621679506953"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier hs-type">nameOccursIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679506953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-392"></span><span id="nameOccursIn"><span class="annot"><span class="annottext">nameOccursIn :: forall a. Data a =&gt; Name -&gt; a -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier hs-var hs-var">nameOccursIn</span></a></span></span><span> </span><span id="local-6989586621679506048"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506048"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506048"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">-- | Extract all Names mentioned in a TH tree.</span><span>
</span><span id="line-395"></span><span id="local-6989586621679506945"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier hs-type">allNamesIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679506945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-396"></span><span id="allNamesIn"><span class="annot"><span class="annottext">allNamesIn :: forall a. Data a =&gt; a -&gt; [Name]
</span><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier hs-var hs-var">allNamesIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Extract the names bound in a @Stmt@</span><span>
</span><span id="line-399"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-type">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-400"></span><span id="extractBoundNamesStmt"><span class="annot"><span class="annottext">extractBoundNamesStmt :: Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var hs-var">extractBoundNamesStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679506031"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506031"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506031"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-401"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679506029"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679506029"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679506029"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span id="local-6989586621679506024"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679506024"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679506024"><span class="hs-identifier hs-var">stmtss</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span id="local-6989586621679506022"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679506022"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679506022"><span class="hs-identifier hs-var">stmtss</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | Extract the names bound in a @Dec@ that could appear in a @let@ expression.</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-type">extractBoundNamesDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-410"></span><span id="extractBoundNamesDec"><span class="annot"><span class="annottext">extractBoundNamesDec :: Dec -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var hs-var">extractBoundNamesDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679506020"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506020"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506020"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679506017"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506017"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Body
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506017"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- | Extract the names bound in a @Pat@</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-type">extractBoundNamesPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-416"></span><span id="extractBoundNamesPat"><span class="annot"><span class="annottext">extractBoundNamesPat :: Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var hs-var">extractBoundNamesPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitP</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679506015"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506015"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679506015"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupP</span></span><span> </span><span id="local-6989586621679506013"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506013"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506013"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupP</span></span><span> </span><span id="local-6989586621679506011"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506011"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506011"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 901
</span><span>                             </span><span class="annot"><span class="annottext">[Kind]
</span><span class="hs-identifier">_</span></span><span class="hs-cpp">
#endif
</span><span>                               </span><span id="local-6989586621679506009"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506009"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679506009"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixP</span></span><span> </span><span id="local-6989586621679506007"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506007"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506006"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506006"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506007"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-426"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506006"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixP</span></span><span> </span><span id="local-6989586621679506003"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506003"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679506002"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506002"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506003"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-428"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506002"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensP</span></span><span> </span><span id="local-6989586621679506000"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506000"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679506000"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TildeP</span></span><span> </span><span id="local-6989586621679505998"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505998"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505998"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BangP</span></span><span> </span><span id="local-6989586621679505996"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505996"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505996"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsP</span></span><span> </span><span id="local-6989586621679505994"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679505994"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679505993"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505993"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679505994"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-433"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505993"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679505990"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679505990"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505989"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679505989"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679505990"><span class="hs-identifier hs-var">field_pats</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-436"></span><span>                                             </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679505989"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListP</span></span><span> </span><span id="local-6989586621679505986"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679505986"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679505986"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigP</span></span><span> </span><span id="local-6989586621679505984"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505984"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505984"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViewP</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679505982"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505982"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505982"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumP</span></span><span> </span><span id="local-6989586621679505980"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505980"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679505980"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-444"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- General utility</span><span>
</span><span id="line-446"></span><span class="hs-comment">----------------------------------------</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-comment">-- dirty implementation of explicit-to-implicit conversion</span><span>
</span><span id="line-450"></span><span class="hs-keyword">newtype</span><span> </span><span id="MagicIP"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span></span><span> </span><span id="local-6989586621679506925"><span class="annot"><a href="#local-6989586621679506925"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span id="local-6989586621679506924"><span class="annot"><a href="#local-6989586621679506924"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679506923"><span class="annot"><a href="#local-6989586621679506923"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MagicIP"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IP</span></span><span> </span><span class="annot"><a href="#local-6989586621679506925"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506924"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506923"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | Get an implicit param constraint (@IP name a@, which is the desugared</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- form of @(?name :: a)@) from an explicit value.</span><span>
</span><span id="line-454"></span><span class="hs-comment">--</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- This function is only available with GHC 8.0 or later.</span><span>
</span><span id="line-456"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier hs-type">bindIP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679506932"><span class="annot"><a href="#local-6989586621679506932"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span id="local-6989586621679506933"><span class="annot"><a href="#local-6989586621679506933"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679506931"><span class="annot"><a href="#local-6989586621679506931"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679506933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IP</span></span><span> </span><span class="annot"><a href="#local-6989586621679506932"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506931"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-457"></span><span id="bindIP"><span class="annot"><span class="annottext">bindIP :: forall (name :: Symbol) a r. a -&gt; (IP name a =&gt; r) -&gt; r
</span><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier hs-var hs-var">bindIP</span></a></span></span><span> </span><span id="local-6989586621679505978"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505978"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679505977"><span class="annot"><span class="annottext">IP name a =&gt; r
</span><a href="#local-6989586621679505977"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) a r. (IP name a =&gt; r) -&gt; MagicIP name a r
</span><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679506932"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="annottext">IP name a =&gt; r
</span><a href="#local-6989586621679505977"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679506933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505978"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-461"></span><span id="local-6989586621679506920"><span id="local-6989586621679506921"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-type">splitAtList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506921"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506920"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506920"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506920"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-462"></span><span id="splitAtList"><span class="annot"><span class="annottext">splitAtList :: forall a b. [a] -&gt; [b] -&gt; ([b], [b])
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var hs-var">splitAtList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679505974"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505974"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505974"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679505973"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505973"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505972"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679505972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679505971"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505971"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505970"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505970"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505969"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505969"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; ([b], [b])
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505973"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505971"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679505972"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505970"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505969"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span id="local-6989586621679506915"><span id="local-6989586621679506916"><span id="local-6989586621679506917"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-type">thdOf3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679506916"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679506915"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506915"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-469"></span><span id="thdOf3"><span class="annot"><span class="annottext">thdOf3 :: forall a b c. (a, b, c) -&gt; c
</span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var hs-var">thdOf3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679505968"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505968"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505968"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span id="local-6989586621679506909"><span id="local-6989586621679506910"><span id="local-6989586621679506911"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier hs-type">liftFst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506910"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506911"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506909"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506910"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506909"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-472"></span><span id="liftFst"><span class="annot"><span class="annottext">liftFst :: forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
</span><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier hs-var hs-var">liftFst</span></a></span></span><span> </span><span id="local-6989586621679505967"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505967"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505966"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505966"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679505965"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505965"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505967"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505966"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505965"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span id="local-6989586621679506903"><span id="local-6989586621679506904"><span id="local-6989586621679506905"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier hs-type">liftSnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506905"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506904"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506903"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506905"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506903"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506904"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-475"></span><span id="liftSnd"><span class="annot"><span class="annottext">liftSnd :: forall a b c. (a -&gt; b) -&gt; (c, a) -&gt; (c, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier hs-var hs-var">liftSnd</span></a></span></span><span> </span><span id="local-6989586621679505964"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505964"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505963"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505963"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679505962"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505962"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505963"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505964"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505962"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span id="local-6989586621679506896"><span id="local-6989586621679506897"><span id="local-6989586621679506898"><span id="local-6989586621679506899"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-type">thirdOf3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506898"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506897"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506896"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506897"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506896"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506898"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-478"></span><span id="thirdOf3"><span class="annot"><span class="annottext">thirdOf3 :: forall a b c d. (a -&gt; b) -&gt; (c, d, a) -&gt; (c, d, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-var hs-var">thirdOf3</span></a></span></span><span> </span><span id="local-6989586621679505961"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505961"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505960"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505960"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505959"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679505959"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505958"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505958"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679505960"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679505959"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679505961"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505958"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- lift concatMap into a monad</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- could this be more efficient?</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Concatenate the result of a @mapM@</span><span>
</span><span id="line-483"></span><span id="local-6989586621679506888"><span id="local-6989586621679506889"><span id="local-6989586621679506890"><span id="local-6989586621679506891"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-type">concatMapM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679506891"><span class="hs-identifier hs-type">monad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679506890"><span class="hs-identifier hs-type">monoid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679506889"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506891"><span class="hs-identifier hs-type">monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506890"><span class="hs-identifier hs-type">monoid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506889"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506891"><span class="hs-identifier hs-type">monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506890"><span class="hs-identifier hs-type">monoid</span></a></span></span></span></span></span><span>
</span><span id="line-485"></span><span id="concatMapM"><span class="annot"><span class="annottext">concatMapM :: forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var hs-var">concatMapM</span></a></span></span><span> </span><span id="local-6989586621679505946"><span class="annot"><span class="annottext">a -&gt; monad monoid
</span><a href="#local-6989586621679505946"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679505945"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679505945"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>  </span><span id="local-6989586621679505944"><span class="annot"><span class="annottext">t monoid
</span><a href="#local-6989586621679505944"><span class="hs-identifier hs-var">bss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; monad monoid
</span><a href="#local-6989586621679505946"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679505945"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">t monoid
</span><a href="#local-6989586621679505944"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Monadic version of mapAccumL</span><span>
</span><span id="line-491"></span><span id="local-6989586621679506875"><span id="local-6989586621679506876"><span id="local-6989586621679506877"><span id="local-6989586621679506878"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-type">mapAccumLM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679506878"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506877"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506876"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506877"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679506875"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ combining function</span><span>
</span><span id="line-493"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506877"><span class="hs-identifier hs-type">acc</span></a></span><span>                      </span><span class="hs-comment">-- ^ initial state</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506876"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>                      </span><span class="hs-comment">-- ^ inputs</span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506877"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506875"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span><span>             </span><span class="hs-comment">-- ^ final state, outputs</span><span>
</span><span id="line-496"></span><span id="mapAccumLM"><span class="annot"><span class="annottext">mapAccumLM :: forall (m :: * -&gt; *) acc x y.
Monad m =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; [x] -&gt; m (acc, [y])
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var hs-var">mapAccumLM</span></a></span></span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679505936"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505936"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505936"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span id="local-6989586621679505935"><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679505935"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679505934"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505934"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505933"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679505933"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679505932"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679505932"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679505931"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505931"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505930"><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679505930"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679505935"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505934"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679505933"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679505929"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505929"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505928"><span class="annot"><span class="annottext">[y]
</span><a href="#local-6989586621679505928"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) acc x y.
Monad m =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; [x] -&gt; m (acc, [y])
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679505935"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505931"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679505932"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679505929"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679505930"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[y]
</span><a href="#local-6989586621679505928"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-503"></span><span id="local-6989586621679506868"><span id="local-6989586621679506869"><span id="local-6989586621679506870"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-type">mapMaybeM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679506870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679506868"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506868"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-504"></span><span id="mapMaybeM"><span class="annot"><span class="annottext">mapMaybeM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var hs-var">mapMaybeM</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span id="local-6989586621679505921"><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679505921"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505920"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505920"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679505919"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505919"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-506"></span><span>  </span><span id="local-6989586621679505918"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679505918"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679505921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505920"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679505917"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505917"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679505921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505919"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679505918"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505917"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679505916"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679505916"><span class="hs-identifier hs-var">z</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679505916"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679505917"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span id="local-6989586621679506863"><span id="local-6989586621679506864"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-type">expectJustM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679506864"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679506863"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506864"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506863"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-513"></span><span id="expectJustM"><span class="annot"><span class="annottext">expectJustM :: forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; Maybe a -&gt; m a
</span><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-var hs-var">expectJustM</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679505910"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505910"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505910"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-var">expectJustM</span></a></span><span> </span><span id="local-6989586621679505909"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679505909"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">Fail.fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679505909"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span id="local-6989586621679506859"><span id="local-6989586621679506860"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-type">firstMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506860"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679506859"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679506860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679506859"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-517"></span><span id="firstMatch"><span class="annot"><span class="annottext">firstMatch :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var hs-var">firstMatch</span></a></span></span><span> </span><span id="local-6989586621679505908"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679505908"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679505907"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505907"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679505908"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679505907"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- | Semi-shallow version of 'everywhereM' - does not recurse into children of nodes of type @a@ (only applies the handler to them).</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- &gt;&gt;&gt; topEverywhereM (pure . fmap (*10) :: [Integer] -&gt; Identity [Integer]) ([1,2,3] :: [Integer], &quot;foo&quot; :: String)</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- Identity ([10,20,30],&quot;foo&quot;)</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- &gt;&gt;&gt; everywhereM (mkM (pure . fmap (*10) :: [Integer] -&gt; Identity [Integer])) ([1,2,3] :: [Integer], &quot;foo&quot; :: String)</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- Identity ([10,200,3000],&quot;foo&quot;)</span><span>
</span><span id="line-526"></span><span id="local-6989586621679506853"><span id="local-6989586621679506854"><span id="local-6989586621679506855"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-type">topEverywhereM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679506855"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679506854"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679506853"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679506855"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506853"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506855"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506854"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679506853"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679506854"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-527"></span><span id="topEverywhereM"><span class="annot"><span class="annottext">topEverywhereM :: forall a b (m :: * -&gt; *).
(Typeable a, Data b, Monad m) =&gt;
(a -&gt; m a) -&gt; b -&gt; m b
</span><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-var hs-var">topEverywhereM</span></a></span></span><span> </span><span id="local-6989586621679505896"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679505896"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Data a, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">gmapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b (m :: * -&gt; *).
(Typeable a, Data b, Monad m) =&gt;
(a -&gt; m a) -&gt; b -&gt; m b
</span><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-var">topEverywhereM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679505896"><span class="hs-identifier hs-var">handler</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(Monad m, Typeable a, Typeable b) =&gt;
(a -&gt; m a) -&gt; (b -&gt; m b) -&gt; a -&gt; m a
</span><span class="hs-operator hs-var">`extM`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679505896"><span class="hs-identifier hs-var">handler</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-comment">-- Checks if a String names a valid Haskell infix data constructor</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- (i.e., does it begin with a colon?).</span><span>
</span><span id="line-532"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-type">isInfixDataCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-533"></span><span id="isInfixDataCon"><span class="annot"><span class="annottext">isInfixDataCon :: String -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var hs-var">isInfixDataCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-534"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var">isInfixDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | Returns 'True' if the argument 'Name' is that of 'Kind.Type'</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- (or @*@ or 'Kind.&#9733;', to support older GHCs).</span><span>
</span><span id="line-538"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier hs-type">isTypeKindName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-539"></span><span id="isTypeKindName"><span class="annot"><span class="annottext">isTypeKindName :: Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier hs-var hs-var">isTypeKindName</span></a></span></span><span> </span><span id="local-6989586621679505889"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679505889"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679505889"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 805
</span><span>                </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">starKindName</span><span>
</span><span id="line-542"></span><span>                </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">uniStarKindName</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- | The 'Name' of:</span><span>
</span><span id="line-546"></span><span class="hs-comment">--</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- 1. The kind 'Kind.Type', on GHC 8.0 or later.</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- 2. The kind @*@ on older GHCs.</span><span>
</span><span id="line-549"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-type">typeKindName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span id="typeKindName"><span class="annot"><span class="annottext">typeKindName :: Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var hs-var">typeKindName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Kind.Type</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">typeKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">starKindName</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 805
</span><span class="hs-comment">-- | The 'Name' of the kind @*@.</span><span>
</span><span id="line-558"></span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">Kind.*</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkNameG_tc</span><span> </span><span class="hs-string">&quot;ghc-prim&quot;</span><span> </span><span class="hs-string">&quot;GHC.Prim&quot;</span><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- | The 'Name' of:</span><span>
</span><span id="line-566"></span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- 1. The kind 'Kind.&#9733;', on GHC 8.0 or later.</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- 2. The kind @*@ on older GHCs.</span><span>
</span><span id="line-569"></span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">Kind.&#9733;</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">starKindName</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span></pre></body></html>