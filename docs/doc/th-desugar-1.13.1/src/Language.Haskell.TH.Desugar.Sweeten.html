<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Sweeten.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Converts desugared TH back into real TH.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Module      :  Language.Haskell.TH.Desugar.Sweeten</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   :  (C) 2014 Richard Eisenberg</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  :  Ryan Scott</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Portability :  non-portable</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- The functions in this module convert desugared Template Haskell back into</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- proper Template Haskell.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Sweeten</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier">expToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier">matchToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier">patToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier">decsToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier">decToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier">letDecToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier">typeToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier">conToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier">foreignToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier">pragmaToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier">ruleBndrToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier">clauseToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier">tvbToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier">cxtToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier">predToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier">derivClauseToTH</span></a></span><span class="hs-special">,</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier">patSynDirToTH</span></a></span><span class="hs-special">,</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier">typeArgToTH</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cxt</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.AST</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier">DTypeArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-type">expToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-50"></span><span id="expToTH"><span class="annot"><span class="annottext">expToTH :: DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var hs-var">expToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-type">DVarE</span></a></span><span> </span><span id="local-6989586621679512857"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512857"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512857"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-type">DConE</span></a></span><span> </span><span id="local-6989586621679512854"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512854"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512854"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-type">DLitE</span></a></span><span> </span><span id="local-6989586621679512851"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679512851"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679512851"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-type">DAppE</span></a></span><span> </span><span id="local-6989586621679512848"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512848"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679512847"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512847"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512848"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512847"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-type">DLamE</span></a></span><span> </span><span id="local-6989586621679512844"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679512844"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679512843"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512843"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">LamE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679512844"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512843"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-type">DCaseE</span></a></span><span> </span><span id="local-6989586621679512839"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512839"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679512838"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679512838"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512839"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; Match
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-var">matchToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679512838"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-type">DLetE</span></a></span><span> </span><span id="local-6989586621679512835"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679512835"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679512834"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512834"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">LetE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679512835"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512834"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-type">DSigE</span></a></span><span> </span><span id="local-6989586621679512831"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512831"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679512830"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512830"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><span class="hs-identifier hs-var">SigE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512831"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512830"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DStaticE</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Static expressions supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DStaticE"><span class="hs-identifier hs-type">DStaticE</span></a></span><span> </span><span id="local-6989586621679512827"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512827"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><span class="hs-identifier hs-var">StaticE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512827"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-type">DAppTypeE</span></a></span><span> </span><span id="local-6989586621679512824"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512824"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679512823"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512823"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><span class="hs-identifier hs-var">AppTypeE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512824"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512823"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- type applications, we will simply drop the applied type.</span><span>
</span><span id="line-68"></span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppTypeE</span><span> </span><span class="hs-identifier">exp</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">exp</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-type">matchToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-72"></span><span id="matchToTH"><span class="annot"><span class="annottext">matchToTH :: DMatch -&gt; Match
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-var hs-var">matchToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span> </span><span id="local-6989586621679512820"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512820"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679512819"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512819"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512820"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512819"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-type">patToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-75"></span><span id="patToTH"><span class="annot"><span class="annottext">patToTH :: DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var hs-var">patToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span id="local-6989586621679512815"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679512815"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Pat
</span><span class="hs-identifier hs-var">LitP</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679512815"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-76"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679512812"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512812"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512812"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679512810"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512810"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512809"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512809"><span class="hs-identifier hs-var">_tys</span></a></span></span><span> </span><span id="local-6989586621679512808"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679512808"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512810"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 901
</span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512809"><span class="hs-identifier hs-var">_tys</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679512808"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679512805"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512805"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><span class="hs-identifier hs-var">TildeP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512805"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679512802"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512802"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><span class="hs-identifier hs-var">BangP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512802"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679512799"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512799"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679512798"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512798"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Type -&gt; Pat
</span><span class="hs-identifier hs-var">SigP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512799"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512798"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-type">decsToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span id="decsToTH"><span class="annot"><span class="annottext">decsToTH :: [DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var hs-var">decsToTH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | This returns a list of @Dec@s because GHC 7.6.3 does not have</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- a one-to-one mapping between 'DDec' and @Dec@.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-type">decToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-93"></span><span id="decToTH"><span class="annot"><span class="annottext">decToTH :: DDec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var hs-var">decToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span> </span><span id="local-6989586621679512793"><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679512793"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679512793"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-type">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span id="local-6989586621679512790"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512790"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512789"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512789"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512788"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512788"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512787"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512787"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679512786"><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512786"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679512785"><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512785"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="annot"><span class="annottext">[Type]
-&gt; Name
-&gt; [TyVarBndr ()]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">DataD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512790"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512789"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512788"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512787"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512786"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512785"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">DataD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-type">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span id="local-6989586621679512781"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512781"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512780"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512780"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512779"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512779"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512778"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512778"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679512777"><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512777"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679512776"><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512776"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="annot"><span class="annottext">[Type]
-&gt; Name
-&gt; [TyVarBndr ()]
-&gt; Maybe Type
-&gt; Con
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">NewtypeD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512781"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512780"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512779"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512778"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512777"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512776"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-type">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span id="local-6989586621679512774"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512774"><span class="hs-identifier hs-var">_cxt</span></a></span></span><span> </span><span id="local-6989586621679512773"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512773"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span id="local-6989586621679512772"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512772"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span> </span><span id="local-6989586621679512771"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512771"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679512770"><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512770"><span class="hs-identifier hs-var">_cons</span></a></span></span><span> </span><span id="local-6989586621679512769"><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512769"><span class="hs-identifier hs-var">_derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Newtype declaration without exactly 1 constructor.&quot;</span></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynD"><span class="hs-identifier hs-type">DTySynD</span></a></span><span> </span><span id="local-6989586621679512766"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512766"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512765"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512765"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512764"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512764"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr ()] -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">TySynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512766"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512765"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512764"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClassD"><span class="hs-identifier hs-type">DClassD</span></a></span><span> </span><span id="local-6989586621679512761"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512761"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512760"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512760"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512759"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512759"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512758"><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679512758"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679512757"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512757"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">[Type] -&gt; Name -&gt; [TyVarBndr ()] -&gt; [FunDep] -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">ClassD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512761"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512760"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512759"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679512758"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var">decsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512757"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInstanceD"><span class="hs-identifier hs-type">DInstanceD</span></a></span><span> </span><span id="local-6989586621679512754"><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679512754"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679512753"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512753"><span class="hs-identifier hs-var">_mtvbs</span></a></span></span><span> </span><span id="local-6989586621679512752"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512752"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512751"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512751"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679512750"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512750"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- We deliberately avoid sweetening _mtvbs. See #151.</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="annottext">Maybe Overlap -&gt; [DType] -&gt; DType -&gt; [DDec] -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-var">instanceDToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679512754"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512752"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512751"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512750"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeignD"><span class="hs-identifier hs-type">DForeignD</span></a></span><span> </span><span id="local-6989586621679512747"><span class="annot"><span class="annottext">DForeign
</span><a href="#local-6989586621679512747"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Foreign -&gt; Dec
</span><span class="hs-identifier hs-var">ForeignD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForeign -&gt; Foreign
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var">foreignToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DForeign
</span><a href="#local-6989586621679512747"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DOpenTypeFamilyD"><span class="hs-identifier hs-type">DOpenTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679512743"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512743"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512742"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512742"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512741"><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679512741"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span id="local-6989586621679512740"><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679512740"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; Dec
</span><span class="hs-identifier hs-var">OpenTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; [TyVarBndr ()]
-&gt; FamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; TypeFamilyHead
</span><span class="hs-identifier hs-var">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512743"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512742"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679512741"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679512740"><span class="hs-identifier hs-var">ann</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DOpenTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">frs</span><span> </span><span class="hs-identifier">_ann</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">frs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataFamilyD"><span class="hs-identifier hs-type">DDataFamilyD</span></a></span><span> </span><span id="local-6989586621679512735"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512735"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512734"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512734"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512733"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512733"><span class="hs-identifier hs-var">mk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr ()] -&gt; Maybe Type -&gt; Dec
</span><span class="hs-identifier hs-var">DataFamilyD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512735"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512734"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512733"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">DataFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">mk</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataInstD"><span class="hs-identifier hs-type">DDataInstD</span></a></span><span> </span><span id="local-6989586621679512730"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679512730"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679512729"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512729"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512728"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512728"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679512727"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512727"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679512726"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512726"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679512725"><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512725"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679512724"><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512724"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679512721"><span class="annot"><span class="annottext">ndc :: DNewOrDataCons
</span><a href="#local-6989586621679512721"><span class="hs-identifier hs-var hs-var">ndc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679512730"><span class="hs-identifier hs-var">nd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512725"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679512720"><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512720"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCon -&gt; DNewOrDataCons
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-var">DNewtypeCon</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512720"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-135"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Newtype that doesn't have only one constructor&quot;</span></span><span>
</span><span id="line-136"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">[DCon]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DCon] -&gt; DNewOrDataCons
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-var">DDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512725"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
-&gt; [DType]
-&gt; Maybe [DTyVarBndrUnit]
-&gt; DType
-&gt; Maybe DType
-&gt; [DDerivClause]
-&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-var">dataInstDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
</span><a href="#local-6989586621679512721"><span class="hs-identifier hs-var">ndc</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512729"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512728"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512727"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512726"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512724"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynInstD"><span class="hs-identifier hs-type">DTySynInstD</span></a></span><span> </span><span id="local-6989586621679512715"><span class="annot"><span class="annottext">DTySynEqn
</span><a href="#local-6989586621679512715"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var">tySynEqnToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DTySynEqn
</span><a href="#local-6989586621679512715"><span class="hs-identifier hs-var">eqn</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynInstD</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eqn'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-identifier">eqn</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn'</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClosedTypeFamilyD"><span class="hs-identifier hs-type">DClosedTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679512711"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512711"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512710"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512710"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512709"><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679512709"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span id="local-6989586621679512708"><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679512708"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679512707"><span class="annot"><span class="annottext">[DTySynEqn]
</span><a href="#local-6989586621679512707"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; [TySynEqn] -&gt; Dec
</span><span class="hs-identifier hs-var">ClosedTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; [TyVarBndr ()]
-&gt; FamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; TypeFamilyHead
</span><span class="hs-identifier hs-var">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512711"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512710"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679512709"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679512708"><span class="hs-identifier hs-var">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var">tySynEqnToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DTySynEqn]
</span><a href="#local-6989586621679512707"><span class="hs-identifier hs-var">eqns</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DClosedTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">frs</span><span> </span><span class="hs-identifier">_ann</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">frs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">tySynEqnToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRoleAnnotD"><span class="hs-identifier hs-type">DRoleAnnotD</span></a></span><span> </span><span id="local-6989586621679512703"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512703"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512702"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679512702"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Role] -&gt; Dec
</span><span class="hs-identifier hs-var">RoleAnnotD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512703"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679512702"><span class="hs-identifier hs-var">roles</span></a></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DStandaloneDerivD"><span class="hs-identifier hs-type">DStandaloneDerivD</span></a></span><span> </span><span id="local-6989586621679512699"><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512699"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679512698"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512698"><span class="hs-identifier hs-var">_mtvbs</span></a></span></span><span> </span><span id="local-6989586621679512697"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512697"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512696"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512696"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- We deliberately avoid sweetening _mtvbs. See #151.</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; [DType] -&gt; DType -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-var">standaloneDerivDToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512699"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512697"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512696"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDefaultSigD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Default method signatures supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDefaultSigD"><span class="hs-identifier hs-type">DDefaultSigD</span></a></span><span> </span><span id="local-6989586621679512693"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512693"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512692"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512692"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">DefaultSigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512693"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512692"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynD"><span class="hs-identifier hs-type">DPatSynD</span></a></span><span> </span><span id="local-6989586621679512689"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512689"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512688"><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679512688"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679512687"><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679512687"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679512686"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512686"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; PatSynArgs -&gt; PatSynDir -&gt; Pat -&gt; Dec
</span><span class="hs-identifier hs-var">PatSynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512689"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679512688"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPatSynDir -&gt; PatSynDir
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679512687"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512686"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynSigD"><span class="hs-identifier hs-type">DPatSynSigD</span></a></span><span> </span><span id="local-6989586621679512683"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512683"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512682"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512682"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">PatSynSigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512683"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512682"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-identifier">DPatSynD</span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">patSynErr</span><span>
</span><span id="line-168"></span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-identifier">DPatSynSigD</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">patSynErr</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKiSigD"><span class="hs-identifier hs-type">DKiSigD</span></a></span><span> </span><span id="local-6989586621679512679"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512679"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512678"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512678"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">KiSigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512679"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512678"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DKiSigD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Standalone kind signatures supported only in GHC 8.10+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 801
</span><span class="hs-identifier">patSynErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-179"></span><span class="hs-identifier">patSynErr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Pattern synonyms supported only in GHC 8.2+&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Indicates whether something is a newtype or data type, bundling its</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- constructor(s) along with it.</span><span>
</span><span id="line-184"></span><span class="hs-keyword">data</span><span> </span><span id="DNewOrDataCons"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewOrDataCons"><span class="hs-identifier hs-var">DNewOrDataCons</span></a></span></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DNewtypeCon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-var">DNewtypeCon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DDataCons"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-var">DDataCons</span></a></span></span><span>   </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Sweeten a 'DDataInstD'.</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-type">dataInstDecToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewOrDataCons"><span class="hs-identifier hs-type">DNewOrDataCons</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-190"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-191"></span><span id="dataInstDecToTH"><span class="annot"><span class="annottext">dataInstDecToTH :: DNewOrDataCons
-&gt; [DType]
-&gt; Maybe [DTyVarBndrUnit]
-&gt; DType
-&gt; Maybe DType
-&gt; [DDerivClause]
-&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-var hs-var">dataInstDecToTH</span></a></span></span><span> </span><span id="local-6989586621679512674"><span class="annot"><span class="annottext">DNewOrDataCons
</span><a href="#local-6989586621679512674"><span class="hs-identifier hs-var">ndc</span></a></span></span><span> </span><span id="local-6989586621679512673"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512673"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512672"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512672"><span class="hs-identifier hs-var">_mtvbs</span></a></span></span><span> </span><span id="local-6989586621679512671"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512671"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679512670"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512670"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679512669"><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512669"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
</span><a href="#local-6989586621679512674"><span class="hs-identifier hs-var">ndc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-type">DNewtypeCon</span></a></span><span> </span><span id="local-6989586621679512668"><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512668"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>      </span><span class="annot"><span class="annottext">[Type]
-&gt; Maybe [TyVarBndr ()]
-&gt; Type
-&gt; Maybe Type
-&gt; Con
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">NewtypeInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512673"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512672"><span class="hs-identifier hs-var">_mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512671"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512670"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679512668"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512669"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span>      </span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">_mk</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-type">DDataCons</span></a></span><span> </span><span id="local-6989586621679512666"><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512666"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>      </span><span class="annot"><span class="annottext">[Type]
-&gt; Maybe [TyVarBndr ()]
-&gt; Type
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">DataInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512673"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512672"><span class="hs-identifier hs-var">_mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512671"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679512670"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679512666"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679512669"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span>      </span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">_mk</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679512664"><span class="annot"><span class="annottext">_lhs' :: Type
</span><a href="#local-6989586621679512664"><span class="hs-identifier hs-var hs-var">_lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512671"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679512660"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512660"><span class="hs-identifier hs-var">_n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679512659"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679512659"><span class="hs-identifier hs-var">_lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512664"><span class="hs-identifier hs-var">_lhs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679512656"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512656"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679512655"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679512655"><span class="hs-identifier hs-var">lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512656"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-var">filterTANormals</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679512655"><span class="hs-identifier hs-var">lhs_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal data instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ppr a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512664"><span class="hs-identifier hs-var">_lhs'</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-type">frsToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFamilyResultSig"><span class="hs-identifier hs-type">DFamilyResultSig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span>
</span><span id="line-227"></span><span id="frsToTH"><span class="annot"><span class="annottext">frsToTH :: DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var hs-var">frsToTH</span></a></span></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNoSig"><span class="hs-identifier hs-var">DNoSig</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier hs-var">NoSig</span></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindSig"><span class="hs-identifier hs-type">DKindSig</span></a></span><span> </span><span id="local-6989586621679512649"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512649"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FamilyResultSig
</span><span class="hs-identifier hs-var">KindSig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512649"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarSig"><span class="hs-identifier hs-type">DTyVarSig</span></a></span><span> </span><span id="local-6989586621679512646"><span class="annot"><span class="annottext">DTyVarBndrUnit
</span><a href="#local-6989586621679512646"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarBndr () -&gt; FamilyResultSig
</span><span class="hs-identifier hs-var">TyVarSig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DTyVarBndrUnit
</span><a href="#local-6989586621679512646"><span class="hs-identifier hs-var">tvb</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DFamilyResultSig</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><span id="line-232"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">DNoSig</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-233"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DKindSig</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTyVarSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DPlainTV</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-235"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTyVarSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DKindedTV</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Name</span><span>
</span><span id="line-240"></span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">nm</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nm</span><span>
</span><span id="line-241"></span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-identifier">error</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Template Haskell in GHC &lt; 8.0 only allows simple derivings: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Sweeten a 'DLetDec'.</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-type">letDecToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-247"></span><span id="letDecToTH"><span class="annot"><span class="annottext">letDecToTH :: DLetDec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var hs-var">letDecToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFunD"><span class="hs-identifier hs-type">DFunD</span></a></span><span> </span><span id="local-6989586621679512643"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512643"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679512642"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679512642"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; Dec
</span><span class="hs-identifier hs-var">FunD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512643"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var">clauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679512642"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-type">DValD</span></a></span><span> </span><span id="local-6989586621679512639"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512639"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679512638"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512638"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">ValD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679512639"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512638"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigD"><span class="hs-identifier hs-type">DSigD</span></a></span><span> </span><span id="local-6989586621679512635"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512635"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679512634"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512634"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">SigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512635"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512634"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfixD"><span class="hs-identifier hs-type">DInfixD</span></a></span><span> </span><span id="local-6989586621679512631"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679512631"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679512630"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512630"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; Name -&gt; Dec
</span><span class="hs-identifier hs-var">InfixD</span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679512631"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512630"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragmaD"><span class="hs-identifier hs-type">DPragmaD</span></a></span><span> </span><span id="local-6989586621679512627"><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679512627"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Dec
</span><span class="hs-identifier hs-var">PragmaD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPragma -&gt; Pragma
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679512627"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-type">conToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span id="conToTH"><span class="annot"><span class="annottext">conToTH :: DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var hs-var">conToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679512624"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512624"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-type">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">DDeclaredInfix
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679512622"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679512622"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679512621"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512621"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">[Name] -&gt; [BangType] -&gt; Type -&gt; Con
</span><span class="hs-identifier hs-var">GadtC</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512624"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679512622"><span class="hs-identifier hs-var">stys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512621"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679512618"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512618"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-type">DRecC</span></a></span><span> </span><span id="local-6989586621679512616"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679512616"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679512615"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512615"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">[Name] -&gt; [VarBangType] -&gt; Type -&gt; Con
</span><span class="hs-identifier hs-var">RecGadtC</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512618"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c d. (a -&gt; b) -&gt; (c, d, a) -&gt; (c, d, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-var">thirdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679512616"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512615"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DNormalC</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">sty1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sty2</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-identifier">InfixC</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sty1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sty2</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Note: it's possible that someone could pass in a DNormalC value that</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- erroneously claims that it's declared infix (e.g., if has more than two</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- fields), but we will fall back on NormalC in such a scenario.</span><span>
</span><span id="line-265"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DNormalC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">stys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-identifier">NormalC</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">stys</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DRecC</span><span> </span><span class="hs-identifier">vstys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-identifier">RecC</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-special">,</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">vstys</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- On GHC 8.0 or later, we sweeten every constructor to GADT syntax, so it is</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- perfectly OK to put all of the quantified type variables</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- (both universal and existential) in a ForallC.</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span id="local-6989586621679512612"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512612"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512611"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512611"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512610"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512610"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512609"><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679512609"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679512608"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512608"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Con -&gt; Con
</span><span class="hs-identifier hs-var">ForallC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512612"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512611"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec] -&gt; [DType] -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512610"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679512609"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512608"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- On GHCs earlier than 8.0, we must be careful, since the only time ForallC is</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- used is when there are either:</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- 1. Any existentially quantified type variables</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- 2. A constructor context</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- If neither of these conditions hold, then we needn't put a ForallC at the</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- front, since it would be completely pointless (you'd end up with things like</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- @data Foo = forall. MkFoo@!).</span><span>
</span><span id="line-286"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">fields</span><span> </span><span class="hs-identifier">rty</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">cxt</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">con'</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ForallC</span><span> </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">con'</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- Fortunately, on old GHCs, it's especially easy to distinguish between</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- universally and existentially quantified type variables. When desugaring</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- a ForallC, we just stick all of the universals (from the datatype</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-comment">-- definition) at the front of the @forall@. Therefore, it suffices to</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- count the number of type variables in the return type and drop that many</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">-- variables from the @forall@ in the ForallC, leaving only the</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">-- existentials.</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndr</span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">rty</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t2</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DSigT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DVarT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">DArrowT</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLitT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-comment">-- These won't show up on pre-8.0 GHCs</span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;`forall` type used in GADT return type&quot;</span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConstrainedT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Constrained type used in GADT return type&quot;</span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">DWildCardT</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-identifier">con'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Con</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-identifier">con'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">fields</span><span> </span><span class="hs-identifier">rty</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-322"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-type">instanceDToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Overlap</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-323"></span><span id="instanceDToTH"><span class="annot"><span class="annottext">instanceDToTH :: Maybe Overlap -&gt; [DType] -&gt; DType -&gt; [DDec] -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-var hs-var">instanceDToTH</span></a></span></span><span> </span><span id="local-6989586621679512606"><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679512606"><span class="hs-identifier hs-var">_over</span></a></span></span><span> </span><span id="local-6989586621679512605"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512605"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512604"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512604"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679512603"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512603"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="annottext">Maybe Overlap -&gt; [Type] -&gt; Type -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">InstanceD</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>            </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679512606"><span class="hs-identifier hs-var">_over</span></a></span><span class="hs-cpp">
#endif
</span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512605"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512604"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var">decsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679512603"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-type">standaloneDerivDToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 710
</span><span id="standaloneDerivDToTH"><span class="annot"><span class="annottext">standaloneDerivDToTH :: Maybe DDerivStrategy -&gt; [DType] -&gt; DType -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-var hs-var">standaloneDerivDToTH</span></a></span></span><span> </span><span id="local-6989586621679512601"><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512601"><span class="hs-identifier hs-var">_mds</span></a></span></span><span> </span><span id="local-6989586621679512600"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512600"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512599"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512599"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><span class="annottext">Maybe DerivStrategy -&gt; [Type] -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">StandaloneDerivD</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 802
</span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512601"><span class="hs-identifier hs-var">_mds</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512600"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512599"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">standaloneDerivDToTH</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Standalone deriving supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-type">foreignToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeign"><span class="hs-identifier hs-type">DForeign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foreign</span></span><span>
</span><span id="line-343"></span><span id="foreignToTH"><span class="annot"><span class="annottext">foreignToTH :: DForeign -&gt; Foreign
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var hs-var">foreignToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DImportF"><span class="hs-identifier hs-type">DImportF</span></a></span><span> </span><span id="local-6989586621679512595"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679512595"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679512594"><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679512594"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621679512593"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512593"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679512592"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512592"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512591"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512591"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">Callconv -&gt; Safety -&gt; [Char] -&gt; Name -&gt; Type -&gt; Foreign
</span><span class="hs-identifier hs-var">ImportF</span></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679512595"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679512594"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512593"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512592"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512591"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var">foreignToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExportF"><span class="hs-identifier hs-type">DExportF</span></a></span><span> </span><span id="local-6989586621679512588"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679512588"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679512587"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512587"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679512586"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512586"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512585"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512585"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; [Char] -&gt; Name -&gt; Type -&gt; Foreign
</span><span class="hs-identifier hs-var">ExportF</span></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679512588"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512587"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512585"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-type">pragmaToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragma"><span class="hs-identifier hs-type">DPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pragma</span></span><span>
</span><span id="line-348"></span><span id="pragmaToTH"><span class="annot"><span class="annottext">pragmaToTH :: DPragma -&gt; Pragma
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var hs-var">pragmaToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInlineP"><span class="hs-identifier hs-type">DInlineP</span></a></span><span> </span><span id="local-6989586621679512582"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512582"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512581"><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679512581"><span class="hs-identifier hs-var">inl</span></a></span></span><span> </span><span id="local-6989586621679512580"><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679512580"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679512579"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512579"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Inline -&gt; RuleMatch -&gt; Phases -&gt; Pragma
</span><span class="hs-identifier hs-var">InlineP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512582"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679512581"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679512580"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512579"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseP"><span class="hs-identifier hs-type">DSpecialiseP</span></a></span><span> </span><span id="local-6989586621679512576"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512576"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512575"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512575"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679512574"><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679512574"><span class="hs-identifier hs-var">m_inl</span></a></span></span><span> </span><span id="local-6989586621679512573"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512573"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Maybe Inline -&gt; Phases -&gt; Pragma
</span><span class="hs-identifier hs-var">SpecialiseP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512576"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512575"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679512574"><span class="hs-identifier hs-var">m_inl</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512573"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-351"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseInstP"><span class="hs-identifier hs-type">DSpecialiseInstP</span></a></span><span> </span><span id="local-6989586621679512570"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512570"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pragma
</span><span class="hs-identifier hs-var">SpecialiseInstP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512570"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleP"><span class="hs-identifier hs-type">DRuleP</span></a></span><span> </span><span id="local-6989586621679512567"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512567"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679512566"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512566"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679512565"><span class="annot"><span class="annottext">[DRuleBndr]
</span><a href="#local-6989586621679512565"><span class="hs-identifier hs-var">rbs</span></a></span></span><span> </span><span id="local-6989586621679512564"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512564"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679512563"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512563"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679512562"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512562"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="annottext">[Char]
-&gt; Maybe [TyVarBndr ()]
-&gt; [RuleBndr]
-&gt; Exp
-&gt; Exp
-&gt; Phases
-&gt; Pragma
</span><span class="hs-identifier hs-var">RuleP</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512567"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512566"><span class="hs-identifier hs-var">mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DRuleBndr -&gt; RuleBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var">ruleBndrToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DRuleBndr]
</span><a href="#local-6989586621679512565"><span class="hs-identifier hs-var">rbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512564"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512563"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679512562"><span class="hs-identifier hs-var">phases</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DRuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">rbs</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span> </span><span class="hs-identifier">phases</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-identifier">RuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">ruleBndrToTH</span><span> </span><span class="hs-identifier">rbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">lhs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">phases</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAnnP"><span class="hs-identifier hs-type">DAnnP</span></a></span><span> </span><span id="local-6989586621679512559"><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679512559"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679512558"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512558"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnTarget -&gt; Exp -&gt; Pragma
</span><span class="hs-identifier hs-var">AnnP</span></span><span> </span><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679512559"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512558"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLineP</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;LINE pragmas only supported in GHC 7.10+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLineP"><span class="hs-identifier hs-type">DLineP</span></a></span><span> </span><span id="local-6989586621679512555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512555"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512554"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512554"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; Pragma
</span><span class="hs-identifier hs-var">LineP</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512555"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679512554"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 801
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCompleteP</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;COMPLETE pragmas only supported in GHC 8.2+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCompleteP"><span class="hs-identifier hs-type">DCompleteP</span></a></span><span> </span><span id="local-6989586621679512551"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679512551"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679512550"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679512550"><span class="hs-identifier hs-var">mty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Maybe Name -&gt; Pragma
</span><span class="hs-identifier hs-var">CompleteP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679512551"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679512550"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-372"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-type">ruleBndrToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleBndr"><span class="hs-identifier hs-type">DRuleBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RuleBndr</span></span><span>
</span><span id="line-373"></span><span id="ruleBndrToTH"><span class="annot"><span class="annottext">ruleBndrToTH :: DRuleBndr -&gt; RuleBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var hs-var">ruleBndrToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleVar"><span class="hs-identifier hs-type">DRuleVar</span></a></span><span> </span><span id="local-6989586621679512547"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512547"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RuleBndr
</span><span class="hs-identifier hs-var">RuleVar</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512547"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var">ruleBndrToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypedRuleVar"><span class="hs-identifier hs-type">DTypedRuleVar</span></a></span><span> </span><span id="local-6989586621679512544"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512544"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512543"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512543"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; RuleBndr
</span><span class="hs-identifier hs-var">TypedRuleVar</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512544"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512543"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-comment">-- | It's convenient to also return a 'Name' here, since some call sites make</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- use of it.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-type">tySynEqnToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span id="tySynEqnToTH"><span class="annot"><span class="annottext">tySynEqnToTH :: DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var hs-var">tySynEqnToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span><span> </span><span id="local-6989586621679512540"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512540"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679512539"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512539"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679512538"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512538"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679512537"><span class="annot"><span class="annottext">lhs' :: Type
</span><a href="#local-6989586621679512537"><span class="hs-identifier hs-var hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512539"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512537"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679512536"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512536"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679512535"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679512535"><span class="hs-identifier hs-var">_lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512536"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679512540"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512537"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512538"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal type instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ppr a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512537"><span class="hs-identifier hs-var">lhs'</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TySynEqn</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">unfoldType</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">ConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lhs_args</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">filterTANormals</span><span> </span><span class="hs-identifier">lhs_args</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Illegal type instance LHS: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">pprint</span><span> </span><span class="hs-identifier">lhs'</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-type">clauseToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span>
</span><span id="line-395"></span><span id="clauseToTH"><span class="annot"><span class="annottext">clauseToTH :: DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var hs-var">clauseToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span> </span><span id="local-6989586621679512532"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679512532"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679512531"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512531"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Body -&gt; [Dec] -&gt; Clause
</span><span class="hs-identifier hs-var">Clause</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679512532"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679512531"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-type">typeToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- We need a special case for DForallT ForallInvis followed by DConstrainedT</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- so that we may collapse them into a single ForallT when sweetening.</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- See Note [Desugaring and sweetening ForallT] in L.H.T.Desugar.Core.</span><span>
</span><span id="line-401"></span><span id="typeToTH"><span class="annot"><span class="annottext">typeToTH :: DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var hs-var">typeToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span> </span><span id="local-6989586621679512527"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512527"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679512525"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512525"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679512524"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512524"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512527"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512525"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512524"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679512522"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679512522"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679512521"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512521"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679512522"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span>  </span><span id="local-6989586621679512520"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512520"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512520"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512519"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallVis"><span class="hs-identifier hs-type">DForallVis</span></a></span><span>   </span><span id="local-6989586621679512517"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512517"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span>      </span><span class="annot"><span class="annottext">[TyVarBndr ()] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallVisT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679512517"><span class="hs-identifier hs-var">_tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679512519"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Visible dependent quantification supported only in GHC 8.10+&quot;</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679512519"><span class="annot"><span class="annottext">ty' :: Type
</span><a href="#local-6989586621679512519"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512521"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-414"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679512515"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512515"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512514"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512514"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512515"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512514"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679512512"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512512"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679512511"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512511"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512512"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512511"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679512508"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512508"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679512507"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512507"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512508"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512507"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679512504"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512504"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512504"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span id="local-6989586621679512501"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512501"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-var">tyconToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512501"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span id="local-6989586621679512496"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679512496"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679512496"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">DWildCardT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679512491"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512491"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679512490"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512490"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512491"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512490"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-431"></span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-434"></span><span id="local-6989586621679512982"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-type">tvbToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512982"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679512982"><span class="hs-identifier hs-type">flag</span></a></span></span><span>
</span><span id="line-435"></span><span id="tvbToTH"><span class="annot"><span class="annottext">tvbToTH :: forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var hs-var">tvbToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679512487"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512487"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512486"><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679512486"><span class="hs-identifier hs-var">flag</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; TyVarBndr_ flag
</span><span class="hs-identifier hs-var">plainTVFlag</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512487"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679512486"><span class="hs-identifier hs-var">flag</span></a></span><span>
</span><span id="line-436"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679512483"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512483"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679512482"><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679512482"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621679512481"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512481"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; Type -&gt; TyVarBndr_ flag
</span><span class="hs-identifier hs-var">kindedTVFlag</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512483"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679512482"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512481"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-type">cxtToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span>
</span><span id="line-439"></span><span id="cxtToTH"><span class="annot"><span class="annottext">cxtToTH :: [DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var hs-var">cxtToTH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-type">derivClauseToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span id="derivClauseToTH"><span class="annot"><span class="annottext">derivClauseToTH :: DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var hs-var">derivClauseToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span> </span><span id="local-6989586621679512477"><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512477"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679512476"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512476"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe DerivStrategy -&gt; [Type] -&gt; DerivClause
</span><span class="hs-identifier hs-var">DerivClause</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679512477"><span class="hs-identifier hs-var">mds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DType] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512476"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Cxt</span><span>
</span><span id="line-447"></span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-type">derivStrategyToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivStrategy</span></span><span>
</span><span id="line-452"></span><span id="derivStrategyToTH"><span class="annot"><span class="annottext">derivStrategyToTH :: DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var hs-var">derivStrategyToTH</span></a></span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStockStrategy"><span class="hs-identifier hs-var">DStockStrategy</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">StockStrategy</span></span><span>
</span><span id="line-453"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnyclassStrategy"><span class="hs-identifier hs-var">DAnyclassStrategy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">AnyclassStrategy</span></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNewtypeStrategy"><span class="hs-identifier hs-var">DNewtypeStrategy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">NewtypeStrategy</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DViaStrategy"><span class="hs-identifier hs-type">DViaStrategy</span></a></span><span> </span><span id="local-6989586621679512467"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512467"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; DerivStrategy
</span><span class="hs-identifier hs-var">ViaStrategy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512467"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">derivStrategyToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DViaStrategy</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;DerivingVia supported only in GHC 8.6+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-type">patSynDirToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynDir"><span class="hs-identifier hs-type">DPatSynDir</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynDir</span></span><span>
</span><span id="line-464"></span><span id="patSynDirToTH"><span class="annot"><span class="annottext">patSynDirToTH :: DPatSynDir -&gt; PatSynDir
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var hs-var">patSynDirToTH</span></a></span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DUnidir"><span class="hs-identifier hs-var">DUnidir</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">Unidir</span></span><span>
</span><span id="line-465"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImplBidir"><span class="hs-identifier hs-var">DImplBidir</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">ImplBidir</span></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExplBidir"><span class="hs-identifier hs-type">DExplBidir</span></a></span><span> </span><span id="local-6989586621679512460"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679512460"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Clause] -&gt; PatSynDir
</span><span class="hs-identifier hs-var">ExplBidir</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var">clauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679512460"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-469"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-type">predToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPred"><span class="hs-identifier hs-type">DPred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-comment">-- for kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DSigT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span>                </span><span class="hs-identifier">p</span><span>  </span><span class="hs-comment">-- this shouldn't happen.</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">nameBase</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;~&quot;</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">DVarT</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Template Haskell in GHC &lt;= 7.8 does not support variable constraints.&quot;</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">DWildCardT</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConstrainedT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">DArrowT</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;(-&gt;) spotted at head of a constraint&quot;</span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLitT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Type-level literal spotted at head of a constraint&quot;</span><span class="hs-cpp">
#else
</span><span id="predToTH"><span class="annot"><span class="annottext">predToTH :: DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var hs-var">predToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679512457"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512457"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679512456"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512456"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512457"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512456"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679512455"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512455"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679512454"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512454"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512455"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512454"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679512453"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512453"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512453"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-500"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span id="local-6989586621679512452"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512452"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512452"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span>
</span><span id="line-502"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span id="local-6989586621679512451"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679512451"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679512451"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-identifier">DWildCardT</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="hs-comment">-- We need a special case for DForallT ForallInvis followed by DConstrainedT</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- so that we may collapse them into a single ForallT when sweetening.</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- See Note [Desugaring and sweetening ForallT] in L.H.T.Desugar.Core.</span><span>
</span><span id="line-512"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span> </span><span id="local-6989586621679512450"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512450"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679512449"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512449"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679512448"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512448"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512450"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512449"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512448"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679512447"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679512447"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679512446"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512446"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679512447"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span> </span><span id="local-6989586621679512445"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512445"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; TyVarBndr_ flag
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679512445"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512446"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallVis"><span class="hs-identifier hs-type">DForallVis</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Visible dependent quantifier spotted at head of a constraint&quot;</span></span><span>
</span><span id="line-518"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679512444"><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512444"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679512443"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512443"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DType]
</span><a href="#local-6989586621679512444"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512443"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span>
</span><span id="line-521"></span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConstrainedT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679512442"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512442"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679512441"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512441"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512442"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512441"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-528"></span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-identifier">p</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-532"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-type">tyconToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-533"></span><span id="tyconToTH"><span class="annot"><span class="annottext">tyconToTH :: Name -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-var hs-var">tyconToTH</span></a></span></span><span> </span><span id="local-6989586621679512440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; DDeclaredInfix
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-comment">-- Work around Trac #14888</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; DDeclaredInfix
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; DDeclaredInfix
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">~</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; DDeclaredInfix
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; DDeclaredInfix
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679512435"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512435"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var">tupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-542"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DDeclaredInfix
</span><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var">isDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512435"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#else
</span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">PromotedT</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-comment">-- Work around Trac #14843</span><span class="hs-cpp">
#endif
</span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512435"><span class="hs-identifier hs-var">deg</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679512430"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512430"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-var">unboxedTupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">UnboxedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512430"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679512427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512427"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-var">unboxedSumNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">UnboxedSumT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679512427"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DDeclaredInfix
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679512440"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-type">typeArgToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span>
</span><span id="line-556"></span><span id="typeArgToTH"><span class="annot"><span class="annottext">typeArgToTH :: DTypeArg -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-var hs-var">typeArgToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679512423"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512423"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512423"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-var">typeArgToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679512420"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512420"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679512420"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-comment">-- | Convert a 'Bang' to a 'Strict'</span><span>
</span><span id="line-561"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strict</span><span>
</span><span id="line-562"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">SourceUnpack</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Unpacked</span><span>
</span><span id="line-563"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">SourceStrict</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IsStrict</span><span>
</span><span id="line-564"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NotStrict</span><span class="hs-cpp">
#endif
</span></pre></body></html>