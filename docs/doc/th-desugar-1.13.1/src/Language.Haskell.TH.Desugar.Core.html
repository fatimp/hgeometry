<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679511782"><span id="local-6989586621679511783"><span id="local-6989586621679511784"><span id="local-6989586621679511785"><span id="local-6989586621679511786"><span id="local-6989586621679511787"><span id="local-6989586621679511788"><span id="local-6989586621679511789"><span id="local-6989586621679511790"><span id="local-6989586621679511791"><span id="local-6989586621679511792"></span></span></span></span></span></span></span></span></span></span></span><span class="hs-comment">{- Language/Haskell/TH/Desugar/Core.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Desugars full Template Haskell syntax into a smaller core syntax for further
processing. The desugared types and constructors are prefixed with a D.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell, LambdaCase, CPP, ScopedTypeVariables,
             TupleSections, DeriveDataTypeable, DeriveGeneric #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Core</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">and</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">match</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clause</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cxt</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadWriter</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Zip</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">notElem</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">All</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.OverloadedLabels</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromLabel</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IP</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Records</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasField</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.AST</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.FV.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.FV</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OS</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier">OSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Reify</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Desugar an expression</span><span>
</span><span id="line-74"></span><span id="local-6989586621679512357"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-type">dsExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512357"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512357"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-75"></span><span id="dsExp"><span class="annot"><span class="annottext">dsExp :: forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var hs-var">dsExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679511585"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511585"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511585"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-76"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679511582"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511582"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511582"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitE</span></span><span> </span><span id="local-6989586621679511579"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679511579"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679511579"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppE</span></span><span> </span><span id="local-6989586621679511576"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511576"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679511575"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511575"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511576"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511575"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679511571"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511571"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511571"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679511570"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511570"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511569"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511569"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511569"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511570"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679511568"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511568"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679511567"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511567"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679511566"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511566"><span class="hs-identifier hs-var">lhsName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lhs&quot;</span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679511564"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511564"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511568"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679511563"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511563"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511567"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511566"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511564"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511566"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511563"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679511561"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511561"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511560"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511560"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679511559"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511559"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511560"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511561"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511559"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensE</span></span><span> </span><span id="local-6989586621679511556"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511556"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511556"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamE</span></span><span> </span><span id="local-6989586621679511554"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679511554"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679511553"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511553"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679511552"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511552"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511553"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511551"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511551"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511550"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511550"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679511554"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511552"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511551"><span class="hs-identifier hs-var">pats'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511550"><span class="hs-identifier hs-var">exp''</span></a></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamCaseE</span></span><span> </span><span id="local-6989586621679511546"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511546"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679511545"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511545"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679511544"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511544"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511545"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511546"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511545"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511545"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511544"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupE</span></span><span> </span><span id="local-6989586621679511540"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511540"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511540"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupE</span></span><span> </span><span id="local-6989586621679511536"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511536"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511536"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CondE</span></span><span> </span><span id="local-6989586621679511533"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511533"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679511532"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511532"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679511531"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511531"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511533"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Exp -&gt; Match
</span><a href="#local-6989586621679511529"><span class="hs-identifier hs-var">mkBoolMatch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511532"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp -&gt; Match
</span><a href="#local-6989586621679511529"><span class="hs-identifier hs-var">mkBoolMatch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511531"><span class="hs-identifier hs-var">e3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679511529"><span class="hs-identifier hs-type">mkBoolMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679511529"><span class="annot"><span class="annottext">mkBoolMatch :: Name -&gt; Exp -&gt; Match
</span><a href="#local-6989586621679511529"><span class="hs-identifier hs-var hs-var">mkBoolMatch</span></a></span></span><span> </span><span id="local-6989586621679511528"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511528"><span class="hs-identifier hs-var">boolDataCon</span></a></span></span><span> </span><span id="local-6989586621679511527"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511527"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511528"><span class="hs-identifier hs-var">boolDataCon</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 901
</span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511527"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MultiIfE</span></span><span> </span><span id="local-6989586621679511522"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511522"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511521"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679511521"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive guards in multi-way if&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511522"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511521"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetE</span></span><span> </span><span id="local-6989586621679511517"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511517"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679511516"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511516"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511515"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511515"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511514"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511514"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511517"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679511512"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511512"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511516"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511515"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511514"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511512"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">-- the following special case avoids creating a new &quot;let&quot; when it's not</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- necessary. See #34.</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679511510"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511510"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511509"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511509"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679511508"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511508"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511510"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511509"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511510"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511508"><span class="hs-identifier hs-var">matches'</span></a></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span id="local-6989586621679511507"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511507"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679511506"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511506"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679511505"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511505"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scrutinee&quot;</span></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679511504"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511504"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511507"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679511503"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511503"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511505"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511506"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511505"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511504"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-128"></span><span>           </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511505"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511503"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 900
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DoE</span></span><span> </span><span id="local-6989586621679511499"><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679511499"><span class="hs-identifier hs-var">mb_mod</span></a></span></span><span> </span><span id="local-6989586621679511498"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511498"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Maybe ModName -&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679511499"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511498"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DoE</span><span>        </span><span class="hs-identifier">stmts</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dsDoStmts</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">stmts</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompE</span></span><span> </span><span id="local-6989586621679511495"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511495"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511495"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromR</span></span><span> </span><span id="local-6989586621679511491"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511491"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFrom</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511491"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenR</span></span><span> </span><span id="local-6989586621679511489"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511489"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679511488"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511488"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThen</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511489"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511488"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromToR</span></span><span> </span><span id="local-6989586621679511486"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511486"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679511485"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511485"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511486"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511485"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenToR</span></span><span> </span><span id="local-6989586621679511483"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511483"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679511482"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511482"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679511481"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511481"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThenTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511483"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-142"></span><span>                               </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511482"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511481"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListE</span></span><span> </span><span id="local-6989586621679511479"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679511479"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}. DsMonad m =&gt; [Exp] -&gt; m DExp
</span><a href="#local-6989586621679511478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679511479"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679511478"><span class="annot"><span class="annottext">go :: [Exp] -&gt; m DExp
</span><a href="#local-6989586621679511478"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="#local-6989586621679511478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679511467"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511467"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511466"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679511466"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511467"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; m DExp
</span><a href="#local-6989586621679511478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679511466"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigE</span></span><span> </span><span id="local-6989586621679511464"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511464"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679511463"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511463"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511464"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511463"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecConE</span></span><span> </span><span id="local-6989586621679511459"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511459"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679511458"><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511458"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679511457"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511457"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511459"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679511455"><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679511455"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}. DsMonad m =&gt; Con -&gt; m [DExp]
</span><a href="#local-6989586621679511454"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511457"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511459"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679511455"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679511454"><span class="annot"><span class="annottext">reorder :: Con -&gt; m [DExp]
</span><a href="#local-6989586621679511454"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679511443"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511443"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511443"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679511441"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511441"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679511440"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679511440"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679511439"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679511440"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-155"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679511437"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679511437"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679511436"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511436"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679511435"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679511435"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679511439"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679511437"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679511435"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679511433"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511433"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679511432"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511432"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {q :: * -&gt; *}. DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679511431"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511432"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-157"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679511429"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511429"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; m [DExp]
</span><a href="#local-6989586621679511454"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511429"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679511427"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511427"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679511426"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679511426"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679511425"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511425"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679511439"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679511426"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-160"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679511423"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511423"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679511422"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511422"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679511421"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511421"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {q :: * -&gt; *}. DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679511431"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511422"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679511431"><span class="annot"><span class="annottext">reorder_fields :: [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679511431"><span class="hs-identifier hs-var hs-var">reorder_fields</span></a></span></span><span> </span><span id="local-6989586621679511418"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511418"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511459"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511418"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511458"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-164"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679511439"><span class="annot"><span class="annottext">non_record :: t a -&gt; m [DExp]
</span><a href="#local-6989586621679511439"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679511406"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679511406"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511458"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-167"></span><span>                        </span><span class="hs-comment">-- Special case: record construction is allowed for any</span><span>
</span><span id="line-168"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-169"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that no</span><span>
</span><span id="line-170"></span><span>                        </span><span class="hs-comment">-- records are given in the expression itself. (See #59).</span><span>
</span><span id="line-171"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con undefined ... undefined.</span><span>
</span><span id="line-173"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679511406"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>                          </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-177"></span><span>                                       </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511459"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecUpdE</span></span><span> </span><span id="local-6989586621679511399"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511399"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679511398"><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511398"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- here, we need to use one of the field names to find the tycon, somewhat dodgily</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679511397"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511397"><span class="hs-identifier hs-var">first_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511398"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679511396"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511396"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511396"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-183"></span><span>                  </span><span class="annot"><span class="annottext">[FieldExp]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record update with no fields listed.&quot;</span></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679511395"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679511395"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511397"><span class="hs-identifier hs-var">first_name</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679511393"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511393"><span class="hs-identifier hs-var">applied_type</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679511395"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679511391"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511391"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679511390"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511390"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679511389"><span class="annot"><span class="annottext">Maybe Dec
</span><a href="#local-6989586621679511389"><span class="hs-identifier hs-var">_m_dec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511390"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span>                    </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_m_dec</span><span> </span><span class="hs-identifier">_fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">extract_first_arg</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>                    </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record update with an invalid field name.&quot;</span></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679511387"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511387"><span class="hs-identifier hs-var">type_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511393"><span class="hs-identifier hs-var">applied_type</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511385"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511385"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndrUnit], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This seems to be an error in GHC.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511387"><span class="hs-identifier hs-var">type_name</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511382"><span class="annot"><span class="annottext">filtered_cons :: [Con]
</span><a href="#local-6989586621679511382"><span class="hs-identifier hs-var hs-var">filtered_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *}. Foldable t =&gt; [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679511381"><span class="hs-identifier hs-var">filter_cons_with_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511385"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511398"><span class="hs-identifier hs-var">field_exps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679511380"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511380"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511399"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679511379"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511379"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679511378"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511382"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511373"><span class="annot"><span class="annottext">all_matches :: [DMatch]
</span><a href="#local-6989586621679511373"><span class="hs-identifier hs-var hs-var">all_matches</span></a></span></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511382"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511385"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511379"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511379"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679511372"><span class="hs-identifier hs-var">error_match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511380"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511373"><span class="hs-identifier hs-var">all_matches</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679512297"><span class="annot"><a href="#local-6989586621679511388"><span class="hs-identifier hs-type">extract_first_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512297"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512297"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679511388"><span class="annot"><span class="annottext">extract_first_arg :: forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679511388"><span class="hs-identifier hs-var hs-var">extract_first_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span id="local-6989586621679511362"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511362"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511362"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679511360"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511360"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511360"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679511358"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511358"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511358"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679511388"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record selector not a function.&quot;</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679512296"><span class="annot"><a href="#local-6989586621679511386"><span class="hs-identifier hs-type">extract_type_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512296"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512296"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679511386"><span class="annot"><span class="annottext">extract_type_name :: forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679511386"><span class="hs-identifier hs-var hs-var">extract_type_name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679511350"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511350"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511350"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679511349"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511349"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511349"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679511347"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511347"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511347"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="#local-6989586621679511386"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record selector domain not a datatype.&quot;</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679511381"><span class="annot"><span class="annottext">filter_cons_with_names :: [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679511381"><span class="hs-identifier hs-var hs-var">filter_cons_with_names</span></a></span></span><span> </span><span id="local-6989586621679511345"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511345"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679511344"><span class="annot"><span class="annottext">t Name
</span><a href="#local-6989586621679511344"><span class="hs-identifier hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679511343"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679511345"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679511338"><span class="annot"><span class="annottext">args_contain_names :: [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679511338"><span class="hs-identifier hs-var hs-var">args_contain_names</span></a></span></span><span> </span><span id="local-6989586621679511337"><span class="annot"><span class="annottext">[(Name, b, c)]
</span><a href="#local-6989586621679511337"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511336"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679511336"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {c}. (a, b, c) -&gt; a
</span><a href="#local-6989586621679511335"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, b, c)]
</span><a href="#local-6989586621679511337"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-219"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511336"><span class="hs-identifier hs-var">con_field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Name
</span><a href="#local-6989586621679511344"><span class="hs-identifier hs-var">field_names</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>        </span><span id="local-6989586621679511343"><span class="annot"><span class="annottext">has_names :: Con -&gt; Bool
</span><a href="#local-6989586621679511343"><span class="hs-identifier hs-var hs-var">has_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679511334"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511334"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679511333"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511333"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">forall {b} {c}. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679511338"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511333"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="annot"><a href="#local-6989586621679511343"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679511332"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511332"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679511331"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511331"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679511330"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511330"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>          </span><span class="annot"><span class="annottext">forall {b} {c}. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679511338"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511331"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>        </span><span class="annot"><a href="#local-6989586621679511343"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679511329"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511329"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679511343"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511329"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><a href="#local-6989586621679511343"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679511314"><span class="annot"><span class="annottext">rec_con_to_dmatch :: Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679511314"><span class="hs-identifier hs-var hs-var">rec_con_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679511313"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511313"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679511312"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511312"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511311"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679511311"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {c}. (a, b, c) -&gt; a
</span><a href="#local-6989586621679511335"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511312"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span id="local-6989586621679511310"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511310"><span class="hs-identifier hs-var">field_var_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511311"><span class="hs-identifier hs-var">con_field_names</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511313"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511310"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-234"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511313"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-235"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511313"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511312"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679511398"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511310"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679512285"><span class="annot"><a href="#local-6989586621679511378"><span class="hs-identifier hs-type">con_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512285"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512285"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679511378"><span class="annot"><span class="annottext">con_to_dmatch :: forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679511378"><span class="hs-identifier hs-var hs-var">con_to_dmatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679511299"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511299"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679511298"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511298"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679511314"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511299"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511298"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-comment">-- We're assuming the GADT constructor has only one Name here, but since</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- this constructor was reified, this assumption should always hold true.</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="#local-6989586621679511378"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679511297"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511297"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679511296"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511296"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679511295"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511295"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679511314"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511297"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679511296"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679511378"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679511294"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511294"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679511378"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679511294"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="#local-6989586621679511378"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error within th-desugar.&quot;</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679511372"><span class="annot"><span class="annottext">error_match :: DMatch
</span><a href="#local-6989586621679511372"><span class="hs-identifier hs-var hs-var">error_match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns in record update&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679511335"><span class="annot"><span class="annottext">fst_of_3 :: (a, b, c) -&gt; a
</span><a href="#local-6989586621679511335"><span class="hs-identifier hs-var hs-var">fst_of_3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679511292"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679511292"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679511292"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StaticE</span></span><span> </span><span id="local-6989586621679511290"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511290"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStaticE"><span class="hs-identifier hs-var">DStaticE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511290"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboundVarE</span></span><span> </span><span id="local-6989586621679511287"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511287"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511287"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppTypeE</span></span><span> </span><span id="local-6989586621679511285"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511285"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679511284"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511284"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-var">DAppTypeE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511285"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679511284"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumE</span></span><span> </span><span id="local-6989586621679511281"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511281"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679511280"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679511280"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679511279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679511279"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679511280"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679511279"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511281"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LabelE</span></span><span> </span><span id="local-6989586621679511276"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511276"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">fromLabel</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511276"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamVarE</span></span><span> </span><span id="local-6989586621679511272"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511272"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ip</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511272"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MDoE</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 902
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GetFieldE</span></span><span> </span><span id="local-6989586621679511269"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511269"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621679511268"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511268"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkGetFieldProj"><span class="hs-identifier hs-var">mkGetFieldProj</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511268"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511269"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProjectionE</span></span><span> </span><span id="local-6989586621679511265"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679511265"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679511265"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679511264"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511264"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679511263"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679511263"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; String -&gt; DExp
</span><a href="#local-6989586621679511261"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkGetFieldProj"><span class="hs-identifier hs-var">mkGetFieldProj</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511264"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679511263"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="#local-6989586621679511261"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679511261"><span class="annot"><span class="annottext">comp :: DExp -&gt; String -&gt; DExp
</span><a href="#local-6989586621679511261"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679511260"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511260"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679511259"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511259"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkGetFieldProj"><span class="hs-identifier hs-var">mkGetFieldProj</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511259"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511260"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span id="local-6989586621679512328"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-type">dsTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512328"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512328"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-281"></span><span id="dsTup"><span class="annot"><span class="annottext">dsTup :: forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var hs-var">dsTup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var">ds_tup</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Exp</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DExp</span><span>
</span><span id="line-284"></span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-identifier">tuple_data_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ds_tup</span><span> </span><span class="hs-identifier">tuple_data_name</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Just</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Desugar a tuple (or tuple section) expression.</span><span>
</span><span id="line-288"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-type">ds_tup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679511255"><span class="annot"><a href="#local-6989586621679511255"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679511255"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-289"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Compute the 'Name' of a tuple (boxed or unboxed)</span><span>
</span><span id="line-290"></span><span>                        </span><span class="hs-comment">--   data constructor from its arity.</span><span>
</span><span id="line-291"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ The tuple's subexpressions. 'Nothing' entries</span><span>
</span><span id="line-292"></span><span>                        </span><span class="hs-comment">--   denote empty fields in a tuple section.</span><span>
</span><span id="line-293"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679511255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-294"></span><span id="ds_tup"><span class="annot"><span class="annottext">ds_tup :: forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var hs-var">ds_tup</span></a></span></span><span> </span><span id="local-6989586621679511236"><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679511236"><span class="hs-identifier hs-var">tuple_data_name</span></a></span></span><span> </span><span id="local-6989586621679511235"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511235"><span class="hs-identifier hs-var">mb_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679511234"><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511234"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679511233"><span class="hs-identifier hs-var">ds_section_exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679511235"><span class="hs-identifier hs-var">mb_exps</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511232"><span class="annot"><span class="annottext">section_vars :: [Name]
</span><a href="#local-6989586621679511232"><span class="hs-identifier hs-var hs-var">section_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511234"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679511231"><span class="annot"><span class="annottext">tup_body :: DExp
</span><a href="#local-6989586621679511231"><span class="hs-identifier hs-var hs-var">tup_body</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679511230"><span class="hs-identifier hs-var">mk_tup_body</span></a></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511234"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511232"><span class="hs-identifier hs-var">section_vars</span></a></span><span>
</span><span id="line-299"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511231"><span class="hs-identifier hs-var">tup_body</span></a></span><span> </span><span class="hs-comment">-- If this isn't a tuple section,</span><span>
</span><span id="line-300"></span><span>                          </span><span class="hs-comment">-- don't create a lambda.</span><span>
</span><span id="line-301"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511232"><span class="hs-identifier hs-var">section_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511231"><span class="hs-identifier hs-var">tup_body</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- If dealing with an empty field in a tuple section (Nothing), create a</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- unique name and return Left. These names will be used to construct the</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- lambda expression that it desugars to.</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- (For example, `(,5)` desugars to `\ts -&gt; (,) ts 5`.)</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- If dealing with a tuple subexpression (Just), desugar it and return</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- Right.</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><a href="#local-6989586621679511233"><span class="hs-identifier hs-type">ds_section_exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679511255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679511233"><span class="annot"><span class="annottext">ds_section_exp :: Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679511233"><span class="hs-identifier hs-var hs-var">ds_section_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ts&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="#local-6989586621679511230"><span class="hs-identifier hs-type">mk_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679511230"><span class="annot"><span class="annottext">mk_tup_body :: [Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679511230"><span class="hs-identifier hs-var hs-var">mk_tup_body</span></a></span></span><span> </span><span id="local-6989586621679511227"><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511227"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679511226"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679511236"><span class="hs-identifier hs-var">tuple_data_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511227"><span class="hs-identifier hs-var">section_exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>             </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679511227"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="#local-6989586621679511226"><span class="hs-identifier hs-type">apply_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679511226"><span class="annot"><span class="annottext">apply_tup_body :: DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679511226"><span class="hs-identifier hs-var hs-var">apply_tup_body</span></a></span></span><span> </span><span id="local-6989586621679511225"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511225"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679511224"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511224"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511225"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511224"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621679511226"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span id="local-6989586621679511223"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511223"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679511222"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511222"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511223"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511222"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Convert a list of 'DPat' arguments and a 'DExp' body into a 'DLamE'. This</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- is needed since 'DLamE' takes a list of 'Name's for its bound variables</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- instead of 'DPat's, so some reorganization is needed.</span><span>
</span><span id="line-325"></span><span id="local-6989586621679512331"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-type">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679512331"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512331"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-326"></span><span id="mkDLamEFromDPats"><span class="annot"><span class="annottext">mkDLamEFromDPats :: forall (q :: * -&gt; *). Quasi q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var hs-var">mkDLamEFromDPats</span></a></span></span><span> </span><span id="local-6989586621679511206"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511206"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679511205"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511205"><span class="hs-identifier hs-var">exp</span></a></span></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679511204"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511204"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Maybe Name
</span><a href="#local-6989586621679511203"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511206"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511204"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511205"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679511202"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511202"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511206"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511200"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679511200"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511202"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>           </span><span id="local-6989586621679511198"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679511198"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679511206"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511205"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-333"></span><span>       </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679511202"><span class="hs-identifier hs-var">arg_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511200"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679511198"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="#local-6989586621679511203"><span class="hs-identifier hs-type">stripDVarP_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679511203"><span class="annot"><span class="annottext">stripDVarP_maybe :: DPat -&gt; Maybe Name
</span><a href="#local-6989586621679511203"><span class="hs-identifier hs-var hs-var">stripDVarP_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679511196"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511196"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511196"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="#local-6989586621679511203"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 902
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkGetFieldProj"><span class="hs-identifier hs-type">mkGetFieldProj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-341"></span><span id="mkGetFieldProj"><span class="annot"><span class="annottext">mkGetFieldProj :: String -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkGetFieldProj"><span class="hs-identifier hs-var hs-var">mkGetFieldProj</span></a></span></span><span> </span><span id="local-6989586621679511195"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511195"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">getField</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511195"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Desugar a list of matches for a @case@ statement</span><span>
</span><span id="line-345"></span><span id="local-6989586621679512329"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-type">dsMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512329"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-346"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>     </span><span class="hs-comment">-- ^ Name of the scrutinee, which must be a bare var</span><span>
</span><span id="line-347"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Matches of the @case@ statement</span><span>
</span><span id="line-348"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512329"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-349"></span><span id="dsMatches"><span class="annot"><span class="annottext">dsMatches :: forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var hs-var">dsMatches</span></a></span></span><span> </span><span id="local-6989586621679511192"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511192"><span class="hs-identifier hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679511191"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679512248"><span class="annot"><a href="#local-6989586621679511191"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512248"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512248"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679511191"><span class="annot"><span class="annottext">go :: forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679511191"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><a href="#local-6989586621679511191"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span> </span><span id="local-6989586621679511176"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511176"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679511175"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679511175"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679511174"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511174"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511173"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511173"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>      </span><span id="local-6989586621679511172"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511172"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679511191"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679511173"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511171"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679511171"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511192"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511172"><span class="hs-identifier hs-var">rest'</span></a></span><span>  </span><span class="hs-comment">-- this might be an empty case.</span><span>
</span><span id="line-356"></span><span>      </span><span id="local-6989586621679511170"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511170"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679511175"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511174"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511171"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679511168"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511168"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511167"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511167"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511176"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511170"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-358"></span><span>      </span><span id="local-6989586621679511165"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679511165"><span class="hs-identifier hs-var">uni_pattern</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511168"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="hs-comment">-- incomplete attempt at #6</span><span>
</span><span id="line-359"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679511165"><span class="hs-identifier hs-var">uni_pattern</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511168"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511167"><span class="hs-identifier hs-var">exp''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511168"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511167"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511172"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Desugar a @Body@</span><span>
</span><span id="line-364"></span><span id="local-6989586621679512246"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-type">dsBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512246"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-365"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Body</span></span><span>      </span><span class="hs-comment">-- ^ body to desugar</span><span>
</span><span id="line-366"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ &quot;where&quot; declarations</span><span>
</span><span id="line-367"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>      </span><span class="hs-comment">-- ^ what to do if the guards don't match</span><span>
</span><span id="line-368"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512246"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-369"></span><span id="dsBody"><span class="annot"><span class="annottext">dsBody :: forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var hs-var">dsBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679511150"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511150"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511149"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511149"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511148"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511148"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511147"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511147"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511149"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679511146"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511146"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511150"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511148"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511147"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511146"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GuardedB</span></span><span> </span><span id="local-6989586621679511143"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511143"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511142"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511142"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679511141"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511141"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511140"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511140"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511139"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511139"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511142"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679511138"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511138"><span class="hs-identifier hs-var">guarded_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511143"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511141"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511140"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511139"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511138"><span class="hs-identifier hs-var">guarded_exp'</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | If decs is non-empty, delcare them in a let:</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-type">maybeDLetE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-380"></span><span id="maybeDLetE"><span class="annot"><span class="annottext">maybeDLetE :: [DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var hs-var">maybeDLetE</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679511137"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511137"><span class="hs-identifier hs-var">exp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511137"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-381"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span id="local-6989586621679511136"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511136"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679511135"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511135"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511136"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511135"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | If matches is non-empty, make a case statement; otherwise make an error statement</span><span>
</span><span id="line-384"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-type">maybeDCaseE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-385"></span><span id="maybeDCaseE"><span class="annot"><span class="annottext">maybeDCaseE :: String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var hs-var">maybeDCaseE</span></a></span></span><span> </span><span id="local-6989586621679511133"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511133"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679511133"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621679511132"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511132"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621679511131"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511131"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511132"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679511131"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Desugar guarded expressions</span><span>
</span><span id="line-389"></span><span id="local-6989586621679512324"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-type">dsGuards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512324"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-390"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Guarded expressions</span><span>
</span><span id="line-391"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>            </span><span class="hs-comment">-- ^ What to do if none of the guards match</span><span>
</span><span id="line-392"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512324"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-393"></span><span id="dsGuards"><span class="annot"><span class="annottext">dsGuards :: forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var hs-var">dsGuards</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679511120"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511120"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511120"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-394"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalG</span></span><span> </span><span id="local-6989586621679511118"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511118"><span class="hs-identifier hs-var">gd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511117"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511117"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511116"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511116"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511115"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511115"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt] -&gt; Guard
</span><span class="hs-identifier hs-var">PatG</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511118"><span class="hs-identifier hs-var">gd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511117"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511116"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511115"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatG</span></span><span> </span><span id="local-6989586621679511112"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511112"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511111"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511111"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511110"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511110"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511109"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511109"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679511108"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511108"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511111"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679511107"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511107"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679511110"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511109"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511112"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511108"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511107"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a guard</span><span>
</span><span id="line-402"></span><span id="local-6989586621679512241"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-type">dsGuardStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512241"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-403"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The @Stmt@s to desugar</span><span>
</span><span id="line-404"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield success</span><span>
</span><span id="line-405"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield failure</span><span>
</span><span id="line-406"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512241"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-407"></span><span id="dsGuardStmts"><span class="annot"><span class="annottext">dsGuardStmts :: forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var hs-var">dsGuardStmts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679511078"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511078"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679511077"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511077"><span class="hs-identifier hs-var">_failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511078"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-408"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679511075"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511075"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679511074"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511074"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511073"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511073"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511072"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511072"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679511071"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511071"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679511070"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511070"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511073"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511072"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511071"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511069"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511069"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511068"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511068"><span class="hs-identifier hs-var">success''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511075"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511070"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679511067"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511067"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511074"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511067"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679511069"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511068"><span class="hs-identifier hs-var">success''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511071"><span class="hs-identifier hs-var">failure</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679511065"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511065"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511064"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511064"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511063"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511063"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679511062"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511062"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679511061"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511061"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511060"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511060"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511065"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621679511059"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511059"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511064"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511063"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511062"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511061"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511060"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511059"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-comment">-- special-case a final pattern containing &quot;otherwise&quot; or &quot;True&quot;</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-comment">-- note that GHC does this special-casing, too, in DsGRHSs.isTrueLHsExpr</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679511058"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511058"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679511057"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511057"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679511056"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511056"><span class="hs-identifier hs-var">_failure</span></a></span></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679511055"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511055"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511058"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511055"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511057"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679511054"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511054"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511058"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511054"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511057"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679511053"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511053"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511052"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511052"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679511051"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511051"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679511050"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511050"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679511049"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511049"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511053"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621679511048"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511048"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511052"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511051"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511050"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511049"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511048"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-431"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511050"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Parallel comprehension in a pattern guard.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a @do@ expression</span><span>
</span><span id="line-438"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-type">dsDoStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679512321"><span class="annot"><a href="#local-6989586621679512321"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512321"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512321"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-439"></span><span id="dsDoStmts"><span class="annot"><span class="annottext">dsDoStmts :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Maybe ModName -&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var hs-var">dsDoStmts</span></a></span></span><span> </span><span id="local-6989586621679511028"><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679511028"><span class="hs-identifier hs-var">mb_mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
</span><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512321"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679511027"><span class="annot"><span class="annottext">go :: [Stmt] -&gt; q DExp
</span><a href="#local-6989586621679511027"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;do-expression ended with something other than bare statement.&quot;</span></span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679511026"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511026"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511026"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679511025"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511025"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679511024"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511024"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511023"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511023"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>      </span><span id="local-6989586621679511022"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511022"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
</span><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511023"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Maybe ModName -&gt; Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679511028"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511024"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679511025"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511022"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;do expression&quot;</span></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679511020"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511020"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511019"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511019"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679511018"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511018"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679511017"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511017"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679511020"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span id="local-6989586621679511016"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511016"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
</span><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511019"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679511018"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679511017"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511016"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679511015"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511015"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679511014"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511014"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>      </span><span id="local-6989586621679511013"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511013"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679511015"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span id="local-6989586621679511012"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511012"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
</span><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679511014"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679511011"><span class="annot"><span class="annottext">sequence_name :: Name
</span><a href="#local-6989586621679511011"><span class="hs-identifier hs-var hs-var">sequence_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModName -&gt; Name -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_qual_do_name"><span class="hs-identifier hs-var">mk_qual_do_name</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679511028"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679511011"><span class="hs-identifier hs-var">sequence_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511013"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679511012"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Parallel comprehension in a do-statement.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="annot"><a href="#local-6989586621679511027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a list or monad comprehension</span><span>
</span><span id="line-462"></span><span id="local-6989586621679512320"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-type">dsComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512320"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512320"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-463"></span><span id="dsComp"><span class="annot"><span class="annottext">dsComp :: forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var hs-var">dsComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List/monad comprehension ended with something other than a bare statement.&quot;</span></span><span>
</span><span id="line-464"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679510980"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510980"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">return</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510980"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-465"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679510979"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510979"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510978"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510978"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510977"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510977"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621679510976"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510976"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510977"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Maybe ModName -&gt; Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510978"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510979"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510976"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;monad comprehension&quot;</span></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679510975"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510975"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510974"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510974"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510973"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510973"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510972"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510972"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510975"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679510971"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510971"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510974"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510973"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510972"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510971"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-472"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679510970"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510970"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510969"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510969"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679510968"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510968"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510970"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621679510967"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510967"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510969"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">guard</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510968"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510967"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span id="local-6989586621679510966"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679510966"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510965"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510965"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510964"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510964"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510963"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510963"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679510966"><span class="hs-identifier hs-var">stmtss</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621679510961"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510961"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510965"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510963"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510964"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510961"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- Desugar a binding statement in a do- or list comprehension.</span><span>
</span><span id="line-485"></span><span class="hs-comment">--</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- In the event that the pattern in the statement is partial, the desugared</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- case expression will contain a catch-all case that calls 'fail' from either</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- 'MonadFail' or 'Monad', depending on whether the @MonadFailDesugaring@</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- language extension is enabled or not. (On GHCs older than 8.0, 'fail' from</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- 'Monad' is always used.)</span><span>
</span><span id="line-491"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-type">dsBindS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679512238"><span class="annot"><a href="#local-6989586621679512238"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512238"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512238"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-493"></span><span id="dsBindS"><span class="annot"><span class="annottext">dsBindS :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Maybe ModName -&gt; Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var hs-var">dsBindS</span></a></span></span><span> </span><span id="local-6989586621679510941"><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679510941"><span class="hs-identifier hs-var">mb_mod</span></a></span></span><span> </span><span id="local-6989586621679510940"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510940"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span></span><span> </span><span id="local-6989586621679510939"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510939"><span class="hs-identifier hs-var">success_pat</span></a></span></span><span> </span><span id="local-6989586621679510938"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510938"><span class="hs-identifier hs-var">success_exp</span></a></span></span><span> </span><span id="local-6989586621679510937"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510937"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-494"></span><span>  </span><span id="local-6989586621679510936"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510936"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510940"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510935"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510935"><span class="hs-identifier hs-var">success_pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510934"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510934"><span class="hs-identifier hs-var">success_exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510939"><span class="hs-identifier hs-var">success_pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510938"><span class="hs-identifier hs-var">success_exp</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621679510933"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679510933"><span class="hs-identifier hs-var">is_univ_pat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510935"><span class="hs-identifier hs-var">success_pat'</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510932"><span class="annot"><span class="annottext">bind_into :: DExp -&gt; DExp
</span><a href="#local-6989586621679510932"><span class="hs-identifier hs-var hs-var">bind_into</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510931"><span class="hs-identifier hs-var">bind_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510936"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679510933"><span class="hs-identifier hs-var">is_univ_pat</span></a></span><span>
</span><span id="line-499"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510932"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510935"><span class="hs-identifier hs-var">success_pat'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510934"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-500"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679510930"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510930"><span class="hs-identifier hs-var">arg_name</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-501"></span><span>             </span><span id="local-6989586621679510929"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510929"><span class="hs-identifier hs-var">fail_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Name
</span><a href="#local-6989586621679510928"><span class="hs-identifier hs-var">mk_fail_name</span></a></span><span>
</span><span id="line-502"></span><span>             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510932"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510930"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510930"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510935"><span class="hs-identifier hs-var">success_pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510934"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-504"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-505"></span><span>                 </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510929"><span class="hs-identifier hs-var">fail_name</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-506"></span><span>                   </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern match failure in &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510937"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621679510931"><span class="annot"><span class="annottext">bind_name :: Name
</span><a href="#local-6989586621679510931"><span class="hs-identifier hs-var hs-var">bind_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModName -&gt; Name -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_qual_do_name"><span class="hs-identifier hs-var">mk_qual_do_name</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679510941"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><a href="#local-6989586621679510928"><span class="hs-identifier hs-type">mk_fail_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679512238"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="hs-comment">-- GHC 8.8 deprecates the MonadFailDesugaring extension since its effects</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-comment">-- are always enabled. Furthermore, MonadFailDesugaring is no longer</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-comment">-- enabled by default, so simply use MonadFail.fail. (That happens to</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-comment">-- be the same as Prelude.fail in 8.8+.)</span><span>
</span><span id="line-517"></span><span>    </span><span id="local-6989586621679510928"><span class="annot"><span class="annottext">mk_fail_name :: q Name
</span><a href="#local-6989586621679510928"><span class="hs-identifier hs-var hs-var">mk_fail_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510927"><span class="hs-identifier hs-var">fail_MonadFail_name</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>      </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">qIsExtEnabled</span><span> </span><span class="hs-identifier">MonadFailDesugaring</span><span>
</span><span id="line-521"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">fail_MonadFail_name</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">fail_Prelude_name</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">fail_Prelude_name</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span id="local-6989586621679510927"><span class="annot"><span class="annottext">fail_MonadFail_name :: Name
</span><a href="#local-6989586621679510927"><span class="hs-identifier hs-var hs-var">fail_MonadFail_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModName -&gt; Name -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_qual_do_name"><span class="hs-identifier hs-var">mk_qual_do_name</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679510941"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MonadFail.fail</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 807
</span><span>    </span><span class="hs-identifier">fail_Prelude_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mk_qual_do_name</span><span> </span><span class="hs-identifier">mb_mod</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Prelude.fail</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | Desugar the contents of a parallel comprehension.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--   Returns a @Pat@ containing a tuple of all bound variables and an expression</span><span>
</span><span id="line-536"></span><span class="hs-comment">--   to produce the values for those variables</span><span>
</span><span id="line-537"></span><span id="local-6989586621679512236"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-type">dsParComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512236"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512236"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-538"></span><span id="dsParComp"><span class="annot"><span class="annottext">dsParComp :: forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var hs-var">dsParComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty list of parallel comprehension statements.&quot;</span></span><span>
</span><span id="line-539"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679510914"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510914"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510910"><span class="annot"><span class="annottext">rv :: OSet Name
</span><a href="#local-6989586621679510910"><span class="hs-identifier hs-var hs-var">rv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510914"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679510907"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510907"><span class="hs-identifier hs-var">dsR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510914"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510910"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_dpat"><span class="hs-identifier hs-var">mk_tuple_dpat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510910"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510907"><span class="hs-identifier hs-var">dsR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679510904"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510904"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510903"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679510903"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510899"><span class="annot"><span class="annottext">qv :: OSet Name
</span><a href="#local-6989586621679510899"><span class="hs-identifier hs-var hs-var">qv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510904"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510898"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510898"><span class="hs-identifier hs-var">rest_pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510897"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510897"><span class="hs-identifier hs-var">rest_exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679510903"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621679510896"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510896"><span class="hs-identifier hs-var">dsQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679510904"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510899"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510895"><span class="annot"><span class="annottext">zipped :: DExp
</span><a href="#local-6989586621679510895"><span class="hs-identifier hs-var hs-var">zipped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">mzip</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510896"><span class="hs-identifier hs-var">dsQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510897"><span class="hs-identifier hs-var">rest_exp</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_dpat"><span class="hs-identifier hs-var">mk_tuple_dpat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510899"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510898"><span class="hs-identifier hs-var">rest_pat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510895"><span class="hs-identifier hs-var">zipped</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-551"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-type">mk_tuple_stmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span>
</span><span id="line-552"></span><span id="mk_tuple_stmt"><span class="annot"><span class="annottext">mk_tuple_stmt :: OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var hs-var">mk_tuple_stmt</span></a></span></span><span> </span><span id="local-6989586621679510894"><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510894"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510894"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-556"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_dpat"><span class="hs-identifier hs-type">mk_tuple_dpat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span>
</span><span id="line-557"></span><span id="mk_tuple_dpat"><span class="annot"><span class="annottext">mk_tuple_dpat :: OSet Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_dpat"><span class="hs-identifier hs-var hs-var">mk_tuple_dpat</span></a></span></span><span> </span><span id="local-6989586621679510892"><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510892"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679510892"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-comment">-- | Desugar a pattern, along with processing a (desugared) expression that</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- is the entire scope of the variables bound in the pattern.</span><span>
</span><span id="line-562"></span><span id="local-6989586621679512245"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-type">dsPatOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512245"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512245"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-563"></span><span id="dsPatOverExp"><span class="annot"><span class="annottext">dsPatOverExp :: forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var hs-var">dsPatOverExp</span></a></span></span><span> </span><span id="local-6989586621679510885"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510885"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510884"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510884"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510883"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510883"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510882"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510882"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510885"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510879"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679510879"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510882"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510883"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510879"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510884"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-comment">-- | Desugar multiple patterns. Like 'dsPatOverExp'.</span><span>
</span><span id="line-569"></span><span id="local-6989586621679512332"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-type">dsPatsOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512332"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512332"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-570"></span><span id="dsPatsOverExp"><span class="annot"><span class="annottext">dsPatsOverExp :: forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var hs-var">dsPatsOverExp</span></a></span></span><span> </span><span id="local-6989586621679510866"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510866"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679510865"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510865"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510864"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510864"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510863"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510863"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510866"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510862"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679510862"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510863"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510864"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510862"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510865"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | Desugar a pattern, returning a list of (Name, DExp) pairs of extra</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- variables that must be bound within the scope of the pattern</span><span>
</span><span id="line-577"></span><span id="local-6989586621679512215"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-type">dsPatX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512215"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512215"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-578"></span><span id="dsPatX"><span class="annot"><span class="annottext">dsPatX :: forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var hs-var">dsPatX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-comment">-- | Desugaring a pattern also returns the list of variables bound in as-patterns</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- and the values they should be bound to. This variables must be brought into</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- scope in the &quot;body&quot; of the pattern.</span><span>
</span><span id="line-583"></span><span class="hs-keyword">type</span><span> </span><span id="PatM"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-var">PatM</span></a></span></span><span> </span><span id="local-6989586621679510858"><span class="annot"><a href="#local-6989586621679510858"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679510858"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- | Desugar a pattern.</span><span>
</span><span id="line-586"></span><span id="local-6989586621679512224"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-type">dsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512224"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512224"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-587"></span><span id="dsPat"><span class="annot"><span class="annottext">dsPat :: forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var hs-var">dsPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitP</span></span><span> </span><span id="local-6989586621679510788"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679510788"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-var">DLitP</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679510788"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-588"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679510785"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510785"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510785"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupP</span></span><span> </span><span id="local-6989586621679510783"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510783"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510783"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510783"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-590"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupP</span></span><span> </span><span id="local-6989586621679510781"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510781"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510781"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-591"></span><span>                           </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510781"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 901
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConP</span></span><span> </span><span id="local-6989586621679510780"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510780"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510779"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510779"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679510778"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510778"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510780"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510779"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510778"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConP</span><span> </span><span class="hs-identifier">name</span><span>     </span><span class="hs-identifier">pats</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DConP</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsPat</span><span> </span><span class="hs-identifier">pats</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixP</span></span><span> </span><span id="local-6989586621679510776"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510776"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679510775"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510775"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510774"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510774"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510775"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510776"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510774"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixP</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-600"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensP</span></span><span> </span><span id="local-6989586621679510771"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510771"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510771"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-601"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TildeP</span></span><span> </span><span id="local-6989586621679510769"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510769"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510769"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-602"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BangP</span></span><span> </span><span id="local-6989586621679510766"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510766"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510766"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-603"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsP</span></span><span> </span><span id="local-6989586621679510763"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510763"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510762"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510762"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>  </span><span id="local-6989586621679510761"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510761"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510762"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span id="local-6989586621679510760"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510760"><span class="hs-identifier hs-var">pat''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510761"><span class="hs-identifier hs-var">pat'</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510763"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510760"><span class="hs-identifier hs-var">pat''</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510760"><span class="hs-identifier hs-var">pat''</span></a></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-609"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecP</span></span><span> </span><span id="local-6989586621679510753"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510753"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679510752"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679510752"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>  </span><span id="local-6989586621679510751"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510751"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510753"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679510750"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510750"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
DsMonad m =&gt;
Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679510749"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510751"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510753"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510750"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-614"></span><span>    </span><span id="local-6989586621679510749"><span class="annot"><span class="annottext">reorder :: Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679510749"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679510729"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510729"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510729"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-615"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679510728"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510728"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679510727"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510727"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {t :: (* -&gt; *) -&gt; * -&gt; *} {m :: * -&gt; *} {a}.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679510726"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510727"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-616"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679510725"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679510725"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679510724"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510724"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679510723"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679510723"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {t :: (* -&gt; *) -&gt; * -&gt; *} {m :: * -&gt; *} {a}.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679510726"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679510725"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679510723"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-617"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679510722"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510722"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679510721"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510721"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {q :: * -&gt; *}. DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679510720"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510721"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-618"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679510719"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510719"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679510749"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510719"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679510718"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679510718"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679510717"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510717"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679510716"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510716"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {t :: (* -&gt; *) -&gt; * -&gt; *} {m :: * -&gt; *} {a}.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679510726"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510717"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-621"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679510715"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679510715"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679510714"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510714"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679510713"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510713"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {q :: * -&gt; *}. DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679510720"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510714"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679510720"><span class="annot"><span class="annottext">reorder_fields_pat :: [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679510720"><span class="hs-identifier hs-var hs-var">reorder_fields_pat</span></a></span></span><span> </span><span id="local-6989586621679510710"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510710"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var">reorderFieldsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510753"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510710"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679510752"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span>    </span><span id="local-6989586621679510726"><span class="annot"><span class="annottext">non_record :: t a -&gt; t m [DPat]
</span><a href="#local-6989586621679510726"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679510696"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679510696"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679510752"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-627"></span><span>                        </span><span class="hs-comment">-- Special case: record patterns are allowed for any</span><span>
</span><span id="line-628"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-629"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that</span><span>
</span><span id="line-630"></span><span>                        </span><span class="hs-comment">-- no records are given in the pattern itself. (See #59).</span><span>
</span><span id="line-631"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-632"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con _ ... _.</span><span>
</span><span id="line-633"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679510696"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-634"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span>
</span><span id="line-635"></span><span>                                         </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-636"></span><span>                                           </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510753"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListP</span></span><span> </span><span id="local-6989586621679510694"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510694"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {q :: * -&gt; *}.
DsMonad q =&gt;
[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679510693"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510694"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679510693"><span class="annot"><span class="annottext">go :: [Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679510693"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>        </span><span class="annot"><a href="#local-6989586621679510693"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679510682"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510682"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679510681"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510681"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>          </span><span id="local-6989586621679510680"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510680"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510682"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-642"></span><span>          </span><span id="local-6989586621679510679"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510679"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679510693"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679510681"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-643"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510680"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510679"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigP</span></span><span> </span><span id="local-6989586621679510677"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510677"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510676"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510676"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DKind -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510677"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510676"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumP</span></span><span> </span><span id="local-6989586621679510673"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510673"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510672"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510672"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679510671"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510671"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510672"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510671"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510673"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViewP</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-650"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;View patterns are not supported in th-desugar. Use pattern guards instead.&quot;</span></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">-- | Convert a 'DPat' to a 'DExp'. Fails on 'DWildP'.</span><span>
</span><span id="line-653"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-type">dPatToDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-654"></span><span id="dPatToDExp"><span class="annot"><span class="annottext">dPatToDExp :: DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var hs-var">dPatToDExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span id="local-6989586621679510669"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679510669"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679510669"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-655"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679510668"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510668"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510668"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-656"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679510667"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510667"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510666"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510666"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679510665"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510665"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-var">DAppTypeE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510667"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510666"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510665"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679510664"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510664"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510664"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-658"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679510663"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510663"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510663"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-659"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679510662"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510662"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510661"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510661"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510662"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510661"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-660"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar: wildcard in rhs of as-pattern&quot;</span></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-comment">-- | Remove all wildcards from a pattern, replacing any wildcard with a fresh</span><span>
</span><span id="line-663"></span><span class="hs-comment">--   variable</span><span>
</span><span id="line-664"></span><span id="local-6989586621679512196"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-type">removeWilds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512196"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512196"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-665"></span><span id="removeWilds"><span class="annot"><span class="annottext">removeWilds :: forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var hs-var">removeWilds</span></a></span></span><span> </span><span id="local-6989586621679510637"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679510637"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510637"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-666"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span id="local-6989586621679510636"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679510636"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510636"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-667"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679510635"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510635"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679510634"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510634"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679510633"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510633"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510635"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510634"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679510633"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-668"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679510632"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510632"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510632"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-669"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679510631"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510631"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510631"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-670"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679510630"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510630"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510629"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510629"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DKind -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510630"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510629"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-671"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wild&quot;</span></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span class="hs-comment">-- | Desugar @Info@</span><span>
</span><span id="line-674"></span><span id="local-6989586621679512181"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-type">dsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512181"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512181"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span></span><span>
</span><span id="line-675"></span><span id="dsInfo"><span class="annot"><span class="annottext">dsInfo :: forall (q :: * -&gt; *). DsMonad q =&gt; Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var hs-var">dsInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassI</span></span><span> </span><span id="local-6989586621679510586"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510586"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679510585"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510585"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679510584"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510584"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510586"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-677"></span><span>  </span><span id="local-6989586621679510582"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679510582"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510585"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510584"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679510582"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassOpI</span></span><span> </span><span id="local-6989586621679510578"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510578"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510577"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510577"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679510576"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510576"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510578"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510577"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510576"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span id="local-6989586621679510573"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510573"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679510572"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510572"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510573"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510572"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-688"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span id="local-6989586621679510570"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510570"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679510569"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510569"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679510568"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510568"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510570"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-690"></span><span>  </span><span id="local-6989586621679510567"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679510567"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510569"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679510568"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679510567"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimTyConI</span></span><span> </span><span id="local-6989586621679510565"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510565"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510564"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510564"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621679510563"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679510563"><span class="hs-identifier hs-var">unlifted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-693"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Int -&gt; Bool -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPrimTyConI"><span class="hs-identifier hs-var">DPrimTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510565"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510564"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679510563"><span class="hs-identifier hs-var">unlifted</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataConI</span></span><span> </span><span id="local-6989586621679510560"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510560"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510559"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510559"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679510558"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510558"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-696"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510560"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510559"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510558"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679510557"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510557"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510556"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510556"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Dec
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-698"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510557"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510556"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-699"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679510555"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510555"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510555"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">parent</span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-706"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-identifier">impossible</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">name</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarI</span></span><span> </span><span id="local-6989586621679510553"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510553"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510552"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510552"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarI"><span class="hs-identifier hs-var">DTyVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510553"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510552"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynI</span></span><span> </span><span id="local-6989586621679510549"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510549"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510548"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510548"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynI"><span class="hs-identifier hs-var">DPatSynI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510549"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510548"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- | Desugar arbitrary @Dec@s</span><span>
</span><span id="line-715"></span><span id="local-6989586621679512176"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-type">dsDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512176"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512176"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-716"></span><span id="dsDecs"><span class="annot"><span class="annottext">dsDecs :: forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var hs-var">dsDecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="hs-comment">-- | Desugar a single @Dec@, perhaps producing multiple 'DDec's</span><span>
</span><span id="line-719"></span><span id="local-6989586621679512177"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-type">dsDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512177"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512177"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-720"></span><span id="dsDec"><span class="annot"><span class="annottext">dsDec :: forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var hs-var">dsDec</span></a></span></span><span> </span><span id="local-6989586621679510435"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679510435"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510435"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-721"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679510432"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679510432"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510432"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span> </span><span id="local-6989586621679510429"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510429"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510428"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510428"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510427"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510427"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510426"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510426"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510425"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510425"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679510424"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510424"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-724"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; [TyVarBndrUnit]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510429"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510428"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510427"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510426"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510425"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510424"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-725"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span id="local-6989586621679510420"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510420"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510419"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510419"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510418"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510418"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510417"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510417"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510416"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510416"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679510415"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510415"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-726"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; [TyVarBndrUnit]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510420"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510419"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510418"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510417"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510416"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510415"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-730"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span id="local-6989586621679510412"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510412"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510411"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510411"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510410"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510410"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndrUnit] -&gt; DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynD"><span class="hs-identifier hs-var">DTySynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510412"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510411"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510410"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span id="local-6989586621679510406"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510406"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510405"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510405"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510404"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510404"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510403"><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679510403"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679510402"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510402"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DKind] -&gt; Name -&gt; [DTyVarBndrUnit] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClassD"><span class="hs-identifier hs-var">DClassD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510406"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510405"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510404"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-737"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679510403"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510402"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span id="local-6989586621679510398"><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679510398"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679510397"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510397"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510396"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510396"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679510395"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510395"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Overlap
-&gt; Maybe [DTyVarBndrUnit] -&gt; [DKind] -&gt; DKind -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInstanceD"><span class="hs-identifier hs-var">DInstanceD</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679510398"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510397"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510396"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510395"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-743"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DInstanceD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsDecs</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679510393"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679510393"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510393"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-746"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignD</span></span><span> </span><span id="local-6989586621679510390"><span class="annot"><span class="annottext">Foreign
</span><a href="#local-6989586621679510390"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForeign -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForeignD"><span class="hs-identifier hs-var">DForeignD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="annot"><span class="annottext">Foreign
</span><a href="#local-6989586621679510390"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679510387"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679510387"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510387"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-748"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679510385"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679510385"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510385"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span id="local-6989586621679510382"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679510382"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DOpenTypeFamilyD"><span class="hs-identifier hs-var">DOpenTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679510382"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataFamilyD</span></span><span> </span><span id="local-6989586621679510378"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510378"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510377"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510377"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510376"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510376"><span class="hs-identifier hs-var">m_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndrUnit] -&gt; Maybe DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataFamilyD"><span class="hs-identifier hs-var">DDataFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510378"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510377"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510376"><span class="hs-identifier hs-var">m_k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DOpenTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">DataFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-758"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDataFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvbUnit</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span id="local-6989586621679510373"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510373"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510372"><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510372"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679510371"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510371"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679510370"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510370"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510369"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510369"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679510368"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510368"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510371"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-763"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679510366"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510366"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510365"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510365"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; Maybe [TyVarBndrUnit]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510373"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510366"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510372"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510365"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510370"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510369"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510368"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected data instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510371"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-765"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span id="local-6989586621679510361"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510361"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510360"><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510360"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679510359"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510359"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679510358"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510358"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510357"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510357"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679510356"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510356"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510359"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-767"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679510355"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510355"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510354"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510354"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; Maybe [TyVarBndrUnit]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510361"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510355"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510360"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510354"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510358"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510357"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510356"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected newtype instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510359"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-771"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-772"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-777"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-778"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynInstD</span></span><span> </span><span id="local-6989586621679510352"><span class="annot"><span class="annottext">TySynEqn
</span><a href="#local-6989586621679510352"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTySynEqn -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynInstD"><span class="hs-identifier hs-var">DTySynInstD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span> </span><span class="annot"><span class="annottext">TySynEqn
</span><a href="#local-6989586621679510352"><span class="hs-identifier hs-var">eqn</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynInstD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span id="local-6989586621679510347"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679510347"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span> </span><span id="local-6989586621679510346"><span class="annot"><span class="annottext">[TySynEqn]
</span><a href="#local-6989586621679510346"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; [DTySynEqn] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClosedTypeFamilyD"><span class="hs-identifier hs-var">DClosedTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679510347"><span class="hs-identifier hs-var">tfHead</span></a></span><span>
</span><span id="line-788"></span><span>                                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var">typeFamilyHeadName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679510347"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><a href="#local-6989586621679510346"><span class="hs-identifier hs-var">eqns</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DClosedTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span>
</span><span id="line-792"></span><span>                                </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RoleAnnotD</span></span><span> </span><span id="local-6989586621679510342"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510342"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510341"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679510341"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Role] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRoleAnnotD"><span class="hs-identifier hs-var">DRoleAnnotD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510342"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679510341"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynD</span></span><span> </span><span id="local-6989586621679510338"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510338"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510337"><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679510337"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679510336"><span class="annot"><span class="annottext">PatSynDir
</span><a href="#local-6989586621679510336"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679510335"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510335"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-798"></span><span>  </span><span id="local-6989586621679510334"><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679510334"><span class="hs-identifier hs-var">dir'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510338"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><a href="#local-6989586621679510336"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510332"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510332"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510331"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510331"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510335"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-800"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510331"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-801"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern synonym definition cannot contain as-patterns (@).&quot;</span></span><span>
</span><span id="line-802"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; PatSynArgs -&gt; DPatSynDir -&gt; DPat -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynD"><span class="hs-identifier hs-var">DPatSynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510338"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679510337"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679510334"><span class="hs-identifier hs-var">dir'</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510332"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-803"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynSigD</span></span><span> </span><span id="local-6989586621679510327"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510327"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510326"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510326"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynSigD"><span class="hs-identifier hs-var">DPatSynSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510327"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510326"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StandaloneDerivD</span></span><span> </span><span id="local-6989586621679510323"><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679510323"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679510322"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510322"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510321"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510321"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DDerivStrategy
-&gt; Maybe [DTyVarBndrUnit] -&gt; [DKind] -&gt; DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStandaloneDerivD"><span class="hs-identifier hs-var">DStandaloneDerivD</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679510323"><span class="hs-identifier hs-var">mds</span></a></span><span>
</span><span id="line-806"></span><span>                               </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510322"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510321"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StandaloneDerivD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DStandaloneDerivD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefaultSigD</span></span><span> </span><span id="local-6989586621679510317"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510317"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510316"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510316"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDefaultSigD"><span class="hs-identifier hs-var">DDefaultSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510317"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510316"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-`let`-bound implicit param binding&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KiSigD</span></span><span> </span><span id="local-6989586621679510312"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510312"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510311"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510311"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKiSigD"><span class="hs-identifier hs-var">DKiSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510312"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510311"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-820"></span><span class="hs-comment">-- | Desugar a 'DataD' or 'NewtypeD'.</span><span>
</span><span id="line-821"></span><span id="local-6989586621679512168"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-type">dsDataDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512168"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-822"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span class="hs-special">]</span><span>
</span><span id="line-823"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512168"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-824"></span><span id="dsDataDec"><span class="annot"><span class="annottext">dsDataDec :: forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; [TyVarBndrUnit]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var hs-var">dsDataDec</span></a></span></span><span> </span><span id="local-6989586621679510278"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679510278"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679510277"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510277"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510276"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510276"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510275"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510275"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510274"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510274"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510273"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510273"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679510272"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510272"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-825"></span><span>  </span><span id="local-6989586621679510271"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510271"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510275"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510270"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndrUnit]
</span><a href="#local-6989586621679510270"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510274"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-827"></span><span>                   </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-828"></span><span>                   </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-829"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-830"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510271"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-831"></span><span>      </span><span id="local-6989586621679510269"><span class="annot"><span class="annottext">h98_return_type :: DKind
</span><a href="#local-6989586621679510269"><span class="hs-identifier hs-var hs-var">h98_return_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndrUnit] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var">nonFamilyDataReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510276"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510271"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; [DKind]
-&gt; Name
-&gt; [DTyVarBndrUnit]
-&gt; Maybe DKind
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-var">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679510278"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510277"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510276"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-833"></span><span>                       </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510271"><span class="hs-identifier hs-var">tvbs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510274"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-834"></span><span>                       </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndrUnit] -&gt; DKind -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510270"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510269"><span class="hs-identifier hs-var">h98_return_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510273"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-835"></span><span>                       </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510272"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="hs-comment">-- | Desugar a 'DataInstD' or a 'NewtypeInstD'.</span><span>
</span><span id="line-838"></span><span id="local-6989586621679512156"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-type">dsDataInstDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512156"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-839"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512156"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-841"></span><span id="dsDataInstDec"><span class="annot"><span class="annottext">dsDataInstDec :: forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; [Type]
-&gt; Name
-&gt; Maybe [TyVarBndrUnit]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var hs-var">dsDataInstDec</span></a></span></span><span> </span><span id="local-6989586621679510229"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679510229"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679510228"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679510227"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510227"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510226"><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510226"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679510225"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510225"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679510224"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510224"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679510223"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510223"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679510222"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510222"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-842"></span><span>  </span><span id="local-6989586621679510221"><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679510221"><span class="hs-identifier hs-var">mtvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679510226"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-843"></span><span>  </span><span id="local-6989586621679510220"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679510220"><span class="hs-identifier hs-var">tys'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679510225"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510218"><span class="annot"><span class="annottext">lhs' :: DKind
</span><a href="#local-6989586621679510218"><span class="hs-identifier hs-var hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510227"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679510220"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-845"></span><span>      </span><span id="local-6989586621679510215"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndrUnit]
</span><a href="#local-6989586621679510215"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-846"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510224"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679510221"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-847"></span><span>          </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-848"></span><span>          </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-849"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-850"></span><span>          </span><span class="hs-comment">-- H98, and there is an explicit `forall` in front. Just reuse the</span><span>
</span><span id="line-851"></span><span>          </span><span class="hs-comment">-- type variable binders from the `forall`.</span><span>
</span><span id="line-852"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679510214"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510214"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510214"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-853"></span><span>          </span><span class="hs-comment">-- H98, and no explicit `forall`. Compute the bound variables</span><span>
</span><span id="line-854"></span><span>          </span><span class="hs-comment">-- manually.</span><span>
</span><span id="line-855"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; [DTyVarBndrUnit]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var">dataFamInstTvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679510220"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-856"></span><span>      </span><span id="local-6989586621679510212"><span class="annot"><span class="annottext">h98_fam_inst_type :: DKind
</span><a href="#local-6989586621679510212"><span class="hs-identifier hs-var hs-var">h98_fam_inst_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var">dataFamInstReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510227"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679510220"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; [DKind]
-&gt; Maybe [DTyVarBndrUnit]
-&gt; DKind
-&gt; Maybe DKind
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataInstD"><span class="hs-identifier hs-var">DDataInstD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679510229"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit]
</span><a href="#local-6989586621679510221"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span>
</span><span id="line-858"></span><span>                           </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510218"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679510224"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-859"></span><span>                           </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndrUnit] -&gt; DKind -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510215"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510212"><span class="hs-identifier hs-var">h98_fam_inst_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679510223"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-860"></span><span>                           </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679510222"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @FamilyResultSig@</span><span>
</span><span id="line-864"></span><span id="local-6989586621679512136"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-type">dsFamilyResultSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512136"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512136"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFamilyResultSig"><span class="hs-identifier hs-type">DFamilyResultSig</span></a></span></span><span>
</span><span id="line-865"></span><span id="dsFamilyResultSig"><span class="annot"><span class="annottext">dsFamilyResultSig :: forall (q :: * -&gt; *).
DsMonad q =&gt;
FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var hs-var">dsFamilyResultSig</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier hs-var">NoSig</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNoSig"><span class="hs-identifier hs-var">DNoSig</span></a></span><span>
</span><span id="line-866"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindSig</span></span><span> </span><span id="local-6989586621679510195"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindSig"><span class="hs-identifier hs-var">DKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-867"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarSig</span></span><span> </span><span id="local-6989586621679510192"><span class="annot"><span class="annottext">TyVarBndrUnit
</span><a href="#local-6989586621679510192"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DTyVarBndrUnit -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarSig"><span class="hs-identifier hs-var">DTyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarBndrUnit
</span><a href="#local-6989586621679510192"><span class="hs-identifier hs-var">tvb</span></a></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span class="hs-comment">-- | Desugar a @TypeFamilyHead@</span><span>
</span><span id="line-870"></span><span id="local-6989586621679512158"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-type">dsTypeFamilyHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512158"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512158"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span></span><span>
</span><span id="line-871"></span><span id="dsTypeFamilyHead"><span class="annot"><span class="annottext">dsTypeFamilyHead :: forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var hs-var">dsTypeFamilyHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679510176"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510176"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510175"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510175"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679510174"><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679510174"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679510173"><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679510173"><span class="hs-identifier hs-var">inj</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [DTyVarBndrUnit]
-&gt; DFamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-var">DTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510176"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679510175"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-873"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679510174"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-874"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679510173"><span class="hs-identifier hs-var">inj</span></a></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-type">typeFamilyHeadName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-877"></span><span id="typeFamilyHeadName"><span class="annot"><span class="annottext">typeFamilyHeadName :: TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var hs-var">typeFamilyHeadName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679510171"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510171"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510171"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar bits and pieces into a 'DTypeFamilyHead'</span><span>
</span><span id="line-880"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span>
</span><span id="line-881"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndrUnit</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTypeFamilyHead</span><span>
</span><span id="line-882"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-identifier">result_sig</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">DNoSig</span><span>
</span><span id="line-885"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">k</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DKindSig</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">k</span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvbUnit</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><span id="line-887"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">result_sig</span><span>
</span><span id="line-888"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- | Desugar @Dec@s that can appear in a @let@ expression. See the</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- documentation for 'dsLetDec' for an explanation of what the return type</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- represents.</span><span>
</span><span id="line-894"></span><span id="local-6989586621679512322"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-type">dsLetDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512322"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512322"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-895"></span><span id="dsLetDecs"><span class="annot"><span class="annottext">dsLetDecs :: forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var hs-var">dsLetDecs</span></a></span></span><span> </span><span id="local-6989586621679510160"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510160"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510159"><span class="annot"><span class="annottext">[[DLetDec]]
</span><a href="#local-6989586621679510159"><span class="hs-identifier hs-var">let_decss</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510158"><span class="annot"><span class="annottext">[DExp -&gt; DExp]
</span><a href="#local-6989586621679510158"><span class="hs-identifier hs-var">ip_binders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><span class="hs-identifier hs-var">mapAndUnzipM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510160"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679510155"><span class="hs-identifier hs-type">let_decs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-898"></span><span>      </span><span id="local-6989586621679510155"><span class="annot"><span class="annottext">let_decs :: [DLetDec]
</span><a href="#local-6989586621679510155"><span class="hs-identifier hs-var hs-var">let_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[DLetDec]]
</span><a href="#local-6989586621679510159"><span class="hs-identifier hs-var">let_decss</span></a></span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span>      </span><span class="annot"><a href="#local-6989586621679510154"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-901"></span><span>      </span><span id="local-6989586621679510154"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679510154"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[DExp -&gt; DExp]
</span><a href="#local-6989586621679510158"><span class="hs-identifier hs-var">ip_binders</span></a></span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510155"><span class="hs-identifier hs-var">let_decs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510154"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span class="hs-comment">-- | Desugar a single 'Dec' that can appear in a @let@ expression.</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- This produces the following output:</span><span>
</span><span id="line-906"></span><span class="hs-comment">--</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- * One or more 'DLetDec's (a single 'Dec' can produce multiple 'DLetDec's</span><span>
</span><span id="line-908"></span><span class="hs-comment">--   in the event of a value declaration that binds multiple things by way</span><span>
</span><span id="line-909"></span><span class="hs-comment">--   of pattern matching.</span><span>
</span><span id="line-910"></span><span class="hs-comment">--</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- * A function of type @'DExp' -&gt; 'DExp'@, which should be applied to the</span><span>
</span><span id="line-912"></span><span class="hs-comment">--   expression immediately following the 'DLetDec's. This function prepends</span><span>
</span><span id="line-913"></span><span class="hs-comment">--   binding forms for any implicit params that were bound in the argument</span><span>
</span><span id="line-914"></span><span class="hs-comment">--   'Dec'. (If no implicit params are bound, this is simply the 'id'</span><span>
</span><span id="line-915"></span><span class="hs-comment">--   function.)</span><span>
</span><span id="line-916"></span><span class="hs-comment">--</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- For instance, if the argument to 'dsLetDec' is the @?x = 42@ part of this</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- expression:</span><span>
</span><span id="line-919"></span><span class="hs-comment">--</span><span>
</span><span id="line-920"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- let { ?x = 42 } in ?x</span><span>
</span><span id="line-922"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-923"></span><span class="hs-comment">--</span><span>
</span><span id="line-924"></span><span class="hs-comment">-- Then the output is:</span><span>
</span><span id="line-925"></span><span class="hs-comment">--</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- * @let new_x_val = 42@</span><span>
</span><span id="line-927"></span><span class="hs-comment">--</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- * @\\z -&gt; 'bindIP' \@\&quot;x\&quot; new_x_val z@</span><span>
</span><span id="line-929"></span><span class="hs-comment">--</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- This way, the expression</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- @let { new_x_val = 42 } in 'bindIP' \@&quot;x&quot; new_x_val ('ip' \@\&quot;x\&quot;)@ can be</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- formed. The implicit param binders always come after all the other</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- 'DLetDec's to support parallel assignment of implicit params.</span><span>
</span><span id="line-934"></span><span id="local-6989586621679512126"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-type">dsLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512126"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512126"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-935"></span><span id="dsLetDec"><span class="annot"><span class="annottext">dsLetDec :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var hs-var">dsLetDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679510127"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510127"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510126"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679510126"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>  </span><span id="local-6989586621679510125"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679510125"><span class="hs-identifier hs-var">clauses'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510127"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679510126"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-937"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [DClause] -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DFunD"><span class="hs-identifier hs-var">DFunD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510127"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679510125"><span class="hs-identifier hs-var">clauses'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679510122"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510122"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679510121"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679510121"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679510120"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510120"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-939"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679510119"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510119"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510118"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510118"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510122"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-940"></span><span>  </span><span id="local-6989586621679510117"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510117"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679510121"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679510120"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510116"><span class="hs-identifier hs-var">error_exp</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510115"><span class="annot"><span class="annottext">extras :: [DLetDec]
</span><a href="#local-6989586621679510115"><span class="hs-identifier hs-var hs-var">extras</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679510118"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679510119"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510117"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679510115"><span class="hs-identifier hs-var">extras</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-943"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-944"></span><span>    </span><span id="local-6989586621679510116"><span class="annot"><span class="annottext">error_exp :: DExp
</span><a href="#local-6989586621679510116"><span class="hs-identifier hs-var hs-var">error_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span>
</span><span id="line-945"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns for &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679510122"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span id="local-6989586621679510110"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510110"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679510109"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510109"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-947"></span><span>  </span><span id="local-6989586621679510108"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510108"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679510109"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-948"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigD"><span class="hs-identifier hs-var">DSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510110"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510108"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span id="local-6989586621679510106"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679510106"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621679510105"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510105"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Fixity -&gt; Name -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInfixD"><span class="hs-identifier hs-var">DInfixD</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679510106"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510105"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span id="local-6989586621679510103"><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621679510103"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621679510102"><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679510102"><span class="hs-identifier hs-var">prag'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621679510103"><span class="hs-identifier hs-var">prag</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPragma -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPragmaD"><span class="hs-identifier hs-var">DPragmaD</span></a></span><span> </span><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679510102"><span class="hs-identifier hs-var">prag'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span id="local-6989586621679510099"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510099"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510098"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510098"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621679510097"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510097"><span class="hs-identifier hs-var">new_n_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new_&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510099"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_val&quot;</span></span><span>
</span><span id="line-956"></span><span>  </span><span id="local-6989586621679510096"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510096"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679510098"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679510095"><span class="hs-identifier hs-type">let_dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span>
</span><span id="line-958"></span><span>      </span><span id="local-6989586621679510095"><span class="annot"><span class="annottext">let_dec :: DLetDec
</span><a href="#local-6989586621679510095"><span class="hs-identifier hs-var hs-var">let_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510097"><span class="hs-identifier hs-var">new_n_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679510096"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span>      </span><span class="annot"><a href="#local-6989586621679510094"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-961"></span><span>      </span><span id="local-6989586621679510094"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679510094"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">bindIP</span><span>        </span><span class="annot"><span class="annottext">DExp -&gt; DKind -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span>
</span><span id="line-962"></span><span>                     </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510099"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-963"></span><span>                     </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510097"><span class="hs-identifier hs-var">new_n_name</span></a></span><span>   </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679510095"><span class="hs-identifier hs-var">let_dec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679510094"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span id="local-6989586621679510093"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679510093"><span class="hs-identifier hs-var">_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal declaration in let expression.&quot;</span></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span class="hs-comment">-- | Desugar a single 'Dec' corresponding to something that could appear after</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- the @let@ in a @let@ expression, but occurring at the top level. Because the</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- 'Dec' occurs at the top level, there is nothing that would correspond to the</span><span>
</span><span id="line-971"></span><span class="hs-comment">-- @in ...@ part of the @let@ expression. As a consequence, this function does</span><span>
</span><span id="line-972"></span><span class="hs-comment">-- not return a @'DExp' -&gt; 'DExp'@ function corresonding to implicit param</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- binders (these cannot occur at the top level).</span><span>
</span><span id="line-974"></span><span id="local-6989586621679510092"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-type">dsTopLevelLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679510092"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679510092"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-975"></span><span id="dsTopLevelLetDec"><span class="annot"><span class="annottext">dsTopLevelLetDec :: forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var hs-var">dsTopLevelLetDec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-var">DLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-comment">-- Note the use of fst above: we're silently throwing away any implicit param</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-comment">-- binders that dsLetDec returns, since there is invariant that there will be</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-comment">-- no implicit params in the first place.</span><span>
</span><span id="line-979"></span><span>
</span><span id="line-980"></span><span class="hs-comment">-- | Desugar a single @Con@.</span><span>
</span><span id="line-981"></span><span class="hs-comment">--</span><span>
</span><span id="line-982"></span><span class="hs-comment">-- Because we always desugar @Con@s to GADT syntax (see the documentation for</span><span>
</span><span id="line-983"></span><span class="hs-comment">-- 'DCon'), it is not always possible to desugar with just a 'Con' alone.</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- For instance, we must desugar:</span><span>
</span><span id="line-985"></span><span class="hs-comment">--</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-987"></span><span class="hs-comment">-- data Foo a = forall b. MkFoo b</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-989"></span><span class="hs-comment">--</span><span>
</span><span id="line-990"></span><span class="hs-comment">-- To this:</span><span>
</span><span id="line-991"></span><span class="hs-comment">--</span><span>
</span><span id="line-992"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-993"></span><span class="hs-comment">-- data Foo a :: Type where</span><span>
</span><span id="line-994"></span><span class="hs-comment">--   MkFoo :: forall a b. b -&gt; Foo a</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-996"></span><span class="hs-comment">--</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- If our only argument was @forall b. MkFoo b@, it would be somewhat awkward</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- to figure out (1) what the set of universally quantified type variables</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- (@[a]@) was, and (2) what the return type (@Foo a@) was. For this reason,</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- we require passing these as arguments. (If we desugar an actual GADT</span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- constructor, these arguments are ignored.)</span><span>
</span><span id="line-1002"></span><span id="local-6989586621679512140"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-type">dsCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512140"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1003"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The universally quantified type variables</span><span>
</span><span id="line-1004"></span><span>                          </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-1005"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>            </span><span class="hs-comment">-- ^ The original data declaration's type</span><span>
</span><span id="line-1006"></span><span>                          </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-1007"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512140"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1008"></span><span id="dsCon"><span class="annot"><span class="annottext">dsCon :: forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndrUnit] -&gt; DKind -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var hs-var">dsCon</span></a></span></span><span> </span><span id="local-6989586621679510076"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510076"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span></span><span> </span><span id="local-6989586621679510075"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510075"><span class="hs-identifier hs-var">data_type</span></a></span></span><span> </span><span id="local-6989586621679510074"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510074"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1009"></span><span>  </span><span id="local-6989586621679510073"><span class="annot"><span class="annottext">[(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="#local-6989586621679510073"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Con
-&gt; q [(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679510074"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1010"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="#local-6989586621679510073"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679510070"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510070"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510069"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510069"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510068"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510068"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510067"><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679510067"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510066"><span class="annot"><span class="annottext">Maybe DKind
</span><a href="#local-6989586621679510066"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1011"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DKind
</span><a href="#local-6989586621679510066"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1012"></span><span>      </span><span class="annot"><span class="annottext">Maybe DKind
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1013"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510065"><span class="annot"><span class="annottext">ex_dtvbs :: [DTyVarBndrSpec]
</span><a href="#local-6989586621679510065"><span class="hs-identifier hs-var hs-var">ex_dtvbs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510069"><span class="hs-identifier hs-var">dtvbs</span></a></span><span>
</span><span id="line-1014"></span><span>            </span><span id="local-6989586621679510064"><span class="annot"><span class="annottext">expl_dtvbs :: [DTyVarBndrSpec]
</span><a href="#local-6989586621679510064"><span class="hs-identifier hs-var hs-var">expl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall newFlag oldFlag.
newFlag -&gt; [DTyVarBndr oldFlag] -&gt; [DTyVarBndr newFlag]
</span><a href="Language.Haskell.TH.Desugar.Core.html#changeDTVFlags"><span class="hs-identifier hs-var">changeDTVFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><span class="hs-identifier hs-var">SpecifiedSpec</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679510076"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1015"></span><span>                         </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510065"><span class="hs-identifier hs-var">ex_dtvbs</span></a></span><span>
</span><span id="line-1016"></span><span>            </span><span id="local-6989586621679510061"><span class="annot"><span class="annottext">impl_dtvbs :: [DTyVarBndrSpec]
</span><a href="#local-6989586621679510061"><span class="hs-identifier hs-var hs-var">impl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall newFlag oldFlag.
newFlag -&gt; [DTyVarBndr oldFlag] -&gt; [DTyVarBndr newFlag]
</span><a href="Language.Haskell.TH.Desugar.Core.html#changeDTVFlags"><span class="hs-identifier hs-var">changeDTVFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><span class="hs-identifier hs-var">SpecifiedSpec</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1017"></span><span>                         </span><span class="annot"><span class="annottext">[DKind] -&gt; [DTyVarBndrUnit]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; Maybe DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510064"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1018"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndrSpec] -&gt; [DKind] -&gt; Name -&gt; DConFields -&gt; DKind -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510061"><span class="hs-identifier hs-var">impl_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510064"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510068"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679510067"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510075"><span class="hs-identifier hs-var">data_type</span></a></span><span>
</span><span id="line-1019"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679510057"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510057"><span class="hs-identifier hs-var">gadt_type</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1020"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510056"><span class="annot"><span class="annottext">univ_ex_dtvbs :: [DTyVarBndrSpec]
</span><a href="#local-6989586621679510056"><span class="hs-identifier hs-var hs-var">univ_ex_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510069"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1021"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndrSpec] -&gt; [DKind] -&gt; Name -&gt; DConFields -&gt; DKind -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679510056"><span class="hs-identifier hs-var">univ_ex_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679510068"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679510067"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679510057"><span class="hs-identifier hs-var">gadt_type</span></a></span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- Desugar a Con in isolation. The meaning of the returned DTyVarBndrs changes</span><span>
</span><span id="line-1024"></span><span class="hs-comment">-- depending on what the returned Maybe DType value is:</span><span>
</span><span id="line-1025"></span><span class="hs-comment">--</span><span>
</span><span id="line-1026"></span><span class="hs-comment">-- * If returning Just gadt_ty, then we've encountered a GadtC or RecGadtC,</span><span>
</span><span id="line-1027"></span><span class="hs-comment">--   so the returned DTyVarBndrs are both the universally and existentially</span><span>
</span><span id="line-1028"></span><span class="hs-comment">--   quantified tyvars.</span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- * If returning Nothing, we're dealing with a non-GADT constructor, so</span><span>
</span><span id="line-1030"></span><span class="hs-comment">--   the returned DTyVarBndrs are the existentials only.</span><span>
</span><span id="line-1031"></span><span id="local-6989586621679512106"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-type">dsCon'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512106"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1032"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512106"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrSpec"><span class="hs-identifier hs-type">DTyVarBndrSpec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConFields"><span class="hs-identifier hs-type">DConFields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1033"></span><span id="dsCon%27"><span class="annot"><span class="annottext">dsCon' :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Con
-&gt; q [(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var hs-var">dsCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679510009"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510009"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510008"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510008"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1034"></span><span>  </span><span id="local-6989586621679510007"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679510007"><span class="hs-identifier hs-var">dtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679510008"><span class="hs-identifier hs-var">stys</span></a></span><span>
</span><span id="line-1035"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510009"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679510007"><span class="hs-identifier hs-var">dtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1036"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679510004"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510004"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679510003"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510003"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1037"></span><span>  </span><span id="local-6989586621679510002"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679510002"><span class="hs-identifier hs-var">vdtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679510003"><span class="hs-identifier hs-var">vstys</span></a></span><span>
</span><span id="line-1038"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679510004"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679510002"><span class="hs-identifier hs-var">vdtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1039"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679509999"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679509999"><span class="hs-identifier hs-var">sty1</span></a></span></span><span> </span><span id="local-6989586621679509998"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509998"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509997"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679509997"><span class="hs-identifier hs-var">sty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1040"></span><span>  </span><span id="local-6989586621679509996"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679509996"><span class="hs-identifier hs-var">dty1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679509999"><span class="hs-identifier hs-var">sty1</span></a></span><span>
</span><span id="line-1041"></span><span>  </span><span id="local-6989586621679509995"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679509995"><span class="hs-identifier hs-var">dty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679509997"><span class="hs-identifier hs-var">sty2</span></a></span><span>
</span><span id="line-1042"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509998"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679509996"><span class="hs-identifier hs-var">dty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679509995"><span class="hs-identifier hs-var">dty2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1043"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span id="local-6989586621679509994"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509994"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509993"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509993"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679509992"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679509992"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1044"></span><span>  </span><span id="local-6989586621679509991"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509991"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndr Specificity -&gt; q DTyVarBndrSpec
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbSpec"><span class="hs-identifier hs-var">dsTvbSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509994"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1045"></span><span>  </span><span id="local-6989586621679509989"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509989"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509993"><span class="hs-identifier hs-var">cxt</span></a></span><span>
</span><span id="line-1046"></span><span>  </span><span id="local-6989586621679509988"><span class="annot"><span class="annottext">[(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="#local-6989586621679509988"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
Con
-&gt; q [(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679509992"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1047"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndrSpec], [DKind], DConFields, Maybe DKind)]
</span><a href="#local-6989586621679509988"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679509987"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509987"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509986"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509986"><span class="hs-identifier hs-var">dtvbs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509985"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509985"><span class="hs-identifier hs-var">dcxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509984"><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679509984"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509983"><span class="annot"><span class="annottext">Maybe DKind
</span><a href="#local-6989586621679509983"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1048"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509987"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509991"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509986"><span class="hs-identifier hs-var">dtvbs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509989"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509985"><span class="hs-identifier hs-var">dcxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679509984"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DKind
</span><a href="#local-6989586621679509983"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679509982"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509982"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679509981"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679509981"><span class="hs-identifier hs-var">btys</span></a></span></span><span> </span><span id="local-6989586621679509980"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509980"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1051"></span><span>  </span><span id="local-6989586621679509979"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679509979"><span class="hs-identifier hs-var">dbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679509981"><span class="hs-identifier hs-var">btys</span></a></span><span>
</span><span id="line-1052"></span><span>  </span><span id="local-6989586621679509978"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509978"><span class="hs-identifier hs-var">drty</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509980"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1053"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509982"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679509976"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509976"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1054"></span><span>    </span><span id="local-6989586621679509975"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679509975"><span class="hs-identifier hs-var">mbFi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Fixity)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-var">reifyFixityWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509976"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-1055"></span><span>    </span><span class="hs-comment">-- A GADT data constructor is declared infix when these three</span><span>
</span><span id="line-1056"></span><span>    </span><span class="hs-comment">-- properties hold:</span><span>
</span><span id="line-1057"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509969"><span class="annot"><span class="annottext">decInfix :: Bool
</span><a href="#local-6989586621679509969"><span class="hs-identifier hs-var hs-var">decInfix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var">isInfixDataCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509976"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 1. Its name uses operator syntax</span><span>
</span><span id="line-1058"></span><span>                                                </span><span class="hs-comment">--    (e.g., (:*:))</span><span>
</span><span id="line-1059"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679509979"><span class="hs-identifier hs-var">dbtys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>            </span><span class="hs-comment">-- 2. It has exactly two fields</span><span>
</span><span id="line-1060"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679509975"><span class="hs-identifier hs-var">mbFi</span></a></span><span>                  </span><span class="hs-comment">-- 3. It has a programmer-specified</span><span>
</span><span id="line-1061"></span><span>                                                </span><span class="hs-comment">--    fixity declaration</span><span>
</span><span id="line-1062"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509976"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679509969"><span class="hs-identifier hs-var">decInfix</span></a></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679509979"><span class="hs-identifier hs-var">dbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509978"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679509966"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509966"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679509965"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509965"><span class="hs-identifier hs-var">vbtys</span></a></span></span><span> </span><span id="local-6989586621679509964"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509964"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1064"></span><span>  </span><span id="local-6989586621679509963"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679509963"><span class="hs-identifier hs-var">dvbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509965"><span class="hs-identifier hs-var">vbtys</span></a></span><span>
</span><span id="line-1065"></span><span>  </span><span id="local-6989586621679509962"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509962"><span class="hs-identifier hs-var">drty</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509964"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1066"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509966"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679509961"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509961"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1067"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509961"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679509963"><span class="hs-identifier hs-var">dvbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509962"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1072"></span><span id="local-6989586621679512094"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-type">dsBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512094"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512094"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangType"><span class="hs-identifier hs-type">DBangType</span></a></span></span><span>
</span><span id="line-1073"></span><span id="dsBangType"><span class="annot"><span class="annottext">dsBangType :: forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var hs-var">dsBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509953"><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679509953"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509952"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509952"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679509953"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509952"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1074"></span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1076"></span><span id="local-6989586621679512092"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-type">dsVarBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512092"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarBangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512092"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarBangType"><span class="hs-identifier hs-type">DVarBangType</span></a></span></span><span>
</span><span id="line-1077"></span><span id="dsVarBangType"><span class="annot"><span class="annottext">dsVarBangType :: forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var hs-var">dsVarBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509944"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509944"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509943"><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679509943"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509942"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509942"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509944"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679509943"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509942"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1080"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">StrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DBangType</span><span>
</span><span id="line-1081"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span>
</span><span id="line-1082"></span><span>
</span><span id="line-1083"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1084"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">VarStrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DVarBangType</span><span>
</span><span id="line-1085"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- | Desugar a @Foreign@.</span><span>
</span><span id="line-1089"></span><span id="local-6989586621679512161"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-type">dsForeign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512161"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foreign</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512161"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeign"><span class="hs-identifier hs-type">DForeign</span></a></span></span><span>
</span><span id="line-1090"></span><span id="dsForeign"><span class="annot"><span class="annottext">dsForeign :: forall (q :: * -&gt; *). DsMonad q =&gt; Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var hs-var">dsForeign</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImportF</span></span><span> </span><span id="local-6989586621679509931"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679509931"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679509930"><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679509930"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621679509929"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509929"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679509928"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509928"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509927"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509927"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; Safety -&gt; String -&gt; Name -&gt; DKind -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImportF"><span class="hs-identifier hs-var">DImportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679509931"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679509930"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509929"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509928"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509927"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1091"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExportF</span></span><span> </span><span id="local-6989586621679509924"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679509924"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679509923"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509923"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679509922"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509922"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509921"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509921"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; String -&gt; Name -&gt; DKind -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExportF"><span class="hs-identifier hs-var">DExportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679509924"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509923"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509922"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509921"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span class="hs-comment">-- | Desugar a @Pragma@.</span><span>
</span><span id="line-1094"></span><span id="local-6989586621679512111"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-type">dsPragma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512111"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pragma</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512111"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragma"><span class="hs-identifier hs-type">DPragma</span></a></span></span><span>
</span><span id="line-1095"></span><span id="dsPragma"><span class="annot"><span class="annottext">dsPragma :: forall (q :: * -&gt; *). DsMonad q =&gt; Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var hs-var">dsPragma</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InlineP</span></span><span> </span><span id="local-6989586621679509884"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509884"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509883"><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679509883"><span class="hs-identifier hs-var">inl</span></a></span></span><span> </span><span id="local-6989586621679509882"><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679509882"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679509881"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509881"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Inline -&gt; RuleMatch -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInlineP"><span class="hs-identifier hs-var">DInlineP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509884"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679509883"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679509882"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509881"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1096"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseP</span></span><span> </span><span id="local-6989586621679509878"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509878"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509877"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509877"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679509876"><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679509876"><span class="hs-identifier hs-var">m_inl</span></a></span></span><span> </span><span id="local-6989586621679509875"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509875"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; Maybe Inline -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseP"><span class="hs-identifier hs-var">DSpecialiseP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509878"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509877"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1097"></span><span>                                                          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679509876"><span class="hs-identifier hs-var">m_inl</span></a></span><span>
</span><span id="line-1098"></span><span>                                                          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509875"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1099"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseInstP</span></span><span> </span><span id="local-6989586621679509872"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509872"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseInstP"><span class="hs-identifier hs-var">DSpecialiseInstP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509872"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleP</span></span><span> </span><span id="local-6989586621679509869"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509869"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679509868"><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679509868"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679509867"><span class="annot"><span class="annottext">[RuleBndr]
</span><a href="#local-6989586621679509867"><span class="hs-identifier hs-var">rbs</span></a></span></span><span> </span><span id="local-6989586621679509866"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509866"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679509865"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509865"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679509864"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509864"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe [DTyVarBndrUnit]
-&gt; [DRuleBndr]
-&gt; DExp
-&gt; DExp
-&gt; Phases
-&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleP"><span class="hs-identifier hs-var">DRuleP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509869"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679509868"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-1103"></span><span>                                                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">[RuleBndr]
</span><a href="#local-6989586621679509867"><span class="hs-identifier hs-var">rbs</span></a></span><span>
</span><span id="line-1104"></span><span>                                                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509866"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1105"></span><span>                                                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509865"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1106"></span><span>                                                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679509864"><span class="hs-identifier hs-var">phases</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsPragma</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">rbs</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span> </span><span class="hs-identifier">phases</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DRuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1109"></span><span>                                                      </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsRuleBndr</span><span> </span><span class="hs-identifier">rbs</span><span>
</span><span id="line-1110"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">lhs</span><span>
</span><span id="line-1111"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">rhs</span><span>
</span><span id="line-1112"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">phases</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AnnP</span></span><span> </span><span id="local-6989586621679509860"><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679509860"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679509859"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509859"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnTarget -&gt; DExp -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnnP"><span class="hs-identifier hs-var">DAnnP</span></a></span><span> </span><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679509860"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509859"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineP</span></span><span> </span><span id="local-6989586621679509856"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509856"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509855"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509855"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLineP"><span class="hs-identifier hs-var">DLineP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509856"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509855"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompleteP</span></span><span> </span><span id="local-6989586621679509852"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509852"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679509851"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679509851"><span class="hs-identifier hs-var">mty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Maybe Name -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCompleteP"><span class="hs-identifier hs-var">DCompleteP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509852"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679509851"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- | Desugar a @RuleBndr@.</span><span>
</span><span id="line-1123"></span><span id="local-6989586621679512075"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-type">dsRuleBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512075"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RuleBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512075"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleBndr"><span class="hs-identifier hs-type">DRuleBndr</span></a></span></span><span>
</span><span id="line-1124"></span><span id="dsRuleBndr"><span class="annot"><span class="annottext">dsRuleBndr :: forall (q :: * -&gt; *). DsMonad q =&gt; RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var hs-var">dsRuleBndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleVar</span></span><span> </span><span id="local-6989586621679509840"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509840"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleVar"><span class="hs-identifier hs-var">DRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509840"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1125"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypedRuleVar</span></span><span> </span><span id="local-6989586621679509837"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509837"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509836"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypedRuleVar"><span class="hs-identifier hs-var">DTypedRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509837"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509836"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1129"></span><span class="hs-comment">--</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- This requires a 'Name' as an argument since 'TySynEqn's did not have</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- this information prior to GHC 8.8.</span><span>
</span><span id="line-1132"></span><span id="local-6989586621679512153"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-type">dsTySynEqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512153"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512153"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span></span><span>
</span><span id="line-1133"></span><span id="dsTySynEqn"><span class="annot"><span class="annottext">dsTySynEqn :: forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var hs-var">dsTySynEqn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span id="local-6989586621679509818"><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679509818"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679509817"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509817"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679509816"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509816"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1134"></span><span>  </span><span class="annot"><span class="annottext">Maybe [DTyVarBndrUnit] -&gt; DKind -&gt; DKind -&gt; DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-var">DTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndrUnit]
</span><a href="#local-6989586621679509818"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509817"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509816"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1137"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTySynEqn</span><span>
</span><span id="line-1138"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-identifier">lhss</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1139"></span><span>  </span><span class="hs-identifier">lhss'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">lhss</span><span>
</span><span id="line-1140"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">applyDType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">DTANormal</span><span> </span><span class="hs-identifier">lhss'</span><span>
</span><span id="line-1141"></span><span>  </span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- | Desugar clauses to a function definition</span><span>
</span><span id="line-1145"></span><span id="local-6989586621679512120"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-type">dsClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512120"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1146"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>         </span><span class="hs-comment">-- ^ Name of the function</span><span>
</span><span id="line-1147"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Clauses to desugar</span><span>
</span><span id="line-1148"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512120"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1149"></span><span id="dsClauses"><span class="annot"><span class="annottext">dsClauses :: forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var hs-var">dsClauses</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679509787"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509787"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679509785"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509785"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679509784"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509784"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679509783"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679509783"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679509782"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679509782"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1151"></span><span>  </span><span class="hs-comment">-- this case is necessary to maintain the roundtrip property.</span><span>
</span><span id="line-1152"></span><span>  </span><span id="local-6989586621679509781"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679509781"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509787"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679509782"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1153"></span><span>  </span><span id="local-6989586621679509780"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509780"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509784"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1154"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679509779"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679509779"><span class="hs-identifier hs-var">where_decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509778"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679509778"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679509783"><span class="hs-identifier hs-var">where_decs</span></a></span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509777"><span class="annot"><span class="annottext">exp_with_wheres :: DExp
</span><a href="#local-6989586621679509777"><span class="hs-identifier hs-var hs-var">exp_with_wheres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679509779"><span class="hs-identifier hs-var">where_decs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679509778"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509780"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1156"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679509776"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509776"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509775"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509775"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509785"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509777"><span class="hs-identifier hs-var">exp_with_wheres</span></a></span><span>
</span><span id="line-1157"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509776"><span class="hs-identifier hs-var">pats'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509775"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679509781"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1158"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679509773"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509773"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509772"><span class="annot"><span class="annottext">clauses :: [Clause]
</span><a href="#local-6989586621679509772"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679509771"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509771"><span class="hs-identifier hs-var">outer_pats</span></a></span></span><span> </span><span class="annot"><span class="annottext">Body
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1159"></span><span>  </span><span id="local-6989586621679509770"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509770"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509771"><span class="hs-identifier hs-var">outer_pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509769"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679509769"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509770"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span>  </span><span id="local-6989586621679509768"><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679509768"><span class="hs-identifier hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509770"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1162"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509769"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldrM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679509766"><span class="hs-identifier hs-var">clause_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509769"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679509772"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679509768"><span class="hs-identifier hs-var">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1164"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1165"></span><span>    </span><span id="local-6989586621679512066"><span class="annot"><a href="#local-6989586621679509766"><span class="hs-identifier hs-type">clause_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512066"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512066"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1166"></span><span>    </span><span id="local-6989586621679509766"><span class="annot"><span class="annottext">clause_to_dmatch :: forall (q :: * -&gt; *).
DsMonad q =&gt;
DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679509766"><span class="hs-identifier hs-var hs-var">clause_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679509746"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509746"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679509745"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509745"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679509744"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679509744"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679509743"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679509743"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679509742"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679509742"><span class="hs-identifier hs-var">failure_matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1167"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509740"><span class="annot"><span class="annottext">failure_exp :: DExp
</span><a href="#local-6989586621679509740"><span class="hs-identifier hs-var hs-var">failure_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns in &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509773"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>                                    </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509746"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679509742"><span class="hs-identifier hs-var">failure_matches</span></a></span><span>
</span><span id="line-1169"></span><span>      </span><span id="local-6989586621679509739"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509739"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679509744"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679509743"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509740"><span class="hs-identifier hs-var">failure_exp</span></a></span><span>
</span><span id="line-1170"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679509738"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509738"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509737"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509737"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679509745"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509739"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1171"></span><span>      </span><span id="local-6989586621679509736"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679509736"><span class="hs-identifier hs-var">uni_pats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509738"><span class="hs-identifier hs-var">pats'</span></a></span><span>
</span><span id="line-1172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509733"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679509733"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509738"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509737"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-1173"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679509736"><span class="hs-identifier hs-var">uni_pats</span></a></span><span>
</span><span id="line-1174"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679509733"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1175"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679509733"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679509742"><span class="hs-identifier hs-var">failure_matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1176"></span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- | Desugar a type</span><span>
</span><span id="line-1178"></span><span id="local-6989586621679512317"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-type">dsType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512317"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512317"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 900
</span><span class="hs-comment">-- See Note [Gracefully handling linear types]</span><span>
</span><span id="line-1181"></span><span id="dsType"><span class="annot"><span class="annottext">dsType :: forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var hs-var">dsType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">MulArrowT</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>
</span><span id="line-1182"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">MulArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar exotic uses of linear types.&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679509669"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509669"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509668"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509668"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621679509667"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509667"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1185"></span><span>  </span><span class="annot"><span class="annottext">DForallTelescope -&gt; [DKind] -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var">mkDForallConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndrSpec] -&gt; DForallTelescope
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-var">DForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndr Specificity -&gt; q DTyVarBndrSpec
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbSpec"><span class="hs-identifier hs-var">dsTvbSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509669"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>                        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509668"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509667"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679509664"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509664"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679509663"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509663"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509664"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509663"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1188"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679509661"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509661"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679509660"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509660"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509661"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509660"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1189"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679509657"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509657"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509657"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1190"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679509655"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509655"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509655"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1191"></span><span>  </span><span class="hs-comment">-- the only difference between ConT and PromotedT is the name lookup. Here, we assume</span><span>
</span><span id="line-1192"></span><span>  </span><span class="hs-comment">-- that the TH quote mechanism figured out the right name. Note that lookupDataName name</span><span>
</span><span id="line-1193"></span><span>  </span><span class="hs-comment">-- does not necessarily work, because `name` has its original module attached, which</span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-comment">-- may not be in scope.</span><span>
</span><span id="line-1195"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679509653"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509653"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509653"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1196"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679509651"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509651"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509651"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1197"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span id="local-6989586621679509648"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509648"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509648"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>
</span><span id="line-1199"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1200"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span id="local-6989586621679509644"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509644"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509644"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1201"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1202"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span>
</span><span id="line-1204"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Constraint</span><span>
</span><span id="line-1205"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span id="local-6989586621679509637"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679509637"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679509637"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">~</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679509634"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509634"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679509633"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509633"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509632"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509633"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509634"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509632"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1211"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1212"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679509629"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509629"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509629"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1213"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span id="local-6989586621679509625"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509625"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679509625"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679509622"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509622"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679509621"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509621"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509622"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509621"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1220"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679509618"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509618"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509617"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509617"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1221"></span><span>  </span><span id="local-6989586621679509616"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509616"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509617"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1222"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509618"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509616"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span id="local-6989586621679509614"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679509614"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509613"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509613"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1226"></span><span>  </span><span class="annot"><span class="annottext">DForallTelescope -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndrUnit] -&gt; DForallTelescope
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallVis"><span class="hs-identifier hs-var">DForallVis</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var">dsTvbUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679509614"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509613"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 900
</span><span class="hs-comment">-- | Desugar a 'TyVarBndr'.</span><span>
</span><span id="line-1231"></span><span id="local-6989586621679512060"><span id="local-6989586621679512061"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-type">dsTvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512061"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr_</span></span><span> </span><span class="annot"><a href="#local-6989586621679512060"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512061"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512060"><span class="hs-identifier hs-type">flag</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1232"></span><span id="dsTvb"><span class="annot"><span class="annottext">dsTvb :: forall (q :: * -&gt; *) flag.
DsMonad q =&gt;
TyVarBndr_ flag -&gt; q (DTyVarBndr flag)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var hs-var">dsTvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span id="local-6989586621679509600"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509600"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509599"><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679509599"><span class="hs-identifier hs-var">flag</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; DTyVarBndr flag
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509600"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679509599"><span class="hs-identifier hs-var">flag</span></a></span><span>
</span><span id="line-1233"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span id="local-6989586621679509596"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509596"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509595"><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679509595"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621679509594"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509594"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; DKind -&gt; DTyVarBndr flag
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509596"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">flag
</span><a href="#local-6989586621679509595"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509594"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a 'TyVarBndr' with a particular @flag@.</span><span>
</span><span id="line-1236"></span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">flag</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">TyVarBndr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTyVarBndr</span><span> </span><span class="hs-identifier">flag</span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">flag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlainTV</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DPlainTV</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">flag</span><span>
</span><span id="line-1238"></span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">flag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">KindedTV</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DKindedTV</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">flag</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">k</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1241"></span><span class="hs-comment">{-
Note [Gracefully handling linear types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Per the README, th-desugar does not currently support linear types.
Unfortunately, we cannot simply reject all occurrences of
multiplicity-polymorphic function arrows (i.e., MulArrowT), as it is possible
for &quot;non-linear&quot; code to contain them when reified. For example, the type of a
Haskell98 data constructor such as `Just` will be reified as

  a #-&gt; Maybe a

In terms of the TH AST, that is:

  MulArrowT `AppT` PromotedConT 'One `AppT` VarT a `AppT` (ConT ''Maybe `AppT` VarT a)

Therefore, in order to desugar these sorts of types, we have to do *something*
with MulArrowT. The approach that th-desugar takes is to pretend that all
multiplicity-polymorphic function arrows are actually ordinary function arrows
(-&gt;) when desugaring types. In other words, whenever th-desugar sees
(MulArrowT `AppT` m), for any particular value of `m`, it will turn it into
DArrowT.

This approach is enough to gracefully handle most uses of MulArrowT, as TH
reification always generates MulArrowT applied to some particular multiplicity
(as of GHC 9.0, at least). It's conceivable that some wily user could manually
construct a TH AST containing MulArrowT in a different position, but since this
situation is rare, we simply throw an error in such cases.

We adopt a similar stance in L.H.TH.Desugar.Reify when locally reifying the
types of data constructors: since th-desugar doesn't currently support linear
types, we pretend as if MulArrowT does not exist. As a result, the type of
`Just` would be locally reified as `a -&gt; Maybe a`, not `a #-&gt; Maybe a`.
-}</span><span>
</span><span id="line-1274"></span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- | Desugar a 'TyVarBndrSpec'.</span><span>
</span><span id="line-1276"></span><span id="local-6989586621679512091"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbSpec"><span class="hs-identifier hs-type">dsTvbSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512091"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrSpec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512091"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrSpec"><span class="hs-identifier hs-type">DTyVarBndrSpec</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 900
</span><span id="dsTvbSpec"><span class="annot"><span class="annottext">dsTvbSpec :: forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndr Specificity -&gt; q DTyVarBndrSpec
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbSpec"><span class="hs-identifier hs-var hs-var">dsTvbSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) flag.
DsMonad q =&gt;
TyVarBndr_ flag -&gt; q (DTyVarBndr flag)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsTvbSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">SpecifiedSpec</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1283"></span><span class="hs-comment">-- | Desugar a 'TyVarBndrUnit'.</span><span>
</span><span id="line-1284"></span><span id="local-6989586621679512165"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-type">dsTvbUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512165"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512165"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 900
</span><span id="dsTvbUnit"><span class="annot"><span class="annottext">dsTvbUnit :: forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndrUnit -&gt; q DTyVarBndrUnit
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbUnit"><span class="hs-identifier hs-var hs-var">dsTvbUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) flag.
DsMonad q =&gt;
TyVarBndr_ flag -&gt; q (DTyVarBndr flag)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsTvbUnit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- | Desugar a @Cxt@</span><span>
</span><span id="line-1292"></span><span id="local-6989586621679512164"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-type">dsCxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512164"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512164"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span>
</span><span id="line-1293"></span><span id="dsCxt"><span class="annot"><span class="annottext">dsCxt :: forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var hs-var">dsCxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | A backwards-compatible type synonym for the thing representing a single</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- derived class in a @deriving@ clause. (This is a @DerivClause@, @Pred@, or</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- @Name@ depending on the GHC version.)</span><span>
</span><span id="line-1299"></span><span class="hs-keyword">type</span><span> </span><span id="DerivingClause"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-var">DerivingClause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span class="hs-comment">-- | Desugar a @DerivingClause@.</span><span>
</span><span id="line-1302"></span><span id="local-6989586621679512139"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-type">dsDerivClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512139"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512139"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span></span><span>
</span><span id="line-1303"></span><span id="dsDerivClause"><span class="annot"><span class="annottext">dsDerivClause :: forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var hs-var">dsDerivClause</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span> </span><span id="local-6989586621679509568"><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679509568"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679509567"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509567"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1304"></span><span>  </span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; [DKind] -&gt; DDerivClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-var">DDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679509568"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509567"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 711
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pred</span><span>
</span><span id="line-1307"></span><span>
</span><span id="line-1308"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1309"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-identifier">p</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Name</span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1314"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @DerivStrategy@.</span><span>
</span><span id="line-1319"></span><span id="local-6989586621679512144"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-type">dsDerivStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512144"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivStrategy</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512144"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span></span><span>
</span><span id="line-1320"></span><span id="dsDerivStrategy"><span class="annot"><span class="annottext">dsDerivStrategy :: forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var hs-var">dsDerivStrategy</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">StockStrategy</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStockStrategy"><span class="hs-identifier hs-var">DStockStrategy</span></a></span><span>
</span><span id="line-1321"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">AnyclassStrategy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnyclassStrategy"><span class="hs-identifier hs-var">DAnyclassStrategy</span></a></span><span>
</span><span id="line-1322"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">NewtypeStrategy</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNewtypeStrategy"><span class="hs-identifier hs-var">DNewtypeStrategy</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViaStrategy</span></span><span> </span><span id="local-6989586621679509548"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509548"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DViaStrategy"><span class="hs-identifier hs-var">DViaStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509548"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @PatSynDir@. (Available only with GHC 8.2+)</span><span>
</span><span id="line-1330"></span><span id="local-6989586621679512147"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-type">dsPatSynDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512147"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynDir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512147"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynDir"><span class="hs-identifier hs-type">DPatSynDir</span></a></span></span><span>
</span><span id="line-1331"></span><span id="dsPatSynDir"><span class="annot"><span class="annottext">dsPatSynDir :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var hs-var">dsPatSynDir</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">Unidir</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DUnidir"><span class="hs-identifier hs-var">DUnidir</span></a></span><span>
</span><span id="line-1332"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">ImplBidir</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImplBidir"><span class="hs-identifier hs-var">DImplBidir</span></a></span><span>
</span><span id="line-1333"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span id="local-6989586621679509533"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509533"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExplBidir</span></span><span> </span><span id="local-6989586621679509531"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679509531"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DClause] -&gt; DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExplBidir"><span class="hs-identifier hs-var">DExplBidir</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509533"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679509531"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1336"></span><span class="hs-comment">-- | Desugar a @Pred@, flattening any internal tuples</span><span>
</span><span id="line-1337"></span><span id="local-6989586621679512052"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-type">dsPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512052"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512052"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1340"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">tys</span><span>
</span><span id="line-1341"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span>
</span><span id="line-1342"></span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1343"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">]</span><span>
</span><span id="line-1344"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">~</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span id="dsPred"><span class="annot"><span class="annottext">dsPred :: forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var hs-var">dsPred</span></a></span></span><span> </span><span id="local-6989586621679509462"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509462"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1347"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679509461"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509461"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [Type]
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-var">splitTuple_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509462"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1348"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509461"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1349"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679509459"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509459"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509458"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509458"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679509457"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509457"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-var">dsForallPred</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509459"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509458"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509457"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1350"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679509455"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509455"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679509454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509454"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1351"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679509453"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509453"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509455"><span class="hs-identifier hs-var">t1</span></a></span><span>   </span><span class="hs-comment">-- tuples can't be applied!</span><span>
</span><span id="line-1352"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509453"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509454"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1353"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679509452"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509452"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679509451"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509451"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1354"></span><span>  </span><span id="local-6989586621679509450"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509450"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509452"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1355"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509450"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1356"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679509449"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509449"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509449"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509451"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1357"></span><span>    </span><span id="local-6989586621679509448"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509448"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509448"><span class="hs-identifier hs-var">other</span></a></span><span>   </span><span class="hs-comment">-- just drop the kind signature on a tuple.</span><span>
</span><span id="line-1358"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679509447"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509447"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509447"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1359"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679509446"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509446"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509446"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1360"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679509445"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679509445"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1361"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted type seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509445"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1362"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1363"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1364"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar in detecting tuple constraints.&quot;</span></span><span>
</span><span id="line-1365"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679509444"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679509444"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1366"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unboxed tuple seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509444"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1367"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arrow seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1368"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1369"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1370"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted tuple seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1371"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted nil seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1372"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted cons seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1373"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;* seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1374"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1375"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The kind `Constraint' seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1376"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679509443"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679509443"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1377"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type literal seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509443"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1378"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">~</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679509442"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509442"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679509441"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509441"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509440"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509440"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509441"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509442"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509440"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1381"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1382"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679509439"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509439"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509439"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1383"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679509438"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679509438"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1387"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unboxed sum seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509438"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679509437"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509437"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679509436"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509436"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679509435"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509435"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509437"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1392"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509436"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679509434"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509434"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679509433"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509433"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1394"></span><span>  </span><span id="local-6989586621679509432"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509432"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509433"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1395"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679509434"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509432"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679509431"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679509431"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1399"></span><span>  </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Visible dependent quantifier seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509431"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 900
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">MulArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linear arrow seen as head of constraint.&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1405"></span><span class="hs-comment">-- | Desugar a quantified constraint.</span><span>
</span><span id="line-1406"></span><span id="local-6989586621679512046"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-type">dsForallPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512046"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrSpec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512046"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span>
</span><span id="line-1407"></span><span id="dsForallPred"><span class="annot"><span class="annottext">dsForallPred :: forall (q :: * -&gt; *).
DsMonad q =&gt;
[TyVarBndr Specificity] -&gt; [Type] -&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-var hs-var">dsForallPred</span></a></span></span><span> </span><span id="local-6989586621679509412"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509412"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509411"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509411"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679509410"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509410"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1408"></span><span>  </span><span id="local-6989586621679509409"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509409"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509410"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1409"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509409"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1410"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679509408"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509408"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForallTelescope -&gt; [DKind] -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var">mkDForallConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1411"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndrSpec] -&gt; DForallTelescope
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-var">DForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
TyVarBndr Specificity -&gt; q DTyVarBndrSpec
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvbSpec"><span class="hs-identifier hs-var">dsTvbSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679509412"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; [Type] -&gt; q [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679509411"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509408"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span>    </span><span class="annot"><span class="annottext">[DKind]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar constraint tuples in the body of a quantified constraint&quot;</span></span><span>
</span><span id="line-1413"></span><span>              </span><span class="hs-comment">-- See GHC #15334.</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1416"></span><span class="hs-comment">-- | Like 'reify', but safer and desugared. Uses local declarations where</span><span>
</span><span id="line-1417"></span><span class="hs-comment">-- available.</span><span>
</span><span id="line-1418"></span><span id="local-6989586621679512044"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-type">dsReify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512044"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512044"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1419"></span><span id="dsReify"><span class="annot"><span class="annottext">dsReify :: forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe DInfo)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-var hs-var">dsReify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a></span><span>
</span><span id="line-1420"></span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- | Like 'reifyType', but safer and desugared. Uses local declarations where</span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- available.</span><span>
</span><span id="line-1423"></span><span id="local-6989586621679512034"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsReifyType"><span class="hs-identifier hs-type">dsReifyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512034"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512034"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1424"></span><span id="dsReifyType"><span class="annot"><span class="annottext">dsReifyType :: forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe DKind)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsReifyType"><span class="hs-identifier hs-var hs-var">dsReifyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Type)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyTypeWithLocals_maybe"><span class="hs-identifier hs-var">reifyTypeWithLocals_maybe</span></a></span><span>
</span><span id="line-1425"></span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- Given a list of `forall`ed type variable binders and a context, construct</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- a DType using DForallT and DConstrainedT as appropriate. The phrase</span><span>
</span><span id="line-1428"></span><span class="hs-comment">-- &quot;as appropriate&quot; is used because DConstrainedT will not be used if the</span><span>
</span><span id="line-1429"></span><span class="hs-comment">-- context is empty, per Note [Desugaring and sweetening ForallT].</span><span>
</span><span id="line-1430"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-type">mkDForallConstrainedT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallTelescope"><span class="hs-identifier hs-type">DForallTelescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1431"></span><span id="mkDForallConstrainedT"><span class="annot"><span class="annottext">mkDForallConstrainedT :: DForallTelescope -&gt; [DKind] -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var hs-var">mkDForallConstrainedT</span></a></span></span><span> </span><span id="local-6989586621679509383"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509383"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679509382"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509382"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679509381"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509381"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1432"></span><span>  </span><span class="annot"><span class="annottext">DForallTelescope -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509383"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509382"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509381"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[DKind] -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-var">DConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509382"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509381"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1433"></span><span>
</span><span id="line-1434"></span><span class="hs-comment">-- create a list of expressions in the same order as the fields in the first argument</span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- but with the values as given in the second argument</span><span>
</span><span id="line-1436"></span><span class="hs-comment">-- if a field is missing from the second argument, use the corresponding expression</span><span>
</span><span id="line-1437"></span><span class="hs-comment">-- from the third argument</span><span>
</span><span id="line-1438"></span><span id="local-6989586621679512308"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-type">reorderFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512308"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldExp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512308"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1439"></span><span id="reorderFields"><span class="annot"><span class="annottext">reorderFields :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var hs-var">reorderFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span>
</span><span id="line-1440"></span><span>
</span><span id="line-1441"></span><span id="local-6989586621679512187"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-type">reorderFieldsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512187"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldPat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512187"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1442"></span><span id="reorderFieldsPat"><span class="annot"><span class="annottext">reorderFieldsPat :: forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var hs-var">reorderFieldsPat</span></a></span></span><span> </span><span id="local-6989586621679509362"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509362"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679509361"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509361"><span class="hs-identifier hs-var">field_decs</span></a></span></span><span> </span><span id="local-6989586621679509360"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679509360"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1443"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509362"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509361"><span class="hs-identifier hs-var">field_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679509360"><span class="hs-identifier hs-var">field_pats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span id="local-6989586621679512028"><span id="local-6989586621679512029"><span id="local-6989586621679512030"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-type">reorderFields'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679512030"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679512030"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1446"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679512029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512028"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1447"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-comment">-- ^ The name of the constructor (used for error reporting)</span><span>
</span><span id="line-1448"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679512029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1449"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679512028"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679512028"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-1450"></span><span id="reorderFields%27"><span class="annot"><span class="annottext">reorderFields' :: forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var hs-var">reorderFields'</span></a></span></span><span> </span><span id="local-6989586621679509354"><span class="annot"><span class="annottext">a -&gt; m da
</span><a href="#local-6989586621679509354"><span class="hs-identifier hs-var">ds_thing</span></a></span></span><span> </span><span id="local-6989586621679509353"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509353"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679509352"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509352"><span class="hs-identifier hs-var">field_names_types</span></a></span></span><span> </span><span id="local-6989586621679509351"><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679509351"><span class="hs-identifier hs-var">field_things</span></a></span></span><span> </span><span id="local-6989586621679509350"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509350"><span class="hs-identifier hs-var">deflts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1451"></span><span>  </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679509349"><span class="hs-identifier hs-var">check_valid_fields</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679509348"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509347"><span class="hs-identifier hs-var">field_names</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509350"><span class="hs-identifier hs-var">deflts</span></a></span><span>
</span><span id="line-1452"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1453"></span><span>    </span><span id="local-6989586621679509347"><span class="annot"><span class="annottext">field_names :: [Name]
</span><a href="#local-6989586621679509347"><span class="hs-identifier hs-var hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679509346"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509346"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bang
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509346"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679509352"><span class="hs-identifier hs-var">field_names_types</span></a></span><span>
</span><span id="line-1454"></span><span>
</span><span id="line-1455"></span><span>    </span><span id="local-6989586621679509349"><span class="annot"><span class="annottext">check_valid_fields :: m ()
</span><a href="#local-6989586621679509349"><span class="hs-identifier hs-var hs-var">check_valid_fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1456"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679509351"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679509339"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509339"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1457"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509339"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509347"><span class="hs-identifier hs-var">field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1458"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509353"><span class="hs-identifier hs-var">con_name</span></a></span><span>   </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; does not have field &#8216;&quot;</span></span><span>
</span><span id="line-1459"></span><span>                                 </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509339"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216;&quot;</span></span><span>
</span><span id="line-1460"></span><span>
</span><span id="line-1461"></span><span>    </span><span id="local-6989586621679509348"><span class="annot"><span class="annottext">reorder :: [Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679509348"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[da]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1462"></span><span>    </span><span class="annot"><a href="#local-6989586621679509348"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509330"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509330"><span class="hs-identifier hs-var">field_name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679509329"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509329"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509328"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679509328"><span class="hs-identifier hs-var">deflt</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679509327"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509327"><span class="hs-identifier hs-var">rest_deflt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1463"></span><span>      </span><span id="local-6989586621679509326"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509326"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679509348"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509329"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509327"><span class="hs-identifier hs-var">rest_deflt</span></a></span><span>
</span><span id="line-1464"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679509324"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509324"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509324"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509330"><span class="hs-identifier hs-var">field_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679509351"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1465"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509323"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679509323"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509326"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m da
</span><a href="#local-6989586621679509354"><span class="hs-identifier hs-var">ds_thing</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679509323"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1466"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Name, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679509328"><span class="hs-identifier hs-var">deflt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679509326"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1467"></span><span>    </span><span class="annot"><a href="#local-6989586621679509348"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar.&quot;</span></span><span>
</span><span id="line-1468"></span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- | Make a tuple 'DExp' from a list of 'DExp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1470"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-type">mkTupleDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1471"></span><span id="mkTupleDExp"><span class="annot"><span class="annottext">mkTupleDExp :: [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var hs-var">mkTupleDExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679509322"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509322"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679509322"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1472"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span id="local-6989586621679509321"><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679509321"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679509321"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679509321"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1473"></span><span>
</span><span id="line-1474"></span><span class="hs-comment">-- | Make a tuple 'Exp' from a list of 'Exp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1475"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-type">mkTupleExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1476"></span><span id="mkTupleExp"><span class="annot"><span class="annottext">mkTupleExp :: [Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var hs-var">mkTupleExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679509320"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509320"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679509320"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1477"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span id="local-6989586621679509319"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679509319"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679509319"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679509319"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1478"></span><span>
</span><span id="line-1479"></span><span class="hs-comment">-- | Make a tuple 'DPat' from a list of 'DPat's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1480"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-type">mkTupleDPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span>
</span><span id="line-1481"></span><span id="mkTupleDPat"><span class="annot"><span class="annottext">mkTupleDPat :: [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var hs-var">mkTupleDPat</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679509318"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509318"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509318"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1482"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span id="local-6989586621679509317"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509317"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DKind] -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509317"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509317"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1483"></span><span>
</span><span id="line-1484"></span><span class="hs-comment">-- | Is this pattern guaranteed to match?</span><span>
</span><span id="line-1485"></span><span id="local-6989586621679512244"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-type">isUniversalPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512244"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512244"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1486"></span><span id="isUniversalPattern"><span class="annot"><span class="annottext">isUniversalPattern :: forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var hs-var">isUniversalPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1487"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1488"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679509292"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509292"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679509291"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509291"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1489"></span><span>  </span><span id="local-6989586621679509290"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509290"><span class="hs-identifier hs-var">data_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509292"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-1490"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679509288"><span class="annot"><span class="annottext">[TyVarBndrUnit]
</span><a href="#local-6989586621679509288"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509287"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679509287"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndrUnit], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509290"><span class="hs-identifier hs-var">data_name</span></a></span><span>
</span><span id="line-1491"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679509287"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1492"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679509291"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1493"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1494"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1495"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679509286"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509286"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509286"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1496"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679509285"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509285"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679509285"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1497"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span class="hs-comment">-- | Apply one 'DExp' to a list of arguments</span><span>
</span><span id="line-1500"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-type">applyDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1501"></span><span id="applyDExp"><span class="annot"><span class="annottext">applyDExp :: DExp -&gt; [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-var hs-var">applyDExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span class="hs-comment">-- | Apply one 'DType' to a list of arguments</span><span>
</span><span id="line-1504"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-type">applyDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1505"></span><span id="applyDType"><span class="annot"><span class="annottext">applyDType :: DKind -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var hs-var">applyDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg -&gt; DKind
</span><a href="#local-6989586621679509283"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1507"></span><span>    </span><span class="annot"><a href="#local-6989586621679509283"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1508"></span><span>    </span><span id="local-6989586621679509283"><span class="annot"><span class="annottext">apply :: DKind -&gt; DTypeArg -&gt; DKind
</span><a href="#local-6989586621679509283"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679509282"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509282"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679509280"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509280"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509282"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509280"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1509"></span><span>    </span><span class="annot"><a href="#local-6989586621679509283"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span id="local-6989586621679509279"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509279"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679509277"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509277"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509279"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-operator hs-var">`DAppKindT`</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509277"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1510"></span><span>
</span><span id="line-1511"></span><span class="hs-comment">-- | An argument to a type, either a normal type ('DTANormal') or a visible</span><span>
</span><span id="line-1512"></span><span class="hs-comment">-- kind application ('DTyArg').</span><span>
</span><span id="line-1513"></span><span class="hs-comment">--</span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- 'DTypeArg' does not appear directly in the @th-desugar@ AST, but it is</span><span>
</span><span id="line-1515"></span><span class="hs-comment">-- useful when decomposing an application of a 'DType' to its arguments.</span><span>
</span><span id="line-1516"></span><span id="local-6989586621679509275"><span id="local-6989586621679509276"></span></span><span class="hs-keyword">data</span><span> </span><span id="DTypeArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-var">DTypeArg</span></a></span></span><span>
</span><span id="line-1517"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DTANormal"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DTyArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1519"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509268"><span id="local-6989586621679509273"><span class="annot"><span class="annottext">DTypeArg -&gt; DTypeArg -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
== :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c== :: DTypeArg -&gt; DTypeArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509255"><span id="local-6989586621679509257"><span id="local-6989586621679509265"><span class="annot"><span class="annottext">Int -&gt; DTypeArg -&gt; ShowS
[DTypeArg] -&gt; ShowS
DTypeArg -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DTypeArg] -&gt; ShowS
$cshowList :: [DTypeArg] -&gt; ShowS
show :: DTypeArg -&gt; String
$cshow :: DTypeArg -&gt; String
showsPrec :: Int -&gt; DTypeArg -&gt; ShowS
$cshowsPrec :: Int -&gt; DTypeArg -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509219"><span id="local-6989586621679509221"><span id="local-6989586621679509223"><span id="local-6989586621679509225"><span id="local-6989586621679509227"><span id="local-6989586621679509229"><span id="local-6989586621679509231"><span id="local-6989586621679509233"><span id="local-6989586621679509235"><span id="local-6989586621679509237"><span id="local-6989586621679509239"><span id="local-6989586621679509241"><span id="local-6989586621679509245"><span id="local-6989586621679509250"><span class="annot"><span class="annottext">Typeable DTypeArg
DTypeArg -&gt; DataType
DTypeArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
dataTypeOf :: DTypeArg -&gt; DataType
$cdataTypeOf :: DTypeArg -&gt; DataType
toConstr :: DTypeArg -&gt; Constr
$ctoConstr :: DTypeArg -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep DTypeArg x -&gt; DTypeArg
forall x. DTypeArg -&gt; Rep DTypeArg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DTypeArg x -&gt; DTypeArg
$cfrom :: forall x. DTypeArg -&gt; Rep DTypeArg x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- | Desugar a 'TypeArg'.</span><span>
</span><span id="line-1522"></span><span id="local-6989586621679512137"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-type">dsTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512137"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679512137"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span></span><span>
</span><span id="line-1523"></span><span id="dsTypeArg"><span class="annot"><span class="annottext">dsTypeArg :: forall (q :: * -&gt; *). DsMonad q =&gt; TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var hs-var">dsTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679509203"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509203"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509203"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1524"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679509201"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509201"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679509201"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- | Filter the normal type arguments from a list of 'DTypeArg's.</span><span>
</span><span id="line-1527"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-type">filterDTANormals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1528"></span><span id="filterDTANormals"><span class="annot"><span class="annottext">filterDTANormals :: [DTypeArg] -&gt; [DKind]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-var hs-var">filterDTANormals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; Maybe DKind
</span><a href="#local-6989586621679509199"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span>
</span><span id="line-1529"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1530"></span><span>    </span><span class="annot"><a href="#local-6989586621679509199"><span class="hs-identifier hs-type">getDTANormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1531"></span><span>    </span><span id="local-6989586621679509199"><span class="annot"><span class="annottext">getDTANormal :: DTypeArg -&gt; Maybe DKind
</span><a href="#local-6989586621679509199"><span class="hs-identifier hs-var hs-var">getDTANormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679509198"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509198"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509198"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1532"></span><span>    </span><span class="annot"><a href="#local-6989586621679509199"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- | Convert a 'DTyVarBndr' into a 'DType'</span><span>
</span><span id="line-1535"></span><span id="local-6989586621679511974"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-type">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679511974"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span></span><span>
</span><span id="line-1536"></span><span id="dTyVarBndrToDType"><span class="annot"><span class="annottext">dTyVarBndrToDType :: forall flag. DTyVarBndr flag -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var hs-var">dTyVarBndrToDType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679509196"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509196"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509196"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1537"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679509195"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509195"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679509194"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509194"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509195"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-operator hs-var">`DSigT`</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509194"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- | Extract the underlying 'DType' or 'DKind' from a 'DTypeArg'. This forgets</span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- information about whether a type is a normal argument or not, so use with</span><span>
</span><span id="line-1541"></span><span class="hs-comment">-- caution.</span><span>
</span><span id="line-1542"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-type">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1543"></span><span id="probablyWrongUnDTypeArg"><span class="annot"><span class="annottext">probablyWrongUnDTypeArg :: DTypeArg -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var hs-var">probablyWrongUnDTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679509192"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509192"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509192"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1544"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679509191"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509191"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509191"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1545"></span><span>
</span><span id="line-1546"></span><span class="hs-comment">-- | Convert a 'Strict' to a 'Bang' in GHCs 7.x. This is just</span><span>
</span><span id="line-1547"></span><span class="hs-comment">-- the identity operation in GHC 8.x, which has no 'Strict'.</span><span>
</span><span id="line-1548"></span><span class="hs-comment">-- (This is included in GHC 8.x only for good Haddocking.)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bang</span><span>
</span><span id="line-1551"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">IsStrict</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">SourceStrict</span><span>
</span><span id="line-1552"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">NotStrict</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">NoSourceStrictness</span><span>
</span><span id="line-1553"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">Unpacked</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">SourceUnpack</span><span> </span><span class="hs-identifier">SourceStrict</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-type">strictToBang</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span>
</span><span id="line-1556"></span><span id="strictToBang"><span class="annot"><span class="annottext">strictToBang :: Bang -&gt; Bang
</span><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-var hs-var">strictToBang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- Take a data type name (which does not belong to a data family) and</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- apply it to its type variable binders to form a DType.</span><span>
</span><span id="line-1561"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-type">nonFamilyDataReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1562"></span><span id="nonFamilyDataReturnType"><span class="annot"><span class="annottext">nonFamilyDataReturnType :: Name -&gt; [DTyVarBndrUnit] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var hs-var">nonFamilyDataReturnType</span></a></span></span><span> </span><span id="local-6989586621679509189"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509189"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1563"></span><span>  </span><span class="annot"><span class="annottext">DKind -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509189"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span class="hs-comment">-- Take a data family name and apply it to its argument types to form a</span><span>
</span><span id="line-1566"></span><span class="hs-comment">-- data family instance DType.</span><span>
</span><span id="line-1567"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-type">dataFamInstReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1568"></span><span id="dataFamInstReturnType"><span class="annot"><span class="annottext">dataFamInstReturnType :: Name -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var hs-var">dataFamInstReturnType</span></a></span></span><span> </span><span id="local-6989586621679509188"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509188"><span class="hs-identifier hs-var">fam_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; [DTypeArg] -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509188"><span class="hs-identifier hs-var">fam_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1569"></span><span>
</span><span id="line-1570"></span><span class="hs-comment">-- Data family instance declarations did not come equipped with a list of bound</span><span>
</span><span id="line-1571"></span><span class="hs-comment">-- type variables until GHC 8.8 (and even then, it's optional whether the user</span><span>
</span><span id="line-1572"></span><span class="hs-comment">-- provides them or not). This means that there are situations where we must</span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- reverse engineer this information ourselves from the list of type</span><span>
</span><span id="line-1574"></span><span class="hs-comment">-- arguments. We accomplish this by taking the free variables of the types</span><span>
</span><span id="line-1575"></span><span class="hs-comment">-- and performing a reverse topological sort on them to ensure that the</span><span>
</span><span id="line-1576"></span><span class="hs-comment">-- returned list is well scoped.</span><span>
</span><span id="line-1577"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-type">dataFamInstTvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1578"></span><span id="dataFamInstTvbs"><span class="annot"><span class="annottext">dataFamInstTvbs :: [DTypeArg] -&gt; [DTyVarBndrUnit]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var hs-var">dataFamInstTvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DKind] -&gt; [DTyVarBndrUnit]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- | Take a list of 'DType's, find their free variables, and sort them in</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- reverse topological order to ensure that they are well scoped. In other</span><span>
</span><span id="line-1582"></span><span class="hs-comment">-- words, the free variables are ordered such that:</span><span>
</span><span id="line-1583"></span><span class="hs-comment">--</span><span>
</span><span id="line-1584"></span><span class="hs-comment">-- 1. Whenever an explicit kind signature of the form @(A :: K)@ is</span><span>
</span><span id="line-1585"></span><span class="hs-comment">--    encountered, the free variables of @K@ will always appear to the left of</span><span>
</span><span id="line-1586"></span><span class="hs-comment">--    the free variables of @A@ in the returned result.</span><span>
</span><span id="line-1587"></span><span class="hs-comment">--</span><span>
</span><span id="line-1588"></span><span class="hs-comment">-- 2. The constraint in (1) notwithstanding, free variables will appear in</span><span>
</span><span id="line-1589"></span><span class="hs-comment">--    left-to-right order of their original appearance.</span><span>
</span><span id="line-1590"></span><span class="hs-comment">--</span><span>
</span><span id="line-1591"></span><span class="hs-comment">-- On older GHCs, this takes measures to avoid returning explicitly bound</span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- kind variables, which was not possible before @TypeInType@.</span><span>
</span><span id="line-1593"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-type">toposortTyVarsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1594"></span><span id="toposortTyVarsOf"><span class="annot"><span class="annottext">toposortTyVarsOf :: [DKind] -&gt; [DTyVarBndrUnit]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var hs-var">toposortTyVarsOf</span></a></span></span><span> </span><span id="local-6989586621679509187"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509187"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1595"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679509186"><span class="hs-identifier hs-type">freeVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1596"></span><span>      </span><span id="local-6989586621679509186"><span class="annot"><span class="annottext">freeVars :: [Name]
</span><a href="#local-6989586621679509186"><span class="hs-identifier hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509187"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1597"></span><span>
</span><span id="line-1598"></span><span>      </span><span class="annot"><a href="#local-6989586621679509183"><span class="hs-identifier hs-type">varKindSigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1599"></span><span>      </span><span id="local-6989586621679509183"><span class="annot"><span class="annottext">varKindSigs :: Map Name DKind
</span><a href="#local-6989586621679509183"><span class="hs-identifier hs-var hs-var">varKindSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509187"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1600"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1601"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1602"></span><span>          </span><span id="local-6989586621679509182"><span class="annot"><span class="annottext">go_ty :: DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679509181"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509181"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679509180"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509180"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DForallTelescope -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509179"><span class="hs-identifier hs-var">go_tele</span></a></span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509181"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509180"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679509178"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509178"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679509177"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509177"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509178"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509177"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1604"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679509176"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509176"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679509175"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509175"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509176"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509175"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1605"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679509174"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509174"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679509173"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509173"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509174"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509173"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1606"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679509172"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509172"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679509171"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509171"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1607"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679509170"><span class="annot"><span class="annottext">kSigs :: Map Name DKind
</span><a href="#local-6989586621679509170"><span class="hs-identifier hs-var hs-var">kSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509171"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1608"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509172"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1609"></span><span>                 </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679509169"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509169"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509169"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509171"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509170"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1610"></span><span>                 </span><span class="annot"><span class="annottext">DKind
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509172"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509170"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1611"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1612"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1613"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1614"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1615"></span><span>          </span><span class="annot"><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1616"></span><span>
</span><span id="line-1617"></span><span>          </span><span class="annot"><a href="#local-6989586621679509179"><span class="hs-identifier hs-type">go_tele</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallTelescope"><span class="hs-identifier hs-type">DForallTelescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1618"></span><span>          </span><span id="local-6989586621679509179"><span class="annot"><span class="annottext">go_tele :: DForallTelescope -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509179"><span class="hs-identifier hs-var hs-var">go_tele</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallVis"><span class="hs-identifier hs-type">DForallVis</span></a></span><span>   </span><span id="local-6989586621679509167"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679509167"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall flag. [DTyVarBndr flag] -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509166"><span class="hs-identifier hs-var">go_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679509167"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1619"></span><span>          </span><span class="annot"><a href="#local-6989586621679509179"><span class="hs-identifier hs-var">go_tele</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span> </span><span id="local-6989586621679509165"><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509165"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall flag. [DTyVarBndr flag] -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509166"><span class="hs-identifier hs-var">go_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><a href="#local-6989586621679509165"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1620"></span><span>
</span><span id="line-1621"></span><span>          </span><span id="local-6989586621679511968"><span class="annot"><a href="#local-6989586621679509166"><span class="hs-identifier hs-type">go_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679511968"><span class="hs-identifier hs-type">flag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span></span><span>
</span><span id="line-1622"></span><span>          </span><span id="local-6989586621679509166"><span class="annot"><span class="annottext">go_tvbs :: forall flag. [DTyVarBndr flag] -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509166"><span class="hs-identifier hs-var hs-var">go_tvbs</span></a></span></span><span> </span><span id="local-6989586621679509163"><span class="annot"><span class="annottext">[DTyVarBndr flag]
</span><a href="#local-6989586621679509163"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679509162"><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509162"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">forall flag. DTyVarBndr flag -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509161"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509162"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr flag]
</span><a href="#local-6989586621679509163"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1623"></span><span>
</span><span id="line-1624"></span><span>          </span><span id="local-6989586621679511966"><span class="annot"><a href="#local-6989586621679509161"><span class="hs-identifier hs-type">go_tvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679511966"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span></span><span>
</span><span id="line-1625"></span><span>          </span><span id="local-6989586621679509161"><span class="annot"><span class="annottext">go_tvb :: forall flag. DTyVarBndr flag -&gt; Map Name DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509161"><span class="hs-identifier hs-var hs-var">go_tvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679509157"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509157"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679509156"><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509156"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509157"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509156"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1626"></span><span>          </span><span class="annot"><a href="#local-6989586621679509161"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679509154"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509154"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679509153"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509153"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679509152"><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509152"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509154"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509152"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; Map Name DKind
</span><a href="#local-6989586621679509182"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509153"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span>      </span><span class="hs-comment">-- | Do a topological sort on a list of tyvars,</span><span>
</span><span id="line-1629"></span><span>      </span><span class="hs-comment">--   so that binders occur before occurrences</span><span>
</span><span id="line-1630"></span><span>      </span><span class="hs-comment">-- E.g. given  [ a::k, k::*, b::k ]</span><span>
</span><span id="line-1631"></span><span>      </span><span class="hs-comment">-- it'll return a well-scoped list [ k::*, a::k, b::k ]</span><span>
</span><span id="line-1632"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1633"></span><span>      </span><span class="hs-comment">-- This is a deterministic sorting operation</span><span>
</span><span id="line-1634"></span><span>      </span><span class="hs-comment">-- (that is, doesn't depend on Uniques).</span><span>
</span><span id="line-1635"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1636"></span><span>      </span><span class="hs-comment">-- It is also meant to be stable: that is, variables should not</span><span>
</span><span id="line-1637"></span><span>      </span><span class="hs-comment">-- be reordered unnecessarily.</span><span>
</span><span id="line-1638"></span><span>      </span><span class="annot"><a href="#local-6989586621679509151"><span class="hs-identifier hs-type">scopedSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1639"></span><span>      </span><span id="local-6989586621679509151"><span class="annot"><span class="annottext">scopedSort :: [Name] -&gt; [Name]
</span><a href="#local-6989586621679509151"><span class="hs-identifier hs-var hs-var">scopedSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679509150"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1640"></span><span>
</span><span id="line-1641"></span><span>      </span><span class="annot"><a href="#local-6989586621679509150"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- already sorted, in reverse order</span><span>
</span><span id="line-1642"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- each set contains all the variables which must be placed</span><span>
</span><span id="line-1643"></span><span>                       </span><span class="hs-comment">-- before the tv corresponding to the set; they are accumulations</span><span>
</span><span id="line-1644"></span><span>                       </span><span class="hs-comment">-- of the fvs in the sorted tvs' kinds</span><span>
</span><span id="line-1645"></span><span>
</span><span id="line-1646"></span><span>                       </span><span class="hs-comment">-- This list is in 1-to-1 correspondence with the sorted tyvars</span><span>
</span><span id="line-1647"></span><span>                       </span><span class="hs-comment">-- INVARIANT:</span><span>
</span><span id="line-1648"></span><span>                       </span><span class="hs-comment">--   all (\tl -&gt; all (`isSubsetOf` head tl) (tail tl)) (tails fv_list)</span><span>
</span><span id="line-1649"></span><span>                       </span><span class="hs-comment">-- That is, each set in the list is a superset of all later sets.</span><span>
</span><span id="line-1650"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- yet to be sorted</span><span>
</span><span id="line-1651"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1652"></span><span>      </span><span id="local-6989586621679509150"><span class="annot"><span class="annottext">go :: [Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679509150"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679509149"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509149"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679509148"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509148"><span class="hs-identifier hs-var">_fv_list</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509149"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1653"></span><span>      </span><span class="annot"><a href="#local-6989586621679509150"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679509146"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509146"><span class="hs-identifier hs-var">acc</span></a></span></span><span>  </span><span id="local-6989586621679509145"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509145"><span class="hs-identifier hs-var">fv_list</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509144"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509144"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679509143"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509143"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1654"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679509150"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509142"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509141"><span class="hs-identifier hs-var">fv_list'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509143"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1655"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1656"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679509142"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509142"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509141"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509141"><span class="hs-identifier hs-var">fv_list'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679509140"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509144"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509146"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509145"><span class="hs-identifier hs-var">fv_list</span></a></span><span>
</span><span id="line-1657"></span><span>
</span><span id="line-1658"></span><span>      </span><span class="annot"><a href="#local-6989586621679509140"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>       </span><span class="hs-comment">-- var to insert</span><span>
</span><span id="line-1659"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- sorted list, in reverse order</span><span>
</span><span id="line-1660"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of fvs, as above</span><span>
</span><span id="line-1661"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- augmented lists</span><span>
</span><span id="line-1662"></span><span>      </span><span id="local-6989586621679509140"><span class="annot"><span class="annottext">insert :: Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679509140"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679509139"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509139"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509139"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679509138"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509139"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span>      </span><span class="annot"><a href="#local-6989586621679509140"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span id="local-6989586621679509137"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509137"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509136"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509136"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679509135"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509135"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509134"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509134"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679509133"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509133"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1664"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509137"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509134"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1665"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509131"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509131"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509130"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509130"><span class="hs-identifier hs-var">fvss'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679509140"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509137"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509135"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509133"><span class="hs-identifier hs-var">fvss</span></a></span><span>
</span><span id="line-1666"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509136"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509131"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509134"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509128"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509130"><span class="hs-identifier hs-var">fvss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1667"></span><span>
</span><span id="line-1668"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1669"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509137"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509136"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509135"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509134"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509128"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679509134"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679509133"><span class="hs-identifier hs-var">fvss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1670"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1671"></span><span>          </span><span id="local-6989586621679509128"><span class="annot"><span class="annottext">fv_tv :: Set Name
</span><a href="#local-6989586621679509128"><span class="hs-identifier hs-var hs-var">fv_tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679509138"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509137"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1672"></span><span>
</span><span id="line-1673"></span><span>         </span><span class="hs-comment">-- lists not in correspondence</span><span>
</span><span id="line-1674"></span><span>      </span><span class="annot"><a href="#local-6989586621679509140"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scopedSort&quot;</span></span><span>
</span><span id="line-1675"></span><span>
</span><span id="line-1676"></span><span>      </span><span id="local-6989586621679509138"><span class="annot"><span class="annottext">kindFVSet :: Name -&gt; Set Name
</span><a href="#local-6989586621679509138"><span class="hs-identifier hs-var hs-var">kindFVSet</span></a></span></span><span> </span><span id="local-6989586621679509126"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509126"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1677"></span><span>        </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. OSet a -&gt; Set a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#toSet"><span class="hs-identifier hs-var">OS.toSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DKind -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509126"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509183"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span>      </span><span id="local-6989586621679509121"><span class="annot"><span class="annottext">ascribeWithKind :: Name -&gt; DTyVarBndrUnit
</span><a href="#local-6989586621679509121"><span class="hs-identifier hs-var hs-var">ascribeWithKind</span></a></span></span><span> </span><span id="local-6989586621679509120"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509120"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1680"></span><span>        </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; DTyVarBndr flag
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509120"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall flag. Name -&gt; flag -&gt; DKind -&gt; DTyVarBndr flag
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509120"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509120"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DKind
</span><a href="#local-6989586621679509183"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1681"></span><span>
</span><span id="line-1682"></span><span>      </span><span class="hs-comment">-- An annoying wrinkle: GHCs before 8.0 don't support explicitly</span><span>
</span><span id="line-1683"></span><span>      </span><span class="hs-comment">-- quantifying kinds, so something like @forall k (a :: k)@ would be</span><span>
</span><span id="line-1684"></span><span>      </span><span class="hs-comment">-- rejected. To work around this, we filter out any binders whose names</span><span>
</span><span id="line-1685"></span><span>      </span><span class="hs-comment">-- also appear in a kind on old GHCs.</span><span>
</span><span id="line-1686"></span><span>      </span><span id="local-6989586621679509119"><span class="annot"><span class="annottext">isKindBinderOnOldGHCs :: b -&gt; Bool
</span><a href="#local-6989586621679509119"><span class="hs-identifier hs-var hs-var">isKindBinderOnOldGHCs</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">kindVars</span><span class="hs-special">)</span><span>
</span><span id="line-1691"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1692"></span><span>            </span><span class="hs-identifier">kindVars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">fvDType</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">M.elems</span><span> </span><span class="hs-identifier">varKindSigs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1695"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndrUnit
</span><a href="#local-6989586621679509121"><span class="hs-identifier hs-var">ascribeWithKind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1696"></span><span>     </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {b}. b -&gt; Bool
</span><a href="#local-6989586621679509119"><span class="hs-identifier hs-var">isKindBinderOnOldGHCs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1697"></span><span>     </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
</span><a href="#local-6989586621679509151"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679509186"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1698"></span><span>
</span><span id="line-1699"></span><span id="local-6989586621679511951"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-type">dtvbName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679511951"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-1700"></span><span id="dtvbName"><span class="annot"><span class="annottext">dtvbName :: forall flag. DTyVarBndr flag -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var hs-var">dtvbName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679509115"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509115"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509115"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1701"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var">dtvbName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679509114"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509114"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509114"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span class="hs-comment">-- @mk_qual_do_name mb_mod orig_name@ will simply return @orig_name@ if</span><span>
</span><span id="line-1704"></span><span class="hs-comment">-- @mb_mod@ is Nothing. If @mb_mod@ is @Just mod_@, then a new 'Name' will be</span><span>
</span><span id="line-1705"></span><span class="hs-comment">-- returned that uses @mod_@ as the new module prefix. This is useful for</span><span>
</span><span id="line-1706"></span><span class="hs-comment">-- emulating the behavior of the @QualifiedDo@ extension, which adds module</span><span>
</span><span id="line-1707"></span><span class="hs-comment">-- prefixes to functions such as ('&gt;&gt;=') and ('&gt;&gt;').</span><span>
</span><span id="line-1708"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_qual_do_name"><span class="hs-identifier hs-type">mk_qual_do_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1709"></span><span id="mk_qual_do_name"><span class="annot"><span class="annottext">mk_qual_do_name :: Maybe ModName -&gt; Name -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_qual_do_name"><span class="hs-identifier hs-var hs-var">mk_qual_do_name</span></a></span></span><span> </span><span id="local-6989586621679509113"><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679509113"><span class="hs-identifier hs-var">mb_mod</span></a></span></span><span> </span><span id="local-6989586621679509112"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509112"><span class="hs-identifier hs-var">orig_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ModName
</span><a href="#local-6989586621679509113"><span class="hs-identifier hs-var">mb_mod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1710"></span><span>  </span><span class="annot"><span class="annottext">Maybe ModName
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509112"><span class="hs-identifier hs-var">orig_name</span></a></span><span>
</span><span id="line-1711"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679509111"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679509111"><span class="hs-identifier hs-var">mod_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; NameFlavour -&gt; Name
</span><span class="hs-identifier hs-var">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; OccName
</span><span class="hs-identifier hs-var">OccName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679509112"><span class="hs-identifier hs-var">orig_name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModName -&gt; NameFlavour
</span><span class="hs-identifier hs-var">NameQ</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679509111"><span class="hs-identifier hs-var">mod_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>
</span><span id="line-1713"></span><span class="hs-comment">-- | Reconstruct an arrow 'DType' from its argument and result types.</span><span>
</span><span id="line-1714"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-type">ravelDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1715"></span><span id="ravelDType"><span class="annot"><span class="annottext">ravelDType :: DFunArgs -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var hs-var">ravelDType</span></a></span></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span>                 </span><span id="local-6989586621679509105"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509105"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509105"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1716"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-type">DFAForalls</span></a></span><span> </span><span id="local-6989586621679509103"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509103"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679509102"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509102"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679509101"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509101"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DForallTelescope -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509103"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509102"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509101"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1717"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-type">DFACxt</span></a></span><span> </span><span id="local-6989586621679509099"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509099"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679509098"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509098"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>      </span><span id="local-6989586621679509097"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509097"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DKind] -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-var">DConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509099"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509098"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509097"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-type">DFAAnon</span></a></span><span> </span><span id="local-6989586621679509095"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509095"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679509094"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509094"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621679509093"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509093"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509095"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DKind -&gt; DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509094"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509093"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="hs-comment">-- | Decompose a function 'DType' into its arguments (the 'DFunArgs') and its</span><span>
</span><span id="line-1721"></span><span class="hs-comment">-- result type (the 'DType).</span><span>
</span><span id="line-1722"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-type">unravelDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span id="unravelDType"><span class="annot"><span class="annottext">unravelDType :: DKind -&gt; (DFunArgs, DKind)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var hs-var">unravelDType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679509091"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509091"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679509090"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509090"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1724"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509089"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509089"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509088"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509088"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; (DFunArgs, DKind)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509090"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1725"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForallTelescope -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-var">DFAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679509091"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509089"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509088"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679509087"><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509087"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679509086"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509086"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1727"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509085"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509085"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509084"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509084"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; (DFunArgs, DKind)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509086"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1728"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DKind] -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-var">DFACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><a href="#local-6989586621679509087"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509085"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509084"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1729"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span> </span><span id="local-6989586621679509083"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509083"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679509082"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509082"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509081"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509081"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509080"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509080"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DKind -&gt; (DFunArgs, DKind)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509082"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1731"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-var">DFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509083"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679509081"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509080"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span id="local-6989586621679509079"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509079"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679509079"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1733"></span><span>
</span><span id="line-1734"></span><span class="hs-comment">-- | The list of arguments in a function 'DType'.</span><span>
</span><span id="line-1735"></span><span id="local-6989586621679509077"><span id="local-6989586621679509078"></span></span><span class="hs-keyword">data</span><span> </span><span id="DFunArgs"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-var">DFunArgs</span></a></span></span><span>
</span><span id="line-1736"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DFANil"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span></span><span>
</span><span id="line-1737"></span><span>    </span><span class="hs-comment">-- ^ No more arguments.</span><span>
</span><span id="line-1738"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFAForalls"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-var">DFAForalls</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallTelescope"><span class="hs-identifier hs-type">DForallTelescope</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1739"></span><span>    </span><span class="hs-comment">-- ^ A series of @forall@ed type variables followed by a dot (if</span><span>
</span><span id="line-1740"></span><span>    </span><span class="hs-comment">--   'ForallInvis') or an arrow (if 'ForallVis'). For example,</span><span>
</span><span id="line-1741"></span><span>    </span><span class="hs-comment">--   the type variables @a1 ... an@ in @forall a1 ... an. r@.</span><span>
</span><span id="line-1742"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFACxt"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-var">DFACxt</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1743"></span><span>    </span><span class="hs-comment">-- ^ A series of constraint arguments followed by @=&gt;@. For example,</span><span>
</span><span id="line-1744"></span><span>    </span><span class="hs-comment">--   the @(c1, ..., cn)@ in @(c1, ..., cn) =&gt; r@.</span><span>
</span><span id="line-1745"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-var">DFAAnon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1746"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow. For example, the @a@</span><span>
</span><span id="line-1747"></span><span>    </span><span class="hs-comment">--   in @a -&gt; r@.</span><span>
</span><span id="line-1748"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679509064"><span id="local-6989586621679509075"><span class="annot"><span class="annottext">DFunArgs -&gt; DFunArgs -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DFunArgs -&gt; DFunArgs -&gt; Bool
$c/= :: DFunArgs -&gt; DFunArgs -&gt; Bool
== :: DFunArgs -&gt; DFunArgs -&gt; Bool
$c== :: DFunArgs -&gt; DFunArgs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509046"><span id="local-6989586621679509048"><span id="local-6989586621679509062"><span class="annot"><span class="annottext">Int -&gt; DFunArgs -&gt; ShowS
[DFunArgs] -&gt; ShowS
DFunArgs -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DFunArgs] -&gt; ShowS
$cshowList :: [DFunArgs] -&gt; ShowS
show :: DFunArgs -&gt; String
$cshow :: DFunArgs -&gt; String
showsPrec :: Int -&gt; DFunArgs -&gt; ShowS
$cshowsPrec :: Int -&gt; DFunArgs -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679509000"><span id="local-6989586621679509002"><span id="local-6989586621679509004"><span id="local-6989586621679509006"><span id="local-6989586621679509008"><span id="local-6989586621679509010"><span id="local-6989586621679509012"><span id="local-6989586621679509014"><span id="local-6989586621679509016"><span id="local-6989586621679509018"><span id="local-6989586621679509020"><span id="local-6989586621679509022"><span id="local-6989586621679509031"><span id="local-6989586621679509042"><span class="annot"><span class="annottext">Typeable DFunArgs
DFunArgs -&gt; DataType
DFunArgs -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
dataTypeOf :: DFunArgs -&gt; DataType
$cdataTypeOf :: DFunArgs -&gt; DataType
toConstr :: DFunArgs -&gt; Constr
$ctoConstr :: DFunArgs -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep DFunArgs x -&gt; DFunArgs
forall x. DFunArgs -&gt; Rep DFunArgs x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DFunArgs x -&gt; DFunArgs
$cfrom :: forall x. DFunArgs -&gt; Rep DFunArgs x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1749"></span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- | A /visible/ function argument type (i.e., one that must be supplied</span><span>
</span><span id="line-1751"></span><span class="hs-comment">-- explicitly in the source code). This is in contrast to /invisible/</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- arguments (e.g., the @c@ in @c =&gt; r@), which are instantiated without</span><span>
</span><span id="line-1753"></span><span class="hs-comment">-- the need for explicit user input.</span><span>
</span><span id="line-1754"></span><span id="local-6989586621679508995"><span id="local-6989586621679508996"></span></span><span class="hs-keyword">data</span><span> </span><span id="DVisFunArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFunArg"><span class="hs-identifier hs-var">DVisFunArg</span></a></span></span><span>
</span><span id="line-1755"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DVisFADep"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFADep"><span class="hs-identifier hs-var">DVisFADep</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndrUnit"><span class="hs-identifier hs-type">DTyVarBndrUnit</span></a></span><span>
</span><span id="line-1756"></span><span>    </span><span class="hs-comment">-- ^ A visible @forall@ (e.g., @forall a -&gt; a@).</span><span>
</span><span id="line-1757"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DVisFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFAAnon"><span class="hs-identifier hs-var">DVisFAAnon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1758"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow (e.g., @a -&gt; r@).</span><span>
</span><span id="line-1759"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679508985"><span id="local-6989586621679508991"><span class="annot"><span class="annottext">DVisFunArg -&gt; DVisFunArg -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
$c/= :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
== :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
$c== :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679508972"><span id="local-6989586621679508974"><span id="local-6989586621679508982"><span class="annot"><span class="annottext">Int -&gt; DVisFunArg -&gt; ShowS
[DVisFunArg] -&gt; ShowS
DVisFunArg -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DVisFunArg] -&gt; ShowS
$cshowList :: [DVisFunArg] -&gt; ShowS
show :: DVisFunArg -&gt; String
$cshow :: DVisFunArg -&gt; String
showsPrec :: Int -&gt; DVisFunArg -&gt; ShowS
$cshowsPrec :: Int -&gt; DVisFunArg -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679508934"><span id="local-6989586621679508936"><span id="local-6989586621679508938"><span id="local-6989586621679508940"><span id="local-6989586621679508942"><span id="local-6989586621679508944"><span id="local-6989586621679508946"><span id="local-6989586621679508948"><span id="local-6989586621679508950"><span id="local-6989586621679508952"><span id="local-6989586621679508954"><span id="local-6989586621679508956"><span id="local-6989586621679508961"><span id="local-6989586621679508967"><span class="annot"><span class="annottext">Typeable DVisFunArg
DVisFunArg -&gt; DataType
DVisFunArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
dataTypeOf :: DVisFunArg -&gt; DataType
$cdataTypeOf :: DVisFunArg -&gt; DataType
toConstr :: DVisFunArg -&gt; Constr
$ctoConstr :: DVisFunArg -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep DVisFunArg x -&gt; DVisFunArg
forall x. DVisFunArg -&gt; Rep DVisFunArg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DVisFunArg x -&gt; DVisFunArg
$cfrom :: forall x. DVisFunArg -&gt; Rep DVisFunArg x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1760"></span><span>
</span><span id="line-1761"></span><span class="hs-comment">-- | Filter the visible function arguments from a list of 'DFunArgs'.</span><span>
</span><span id="line-1762"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-type">filterDVisFunArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFunArg"><span class="hs-identifier hs-type">DVisFunArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1763"></span><span id="filterDVisFunArgs"><span class="annot"><span class="annottext">filterDVisFunArgs :: DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var hs-var">filterDVisFunArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1764"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-type">DFAForalls</span></a></span><span> </span><span id="local-6989586621679508928"><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679508928"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span id="local-6989586621679508927"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508927"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1765"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><a href="#local-6989586621679508928"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1766"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallVis"><span class="hs-identifier hs-type">DForallVis</span></a></span><span> </span><span id="local-6989586621679508926"><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679508926"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndrUnit -&gt; DVisFunArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DVisFADep"><span class="hs-identifier hs-var">DVisFADep</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrUnit]
</span><a href="#local-6989586621679508926"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DVisFunArg]
</span><a href="#local-6989586621679508925"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1767"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallInvis"><span class="hs-identifier hs-type">DForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DVisFunArg]
</span><a href="#local-6989586621679508925"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1768"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1769"></span><span>    </span><span id="local-6989586621679508925"><span class="annot"><span class="annottext">args' :: [DVisFunArg]
</span><a href="#local-6989586621679508925"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508927"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1770"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-type">DFACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[DKind]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679508924"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508924"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1771"></span><span>  </span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508924"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1772"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-type">DFAAnon</span></a></span><span> </span><span id="local-6989586621679508923"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508923"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679508922"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508922"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1773"></span><span>  </span><span class="annot"><span class="annottext">DKind -&gt; DVisFunArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DVisFAAnon"><span class="hs-identifier hs-var">DVisFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508923"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679508922"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1774"></span><span>
</span><span id="line-1775"></span><span class="hs-comment">-- | Decompose an applied type into its individual components. For example, this:</span><span>
</span><span id="line-1776"></span><span class="hs-comment">--</span><span>
</span><span id="line-1777"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1778"></span><span class="hs-comment">-- Proxy \@Type Char</span><span>
</span><span id="line-1779"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1780"></span><span class="hs-comment">--</span><span>
</span><span id="line-1781"></span><span class="hs-comment">-- would be unfolded to this:</span><span>
</span><span id="line-1782"></span><span class="hs-comment">--</span><span>
</span><span id="line-1783"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1784"></span><span class="hs-comment">-- ('DConT' ''Proxy, ['DTyArg' ('DConT' ''Type), 'DTANormal' ('DConT' ''Char)])</span><span>
</span><span id="line-1785"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1786"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-type">unfoldDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1787"></span><span id="unfoldDType"><span class="annot"><span class="annottext">unfoldDType :: DKind -&gt; (DKind, [DTypeArg])
</span><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-var hs-var">unfoldDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1788"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1789"></span><span>    </span><span class="annot"><a href="#local-6989586621679508920"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1790"></span><span>    </span><span id="local-6989586621679508920"><span class="annot"><span class="annottext">go :: [DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679508919"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508919"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">DForallTelescope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679508918"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508918"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508919"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508918"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1791"></span><span>    </span><span class="annot"><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679508917"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508917"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679508916"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508916"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679508915"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508915"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508915"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508917"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508916"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1792"></span><span>    </span><span class="annot"><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679508914"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508914"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679508913"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508913"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679508912"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508912"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508912"><span class="hs-identifier hs-var">ki</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508914"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508913"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1793"></span><span>    </span><span class="annot"><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679508911"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508911"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679508910"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508910"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DKind -&gt; (DKind, [DTypeArg])
</span><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508911"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508910"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1794"></span><span>    </span><span class="annot"><a href="#local-6989586621679508920"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679508909"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508909"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679508908"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508908"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508908"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679508909"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1795"></span><span>
</span><span id="line-1796"></span><span class="hs-comment">-- | Extract the kind from a 'DTyVarBndr', if one is present.</span><span>
</span><span id="line-1797"></span><span id="local-6989586621679512097"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-type">extractTvbKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512097"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span></span><span>
</span><span id="line-1798"></span><span id="extractTvbKind"><span class="annot"><span class="annottext">extractTvbKind :: forall flag. DTyVarBndr flag -&gt; Maybe DKind
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var hs-var">extractTvbKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1799"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679508907"><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508907"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DKind
</span><a href="#local-6989586621679508907"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1800"></span><span>
</span><span id="line-1801"></span><span class="hs-comment">-- | Set the flag in a list of 'DTyVarBndr's. This is often useful in contexts</span><span>
</span><span id="line-1802"></span><span class="hs-comment">-- where one needs to re-use a list of 'DTyVarBndr's from one flag setting to</span><span>
</span><span id="line-1803"></span><span class="hs-comment">-- another flag setting. For example, in order to re-use the 'DTyVarBndr's bound</span><span>
</span><span id="line-1804"></span><span class="hs-comment">-- by a 'DDataD' in a 'DForallT', one can do the following:</span><span>
</span><span id="line-1805"></span><span class="hs-comment">--</span><span>
</span><span id="line-1806"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1807"></span><span class="hs-comment">-- case x of</span><span>
</span><span id="line-1808"></span><span class="hs-comment">--   'DDataD' _ _ _ tvbs _ _ _ -&gt;</span><span>
</span><span id="line-1809"></span><span class="hs-comment">--     'DForallT' ('DForallInvis' ('changeDTVFlags' 'SpecifiedSpec' tvbs)) ...</span><span>
</span><span id="line-1810"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1811"></span><span id="local-6989586621679512101"><span id="local-6989586621679512102"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#changeDTVFlags"><span class="hs-identifier hs-type">changeDTVFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679512102"><span class="hs-identifier hs-type">newFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512101"><span class="hs-identifier hs-type">oldFlag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679512102"><span class="hs-identifier hs-type">newFlag</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1812"></span><span id="changeDTVFlags"><span class="annot"><span class="annottext">changeDTVFlags :: forall newFlag oldFlag.
newFlag -&gt; [DTyVarBndr oldFlag] -&gt; [DTyVarBndr newFlag]
</span><a href="Language.Haskell.TH.Desugar.Core.html#changeDTVFlags"><span class="hs-identifier hs-var hs-var">changeDTVFlags</span></a></span></span><span> </span><span id="local-6989586621679508904"><span class="annot"><span class="annottext">newFlag
</span><a href="#local-6989586621679508904"><span class="hs-identifier hs-var">new_flag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">newFlag
</span><a href="#local-6989586621679508904"><span class="hs-identifier hs-var">new_flag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span>
</span><span id="line-1813"></span><span>
</span><span id="line-1814"></span><span class="hs-comment">-- | Some functions in this module only use certain arguments on particular</span><span>
</span><span id="line-1815"></span><span class="hs-comment">-- versions of GHC. Other versions of GHC (that don't make use of those</span><span>
</span><span id="line-1816"></span><span class="hs-comment">-- arguments) might need to conjure up those arguments out of thin air at the</span><span>
</span><span id="line-1817"></span><span class="hs-comment">-- functions' call sites, so this function serves as a placeholder to use in</span><span>
</span><span id="line-1818"></span><span class="hs-comment">-- those situations. (In other words, this is a slightly more informative</span><span>
</span><span id="line-1819"></span><span class="hs-comment">-- version of 'undefined'.)</span><span>
</span><span id="line-1820"></span><span id="local-6989586621679512152"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-type">unusedArgument</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679512152"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1821"></span><span id="unusedArgument"><span class="annot"><span class="annottext">unusedArgument :: forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var hs-var">unusedArgument</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unused&quot;</span></span><span>
</span><span id="line-1822"></span><span>
</span><span id="line-1823"></span><span class="hs-comment">{-
Note [Desugaring and sweetening ForallT]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The ForallT constructor from template-haskell is tremendously awkward. Because
ForallT contains both a list of type variable binders and constraint arguments,
ForallT expressions can be ambiguous when one of these lists is empty. For
example, consider this expression with no constraints:

  ForallT [PlainTV a] [] (VarT a)

What should this desugar to in th-desugar, which must maintain a clear
separation between type variable binders and constraints? There are two
possibilities:

1. DForallT DForallInvis [DPlainTV a] (DVarT a)
   (i.e., forall a. a)
2. DForallT DForallInvis [DPlainTV a] (DConstrainedT [] (DVarT a))
   (i.e., forall a. () =&gt; a)

Template Haskell generally drops these empty lists when splicing Template
Haskell expressions, so we would like to do the same in th-desugar to mimic
TH's behavior as closely as possible. However, there are some situations where
dropping empty lists of `forall`ed type variable binders can change the
semantics of a program. For instance, contrast `foo :: forall. a -&gt; a` (which
is an error) with `foo :: a -&gt; a` (which is fine). Therefore, we try to
preserve empty `forall`s to the best of our ability.

Here is an informal specification of how th-desugar should handle different sorts
of ambiguity. First, a specification for desugaring.
Let `tvbs` and `ctxt` be non-empty:

* `ForallT tvbs [] ty` should desugar to `DForallT DForallInvis tvbs ty`.
* `ForallT [] ctxt ty` should desguar to `DForallT DForallInvis [] (DConstrainedT ctxt ty)`.
* `ForallT [] [] ty`   should desugar to `DForallT DForallInvis [] ty`.
* For all other cases, just straightforwardly desugar
  `ForallT tvbs ctxt ty` to `DForallT DForallInvis tvbs (DConstraintedT ctxt ty)`.

For sweetening:

* `DForallT DForallInvis tvbs (DConstrainedT ctxt ty)` should sweeten to `ForallT tvbs ctxt ty`.
* `DForallT DForallInvis []   (DConstrainedT ctxt ty)` should sweeten to `ForallT [] ctxt ty`.
* `DForallT DForallInvis tvbs (DConstrainedT [] ty)`   should sweeten to `ForallT tvbs [] ty`.
* `DForallT DForallInvis []   (DConstrainedT [] ty)`   should sweeten to `ForallT [] [] ty`.
* For all other cases, just straightforwardly sweeten
  `DForallT DForallInvis tvbs ty` to `ForallT tvbs [] ty` and
  `DConstrainedT ctxt ty` to `ForallT [] ctxt ty`.
-}</span><span>
</span><span id="line-1870"></span></pre></body></html>