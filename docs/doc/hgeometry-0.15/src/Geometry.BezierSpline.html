<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns         #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Geometry.BezierSpline</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geometry.BezierSpline</span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier">BezierSpline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier">BezierSpline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier2"><span class="hs-identifier">Bezier2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-identifier">Bezier3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier">controlPoints</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier">fromPointSeq</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#reverse"><span class="hs-identifier">Geometry.BezierSpline.reverse</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier">evaluate</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier">split</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#splitMany"><span class="hs-identifier">splitMany</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#splitMonotone"><span class="hs-identifier">splitMonotone</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#splitByPoints"><span class="hs-identifier">splitByPoints</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#extension"><span class="hs-identifier">extension</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#extend"><span class="hs-identifier">extend</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#growTo"><span class="hs-identifier">growTo</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#merge"><span class="hs-identifier">merge</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#subBezier"><span class="hs-identifier">subBezier</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#tangent"><span class="hs-identifier">tangent</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#approximate"><span class="hs-identifier">approximate</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#parameterOf"><span class="hs-identifier">parameterOf</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#snap"><span class="hs-identifier">snap</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#intersectB"><span class="hs-identifier">intersectB</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#colinear"><span class="hs-identifier">colinear</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#quadToCubic"><span class="hs-identifier">quadToCubic</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algorithms.Geometry.ConvexHull.GrahamScan.html"><span class="hs-identifier">Algorithms.Geometry.ConvexHull.GrahamScan</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algorithms.Geometry.SmallestEnclosingBall.RIC.html"><span class="hs-identifier">Algorithms.Geometry.SmallestEnclosingBall.RIC</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algorithms.Geometry.SmallestEnclosingBall.Types.html"><span class="hs-identifier">Algorithms.Geometry.SmallestEnclosingBall.Types</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.LSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LSeq</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.LSeq</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LSeq</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Radical</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Radical</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fmapDefault</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">foldMapDefault</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Ball.html"><span class="hs-identifier">Geometry.Ball</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Box.Internal.html"><span class="hs-identifier">Geometry.Box.Internal</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Line.html"><span class="hs-identifier">Geometry.Line</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.LineSegment.html"><span class="hs-identifier">Geometry.LineSegment</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.LineSegment.Internal.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Point.html"><span class="hs-identifier">Geometry.Point</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.PolyLine.html"><span class="hs-identifier">Geometry.PolyLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PolyLine.html#PolyLine"><span class="hs-identifier">PolyLine</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Polygon.html"><span class="hs-identifier">Geometry.Polygon</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Polygon.Convex.html"><span class="hs-identifier">Geometry.Polygon.Convex</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Polygon.Convex.html#merge"><span class="hs-identifier">merge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Properties.html"><span class="hs-identifier">Geometry.Properties</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Transformation.html"><span class="hs-identifier">Geometry.Transformation</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Vector.html"><span class="hs-identifier">Geometry.Vector</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#init"><span class="hs-identifier">init</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- import Debug.Trace</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Datatype representing a Bezier curve of degree \(n\) in \(d\)-dimensional space.</span><span>
</span><span id="line-69"></span><span class="hs-keyword">newtype</span><span> </span><span id="BezierSpline"><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-var">BezierSpline</span></a></span></span><span> </span><span id="local-6989586621680054059"><span class="annot"><a href="#local-6989586621680054059"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680054058"><span class="annot"><a href="#local-6989586621680054058"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680054057"><span class="annot"><a href="#local-6989586621680054057"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BezierSpline"><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-var">BezierSpline</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_controlPoints"><span class="annot"><span class="annottext">BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><a href="#local-6989586621680054059"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054058"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- makeLenses ''BezierSpline</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Bezier control points. With n degrees, there are n+1 control points.</span><span>
</span><span id="line-73"></span><span id="local-6989586621680053888"><span id="local-6989586621680053889"><span id="local-6989586621680053890"><span id="local-6989586621680053891"><span id="local-6989586621680053892"><span id="local-6989586621680053893"><span class="annot"><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-type">controlPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053893"><span class="hs-identifier hs-type">n1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053892"><span class="hs-identifier hs-type">d1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053891"><span class="hs-identifier hs-type">r1</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053890"><span class="hs-identifier hs-type">n2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053889"><span class="hs-identifier hs-type">d2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053888"><span class="hs-identifier hs-type">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><a href="#local-6989586621680053893"><span class="hs-identifier hs-type">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053892"><span class="hs-identifier hs-type">d1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053891"><span class="hs-identifier hs-type">r1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><a href="#local-6989586621680053890"><span class="hs-identifier hs-type">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053889"><span class="hs-identifier hs-type">d2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053888"><span class="hs-identifier hs-type">r2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-75"></span><span id="controlPoints"><span class="annot"><span class="annottext">controlPoints :: p (LSeq (1 + n1) (Point d1 r1)) (f (LSeq (1 + n2) (Point d2 r2)))
-&gt; p (BezierSpline n1 d1 r1) (f (BezierSpline n2 d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var hs-var">controlPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n1 d1 r1 -&gt; LSeq (1 + n1) (Point d1 r1))
-&gt; (LSeq (1 + n2) (Point d2 r2) -&gt; BezierSpline n2 d2 r2)
-&gt; Iso
     (BezierSpline n1 d1 r1)
     (BezierSpline n2 d2 r2)
     (LSeq (1 + n1) (Point d1 r1))
     (LSeq (1 + n2) (Point d2 r2))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n1 d1 r1 -&gt; LSeq (1 + n1) (Point d1 r1)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n2) (Point d2 r2) -&gt; BezierSpline n2 d2 r2
forall (n :: Nat) (d :: Nat) r.
LSeq (1 + n) (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-var">BezierSpline</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Quadratic Bezier Spline</span><span>
</span><span id="line-78"></span><span id="local-6989586621680054054"><span id="local-6989586621680054055"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier2"><span class="hs-identifier hs-type">Bezier2</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054055"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054054"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054055"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054054"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054055"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054054"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680054055"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054054"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bBezier2"><span id="%24mBezier2"><span id="Bezier2"><span class="annot"><span class="annottext">$bBezier2 :: Point d r -&gt; Point d r -&gt; Point d r -&gt; BezierSpline 2 d r
$mBezier2 :: forall r (d :: Nat) r.
BezierSpline 2 d r
-&gt; (Point d r -&gt; Point d r -&gt; Point d r -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Geometry.BezierSpline.html#%24bBezier2"><span class="hs-identifier hs-var hs-var hs-var hs-var">Bezier2</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680053540"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053539"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053538"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.toList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq.take</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var">_controlPoints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680053540"><span class="annot"><a href="#local-6989586621680053540"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053539"><span class="annot"><a href="#local-6989586621680053539"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053538"><span class="annot"><a href="#local-6989586621680053538"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier2"><span class="hs-identifier hs-var">Bezier2</span></a></span><span> </span><span id="local-6989586621680053534"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053534"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053533"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053533"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680053532"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053532"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline 2 d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline 2 d r)
-&gt; ([Point d r] -&gt; Seq (Point d r))
-&gt; [Point d r]
-&gt; BezierSpline 2 d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; Seq (Point d r)
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; BezierSpline 2 d r)
-&gt; [Point d r] -&gt; BezierSpline 2 d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053534"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053533"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053532"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier2"><span class="hs-pragma hs-type">Bezier2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Cubic Bezier Spline</span><span>
</span><span id="line-85"></span><span id="local-6989586621680054037"><span id="local-6989586621680054038"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-identifier hs-type">Bezier3</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054038"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054038"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054038"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054038"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621680054038"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054037"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bBezier3"><span id="%24mBezier3"><span id="Bezier3"><span class="annot"><span class="annottext">$bBezier3 :: Point d r
-&gt; Point d r -&gt; Point d r -&gt; Point d r -&gt; BezierSpline 3 d r
$mBezier3 :: forall r (d :: Nat) r.
BezierSpline 3 d r
-&gt; (Point d r -&gt; Point d r -&gt; Point d r -&gt; Point d r -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="Geometry.BezierSpline.html#%24bBezier3"><span class="hs-identifier hs-var hs-var hs-var hs-var">Bezier3</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680053528"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053527"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053526"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053525"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.toList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq.take</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var">_controlPoints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680053528"><span class="annot"><a href="#local-6989586621680053528"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053527"><span class="annot"><a href="#local-6989586621680053527"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053526"><span class="annot"><a href="#local-6989586621680053526"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053525"><span class="annot"><a href="#local-6989586621680053525"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-identifier hs-var">Bezier3</span></a></span><span> </span><span id="local-6989586621680053524"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053524"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053523"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053523"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680053522"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053522"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680053521"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053521"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline 3 d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline 3 d r)
-&gt; ([Point d r] -&gt; Seq (Point d r))
-&gt; [Point d r]
-&gt; BezierSpline 3 d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; Seq (Point d r)
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; BezierSpline 3 d r)
-&gt; [Point d r] -&gt; BezierSpline 3 d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053524"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053523"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053522"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053521"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-pragma hs-type">Bezier3</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Constructs the Bezier Spline from a given sequence of points.</span><span>
</span><span id="line-92"></span><span id="local-6989586621680054047"><span id="local-6989586621680054048"><span id="local-6989586621680054049"><span class="annot"><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-type">fromPointSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054049"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054048"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054047"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054049"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054048"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-93"></span><span id="fromPointSeq"><span class="annot"><span class="annottext">fromPointSeq :: Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var hs-var">fromPointSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; BezierSpline n d r
forall (n :: Nat) (d :: Nat) r.
LSeq (1 + n) (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-var">BezierSpline</span></a></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r) -&gt; BezierSpline n d r)
-&gt; (Seq (Point d r) -&gt; LSeq (1 + n) (Point d r))
-&gt; Seq (Point d r)
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LSeq 0 (Point d r) -&gt; LSeq (1 + n) (Point d r)
forall (n :: Nat) (m :: Nat) a. LSeq m a -&gt; LSeq n a
</span><span class="hs-identifier hs-var">LSeq.promise</span></span><span> </span><span class="annot"><span class="annottext">(LSeq 0 (Point d r) -&gt; LSeq (1 + n) (Point d r))
-&gt; (Seq (Point d r) -&gt; LSeq 0 (Point d r))
-&gt; Seq (Point d r)
-&gt; LSeq (1 + n) (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; LSeq 0 (Point d r)
forall a. Seq a -&gt; LSeq 0 a
</span><span class="hs-identifier hs-var">LSeq.fromSeq</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621680053512"><span id="local-6989586621680053514"><span id="local-6989586621680053516"><span id="local-6989586621680053517"><span id="local-6989586621680053518"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053518"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680053517"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053516"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053518"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053517"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="Geometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span id="local-6989586621680053510"><span class="annot"><a href="#local-6989586621680053510"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053509"><span class="annot"><a href="#local-6989586621680053509"><span class="hs-identifier hs-type hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053508"><span class="annot"><a href="#local-6989586621680053508"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680053509"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="Geometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span id="local-6989586621680053507"><span class="annot"><a href="#local-6989586621680053507"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053506"><span class="annot"><a href="#local-6989586621680053506"><span class="hs-identifier hs-type hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053505"><span class="annot"><a href="#local-6989586621680053505"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680053505"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621680053502"><span id="local-6989586621680053503"><span id="local-6989586621680053504"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680053499"><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053504"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053503"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621680053502"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053504"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053503"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053502"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621680053497"><span class="annot"><span class="annottext">arbitrary :: Gen (BezierSpline n d r)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline n d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; ([Point d r] -&gt; Seq (Point d r))
-&gt; [Point d r]
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; Seq (Point d r)
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; BezierSpline n d r)
-&gt; Gen [Point d r] -&gt; Gen (BezierSpline n d r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen [Point d r]
forall a. Arbitrary a =&gt; Int -&gt; Gen [a]
</span><span class="hs-identifier hs-var">QC.vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Int) -&gt; (C n -&gt; Natural) -&gt; C n -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Natural) -&gt; (C n -&gt; Natural) -&gt; C n -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">C n -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">(C n -&gt; Int) -&gt; C n -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">C n
forall (n :: Nat). C n
</span><a href="Geometry.Vector.VectorFixed.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680053504"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">{-
instance (Arity n, Arity d, QC.Arbitrary r, Ord r) =&gt; QC.Arbitrary (BezierSpline n d r) where
  arbitrary = fromPointSeq . Seq.fromList &lt;$&gt; allDifferent (fromIntegral . (1+) . natVal $ C @n)

-- | Generates a set of unique items.
allDifferent   :: (Ord a, QC.Arbitrary  a) =&gt; Int -&gt; QC.Gen [a]
allDifferent n = take n . Set.toList . go maxattempts mempty &lt;$&gt; QC.infiniteList
  where
    maxattempts = 100
    go 0 s _                        = s -- too many attempts
    go t s (x:xs) | Set.size s == n = s
                  | otherwise       = go (t-1) (Set.insert x s) xs
-}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621680053488"><span id="local-6989586621680053489"><span id="local-6989586621680053490"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680053483"><span id="local-6989586621680053486"><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053490"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680053489"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053488"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053490"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053489"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621680053481"><span class="annot"><span class="annottext">show :: BezierSpline n d r -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span id="local-6989586621680053479"><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r)
</span><a href="#local-6989586621680053479"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BezierSpline&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r)
</span><a href="#local-6989586621680053479"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; [Point d r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r)
</span><a href="#local-6989586621680053479"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621680053476"><span id="local-6989586621680053477"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680053473"><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053477"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053476"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053477"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621680053471"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; BezierSpline n d a -&gt; BezierSpline n d b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; BezierSpline n d a -&gt; BezierSpline n d b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span></span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621680053469"><span id="local-6989586621680053470"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680053436"><span id="local-6989586621680053438"><span id="local-6989586621680053440"><span id="local-6989586621680053442"><span id="local-6989586621680053444"><span id="local-6989586621680053446"><span id="local-6989586621680053448"><span id="local-6989586621680053450"><span id="local-6989586621680053452"><span id="local-6989586621680053454"><span id="local-6989586621680053456"><span id="local-6989586621680053458"><span id="local-6989586621680053460"><span id="local-6989586621680053462"><span id="local-6989586621680053464"><span id="local-6989586621680053467"><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053470"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053469"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053470"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621680053434"><span class="annot"><span class="annottext">foldMap :: (a -&gt; m) -&gt; BezierSpline n d a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; BezierSpline n d a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621680053431"><span id="local-6989586621680053432"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680053422"><span id="local-6989586621680053424"><span id="local-6989586621680053426"><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053432"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053431"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053432"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621680053420"><span class="annot"><span class="annottext">traverse :: (a -&gt; f b) -&gt; BezierSpline n d a -&gt; f (BezierSpline n d b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span id="local-6989586621680053418"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621680053418"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span id="local-6989586621680053417"><span class="annot"><span class="annottext">LSeq (1 + n) (Point d a)
</span><a href="#local-6989586621680053417"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d b) -&gt; BezierSpline n d b
forall (n :: Nat) (d :: Nat) r.
LSeq (1 + n) (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-var">BezierSpline</span></a></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d b) -&gt; BezierSpline n d b)
-&gt; f (LSeq (1 + n) (Point d b)) -&gt; f (BezierSpline n d b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Point d a -&gt; f (Point d b))
-&gt; LSeq (1 + n) (Point d a) -&gt; f (LSeq (1 + n) (Point d b))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Point d a -&gt; f (Point d b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621680053418"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d a)
</span><a href="#local-6989586621680053417"><span class="hs-identifier hs-var">ps</span></a></span></span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621680053414"><span id="local-6989586621680053415"><span id="local-6989586621680053416"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053416"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053415"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680053415"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053414"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.Transformation.Internal.html#IsTransformable"><span class="hs-identifier hs-type">IsTransformable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053414"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053415"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053416"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621680053411"><span class="annot"><span class="annottext">transformBy :: Transformation
  (Dimension (BezierSpline n d r)) (NumType (BezierSpline n d r))
-&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.Transformation.Internal.html#transformBy"><span class="hs-identifier hs-var hs-var hs-var hs-var">transformBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transformation
  (Dimension (BezierSpline n d r)) (NumType (BezierSpline n d r))
-&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall (g :: * -&gt; *) r (d :: Nat).
(PointFunctor g, Fractional r, d ~ Dimension (g r), Arity d,
 Arity (d + 1)) =&gt;
Transformation d r -&gt; g r -&gt; g r
</span><a href="Geometry.Transformation.Internal.html#transformPointFunctor"><span class="hs-identifier hs-var">transformPointFunctor</span></a></span></span></span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621680053407"><span id="local-6989586621680053408"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#PointFunctor"><span class="hs-identifier hs-type">PointFunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053408"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053407"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621680053404"><span class="annot"><span class="annottext">pmap :: (Point (Dimension (BezierSpline n d r)) r
 -&gt; Point (Dimension (BezierSpline n d s)) s)
-&gt; BezierSpline n d r -&gt; BezierSpline n d s
</span><a href="Geometry.Point.Internal.html#pmap"><span class="hs-identifier hs-var hs-var hs-var hs-var">pmap</span></a></span></span><span> </span><span id="local-6989586621680053402"><span class="annot"><span class="annottext">Point (Dimension (BezierSpline n d r)) r
-&gt; Point (Dimension (BezierSpline n d s)) s
</span><a href="#local-6989586621680053402"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  (BezierSpline n d r)
  (BezierSpline n d s)
  (LSeq (1 + n) (Point d r))
  (LSeq (1 + n) (Point d s))
-&gt; (LSeq (1 + n) (Point d r) -&gt; LSeq (1 + n) (Point d s))
-&gt; BezierSpline n d r
-&gt; BezierSpline n d s
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (BezierSpline n d r)
  (BezierSpline n d s)
  (LSeq (1 + n) (Point d r))
  (LSeq (1 + n) (Point d s))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point d r -&gt; Point d s)
-&gt; LSeq (1 + n) (Point d r) -&gt; LSeq (1 + n) (Point d s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d s
Point (Dimension (BezierSpline n d r)) r
-&gt; Point (Dimension (BezierSpline n d s)) s
</span><a href="#local-6989586621680053402"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Convert a quadratic bezier to a cubic bezier.</span><span>
</span><span id="line-141"></span><span id="local-6989586621680053400"><span class="annot"><a href="Geometry.BezierSpline.html#quadToCubic"><span class="hs-identifier hs-type">quadToCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053400"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053400"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053400"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-142"></span><span id="quadToCubic"><span class="annot"><span class="annottext">quadToCubic :: BezierSpline 2 2 r -&gt; BezierSpline 3 2 r
</span><a href="Geometry.BezierSpline.html#quadToCubic"><span class="hs-identifier hs-var hs-var">quadToCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier2"><span class="hs-identifier hs-type">Bezier2</span></a></span><span> </span><span id="local-6989586621680053399"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053399"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621680053397"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621680053397"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680053396"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053396"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">Point 2 r
-&gt; Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; BezierSpline 3 2 r
forall (d :: Nat) r.
Point d r
-&gt; Point d r -&gt; Point d r -&gt; Point d r -&gt; BezierSpline 3 d r
</span><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-identifier hs-var">Bezier3</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053399"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Point 2 r
forall (d :: Nat) r. Vector d r -&gt; Point d r
</span><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 r -&gt; Point 2 r) -&gt; Vector 2 r -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r
</span><a href="Geometry.Point.Internal.html#toVec"><span class="hs-identifier hs-var hs-var">toVec</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053399"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Additive f, Num a) =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621680053397"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Point 2 r
forall (d :: Nat) r. Vector d r -&gt; Point d r
</span><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 r -&gt; Point 2 r) -&gt; Vector 2 r -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621680053397"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r -&gt; Vector 2 r
forall (f :: * -&gt; *) a. (Additive f, Num a) =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r
</span><a href="Geometry.Point.Internal.html#toVec"><span class="hs-identifier hs-var hs-var">toVec</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053396"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053396"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Reverse a BezierSpline</span><span>
</span><span id="line-148"></span><span id="local-6989586621680053389"><span id="local-6989586621680053390"><span id="local-6989586621680053391"><span class="annot"><a href="Geometry.BezierSpline.html#reverse"><span class="hs-identifier hs-type">reverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053391"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053390"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053390"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053389"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053391"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053390"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053389"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053391"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053390"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-149"></span><span id="reverse"><span class="annot"><span class="annottext">reverse :: BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#reverse"><span class="hs-identifier hs-var hs-var">reverse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r) -&gt; Identity (LSeq (1 + n) (Point d r)))
-&gt; BezierSpline n d r -&gt; Identity (BezierSpline n d r)
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">((LSeq (1 + n) (Point d r) -&gt; Identity (LSeq (1 + n) (Point d r)))
 -&gt; BezierSpline n d r -&gt; Identity (BezierSpline n d r))
-&gt; (LSeq (1 + n) (Point d r) -&gt; LSeq (1 + n) (Point d r))
-&gt; BezierSpline n d r
-&gt; BezierSpline n d r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; LSeq (1 + n) (Point d r)
forall (n :: Nat) a. LSeq n a -&gt; LSeq n a
</span><span class="hs-identifier hs-var">LSeq.reverse</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Evaluate a BezierSpline curve at time t in [0, 1]</span><span>
</span><span id="line-153"></span><span class="hs-comment">--</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- pre: \(t \in [0,1]\)</span><span>
</span><span id="line-155"></span><span id="local-6989586621680053698"><span id="local-6989586621680053699"><span id="local-6989586621680053700"><span class="annot"><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-type">evaluate</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053700"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680053699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053698"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053700"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053700"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053699"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-156"></span><span id="evaluate"><span class="annot"><span class="annottext">evaluate :: BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var hs-var">evaluate</span></a></span></span><span> </span><span id="local-6989586621680053386"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053386"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point d r, Point d r) -&gt; Point d r)
-&gt; (Point d r, Point d r) -&gt; Point d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053386"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span id="local-6989586621680053385"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053385"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point d r, Point d r) -&gt; Point d r)
-&gt; (Point d r, Point d r) -&gt; Point d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span id="local-6989586621680053384"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053384"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053383"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053383"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Point d r
</span><a href="#local-6989586621680053382"><span class="hs-identifier hs-var">evaluate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053384"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting (Seq (Point d r)) (BezierSpline n d r) (Seq (Point d r))
-&gt; Seq (Point d r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r)
 -&gt; Const (Seq (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; BezierSpline n d r
-&gt; Const (Seq (Point d r)) (BezierSpline n d r)
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span class="annot"><span class="annottext">((LSeq (1 + n) (Point d r)
  -&gt; Const (Seq (Point d r)) (LSeq (1 + n) (Point d r)))
 -&gt; BezierSpline n d r
 -&gt; Const (Seq (Point d r)) (BezierSpline n d r))
-&gt; ((Seq (Point d r) -&gt; Const (Seq (Point d r)) (Seq (Point d r)))
    -&gt; LSeq (1 + n) (Point d r)
    -&gt; Const (Seq (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; Getting (Seq (Point d r)) (BezierSpline n d r) (Seq (Point d r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r) -&gt; Seq (Point d r))
-&gt; (Seq (Point d r) -&gt; Const (Seq (Point d r)) (Seq (Point d r)))
-&gt; LSeq (1 + n) (Point d r)
-&gt; Const (Seq (Point d r)) (LSeq (1 + n) (Point d r))
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; Seq (Point d r)
forall (n :: Nat) a. LSeq n a -&gt; Seq a
</span><span class="hs-identifier hs-var">LSeq.toSeq</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621680053382"><span class="annot"><span class="annottext">evaluate' :: Seq (Point d r) -&gt; Point d r
</span><a href="#local-6989586621680053382"><span class="hs-identifier hs-var hs-var">evaluate'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680053378"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053378"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><span class="hs-identifier hs-var">Empty</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053378"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span id="local-6989586621680053375"><span class="annot"><span class="annottext">pts :: Seq (Point d r)
</span><a href="#local-6989586621680053375"><span class="hs-identifier hs-var">pts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621680053374"><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053374"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053373"><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053373"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053375"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Point d r
</span><a href="#local-6989586621680053382"><span class="hs-identifier hs-var">evaluate'</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; Point d r) -&gt; Seq (Point d r) -&gt; Point d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point d r -&gt; Point d r -&gt; Point d r)
-&gt; Seq (Point d r) -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a b c. (a -&gt; b -&gt; c) -&gt; Seq a -&gt; Seq b -&gt; Seq c
</span><span class="hs-identifier hs-var">Seq.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Point d r
</span><a href="#local-6989586621680053370"><span class="hs-identifier hs-var">blend</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053373"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053374"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Point d r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;evaluate: absurd&quot;</span></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621680053370"><span class="annot"><span class="annottext">blend :: Point d r -&gt; Point d r -&gt; Point d r
</span><a href="#local-6989586621680053370"><span class="hs-identifier hs-var hs-var">blend</span></a></span></span><span> </span><span id="local-6989586621680053368"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053368"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053367"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053367"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053368"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Diff (Point d) r -&gt; Point d r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; Diff p a -&gt; p a
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053383"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Vector d r -&gt; Vector d r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053367"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Diff (Point d) r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; p a -&gt; Diff p a
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053368"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Extract a tangent vector from the first to the second control point.</span><span>
</span><span id="line-167"></span><span id="local-6989586621680053362"><span id="local-6989586621680053363"><span id="local-6989586621680053364"><span class="annot"><a href="Geometry.BezierSpline.html#tangent"><span class="hs-identifier hs-type">tangent</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053364"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621680053362"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053362"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053364"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053363"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053364"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053363"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-168"></span><span id="tangent"><span class="annot"><span class="annottext">tangent :: BezierSpline n d r -&gt; Vector d r
</span><a href="Geometry.BezierSpline.html#tangent"><span class="hs-identifier hs-var hs-var">tangent</span></a></span></span><span> </span><span id="local-6989586621680053360"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053360"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053360"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting (Endo (Point d r)) (BezierSpline n d r) (Point d r)
-&gt; Point d r
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r)
 -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; BezierSpline n d r
-&gt; Const (Endo (Point d r)) (BezierSpline n d r)
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span class="annot"><span class="annottext">((LSeq (1 + n) (Point d r)
  -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
 -&gt; BezierSpline n d r
 -&gt; Const (Endo (Point d r)) (BezierSpline n d r))
-&gt; ((Point d r -&gt; Const (Endo (Point d r)) (Point d r))
    -&gt; LSeq (1 + n) (Point d r)
    -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; Getting (Endo (Point d r)) (BezierSpline n d r) (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (LSeq (1 + n) (Point d r))
-&gt; Traversal'
     (LSeq (1 + n) (Point d r)) (IxValue (LSeq (1 + n) (Point d r)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index (LSeq (1 + n) (Point d r))
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Diff (Point d) r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; p a -&gt; Diff p a
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053360"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting (Endo (Point d r)) (BezierSpline n d r) (Point d r)
-&gt; Point d r
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r)
 -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; BezierSpline n d r
-&gt; Const (Endo (Point d r)) (BezierSpline n d r)
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span class="annot"><span class="annottext">((LSeq (1 + n) (Point d r)
  -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
 -&gt; BezierSpline n d r
 -&gt; Const (Endo (Point d r)) (BezierSpline n d r))
-&gt; ((Point d r -&gt; Const (Endo (Point d r)) (Point d r))
    -&gt; LSeq (1 + n) (Point d r)
    -&gt; Const (Endo (Point d r)) (LSeq (1 + n) (Point d r)))
-&gt; Getting (Endo (Point d r)) (BezierSpline n d r) (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (LSeq (1 + n) (Point d r))
-&gt; Traversal'
     (LSeq (1 + n) (Point d r)) (IxValue (LSeq (1 + n) (Point d r)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index (LSeq (1 + n) (Point d r))
</span><span class="hs-number">0</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Return the endpoints of the Bezier spline.</span><span>
</span><span id="line-171"></span><span id="local-6989586621680053864"><span id="local-6989586621680053865"><span id="local-6989586621680053866"><span class="annot"><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-type">endPoints</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053866"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053865"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053864"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053865"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053864"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053865"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053864"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-172"></span><span id="endPoints"><span class="annot"><span class="annottext">endPoints :: BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var hs-var">endPoints</span></a></span></span><span> </span><span id="local-6989586621680053357"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053357"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053356"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053356"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">LSeq.:&lt;|</span></span><span> </span><span class="annot"><span class="annottext">LSeq n (Point d r)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053357"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting
     (LSeq (1 + n) (Point d r))
     (BezierSpline n d r)
     (LSeq (1 + n) (Point d r))
-&gt; LSeq (1 + n) (Point d r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point d r))
  (BezierSpline n d r)
  (LSeq (1 + n) (Point d r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span>
</span><span id="line-173"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LSeq n (Point d r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">LSeq.:|&gt;</span></span><span> </span><span id="local-6989586621680053353"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053353"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053357"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting
     (LSeq (1 + n) (Point d r))
     (BezierSpline n d r)
     (LSeq (1 + n) (Point d r))
-&gt; LSeq (1 + n) (Point d r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point d r))
  (BezierSpline n d r)
  (LSeq (1 + n) (Point d r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span>
</span><span id="line-174"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053356"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053353"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Restrict a Bezier curve to the piece between parameters t &lt; u in [0, 1].</span><span>
</span><span id="line-180"></span><span id="local-6989586621680053350"><span id="local-6989586621680053351"><span id="local-6989586621680053352"><span class="annot"><a href="Geometry.BezierSpline.html#subBezier"><span class="hs-identifier hs-type">subBezier</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053352"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053351"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053352"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053351"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053352"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053351"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053350"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-182"></span><span id="subBezier"><span class="annot"><span class="annottext">subBezier :: r -&gt; r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#subBezier"><span class="hs-identifier hs-var hs-var">subBezier</span></a></span></span><span> </span><span id="local-6989586621680053349"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053349"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053348"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053348"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r))
-&gt; BezierSpline n d r
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053348"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r))
-&gt; (BezierSpline n d r -&gt; BezierSpline n d r)
-&gt; BezierSpline n d r
-&gt; (BezierSpline n d r, BezierSpline n d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r))
-&gt; BezierSpline n d r
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053349"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Compute the convex hull of the control polygon of a 2-dimensional Bezier curve.</span><span>
</span><span id="line-186"></span><span class="hs-comment">--   Should also work in any dimension, but convex hull is not yet implemented.</span><span>
</span><span id="line-187"></span><span id="local-6989586621680053667"><span id="local-6989586621680053668"><span class="annot"><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-type">convexHullB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053668"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053668"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053667"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053668"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Convex.html#ConvexPolygon"><span class="hs-identifier hs-type">ConvexPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053668"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-188"></span><span id="convexHullB"><span class="annot"><span class="annottext">convexHullB :: BezierSpline n 2 r -&gt; ConvexPolygon () r
</span><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-var hs-var">convexHullB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ ()) -&gt; ConvexPolygon () r
forall r p.
(Ord r, Num r) =&gt;
NonEmpty (Point 2 r :+ p) -&gt; ConvexPolygon p r
</span><a href="Algorithms.Geometry.ConvexHull.GrahamScan.html#convexHull"><span class="hs-identifier hs-var">convexHull</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Point 2 r :+ ()) -&gt; ConvexPolygon () r)
-&gt; (BezierSpline n 2 r -&gt; NonEmpty (Point 2 r :+ ()))
-&gt; BezierSpline n 2 r
-&gt; ConvexPolygon () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ ()] -&gt; NonEmpty (Point 2 r :+ ())
forall a. [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ ()] -&gt; NonEmpty (Point 2 r :+ ()))
-&gt; (BezierSpline n 2 r -&gt; [Point 2 r :+ ()])
-&gt; BezierSpline n 2 r
-&gt; NonEmpty (Point 2 r :+ ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 r :+ ()) -&gt; [Point 2 r] -&gt; [Point 2 r :+ ()]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [Point 2 r :+ ()])
-&gt; (BezierSpline n 2 r -&gt; [Point 2 r])
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r :+ ()]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r])
-&gt; (BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r))
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Split a Bezier curve at time t in [0, 1] into two pieces.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-type">split</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053820"><span class="annot"><a href="#local-6989586621680053820"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053819"><span class="annot"><a href="#local-6989586621680053819"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053818"><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053820"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053819"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053820"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053819"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053820"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053819"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053820"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053819"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span id="split"><span class="annot"><span class="annottext">split :: r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621680053343"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053343"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053342"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053342"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053343"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (BezierSpline n d r, BezierSpline n d r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;split: t &lt; 0&quot;</span></span><span> </span><span class="hs-comment">-- ++ show t ++ &quot; &lt; 0&quot;</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053343"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (BezierSpline n d r, BezierSpline n d r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;split: t &gt; 1&quot;</span></span><span> </span><span class="hs-comment">-- ++ show t ++ &quot; &gt; 1&quot;</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var">splitRaw</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053343"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053342"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Split without parameter check. If t outside [0,1], will actually extend the curve</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   rather than split it.</span><span>
</span><span id="line-202"></span><span class="annot"><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-type">splitRaw</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053338"><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053337"><span class="annot"><a href="#local-6989586621680053337"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053336"><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053337"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053337"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053337"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053337"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="splitRaw"><span class="annot"><span class="annottext">splitRaw :: r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var hs-var">splitRaw</span></a></span></span><span> </span><span id="local-6989586621680053335"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053335"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053334"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053334"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053333"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680053333"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Int) -&gt; Natural -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">C n -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">C n
forall (n :: Nat). C n
</span><a href="Geometry.Vector.VectorFixed.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680053338"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>                   </span><span id="local-6989586621680053332"><span class="annot"><span class="annottext">ps :: Seq (Point d r)
</span><a href="#local-6989586621680053332"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; LSeq (1 + n) (Point d r) -&gt; Seq (Point d r)
forall (d :: Nat) r (n :: Nat).
(Arity d, Ord r, Num r) =&gt;
r -&gt; LSeq n (Point d r) -&gt; Seq (Point d r)
</span><a href="Geometry.BezierSpline.html#collect"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053335"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r) -&gt; Seq (Point d r))
-&gt; LSeq (1 + n) (Point d r) -&gt; Seq (Point d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053334"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">BezierSpline n d r
-&gt; Getting
     (LSeq (1 + n) (Point d r))
     (BezierSpline n d r)
     (LSeq (1 + n) (Point d r))
-&gt; LSeq (1 + n) (Point d r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point d r))
  (BezierSpline n d r)
  (LSeq (1 + n) (Point d r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span>
</span><span id="line-206"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline n d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; (Seq (Point d r) -&gt; Seq (Point d r))
-&gt; Seq (Point d r)
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053333"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; Seq (Point d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053332"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-207"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline n d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; (Seq (Point d r) -&gt; Seq (Point d r))
-&gt; Seq (Point d r)
-&gt; BezierSpline n d r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053333"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; Seq (Point d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053332"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-208"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | implementation of splitRaw</span><span>
</span><span id="line-211"></span><span id="local-6989586621680053799"><span id="local-6989586621680053800"><span id="local-6989586621680053801"><span class="annot"><a href="Geometry.BezierSpline.html#collect"><span class="hs-identifier hs-type">collect</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053801"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053800"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="annot"><a href="#local-6989586621680053799"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053801"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053801"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-212"></span><span id="collect"><span class="annot"><span class="annottext">collect :: r -&gt; LSeq n (Point d r) -&gt; Seq (Point d r)
</span><a href="Geometry.BezierSpline.html#collect"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span id="local-6989586621680053328"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053328"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053327"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; Seq (Point d r))
-&gt; (LSeq n (Point d r) -&gt; Seq (Point d r))
-&gt; LSeq n (Point d r)
-&gt; Seq (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LSeq n (Point d r) -&gt; Seq (Point d r)
forall (n :: Nat) a. LSeq n a -&gt; Seq a
</span><span class="hs-identifier hs-var">LSeq.toSeq</span></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621680053327"><span class="annot"><span class="annottext">go :: Seq (Point d r) -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053327"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621680053326"><span class="annot"><span class="annottext">ps :: Seq (Point d r)
</span><a href="#local-6989586621680053326"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><span class="hs-identifier hs-var">Empty</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053326"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span id="local-6989586621680053325"><span class="annot"><span class="annottext">ps :: Seq (Point d r)
</span><a href="#local-6989586621680053325"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680053324"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053324"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621680053323"><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053323"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053322"><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053322"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span> </span><span id="local-6989586621680053321"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053321"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053325"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053324"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">:&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053327"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point d r -&gt; Point d r -&gt; Point d r)
-&gt; Seq (Point d r) -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a b c. (a -&gt; b -&gt; c) -&gt; Seq a -&gt; Seq b -&gt; Seq c
</span><span class="hs-identifier hs-var">Seq.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Point d r
</span><a href="#local-6989586621680053320"><span class="hs-identifier hs-var">blend</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053322"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><a href="#local-6989586621680053323"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Point d r -&gt; Seq (Point d r)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">:|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053321"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">Seq (Point d r)
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Seq (Point d r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;collect: absurd&quot;</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621680053320"><span class="annot"><span class="annottext">blend :: Point d r -&gt; Point d r -&gt; Point d r
</span><a href="#local-6989586621680053320"><span class="hs-identifier hs-var hs-var">blend</span></a></span></span><span> </span><span id="local-6989586621680053319"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053319"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053318"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053318"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053319"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Diff (Point d) r -&gt; Point d r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; Diff p a -&gt; p a
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053328"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Vector d r -&gt; Vector d r
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053318"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Diff (Point d) r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; p a -&gt; Diff p a
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053319"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Split a Bezier curve into many pieces.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   Todo: filter out duplicate parameter values!</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Geometry.BezierSpline.html#splitMany"><span class="hs-identifier hs-type">splitMany</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053782"><span class="annot"><a href="#local-6989586621680053782"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053781"><span class="annot"><a href="#local-6989586621680053781"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053780"><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053782"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053781"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053782"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053781"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053782"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053781"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span id="splitMany"><span class="annot"><span class="annottext">splitMany :: [r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="Geometry.BezierSpline.html#splitMany"><span class="hs-identifier hs-var hs-var">splitMany</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="#local-6989586621680053317"><span class="hs-identifier hs-var">splitManySorted</span></a></span><span> </span><span class="annot"><span class="annottext">([r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r])
-&gt; ([r] -&gt; [r])
-&gt; [r]
-&gt; BezierSpline n d r
-&gt; [BezierSpline n d r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[r] -&gt; [r]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">([r] -&gt; [r]) -&gt; ([r] -&gt; [r]) -&gt; [r] -&gt; [r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; [r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; r -&gt; r -&gt; r -&gt; r
forall r. Ord r =&gt; String -&gt; r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitMany&quot;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680053317"><span class="annot"><span class="annottext">splitManySorted :: [r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="#local-6989586621680053317"><span class="hs-identifier hs-var hs-var">splitManySorted</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621680053315"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053315"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053315"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><a href="#local-6989586621680053317"><span class="hs-identifier hs-var">splitManySorted</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053314"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053314"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680053313"><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621680053313"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680053312"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053312"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053311"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053311"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053310"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053310"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053314"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053312"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-229"></span><span>                                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053311"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; [BezierSpline n d r] -&gt; [BezierSpline n d r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="#local-6989586621680053317"><span class="hs-identifier hs-var">splitManySorted</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; [r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621680053309"><span class="hs-identifier hs-var">rescale</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053314"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621680053313"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053310"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="#local-6989586621680053309"><span class="hs-identifier hs-type">rescale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053780"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621680053309"><span class="annot"><span class="annottext">rescale :: r -&gt; r -&gt; r
</span><a href="#local-6989586621680053309"><span class="hs-identifier hs-var hs-var">rescale</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><a href="#local-6989586621680053309"><span class="hs-identifier hs-var">rescale</span></a></span><span> </span><span id="local-6989586621680053308"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053308"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053307"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053307"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053307"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053308"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053308"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Cut a Bezier curve into $x_i$-monotone pieces.</span><span>
</span><span id="line-236"></span><span class="hs-comment">--   Can only be solved exactly for degree 4 or smaller.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--   Only gives rational result for degree 2 or smaller.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--   Currentlly implemented for degree 3.</span><span>
</span><span id="line-239"></span><span id="local-6989586621680053305"><span id="local-6989586621680053306"><span class="annot"><a href="Geometry.BezierSpline.html#splitMonotone"><span class="hs-identifier hs-type">splitMonotone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053306"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Radical.Radical</span></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621680053306"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621680053306"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-240"></span><span id="splitMonotone"><span class="annot"><span class="annottext">splitMonotone :: Int -&gt; BezierSpline 3 d r -&gt; [BezierSpline 3 d r]
</span><a href="Geometry.BezierSpline.html#splitMonotone"><span class="hs-identifier hs-var hs-var">splitMonotone</span></a></span></span><span> </span><span id="local-6989586621680053304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053304"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680053303"><span class="annot"><span class="annottext">BezierSpline 3 d r
</span><a href="#local-6989586621680053303"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[r] -&gt; BezierSpline 3 d r -&gt; [BezierSpline 3 d r]
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
[r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="Geometry.BezierSpline.html#splitMany"><span class="hs-identifier hs-var">splitMany</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BezierSpline 3 d r -&gt; [r]
forall (d :: Nat) r.
(Arity d, Ord r, Enum r, Fractional r, Radical r) =&gt;
Int -&gt; BezierSpline 3 d r -&gt; [r]
</span><a href="Geometry.BezierSpline.html#locallyExtremalParameters"><span class="hs-identifier hs-var">locallyExtremalParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053304"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline 3 d r
</span><a href="#local-6989586621680053303"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BezierSpline 3 d r
</span><a href="#local-6989586621680053303"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">{-
type family RealTypeConstraint (n :: Nat) (r :: *) :: Constraint where
  RealTypeConstraint 1 r = (Fractional r)
  RealTypeConstraint 2 r = (Fractional r)
  RealTypeConstraint 3 r = (Floating r)
  RealTypeConstraint 4 r = (Floating r)
  RealTypeConstraint 5 r = (Floating r)
  RealTypeConstraint n r = TypeError &quot;&quot;
-}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Report all parameter values at which the derivative of the $i$th coordinate is 0.</span><span>
</span><span id="line-253"></span><span id="local-6989586621680053778"><span id="local-6989586621680053779"><span class="annot"><a href="Geometry.BezierSpline.html#locallyExtremalParameters"><span class="hs-identifier hs-type">locallyExtremalParameters</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053779"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Radical.Radical</span></span><span> </span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>                                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621680053779"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680053778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-255"></span><span id="locallyExtremalParameters"><span class="annot"><span class="annottext">locallyExtremalParameters :: Int -&gt; BezierSpline 3 d r -&gt; [r]
</span><a href="Geometry.BezierSpline.html#locallyExtremalParameters"><span class="hs-identifier hs-var hs-var">locallyExtremalParameters</span></a></span></span><span> </span><span id="local-6989586621680053301"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053301"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680053300"><span class="annot"><span class="annottext">BezierSpline 3 d r
</span><a href="#local-6989586621680053300"><span class="hs-identifier hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680053299"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053299"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053298"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053298"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053297"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053297"><span class="hs-identifier hs-var">x3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053296"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053296"><span class="hs-identifier hs-var">x4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r -&gt; r) -&gt; [Point d r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting r (Point d r) r -&gt; Point d r -&gt; r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">(Getting r (Point d r) r -&gt; Point d r -&gt; r)
-&gt; Getting r (Point d r) r -&gt; Point d r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Lens' (Point d r) r
forall (d :: Nat) (p :: Nat -&gt; * -&gt; *) r.
(Arity d, AsAPoint p) =&gt;
Int -&gt; Lens' (p d r) r
</span><a href="Geometry.Point.Class.html#unsafeCoord"><span class="hs-identifier hs-var">unsafeCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680053301"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; [r]) -&gt; [Point d r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LSeq 4 (Point d r) -&gt; [Point d r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq 4 (Point d r) -&gt; [Point d r])
-&gt; LSeq 4 (Point d r) -&gt; [Point d r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline 3 d r -&gt; LSeq (1 + 3) (Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline 3 d r
</span><a href="#local-6989586621680053300"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621680053293"><span class="annot"><span class="annottext">a :: r
</span><a href="#local-6989586621680053293"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053296"><span class="hs-identifier hs-var">x4</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053297"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053298"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053299"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span id="local-6989586621680053291"><span class="annot"><span class="annottext">b :: r
</span><a href="#local-6989586621680053291"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053299"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">12</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053298"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053297"><span class="hs-identifier hs-var">x3</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621680053290"><span class="annot"><span class="annottext">c :: r
</span><a href="#local-6989586621680053290"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053298"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053299"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Bool) -&gt; [r] -&gt; [r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680053289"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053289"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053289"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053289"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([r] -&gt; [r]) -&gt; [r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r -&gt; [r]
forall r.
(Ord r, Enum r, Fractional r, Radical r) =&gt;
r -&gt; r -&gt; r -&gt; [r]
</span><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053293"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053291"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053290"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- | Subdivide a curve based on a sequence of points.</span><span>
</span><span id="line-264"></span><span class="hs-comment">--   Assumes these points are all supposed to lie on the curve, and</span><span>
</span><span id="line-265"></span><span class="hs-comment">--   snaps endpoints of pieces to these points.</span><span>
</span><span id="line-266"></span><span class="hs-comment">--   (higher dimensions would work, but depends on convex hull)</span><span>
</span><span id="line-267"></span><span id="local-6989586621680053284"><span id="local-6989586621680053285"><span class="annot"><a href="Geometry.BezierSpline.html#splitByPoints"><span class="hs-identifier hs-type">splitByPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053285"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053285"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053285"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-269"></span><span id="splitByPoints"><span class="annot"><span class="annottext">splitByPoints :: r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [BezierSpline n 2 r]
</span><a href="Geometry.BezierSpline.html#splitByPoints"><span class="hs-identifier hs-var hs-var">splitByPoints</span></a></span></span><span> </span><span id="local-6989586621680053283"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053283"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053282"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053282"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span id="local-6989586621680053281"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053281"><span class="hs-identifier hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053280"><span class="annot"><span class="annottext">a :: Point 2 r
</span><a href="#local-6989586621680053280"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053281"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621680053279"><span class="annot"><span class="annottext">b :: Point 2 r
</span><a href="#local-6989586621680053279"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053281"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span id="local-6989586621680053278"><span class="annot"><span class="annottext">intern :: [Point 2 r]
</span><a href="#local-6989586621680053278"><span class="hs-identifier hs-var hs-var">intern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680053277"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053277"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053277"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053280"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053277"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053279"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053282"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span id="local-6989586621680053275"><span class="annot"><span class="annottext">times :: [r]
</span><a href="#local-6989586621680053275"><span class="hs-identifier hs-var hs-var">times</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; r) -&gt; [Point 2 r] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterOf"><span class="hs-identifier hs-var">parameterOf</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053283"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053281"><span class="hs-identifier hs-var">curve</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053278"><span class="hs-identifier hs-var">intern</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span id="local-6989586621680053274"><span class="annot"><span class="annottext">tipos :: [(r, Point 2 r)]
</span><a href="#local-6989586621680053274"><span class="hs-identifier hs-var hs-var">tipos</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, Point 2 r)] -&gt; [(r, Point 2 r)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">([(r, Point 2 r)] -&gt; [(r, Point 2 r)])
-&gt; [(r, Point 2 r)] -&gt; [(r, Point 2 r)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[r] -&gt; [Point 2 r] -&gt; [(r, Point 2 r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621680053275"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053278"><span class="hs-identifier hs-var">intern</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621680053273"><span class="annot"><span class="annottext">pieces :: [BezierSpline n 2 r]
</span><a href="#local-6989586621680053273"><span class="hs-identifier hs-var hs-var">pieces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[r] -&gt; BezierSpline n 2 r -&gt; [BezierSpline n 2 r]
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
[r] -&gt; BezierSpline n d r -&gt; [BezierSpline n d r]
</span><a href="Geometry.BezierSpline.html#splitMany"><span class="hs-identifier hs-var">splitMany</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((r, Point 2 r) -&gt; r) -&gt; [(r, Point 2 r)] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(r, Point 2 r) -&gt; r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(r, Point 2 r)]
</span><a href="#local-6989586621680053274"><span class="hs-identifier hs-var">tipos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053281"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span id="local-6989586621680053272"><span class="annot"><span class="annottext">stapts :: [Point 2 r]
</span><a href="#local-6989586621680053272"><span class="hs-identifier hs-var hs-var">stapts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053280"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((r, Point 2 r) -&gt; Point 2 r) -&gt; [(r, Point 2 r)] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(r, Point 2 r)]
</span><a href="#local-6989586621680053274"><span class="hs-identifier hs-var">tipos</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621680053271"><span class="annot"><span class="annottext">endpts :: [Point 2 r]
</span><a href="#local-6989586621680053271"><span class="hs-identifier hs-var hs-var">endpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((r, Point 2 r) -&gt; Point 2 r) -&gt; [(r, Point 2 r)] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(r, Point 2 r)]
</span><a href="#local-6989586621680053274"><span class="hs-identifier hs-var">tipos</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053279"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Point 2 r
 -&gt; Point 2 r -&gt; BezierSpline n 2 r -&gt; BezierSpline n 2 r)
-&gt; [Point 2 r]
-&gt; [Point 2 r]
-&gt; [BezierSpline n 2 r]
-&gt; [BezierSpline n 2 r]
forall a b c d. (a -&gt; b -&gt; c -&gt; d) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d]
</span><span class="hs-identifier hs-var">zipWith3</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; BezierSpline n 2 r -&gt; BezierSpline n 2 r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
Point d r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#snapEndpoints"><span class="hs-identifier hs-var">snapEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053272"><span class="hs-identifier hs-var">stapts</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053271"><span class="hs-identifier hs-var">endpts</span></a></span><span> </span><span class="annot"><span class="annottext">[BezierSpline n 2 r]
</span><a href="#local-6989586621680053273"><span class="hs-identifier hs-var">pieces</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Extend a Bezier curve to a parameter value t outside the interval [0,1].</span><span>
</span><span id="line-283"></span><span class="hs-comment">--   For t &lt; 0, returns a Bezier representation of the section of the underlying curve</span><span>
</span><span id="line-284"></span><span class="hs-comment">--   from parameter value t until paramater value 0. For t &gt; 1, the same from 1 to t.</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- pre: t outside [0,1]</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Geometry.BezierSpline.html#extension"><span class="hs-identifier hs-type">extension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053268"><span class="annot"><a href="#local-6989586621680053268"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053267"><span class="annot"><a href="#local-6989586621680053267"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053266"><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053268"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053267"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053267"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053267"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053266"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-289"></span><span id="extension"><span class="annot"><span class="annottext">extension :: r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#extension"><span class="hs-identifier hs-var hs-var">extension</span></a></span></span><span> </span><span id="local-6989586621680053265"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053264"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053264"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BezierSpline n d r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extension: 0 &lt; t &lt; 1&quot;</span></span><span> </span><span class="hs-comment">-- ++ show t ++ &quot; &lt; 1&quot;</span><span>
</span><span id="line-290"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var">splitRaw</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053264"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-291"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">{- t &gt;= 1-}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var">splitRaw</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053265"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053264"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Extend a Bezier curve to a parameter value t outside the interval [0,1].</span><span>
</span><span id="line-294"></span><span class="hs-comment">--   For t &lt; 0, returns a Bezier representation of the section of the underlying curve</span><span>
</span><span id="line-295"></span><span class="hs-comment">--   from parameter value t until paramater value 1. For t &gt; 1, the same from 0 to t.</span><span>
</span><span id="line-296"></span><span class="hs-comment">--</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- pre: t outside [0,1]</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Geometry.BezierSpline.html#extend"><span class="hs-identifier hs-type">extend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053737"><span class="annot"><a href="#local-6989586621680053737"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680053736"><span class="annot"><a href="#local-6989586621680053736"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680053735"><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053737"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053736"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053737"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053736"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053737"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053736"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053735"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-300"></span><span id="extend"><span class="annot"><span class="annottext">extend :: r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#extend"><span class="hs-identifier hs-var hs-var">extend</span></a></span></span><span> </span><span id="local-6989586621680053263"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053262"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053262"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BezierSpline n d r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extend: 0 &lt; t &lt; 1&quot;</span></span><span> </span><span class="hs-comment">-- ++ show t ++ &quot; &lt; 1&quot;</span><span>
</span><span id="line-301"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var">splitRaw</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053262"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-302"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">{- t &gt;= 1 -}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r)
-&gt; (BezierSpline n d r, BezierSpline n d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#splitRaw"><span class="hs-identifier hs-var">splitRaw</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053262"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Extend a Bezier curve to a point not on the curve, but on / close</span><span>
</span><span id="line-306"></span><span class="hs-comment">--   to the extended underlying curve.</span><span>
</span><span id="line-307"></span><span id="local-6989586621680053729"><span id="local-6989586621680053730"><span id="local-6989586621680053731"><span class="annot"><a href="Geometry.BezierSpline.html#growTo"><span class="hs-identifier hs-type">growTo</span></a></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053731"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053730"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053730"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053731"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053730"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053731"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053730"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053729"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-309"></span><span id="growTo"><span class="annot"><span class="annottext">growTo :: r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#growTo"><span class="hs-identifier hs-var hs-var">growTo</span></a></span></span><span> </span><span id="local-6989586621680053261"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053261"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053260"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053260"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053259"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053259"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053258"><span class="annot"><span class="annottext">t :: r
</span><a href="#local-6989586621680053258"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; Point d r -&gt; r
forall (d :: Nat) (n :: Nat) r.
(Arity d, KnownNat n, Ord r, Fractional r) =&gt;
r -&gt; BezierSpline n d r -&gt; Point d r -&gt; r
</span><a href="Geometry.BezierSpline.html#extendedParameterOf"><span class="hs-identifier hs-var">extendedParameterOf</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053261"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053259"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053260"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621680053256"><span class="annot"><span class="annottext">r :: BezierSpline n d r
</span><a href="#local-6989586621680053256"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053258"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#extend"><span class="hs-identifier hs-var">extend</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053258"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053259"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053258"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#extend"><span class="hs-identifier hs-var">extend</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053258"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053259"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053259"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053256"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">{-

-- | Tries to fit a degree n Bezier curve through a list of points, with error parameter eps.
--   Either returns an appropriate curve, or fails.
fit :: r -&gt; [Point 2 r] -&gt; Maybe (Bezier n d r)
fit eps pts

-}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Merge two Bezier pieces. Assumes they can be merged into a single piece of the same degree</span><span>
</span><span id="line-329"></span><span class="hs-comment">--   (as would e.g. be the case for the result of a 'split' operation).</span><span>
</span><span id="line-330"></span><span class="hs-comment">--   Does not test whether this is the case!</span><span>
</span><span id="line-331"></span><span id="local-6989586621680053253"><span id="local-6989586621680053254"><span id="local-6989586621680053255"><span class="annot"><a href="Geometry.BezierSpline.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053255"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053254"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053254"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053254"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053254"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053253"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-333"></span><span id="merge"><span class="annot"><span class="annottext">merge :: r -&gt; BezierSpline n d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621680053252"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053252"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053251"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053251"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621680053250"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053250"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053249"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053249"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053248"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053248"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053251"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-334"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621680053247"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053247"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053246"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053246"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053250"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-335"></span><span>                           </span><span id="local-6989586621680053245"><span class="annot"><span class="annottext">result :: BezierSpline n d r
</span><a href="#local-6989586621680053245"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053248"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053247"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BezierSpline n d r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;merge: something is wrong, maybe need to flip one of the curves?&quot;</span></span><span>
</span><span id="line-336"></span><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
Point d r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#snapEndpoints"><span class="hs-identifier hs-var">snapEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053249"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053246"><span class="hs-identifier hs-var">q2</span></a></span><span> </span><span class="annot"><span class="annottext">(BezierSpline n d r -&gt; BezierSpline n d r)
-&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#growTo"><span class="hs-identifier hs-var">growTo</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053252"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053249"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053250"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-337"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053245"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- need distance function between polyBeziers...</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | Approximate Bezier curve by Polyline with given resolution.  That</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- is, every point on the approximation will have distance at most res</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- to the Bezier curve.</span><span>
</span><span id="line-348"></span><span id="local-6989586621680053242"><span id="local-6989586621680053243"><span id="local-6989586621680053244"><span class="annot"><a href="Geometry.BezierSpline.html#approximate"><span class="hs-identifier hs-type">approximate</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053244"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053243"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053242"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053242"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053242"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053244"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053243"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053242"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PolyLine.html#PolyLine"><span class="hs-identifier hs-type">PolyLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053243"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053242"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-350"></span><span id="approximate"><span class="annot"><span class="annottext">approximate :: r -&gt; BezierSpline n d r -&gt; PolyLine d () r
</span><a href="Geometry.BezierSpline.html#approximate"><span class="hs-identifier hs-var hs-var">approximate</span></a></span></span><span> </span><span id="local-6989586621680053241"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053241"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq 2 (Point d r :+ ()) -&gt; PolyLine d () r
forall (d :: Nat) p r. LSeq 2 (Point d r :+ p) -&gt; PolyLine d p r
</span><a href="Geometry.PolyLine.html#PolyLine"><span class="hs-identifier hs-var">PolyLine</span></a></span><span> </span><span class="annot"><span class="annottext">(LSeq 2 (Point d r :+ ()) -&gt; PolyLine d () r)
-&gt; (BezierSpline n d r -&gt; LSeq 2 (Point d r :+ ()))
-&gt; BezierSpline n d r
-&gt; PolyLine d () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point d r -&gt; Point d r :+ ())
-&gt; LSeq 2 (Point d r) -&gt; LSeq 2 (Point d r :+ ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">(LSeq 2 (Point d r) -&gt; LSeq 2 (Point d r :+ ()))
-&gt; (BezierSpline n d r -&gt; LSeq 2 (Point d r))
-&gt; BezierSpline n d r
-&gt; LSeq 2 (Point d r :+ ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; LSeq 2 (Point d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
r -&gt; BezierSpline n d r -&gt; LSeq 2 (Point d r)
</span><a href="Geometry.BezierSpline.html#approximate%27"><span class="hs-identifier hs-var">approximate'</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053241"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | implementation of approximate; returns the polyline as an LSeq</span><span>
</span><span id="line-353"></span><span id="local-6989586621680053719"><span id="local-6989586621680053720"><span id="local-6989586621680053721"><span class="annot"><a href="Geometry.BezierSpline.html#approximate%27"><span class="hs-identifier hs-type">approximate'</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053721"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053720"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053719"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053719"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053719"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053721"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053720"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053719"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053720"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053719"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-355"></span><span id="approximate%27"><span class="annot"><span class="annottext">approximate' :: r -&gt; BezierSpline n d r -&gt; LSeq 2 (Point d r)
</span><a href="Geometry.BezierSpline.html#approximate%27"><span class="hs-identifier hs-var hs-var">approximate'</span></a></span></span><span> </span><span id="local-6989586621680053238"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053238"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq 0 (Point d r) -&gt; LSeq 2 (Point d r)
forall (n :: Nat) (m :: Nat) a. LSeq m a -&gt; LSeq n a
</span><span class="hs-identifier hs-var">LSeq.promise</span></span><span> </span><span class="annot"><span class="annottext">(LSeq 0 (Point d r) -&gt; LSeq 2 (Point d r))
-&gt; (BezierSpline n d r -&gt; LSeq 0 (Point d r))
-&gt; BezierSpline n d r
-&gt; LSeq 2 (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; LSeq 0 (Point d r)
forall a. Seq a -&gt; LSeq 0 a
</span><span class="hs-identifier hs-var">LSeq.fromSeq</span></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; LSeq 0 (Point d r))
-&gt; (BezierSpline n d r -&gt; Seq (Point d r))
-&gt; BezierSpline n d r
-&gt; LSeq 0 (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053237"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621680053237"><span class="annot"><span class="annottext">go :: BezierSpline n d r -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053237"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680053236"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053236"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; Bool
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
r -&gt; BezierSpline n d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#flat"><span class="hs-identifier hs-var">flat</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053238"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053236"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053234"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053234"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680053233"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053233"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053236"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; Seq (Point d r)
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053234"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053233"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053232"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053232"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053231"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053231"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053236"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053237"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053232"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq (Point d r) -&gt; Seq (Point d r)
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; Seq (Point d r)
</span><a href="#local-6989586621680053237"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053231"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | Test whether a Bezier curve can be approximated by a single line segment,</span><span>
</span><span id="line-361"></span><span class="hs-comment">--   given the resolution parameter.</span><span>
</span><span id="line-362"></span><span id="local-6989586621680053713"><span id="local-6989586621680053714"><span id="local-6989586621680053715"><span class="annot"><a href="Geometry.BezierSpline.html#flat"><span class="hs-identifier hs-type">flat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053715"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053714"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053713"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053713"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053713"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053715"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053714"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053713"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-363"></span><span id="flat"><span class="annot"><span class="annottext">flat :: r -&gt; BezierSpline n d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#flat"><span class="hs-identifier hs-var hs-var">flat</span></a></span></span><span> </span><span id="local-6989586621680053230"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053230"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680053229"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053229"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053228"><span class="annot"><span class="annottext">p :: Point d r
</span><a href="#local-6989586621680053228"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point d r, Point d r) -&gt; Point d r)
-&gt; (Point d r, Point d r) -&gt; Point d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053229"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-364"></span><span>               </span><span id="local-6989586621680053227"><span class="annot"><span class="annottext">q :: Point d r
</span><a href="#local-6989586621680053227"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point d r, Point d r) -&gt; Point d r)
-&gt; (Point d r, Point d r) -&gt; Point d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053229"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-365"></span><span>               </span><span id="local-6989586621680053226"><span class="annot"><span class="annottext">s :: LineSegment d () r
</span><a href="#local-6989586621680053226"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point d r :+ ()) -&gt; (Point d r :+ ()) -&gt; LineSegment d () r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Geometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053228"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; () -&gt; Point d r :+ ()
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053227"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; () -&gt; Point d r :+ ()
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>               </span><span id="local-6989586621680053223"><span class="annot"><span class="annottext">e :: r -&gt; Bool
</span><a href="#local-6989586621680053223"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680053222"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053222"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
  (Dimension (LineSegment d () r)) (NumType (LineSegment d () r))
-&gt; LineSegment d () r -&gt; NumType (LineSegment d () r)
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; r -&gt; Point d r
forall (d :: Nat) r (n :: Nat).
(Arity d, Eq r, Num r) =&gt;
BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053229"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053222"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineSegment d () r
</span><a href="#local-6989586621680053226"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053230"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-367"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall (p :: * -&gt; *) a.
(Affine p, Foldable (Diff p), Num a) =&gt;
p a -&gt; p a -&gt; a
</span><span class="hs-identifier hs-var">qdA</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053228"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053227"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053230"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Bool) -&gt; [r] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
</span><a href="#local-6989586621680053223"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.9</span></span><span class="hs-special">]</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- seems this is now covered by approximate</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- -- | Approximate curve as line segments where no point on the curve is further away</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- --   from the nearest line segment than the given tolerance.</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- lineApproximate :: (Ord r, Fractional r) =&gt; r -&gt; BezierSpline 3 2 r -&gt; [Point 2 r]</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- lineApproximate eps bezier</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   | colinear eps bezier =</span><span>
</span><span id="line-377"></span><span class="hs-comment">--     [ bezier^.controlPoints.to LSeq.head</span><span>
</span><span id="line-378"></span><span class="hs-comment">--     , bezier^.controlPoints.to LSeq.last ]</span><span>
</span><span id="line-379"></span><span class="hs-comment">--   | otherwise =</span><span>
</span><span id="line-380"></span><span class="hs-comment">--     let (b1, b2) = split 0.5 bezier</span><span>
</span><span id="line-381"></span><span class="hs-comment">--     in lineApproximate eps b1 ++ tail (lineApproximate eps b2)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- If both control points are on the same side of the straight line from the start and end</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- points then the curve is guaranteed to be within 3/4 of the distance from the straight line</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- to the furthest control point.</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- Otherwise, if the control points are on either side of the straight line, the curve is</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- guaranteed to be within 4/9 of the maximum distance from the straight line to a control</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- point.</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- Also: 3/4 * sqrt(v) = sqrt (9/16 * v)</span><span>
</span><span id="line-390"></span><span class="hs-comment">--       4/9 * sqrt(v) = sqrt (16/81 * v)</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- So: 3/4 * sqrt(v) &lt; eps =&gt;</span><span>
</span><span id="line-392"></span><span class="hs-comment">--     sqrt(9/16 * v) &lt; eps =&gt;</span><span>
</span><span id="line-393"></span><span class="hs-comment">--     9/16*v &lt; eps*eps</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- | Return True if the curve is definitely completely covered by a line of thickness</span><span>
</span><span id="line-395"></span><span class="hs-comment">--   twice the given tolerance. May return false negatives but not false positives.</span><span>
</span><span id="line-396"></span><span id="local-6989586621680053216"><span class="annot"><a href="Geometry.BezierSpline.html#colinear"><span class="hs-identifier hs-type">colinear</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053216"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053216"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053216"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053216"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-397"></span><span id="colinear"><span class="annot"><span class="annottext">colinear :: r -&gt; BezierSpline 3 2 r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#colinear"><span class="hs-identifier hs-var hs-var">colinear</span></a></span></span><span> </span><span id="local-6989586621680053215"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053215"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.BezierSpline.html#Bezier3"><span class="hs-identifier hs-type">Bezier3</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680053214"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053214"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680053213"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053213"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680053212"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053212"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680053211"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053211"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053210"><span class="hs-identifier hs-var">sqBound</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053215"><span class="hs-identifier hs-var">eps</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053215"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680053209"><span class="annot"><span class="annottext">ld :: Point 2 r -&gt; r
</span><a href="#local-6989586621680053209"><span class="hs-identifier hs-var hs-var">ld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Line 2 r -&gt; r) -&gt; Line 2 r -&gt; Point 2 r -&gt; r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Line 2 r -&gt; r
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Line 2 r
forall r (d :: Nat).
(Num r, Arity d) =&gt;
Point d r -&gt; Point d r -&gt; Line d r
</span><a href="Geometry.Line.Internal.html#lineThrough"><span class="hs-identifier hs-var">lineThrough</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053214"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053211"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span id="local-6989586621680053206"><span class="annot"><span class="annottext">sameSide :: Bool
</span><a href="#local-6989586621680053206"><span class="hs-identifier hs-var hs-var">sameSide</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall r pointP pointQ pointR.
(Ord r, Num r, ToAPoint pointP 2 r, ToAPoint pointQ 2 r,
 ToAPoint pointR 2 r) =&gt;
pointP -&gt; pointQ -&gt; pointR -&gt; CCW
</span><a href="Geometry.Point.Orientation.Degenerate.html#ccw"><span class="hs-identifier hs-var">ccw</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053214"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053211"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053213"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall r pointP pointQ pointR.
(Ord r, Num r, ToAPoint pointP 2 r, ToAPoint pointQ 2 r,
 ToAPoint pointR 2 r) =&gt;
pointP -&gt; pointQ -&gt; pointR -&gt; CCW
</span><a href="Geometry.Point.Orientation.Degenerate.html#ccw"><span class="hs-identifier hs-var">ccw</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053214"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053211"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053212"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span id="local-6989586621680053204"><span class="annot"><span class="annottext">maxDist :: r
</span><a href="#local-6989586621680053204"><span class="hs-identifier hs-var hs-var">maxDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; r
</span><a href="#local-6989586621680053209"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053213"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; r
</span><a href="#local-6989586621680053209"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053212"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span id="local-6989586621680053210"><span class="annot"><span class="annottext">sqBound :: r
</span><a href="#local-6989586621680053210"><span class="hs-identifier hs-var hs-var">sqBound</span></a></span></span><span>
</span><span id="line-402"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053206"><span class="hs-identifier hs-var">sameSide</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">9</span></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">16</span></span><span>  </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053204"><span class="hs-identifier hs-var">maxDist</span></a></span><span>
</span><span id="line-403"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">81</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053204"><span class="hs-identifier hs-var">maxDist</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- general d depends on convex hull</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- parameterOf :: (Arity d, Ord r, Fractional r) =&gt; BezierSpline n d r -&gt; Point d r -&gt; r</span><span>
</span><span id="line-409"></span><span class="hs-comment">--</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- | Given a point on (or within distance treshold to) a Bezier curve, return the parameter value</span><span>
</span><span id="line-411"></span><span class="hs-comment">--   of some point on the curve within distance treshold from p.</span><span>
</span><span id="line-412"></span><span class="hs-comment">--   For points farther than treshold from the curve, the function will attempt to return the</span><span>
</span><span id="line-413"></span><span class="hs-comment">--   parameter value of an approximate locally closest point to the input point, but no guarantees.</span><span>
</span><span id="line-414"></span><span id="local-6989586621680053760"><span id="local-6989586621680053761"><span class="annot"><a href="Geometry.BezierSpline.html#parameterOf"><span class="hs-identifier hs-type">parameterOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053761"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053761"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053760"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-415"></span><span id="parameterOf"><span class="annot"><span class="annottext">parameterOf :: r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterOf"><span class="hs-identifier hs-var hs-var">parameterOf</span></a></span></span><span> </span><span id="local-6989586621680053202"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053202"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053201"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053201"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053200"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053200"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053202"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; Point 2 r -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053201"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-416"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053202"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; Point 2 r -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053201"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>
</span><span id="line-417"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterInterior"><span class="hs-identifier hs-var">parameterInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053202"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053201"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053200"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- parameterInterior is slow, look into algebraic solution?</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">-- general d depends on convex hull</span><span>
</span><span id="line-422"></span><span id="local-6989586621680053196"><span id="local-6989586621680053197"><span class="annot"><a href="Geometry.BezierSpline.html#parameterInterior"><span class="hs-identifier hs-type">parameterInterior</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053197"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053197"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-423"></span><span id="parameterInterior"><span class="annot"><span class="annottext">parameterInterior :: r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterInterior"><span class="hs-identifier hs-var hs-var">parameterInterior</span></a></span></span><span> </span><span id="local-6989586621680053195"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053194"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053194"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053193"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; r
forall r. (Ord r, RealFrac r) =&gt; [Point 2 r] -&gt; r
</span><a href="Geometry.BezierSpline.html#sqrad"><span class="hs-identifier hs-var">sqrad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r])
-&gt; LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
-&gt; BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053194"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-424"></span><span>                               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680053191"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053191"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053190"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053190"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; (BezierSpline n 2 r, BezierSpline n 2 r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053194"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621680053189"><span class="annot"><span class="annottext">recurse1 :: r
</span><a href="#local-6989586621680053189"><span class="hs-identifier hs-var hs-var">recurse1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>       </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterInterior"><span class="hs-identifier hs-var">parameterInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053191"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621680053188"><span class="annot"><span class="annottext">recurse2 :: r
</span><a href="#local-6989586621680053188"><span class="hs-identifier hs-var hs-var">recurse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterInterior"><span class="hs-identifier hs-var">parameterInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053190"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span id="local-6989586621680053187"><span class="annot"><span class="annottext">chb1 :: SimplePolygon () r
</span><a href="#local-6989586621680053187"><span class="hs-identifier hs-var hs-var">chb1</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon () r -&gt; SimplePolygon () r
forall p r. ConvexPolygon p r -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Convex.html#_simplePolygon"><span class="hs-identifier hs-var hs-var">_simplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygon () r -&gt; SimplePolygon () r)
-&gt; ConvexPolygon () r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; ConvexPolygon () r
forall r (n :: Nat).
(Ord r, Fractional r) =&gt;
BezierSpline n 2 r -&gt; ConvexPolygon () r
</span><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-var">convexHullB</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053191"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621680053185"><span class="annot"><span class="annottext">chb2 :: SimplePolygon () r
</span><a href="#local-6989586621680053185"><span class="hs-identifier hs-var hs-var">chb2</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon () r -&gt; SimplePolygon () r
forall p r. ConvexPolygon p r -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Convex.html#_simplePolygon"><span class="hs-identifier hs-var hs-var">_simplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygon () r -&gt; SimplePolygon () r)
-&gt; ConvexPolygon () r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; ConvexPolygon () r
forall r (n :: Nat).
(Ord r, Fractional r) =&gt;
BezierSpline n 2 r -&gt; ConvexPolygon () r
</span><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-var">convexHullB</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053190"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621680053184"><span class="annot"><span class="annottext">in1 :: Bool
</span><a href="#local-6989586621680053184"><span class="hs-identifier hs-var hs-var">in1</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
-&gt; SimplePolygon () r -&gt; NumType (SimplePolygon () r)
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053187"><span class="hs-identifier hs-var">chb1</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-431"></span><span>      </span><span id="local-6989586621680053183"><span class="annot"><span class="annottext">in2 :: Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var hs-var">in2</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
-&gt; SimplePolygon () r -&gt; NumType (SimplePolygon () r)
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053185"><span class="hs-identifier hs-var">chb2</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053195"><span class="hs-identifier hs-var">treshold</span></a></span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621680053182"><span class="annot"><span class="annottext">result :: r
</span><a href="#local-6989586621680053182"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span>     </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053184"><span class="hs-identifier hs-var">in1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>     </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var">in2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; Point 2 r -&gt; r -&gt; r -&gt; r
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Fractional r) =&gt;
BezierSpline n d r -&gt; Point d r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#betterFit"><span class="hs-identifier hs-var">betterFit</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053194"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053189"><span class="hs-identifier hs-var">recurse1</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053188"><span class="hs-identifier hs-var">recurse2</span></a></span><span>
</span><span id="line-433"></span><span>             </span><span class="hs-glyph">|</span><span>     </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var">in2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var">in2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053189"><span class="hs-identifier hs-var">recurse1</span></a></span><span>
</span><span id="line-434"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var">in2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>     </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053183"><span class="hs-identifier hs-var">in2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053188"><span class="hs-identifier hs-var">recurse2</span></a></span><span>
</span><span id="line-435"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
-&gt; SimplePolygon () r -&gt; NumType (SimplePolygon () r)
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053187"><span class="hs-identifier hs-var">chb1</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
-&gt; SimplePolygon () r -&gt; NumType (SimplePolygon () r)
forall g.
(HasSquaredEuclideanDistance g, Num (NumType g),
 Arity (Dimension g)) =&gt;
Point (Dimension g) (NumType g) -&gt; g -&gt; NumType g
</span><a href="Geometry.Point.Internal.html#squaredEuclideanDistTo"><span class="hs-identifier hs-var">squaredEuclideanDistTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
Point
  (Dimension (SimplePolygon () r)) (NumType (SimplePolygon () r))
</span><a href="#local-6989586621680053193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053185"><span class="hs-identifier hs-var">chb2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053189"><span class="hs-identifier hs-var">recurse1</span></a></span><span>
</span><span id="line-436"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053188"><span class="hs-identifier hs-var">recurse2</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053182"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Given a point on (or close to) the extension of a Bezier curve, return the corresponding</span><span>
</span><span id="line-440"></span><span class="hs-comment">--   parameter value, which might also be smaller than 0 or larger than 1.</span><span>
</span><span id="line-441"></span><span class="hs-comment">--   (For points far away from the curve, the function will return the parameter value of</span><span>
</span><span id="line-442"></span><span class="hs-comment">--   an approximate locally closest point to the input point.)</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">--   This implementation is not robust: might return a locally closest point on the curve</span><span>
</span><span id="line-445"></span><span class="hs-comment">--   even though the point lies on another part of the curve. For points on the actual</span><span>
</span><span id="line-446"></span><span class="hs-comment">--   curve, use parameterOf instead.</span><span>
</span><span id="line-447"></span><span id="local-6989586621680053738"><span id="local-6989586621680053739"><span id="local-6989586621680053740"><span class="annot"><a href="Geometry.BezierSpline.html#extendedParameterOf"><span class="hs-identifier hs-type">extendedParameterOf</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053740"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053739"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053739"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053740"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053740"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053738"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-449"></span><span id="extendedParameterOf"><span class="annot"><span class="annottext">extendedParameterOf :: r -&gt; BezierSpline n d r -&gt; Point d r -&gt; r
</span><a href="Geometry.BezierSpline.html#extendedParameterOf"><span class="hs-identifier hs-var hs-var">extendedParameterOf</span></a></span></span><span> </span><span id="local-6989586621680053179"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053179"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053178"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053178"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053177"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053177"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053177"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053178"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-450"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053177"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Point d r, Point d r) -&gt; Point d r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; (Point d r, Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053178"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>
</span><span id="line-451"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
forall r. (Ord r, Fractional r) =&gt; r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#binarySearch"><span class="hs-identifier hs-var">binarySearch</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053179"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall (p :: * -&gt; *) a.
(Affine p, Foldable (Diff p), Num a) =&gt;
p a -&gt; p a -&gt; a
</span><span class="hs-identifier hs-var">qdA</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053177"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Point d r -&gt; r) -&gt; (r -&gt; Point d r) -&gt; r -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; r -&gt; Point d r
forall (d :: Nat) r (n :: Nat).
(Arity d, Eq r, Num r) =&gt;
BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053178"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">100</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- * Stuff to implement parameterOf and extendedParameterOf</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span id="local-6989586621680053664"><span id="local-6989586621680053665"><span id="local-6989586621680053666"><span class="annot"><a href="Geometry.BezierSpline.html#betterFit"><span class="hs-identifier hs-type">betterFit</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053665"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053666"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053665"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053665"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053664"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-458"></span><span id="betterFit"><span class="annot"><span class="annottext">betterFit :: BezierSpline n d r -&gt; Point d r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#betterFit"><span class="hs-identifier hs-var hs-var">betterFit</span></a></span></span><span> </span><span id="local-6989586621680053175"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053175"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053174"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053174"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053173"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053173"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680053172"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053172"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053171"><span class="annot"><span class="annottext">q :: Point d r
</span><a href="#local-6989586621680053171"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; r -&gt; Point d r
forall (d :: Nat) r (n :: Nat).
(Arity d, Eq r, Num r) =&gt;
BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053175"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053173"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-460"></span><span>      </span><span id="local-6989586621680053170"><span class="annot"><span class="annottext">r :: Point d r
</span><a href="#local-6989586621680053170"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; r -&gt; Point d r
forall (d :: Nat) r (n :: Nat).
(Arity d, Eq r, Num r) =&gt;
BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053175"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053172"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall (p :: * -&gt; *) a.
(Affine p, Foldable (Diff p), Num a) =&gt;
p a -&gt; p a -&gt; a
</span><span class="hs-identifier hs-var">qdA</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053171"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053174"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall (p :: * -&gt; *) a.
(Affine p, Foldable (Diff p), Num a) =&gt;
p a -&gt; p a -&gt; a
</span><span class="hs-identifier hs-var">qdA</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053170"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053174"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053173"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053172"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Given two Bezier curves, list all intersection points.</span><span>
</span><span id="line-466"></span><span class="hs-comment">--   Not exact, since for degree &gt;= 3 there is no closed form.</span><span>
</span><span id="line-467"></span><span class="hs-comment">--   (In principle, this algorithm works in any dimension</span><span>
</span><span id="line-468"></span><span class="hs-comment">--   but this requires convexHull, area/volume, and intersect.)</span><span>
</span><span id="line-469"></span><span id="local-6989586621680053168"><span id="local-6989586621680053169"><span class="annot"><a href="Geometry.BezierSpline.html#intersectB"><span class="hs-identifier hs-type">intersectB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053169"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053169"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053169"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-470"></span><span id="intersectB"><span class="annot"><span class="annottext">intersectB :: r -&gt; BezierSpline n 2 r -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectB"><span class="hs-identifier hs-var hs-var">intersectB</span></a></span></span><span> </span><span id="local-6989586621680053167"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053167"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053166"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053166"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680053165"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053166"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; BezierSpline n 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; Point 2 r)
-&gt; (Point 2 r, Point 2 r) -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; (Point 2 r, Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; (Point d r, Point d r)
</span><a href="Geometry.BezierSpline.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- should really return the whole curve</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680053164"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053164"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053163"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053163"><span class="hs-identifier hs-var">_a2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053162"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053162"><span class="hs-identifier hs-var">_a3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053161"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053161"><span class="hs-identifier hs-var">a4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r])
-&gt; LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053166"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-473"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621680053160"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053160"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053159"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053159"><span class="hs-identifier hs-var">_b2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053158"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053158"><span class="hs-identifier hs-var">_b3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053157"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053157"><span class="hs-identifier hs-var">b4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r])
-&gt; LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-474"></span><span>                </span><span class="hs-keyword">in</span><span>    </span><span class="annot"><span class="annottext">r -&gt; [Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall r.
(Ord r, Fractional r) =&gt;
r -&gt; [Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectPointsPoints"><span class="hs-identifier hs-var">intersectPointsPoints</span></a></span><span>     </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053167"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053164"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053161"><span class="hs-identifier hs-var">a4</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053160"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053157"><span class="hs-identifier hs-var">b4</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>                   </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectPointsInterior"><span class="hs-identifier hs-var">intersectPointsInterior</span></a></span><span>   </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053167"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053164"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053161"><span class="hs-identifier hs-var">a4</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-476"></span><span>                   </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectPointsInterior"><span class="hs-identifier hs-var">intersectPointsInterior</span></a></span><span>   </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053167"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053160"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053157"><span class="hs-identifier hs-var">b4</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053166"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-477"></span><span>                   </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var">intersectInteriorInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053167"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053164"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053161"><span class="hs-identifier hs-var">a4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053160"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053157"><span class="hs-identifier hs-var">b4</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053166"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053165"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span id="local-6989586621680053675"><span id="local-6989586621680053676"><span class="annot"><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-type">closeEnough</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053676"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053676"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053676"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-481"></span><span id="closeEnough"><span class="annot"><span class="annottext">closeEnough :: r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var hs-var">closeEnough</span></a></span></span><span> </span><span id="local-6989586621680053153"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053153"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053152"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053152"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053151"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053151"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall (p :: * -&gt; *) a.
(Affine p, Foldable (Diff p), Num a) =&gt;
p a -&gt; p a -&gt; a
</span><span class="hs-identifier hs-var">qdA</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053152"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053151"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053153"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span id="local-6989586621680053654"><span class="annot"><a href="Geometry.BezierSpline.html#intersectPointsPoints"><span class="hs-identifier hs-type">intersectPointsPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053654"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-484"></span><span id="intersectPointsPoints"><span class="annot"><span class="annottext">intersectPointsPoints :: r -&gt; [Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectPointsPoints"><span class="hs-identifier hs-var hs-var">intersectPointsPoints</span></a></span></span><span> </span><span id="local-6989586621680053150"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053150"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053149"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053149"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680053148"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053148"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053150"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053148"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053149"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span id="local-6989586621680053652"><span id="local-6989586621680053653"><span class="annot"><a href="Geometry.BezierSpline.html#intersectPointsInterior"><span class="hs-identifier hs-type">intersectPointsInterior</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053653"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053653"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053652"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-487"></span><span id="intersectPointsInterior"><span class="annot"><span class="annottext">intersectPointsInterior :: r -&gt; [Point 2 r] -&gt; BezierSpline n 2 r -&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectPointsInterior"><span class="hs-identifier hs-var hs-var">intersectPointsInterior</span></a></span></span><span> </span><span id="local-6989586621680053146"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053146"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053145"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053145"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680053144"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053144"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680053143"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053143"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053142"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053142"><span class="hs-identifier hs-var">_b2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053141"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053141"><span class="hs-identifier hs-var">_b3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053140"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053140"><span class="hs-identifier hs-var">b4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r])
-&gt; LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053144"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-489"></span><span>      </span><span id="local-6989586621680053139"><span class="annot"><span class="annottext">nearc :: Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053139"><span class="hs-identifier hs-var hs-var">nearc</span></a></span></span><span> </span><span id="local-6989586621680053138"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053138"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053146"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; Point 2 r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; Point 2 r
</span><a href="Geometry.BezierSpline.html#snap"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053146"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053144"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053138"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053138"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span id="local-6989586621680053137"><span class="annot"><span class="annottext">near1 :: Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053137"><span class="hs-identifier hs-var hs-var">near1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053146"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053143"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621680053136"><span class="annot"><span class="annottext">near4 :: Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053136"><span class="hs-identifier hs-var hs-var">near4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053146"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053140"><span class="hs-identifier hs-var">b4</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680053135"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053135"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053139"><span class="hs-identifier hs-var">nearc</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053135"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053137"><span class="hs-identifier hs-var">near1</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053135"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Bool
</span><a href="#local-6989586621680053136"><span class="hs-identifier hs-var">near4</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053135"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053145"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span id="local-6989586621680053650"><span id="local-6989586621680053651"><span class="annot"><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-type">intersectInteriorInterior</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053651"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053651"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053651"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053650"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-496"></span><span id="intersectInteriorInterior"><span class="annot"><span class="annottext">intersectInteriorInterior :: r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var hs-var">intersectInteriorInterior</span></a></span></span><span> </span><span id="local-6989586621680053134"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053133"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span></span><span> </span><span id="local-6989586621680053132"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053132"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680053131"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053131"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053130"><span class="annot"><span class="annottext">cha :: SimplePolygon () r
</span><a href="#local-6989586621680053130"><span class="hs-identifier hs-var hs-var">cha</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon () r -&gt; SimplePolygon () r
forall p r. ConvexPolygon p r -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Convex.html#_simplePolygon"><span class="hs-identifier hs-var hs-var">_simplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygon () r -&gt; SimplePolygon () r)
-&gt; ConvexPolygon () r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; ConvexPolygon () r
forall r (n :: Nat).
(Ord r, Fractional r) =&gt;
BezierSpline n 2 r -&gt; ConvexPolygon () r
</span><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-var">convexHullB</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053132"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-498"></span><span>      </span><span id="local-6989586621680053129"><span class="annot"><span class="annottext">chb :: SimplePolygon () r
</span><a href="#local-6989586621680053129"><span class="hs-identifier hs-var hs-var">chb</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon () r -&gt; SimplePolygon () r
forall p r. ConvexPolygon p r -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Convex.html#_simplePolygon"><span class="hs-identifier hs-var hs-var">_simplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygon () r -&gt; SimplePolygon () r)
-&gt; ConvexPolygon () r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; ConvexPolygon () r
forall r (n :: Nat).
(Ord r, Fractional r) =&gt;
BezierSpline n 2 r -&gt; ConvexPolygon () r
</span><a href="Geometry.BezierSpline.html#convexHullB"><span class="hs-identifier hs-var">convexHullB</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053131"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680053128"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053128"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053127"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053127"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; (BezierSpline n 2 r, BezierSpline n 2 r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053132"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680053126"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053126"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053125"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053125"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; (BezierSpline n 2 r, BezierSpline n 2 r)
forall (n :: Nat) (d :: Nat) r.
(KnownNat n, Arity d, Ord r, Num r) =&gt;
r -&gt; BezierSpline n d r -&gt; (BezierSpline n d r, BezierSpline n d r)
</span><a href="Geometry.BezierSpline.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053131"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621680053124"><span class="annot"><span class="annottext">points :: [Point 2 r]
</span><a href="#local-6989586621680053124"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
-&gt; BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053132"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>              </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
-&gt; BezierSpline n 2 r -&gt; LSeq (1 + n) (Point 2 r)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (LSeq (1 + n) (Point 2 r))
  (BezierSpline n 2 r)
  (LSeq (1 + n) (Point 2 r))
forall (n1 :: Nat) (d1 :: Nat) r1 (n2 :: Nat) (d2 :: Nat) r2.
Iso
  (BezierSpline n1 d1 r1)
  (BezierSpline n2 d2 r2)
  (LSeq (1 + n1) (Point d1 r1))
  (LSeq (1 + n2) (Point d2 r2))
</span><a href="Geometry.BezierSpline.html#controlPoints"><span class="hs-identifier hs-var">controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053131"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>      </span><span id="local-6989586621680053123"><span class="annot"><span class="annottext">approx :: Point 2 r
</span><a href="#local-6989586621680053123"><span class="hs-identifier hs-var hs-var">approx</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Point 2 r
forall (t :: * -&gt; *) (d :: Nat) r.
(Functor t, Foldable t, Arity d, Fractional r) =&gt;
t (Point d r) -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#average"><span class="hs-identifier hs-var">average</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053124"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-504"></span><span>      </span><span id="local-6989586621680053121"><span class="annot"><span class="annottext">done :: Bool
</span><a href="#local-6989586621680053121"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053130"><span class="hs-identifier hs-var">cha</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r -&gt; SimplePolygon () r -&gt; Bool
forall r p.
(Ord r, Fractional r) =&gt;
SimplePolygon p r -&gt; SimplePolygon p r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#intersectsP"><span class="hs-operator hs-var">`intersectsP`</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053129"><span class="hs-identifier hs-var">chb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-505"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; r
forall r. (Ord r, RealFrac r) =&gt; [Point 2 r] -&gt; r
</span><a href="Geometry.BezierSpline.html#sqrad"><span class="hs-identifier hs-var">sqrad</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053124"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-506"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-507"></span><span>      </span><span id="local-6989586621680053119"><span class="annot"><span class="annottext">result :: [Point 2 r]
</span><a href="#local-6989586621680053119"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053130"><span class="hs-identifier hs-var">cha</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r -&gt; SimplePolygon () r -&gt; Bool
forall r p.
(Ord r, Fractional r) =&gt;
SimplePolygon p r -&gt; SimplePolygon p r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#intersectsP"><span class="hs-operator hs-var">`intersectsP`</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680053129"><span class="hs-identifier hs-var">chb</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Point 2 r -&gt; Point 2 r -&gt; Bool
forall (d :: Nat) r.
(Arity d, Ord r, Fractional r) =&gt;
r -&gt; Point d r -&gt; Point d r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#closeEnough"><span class="hs-identifier hs-var">closeEnough</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053123"><span class="hs-identifier hs-var">approx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680053123"><span class="hs-identifier hs-var">approx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-510"></span><span>      </span><span id="local-6989586621680053118"><span class="annot"><span class="annottext">recurse :: [Point 2 r]
</span><a href="#local-6989586621680053118"><span class="hs-identifier hs-var hs-var">recurse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var">intersectInteriorInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053128"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053126"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-511"></span><span>             </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var">intersectInteriorInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053128"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053125"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-512"></span><span>             </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var">intersectInteriorInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053127"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053126"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-513"></span><span>             </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r
-&gt; [Point 2 r]
-&gt; BezierSpline n 2 r
-&gt; BezierSpline n 2 r
-&gt; [Point 2 r]
</span><a href="Geometry.BezierSpline.html#intersectInteriorInterior"><span class="hs-identifier hs-var">intersectInteriorInterior</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053134"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053133"><span class="hs-identifier hs-var">forbidden</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053127"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053125"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680053121"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053119"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053118"><span class="hs-identifier hs-var">recurse</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span id="local-6989586621680053672"><span class="annot"><a href="Geometry.BezierSpline.html#sqrad"><span class="hs-identifier hs-type">sqrad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053672"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053672"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053672"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053672"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-517"></span><span id="sqrad"><span class="annot"><span class="annottext">sqrad :: [Point 2 r] -&gt; r
</span><a href="Geometry.BezierSpline.html#sqrad"><span class="hs-identifier hs-var hs-var">sqrad</span></a></span></span><span> </span><span id="local-6989586621680053117"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053117"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053117"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sqrad: not enough points&quot;</span></span><span>
</span><span id="line-518"></span><span class="annot"><a href="Geometry.BezierSpline.html#sqrad"><span class="hs-identifier hs-var">sqrad</span></a></span><span> </span><span id="local-6989586621680053116"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053116"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680053115"><span class="hs-identifier hs-type">rationalPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- smallestEnclosingDisk fails on Floats</span><span>
</span><span id="line-520"></span><span>      </span><span id="local-6989586621680053115"><span class="annot"><span class="annottext">rationalPoints :: [Point 2 Rational]
</span><a href="#local-6989586621680053115"><span class="hs-identifier hs-var hs-var">rationalPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 Rational)
-&gt; [Point 2 r] -&gt; [Point 2 Rational]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r -&gt; Identity Rational)
-&gt; Point 2 r -&gt; Identity (Point 2 Rational)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; Identity Rational)
 -&gt; Point 2 r -&gt; Identity (Point 2 Rational))
-&gt; (r -&gt; Rational) -&gt; Point 2 r -&gt; Point 2 Rational
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Rational
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621680053116"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-521"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680053114"><span class="annot"><span class="annottext">Point 2 Rational :+ ()
</span><a href="#local-6989586621680053114"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680053113"><span class="annot"><span class="annottext">Point 2 Rational :+ ()
</span><a href="#local-6989586621680053113"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680053112"><span class="annot"><span class="annottext">[Point 2 Rational :+ ()]
</span><a href="#local-6989586621680053112"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational -&gt; Point 2 Rational :+ ())
-&gt; [Point 2 Rational] -&gt; [Point 2 Rational :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 Rational -&gt; () -&gt; Point 2 Rational :+ ()
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational]
</span><a href="#local-6989586621680053115"><span class="hs-identifier hs-var">rationalPoints</span></a></span><span>
</span><span id="line-522"></span><span>      </span><span id="local-6989586621680053111"><span class="annot"><span class="annottext">diskResult :: DiskResult () Rational
</span><a href="#local-6989586621680053111"><span class="hs-identifier hs-var hs-var">diskResult</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational :+ ())
-&gt; (Point 2 Rational :+ ())
-&gt; [Point 2 Rational :+ ()]
-&gt; DiskResult () Rational
forall r p.
(Ord r, Fractional r) =&gt;
(Point 2 r :+ p)
-&gt; (Point 2 r :+ p) -&gt; [Point 2 r :+ p] -&gt; DiskResult p r
</span><a href="Algorithms.Geometry.SmallestEnclosingBall.RIC.html#smallestEnclosingDisk%27"><span class="hs-identifier hs-var">smallestEnclosingDisk'</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational :+ ()
</span><a href="#local-6989586621680053114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational :+ ()
</span><a href="#local-6989586621680053113"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational :+ ()]
</span><a href="#local-6989586621680053112"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; r
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; r) -&gt; Rational -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting Rational (Disk () Rational) Rational
-&gt; Disk () Rational -&gt; Rational
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Rational (Disk () Rational) Rational
forall (d :: Nat) p r. Lens' (Ball d p r) r
</span><a href="Geometry.Ball.html#squaredRadius"><span class="hs-identifier hs-var">squaredRadius</span></a></span><span> </span><span class="annot"><span class="annottext">(Disk () Rational -&gt; Rational) -&gt; Disk () Rational -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Disk () Rational) (DiskResult () Rational) (Disk () Rational)
-&gt; DiskResult () Rational -&gt; Disk () Rational
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Disk () Rational) (DiskResult () Rational) (Disk () Rational)
forall p r. Lens' (DiskResult p r) (Disk () r)
</span><a href="Algorithms.Geometry.SmallestEnclosingBall.Types.html#enclosingDisk"><span class="hs-identifier hs-var">enclosingDisk</span></a></span><span> </span><span class="annot"><span class="annottext">(DiskResult () Rational -&gt; Disk () Rational)
-&gt; DiskResult () Rational -&gt; Disk () Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DiskResult () Rational
</span><a href="#local-6989586621680053111"><span class="hs-identifier hs-var">diskResult</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span id="local-6989586621680053638"><span id="local-6989586621680053639"><span id="local-6989586621680053640"><span class="annot"><a href="Geometry.BezierSpline.html#average"><span class="hs-identifier hs-type">average</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621680053640"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621680053640"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053639"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053640"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053639"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053639"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053638"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-526"></span><span id="average"><span class="annot"><span class="annottext">average :: t (Point d r) -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#average"><span class="hs-identifier hs-var hs-var">average</span></a></span></span><span> </span><span id="local-6989586621680053107"><span class="annot"><span class="annottext">t (Point d r)
</span><a href="#local-6989586621680053107"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r
forall (d :: Nat) r. (Arity d, Num r) =&gt; Point d r
</span><a href="Geometry.Point.Internal.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Diff (Point d) r -&gt; Point d r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; Diff p a -&gt; p a
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">(Vector d r -&gt; Vector d r -&gt; Vector d r)
-&gt; t (Vector d r) -&gt; Vector d r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="annot"><span class="annottext">Vector d r -&gt; Vector d r -&gt; Vector d r
forall (f :: * -&gt; *) a. (Additive f, Num a) =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">(^+^)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point d r -&gt; Vector d r) -&gt; t (Point d r) -&gt; t (Vector d r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Vector d r
forall (d :: Nat) r. Point d r -&gt; Vector d r
</span><a href="Geometry.Point.Internal.html#toVec"><span class="hs-identifier hs-var hs-var">toVec</span></a></span><span> </span><span class="annot"><span class="annottext">t (Point d r)
</span><a href="#local-6989586621680053107"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector d r -&gt; r -&gt; Vector d r
forall (f :: * -&gt; *) a.
(Functor f, Fractional a) =&gt;
f a -&gt; a -&gt; f a
</span><span class="hs-operator hs-var">^/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; r
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t (Point d r) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t (Point d r)
</span><a href="#local-6989586621680053107"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">{-
type instance IntersectionOf (BezierSpline n 2 r) (BezierSpline n 2 r) = [ NoIntersection
                                                                                   , [Point 2 r]
                                                                                   , BezierSpline n 2 r
                                                                                   ]


instance (KnownNat n, Ord r, Fractional r) =&gt; (BezierSpline n 2 r) `IsIntersectableWith` (BezierSpline n 2 r) where
  nonEmptyIntersection = defaultNonEmptyIntersection
  a `intersect` b = a `intersectB` b
-}</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- function to test whether two convex polygons intersect</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- for speed, first test bounding boxes</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- maybe would be faster to directly compare bounding boxes of points, rather than</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- call convex hull first?</span><span>
</span><span id="line-545"></span><span id="local-6989586621680053636"><span id="local-6989586621680053637"><span class="annot"><a href="Geometry.BezierSpline.html#intersectsP"><span class="hs-identifier hs-type">intersectsP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053637"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053637"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053636"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053637"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053636"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053637"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-546"></span><span id="intersectsP"><span class="annot"><span class="annottext">intersectsP :: SimplePolygon p r -&gt; SimplePolygon p r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#intersectsP"><span class="hs-identifier hs-var hs-var">intersectsP</span></a></span></span><span> </span><span id="local-6989586621680053103"><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053103"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053102"><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053102"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
-&gt; Box
     (Dimension (SimplePolygon p r)) () (NumType (SimplePolygon p r))
forall g.
(IsBoxable g, Ord (NumType g)) =&gt;
g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var">boundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053103"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Box 2 () r -&gt; Box 2 () r -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
-&gt; Box
     (Dimension (SimplePolygon p r)) () (NumType (SimplePolygon p r))
forall g.
(IsBoxable g, Ord (NumType g)) =&gt;
g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var">boundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053102"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-547"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680053098"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r -&gt; LineSegment 2 p r -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680053097"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680053098"><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680053098"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053103"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
-&gt; (SimplePolygon p r -&gt; [LineSegment 2 p r])
-&gt; [LineSegment 2 p r]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r -&gt; [LineSegment 2 p r]
forall (t :: PolygonType) p r. Polygon t p r -&gt; [LineSegment 2 p r]
</span><a href="Geometry.Polygon.Core.html#listEdges"><span class="hs-identifier hs-var">listEdges</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680053097"><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680053097"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053102"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
-&gt; (SimplePolygon p r -&gt; [LineSegment 2 p r])
-&gt; [LineSegment 2 p r]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r -&gt; [LineSegment 2 p r]
forall (t :: PolygonType) p r. Polygon t p r -&gt; [LineSegment 2 p r]
</span><a href="Geometry.Polygon.Core.html#listEdges"><span class="hs-identifier hs-var">listEdges</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>                           </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; SimplePolygon p r -&gt; Bool)
-&gt; SimplePolygon p r -&gt; Point 2 r -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; SimplePolygon p r -&gt; Bool
forall r (t :: PolygonType) p.
(Fractional r, Ord r) =&gt;
Point 2 r -&gt; Polygon t p r -&gt; Bool
</span><a href="Algorithms.Geometry.InPolygon.html#insidePolygon"><span class="hs-identifier hs-var">insidePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053103"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ p) -&gt; Point 2 r) -&gt; [Point 2 r :+ p] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ p) -&gt; Point 2 r
forall core extra. (core :+ extra) -&gt; core
</span><span class="hs-identifier hs-var">_core</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [Point 2 r])
-&gt; [Point 2 r :+ p] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r -&gt; NonEmpty (Point 2 r :+ p)
forall (t :: PolygonType) p r.
Polygon t p r -&gt; NonEmpty (Point 2 r :+ p)
</span><a href="Geometry.Polygon.Core.html#polygonVertices"><span class="hs-identifier hs-var">polygonVertices</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053102"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>                           </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; SimplePolygon p r -&gt; Bool)
-&gt; SimplePolygon p r -&gt; Point 2 r -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; SimplePolygon p r -&gt; Bool
forall r (t :: PolygonType) p.
(Fractional r, Ord r) =&gt;
Point 2 r -&gt; Polygon t p r -&gt; Bool
</span><a href="Algorithms.Geometry.InPolygon.html#insidePolygon"><span class="hs-identifier hs-var">insidePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053102"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Bool) -&gt; [Point 2 r] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ p) -&gt; Point 2 r) -&gt; [Point 2 r :+ p] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ p) -&gt; Point 2 r
forall core extra. (core :+ extra) -&gt; core
</span><span class="hs-identifier hs-var">_core</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [Point 2 r])
-&gt; [Point 2 r :+ p] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r -&gt; NonEmpty (Point 2 r :+ p)
forall (t :: PolygonType) p r.
Polygon t p r -&gt; NonEmpty (Point 2 r :+ p)
</span><a href="Geometry.Polygon.Core.html#polygonVertices"><span class="hs-identifier hs-var">polygonVertices</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680053103"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-comment">-- first test bounding box?</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-comment">{-

instance (Arity d, Floating r) =&gt; IsBoxable (BezierSpline 3 d r) where
  boundingBox b = foldr1 (&lt;&gt;) $ map (\i -&gt; boundingBox (extremal True i b) &lt;&gt; boundingBox (extremal False i b)) [1 .. d]

-- | Find extremal points on curve in the $i$th dimension.
extremal :: Floating r =&gt; Bool -&gt; Int -&gt; BezierSpline 3 d r -&gt; Point d r
extremal pos i b =
  let [p1, _, _, p4] = F.toList $ view controlPoints b
      ps = map evaluate $ locallyExtremalParameters i b
      candidates = [p1, p4] ++ ps
      result | pos     = maximumBy (unsafeCoord i . snd) candidates
             | not pos = minimumBy (unsafeCoord i . snd) candidates
  in result

-}</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span id="local-6989586621680053750"><span id="local-6989586621680053751"><span id="local-6989586621680053752"><span class="annot"><a href="Geometry.BezierSpline.html#snapEndpoints"><span class="hs-identifier hs-type">snapEndpoints</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053752"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053751"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053751"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053751"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053751"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053751"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053750"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-575"></span><span id="snapEndpoints"><span class="annot"><span class="annottext">snapEndpoints :: Point d r -&gt; Point d r -&gt; BezierSpline n d r -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#snapEndpoints"><span class="hs-identifier hs-var hs-var">snapEndpoints</span></a></span></span><span> </span><span id="local-6989586621680053091"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053091"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680053090"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053090"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680053089"><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053089"><span class="hs-identifier hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053088"><span class="annot"><span class="annottext">points :: [Point d r]
</span><a href="#local-6989586621680053088"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSeq (1 + n) (Point d r) -&gt; [Point d r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(LSeq (1 + n) (Point d r) -&gt; [Point d r])
-&gt; LSeq (1 + n) (Point d r) -&gt; [Point d r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
forall (n :: Nat) (d :: Nat) r.
BezierSpline n d r -&gt; LSeq (1 + n) (Point d r)
</span><a href="Geometry.BezierSpline.html#_controlPoints"><span class="hs-identifier hs-var hs-var">_controlPoints</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n d r
</span><a href="#local-6989586621680053089"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span id="local-6989586621680053087"><span class="annot"><span class="annottext">middle :: [Point d r]
</span><a href="#local-6989586621680053087"><span class="hs-identifier hs-var hs-var">middle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; [Point d r]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; [Point d r])
-&gt; ([Point d r] -&gt; [Point d r]) -&gt; [Point d r] -&gt; [Point d r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; [Point d r]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">([Point d r] -&gt; [Point d r]) -&gt; [Point d r] -&gt; [Point d r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point d r]
</span><a href="#local-6989586621680053088"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span id="local-6989586621680053084"><span class="annot"><span class="annottext">new :: [Point d r]
</span><a href="#local-6989586621680053084"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053091"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; [Point d r] -&gt; [Point d r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Point d r]
</span><a href="#local-6989586621680053087"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; [Point d r] -&gt; [Point d r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621680053090"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Seq (Point d r) -&gt; BezierSpline n d r
forall (d :: Nat) r (n :: Nat).
Seq (Point d r) -&gt; BezierSpline n d r
</span><a href="Geometry.BezierSpline.html#fromPointSeq"><span class="hs-identifier hs-var">fromPointSeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Point d r) -&gt; BezierSpline n d r)
-&gt; Seq (Point d r) -&gt; BezierSpline n d r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point d r] -&gt; Seq (Point d r)
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Point d r]
</span><a href="#local-6989586621680053084"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">-- | Snap a point close to a Bezier curve to the curve.</span><span>
</span><span id="line-583"></span><span id="local-6989586621680053643"><span id="local-6989586621680053644"><span class="annot"><a href="Geometry.BezierSpline.html#snap"><span class="hs-identifier hs-type">snap</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621680053644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.BezierSpline.html#BezierSpline"><span class="hs-identifier hs-type">BezierSpline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053644"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680053643"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-584"></span><span id="snap"><span class="annot"><span class="annottext">snap :: r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; Point 2 r
</span><a href="Geometry.BezierSpline.html#snap"><span class="hs-identifier hs-var hs-var">snap</span></a></span></span><span> </span><span id="local-6989586621680053083"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053083"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053082"><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053082"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r -&gt; r -&gt; Point 2 r
forall (d :: Nat) r (n :: Nat).
(Arity d, Eq r, Num r) =&gt;
BezierSpline n d r -&gt; r -&gt; Point d r
</span><a href="Geometry.BezierSpline.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053082"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Point 2 r) -&gt; (Point 2 r -&gt; r) -&gt; Point 2 r -&gt; Point 2 r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
forall (n :: Nat) r.
(KnownNat n, Ord r, RealFrac r) =&gt;
r -&gt; BezierSpline n 2 r -&gt; Point 2 r -&gt; r
</span><a href="Geometry.BezierSpline.html#parameterOf"><span class="hs-identifier hs-var">parameterOf</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053083"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">BezierSpline n 2 r
</span><a href="#local-6989586621680053082"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- * Helper functions</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | Solve equation of the form ax^2 + bx + c = 0.</span><span>
</span><span id="line-590"></span><span class="hs-comment">--   If there are multiple solutions, report in ascending order.</span><span>
</span><span id="line-591"></span><span class="hs-comment">--   Attempt at a somewhat robust implementation.</span><span>
</span><span id="line-592"></span><span id="local-6989586621680053764"><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-type">solveQuadraticEquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Radical.Radical</span></span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680053764"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-593"></span><span id="solveQuadraticEquation"><span class="annot"><span class="annottext">solveQuadraticEquation :: r -&gt; r -&gt; r -&gt; [r]
</span><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var hs-var">solveQuadraticEquation</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- error &quot;infinite solutions&quot;</span><span>
</span><span id="line-594"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-597"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span id="local-6989586621680053081"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053081"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680053080"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053080"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[r] -&gt; [r]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053080"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053081"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span id="local-6989586621680053079"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053079"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680053078"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053078"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053078"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053079"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-599"></span><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053078"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053079"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-600"></span><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053078"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053079"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r -&gt; r
forall r. Radical r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">Radical.sqrt</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053078"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053079"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-601"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680053076"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053076"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053075"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053075"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053075"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053076"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-602"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span id="local-6989586621680053074"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053074"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680053073"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053073"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053072"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053072"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall r. (Fractional r, Ord r) =&gt; r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#almostzero"><span class="hs-identifier hs-var">almostzero</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053074"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall r. (Fractional r, Ord r) =&gt; r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#almostzero"><span class="hs-identifier hs-var">almostzero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053074"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053073"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall r. (Fractional r, Ord r) =&gt; r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#almostzero"><span class="hs-identifier hs-var">almostzero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053074"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053072"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r -&gt; [r]
forall r.
(Ord r, Enum r, Fractional r, Radical r) =&gt;
r -&gt; r -&gt; r -&gt; [r]
</span><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053073"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053072"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-603"></span><span class="annot"><a href="Geometry.BezierSpline.html#solveQuadraticEquation"><span class="hs-identifier hs-var">solveQuadraticEquation</span></a></span><span> </span><span id="local-6989586621680053070"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053070"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680053069"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053069"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680053068"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053068"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680053067"><span class="annot"><span class="annottext">d :: r
</span><a href="#local-6989586621680053067"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053069"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">r -&gt; Integer -&gt; r
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053070"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053068"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span id="local-6989586621680053066"><span class="annot"><span class="annottext">result :: [r]
</span><a href="#local-6989586621680053066"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053067"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053069"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053070"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053067"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053069"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Radical r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">Radical.sqrt</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053067"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053070"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053069"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Radical r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">Radical.sqrt</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053067"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053070"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621680053066"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-comment">-- trace (&quot;soving equation &quot; ++ show a ++ &quot;x^2 + &quot; ++ show b ++ &quot;x + &quot; ++ show c ++ &quot; = 0&quot;) $ result</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- | Test whether a floating point number is close enough to zero, taking rounding errors into account.</span><span>
</span><span id="line-612"></span><span id="local-6989586621680053583"><span class="annot"><a href="Geometry.BezierSpline.html#almostzero"><span class="hs-identifier hs-type">almostzero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053583"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053583"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053583"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-613"></span><span id="almostzero"><span class="annot"><span class="annottext">almostzero :: r -&gt; Bool
</span><a href="Geometry.BezierSpline.html#almostzero"><span class="hs-identifier hs-var hs-var">almostzero</span></a></span></span><span> </span><span id="local-6989586621680053065"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053065"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053065"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Fractional r =&gt; r
</span><a href="Geometry.BezierSpline.html#epsilon"><span class="hs-identifier hs-var">epsilon</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Treshold for rounding errors in almostzero test.</span><span>
</span><span id="line-616"></span><span class="hs-comment">--   TODO: Should be different depending on the type.</span><span>
</span><span id="line-617"></span><span id="local-6989586621680053581"><span class="annot"><a href="Geometry.BezierSpline.html#epsilon"><span class="hs-identifier hs-type">epsilon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053581"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053581"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-618"></span><span id="epsilon"><span class="annot"><span class="annottext">epsilon :: r
</span><a href="Geometry.BezierSpline.html#epsilon"><span class="hs-identifier hs-var hs-var">epsilon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.0001</span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- | This function tests whether a value lies within bounds of a given interval.</span><span>
</span><span id="line-622"></span><span class="hs-comment">--   If not, graciously continues with value snapped to interval.</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   This should never happen, but apparently it sometimes does?</span><span>
</span><span id="line-624"></span><span id="local-6989586621680053786"><span class="annot"><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-type">restrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053786"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053786"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053786"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053786"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053786"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-625"></span><span id="restrict"><span class="annot"><span class="annottext">restrict :: String -&gt; r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-var hs-var">restrict</span></a></span></span><span> </span><span id="local-6989586621680053062"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680053062"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680053061"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053061"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680053060"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053060"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680053059"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053059"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053061"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053060"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; r) -&gt; String -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680053062"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: restrict [l,r] is not an interval&quot;</span></span><span> </span><span class="hs-comment">--error $ f ++ &quot;: restrict: [&quot; ++ show l ++ &quot;, &quot; ++ show r ++ &quot;] is not an interval&quot;</span><span>
</span><span id="line-626"></span><span>                 </span><span class="hs-comment">--   | x &lt; l = trace (f ++ &quot;: restricting &quot; ++ show x ++ &quot; to [&quot; ++ show l ++ &quot;, &quot; ++ show r ++ &quot;]&quot;) l</span><span>
</span><span id="line-627"></span><span>                 </span><span class="hs-comment">--   | x &gt; r = trace (f ++ &quot;: restricting &quot; ++ show x ++ &quot; to [&quot; ++ show l ++ &quot;, &quot; ++ show r ++ &quot;]&quot;) r</span><span>
</span><span id="line-628"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053059"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span id="local-6989586621680053660"><span class="annot"><a href="Geometry.BezierSpline.html#binarySearch"><span class="hs-identifier hs-type">binarySearch</span></a></span><span>                                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>                                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053660"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-633"></span><span id="binarySearch"><span class="annot"><span class="annottext">binarySearch :: r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#binarySearch"><span class="hs-identifier hs-var hs-var">binarySearch</span></a></span></span><span> </span><span id="local-6989586621680053058"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053058"><span class="hs-identifier hs-var">treshold</span></a></span></span><span> </span><span id="local-6989586621680053057"><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680053056"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680053055"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053058"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r -&gt; r -&gt; r -&gt; r
forall r. Ord r =&gt; String -&gt; r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;binarySearch&quot;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span>   </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053054"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall r. Fractional r =&gt; (r -&gt; r) -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#derivative"><span class="hs-identifier hs-var">derivative</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053054"><span class="hs-identifier hs-var">m</span></a></span><span>  </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r -&gt; r -&gt; r -&gt; r
forall r. Ord r =&gt; String -&gt; r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;binarySearch&quot;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
forall r. (Ord r, Fractional r) =&gt; r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#binarySearch"><span class="hs-identifier hs-var">binarySearch</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053058"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053054"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r -&gt; r -&gt; r -&gt; r
forall r. Ord r =&gt; String -&gt; r -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;binarySearch&quot;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
forall r. (Ord r, Fractional r) =&gt; r -&gt; (r -&gt; r) -&gt; r -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#binarySearch"><span class="hs-identifier hs-var">binarySearch</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053058"><span class="hs-identifier hs-var">treshold</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053054"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680053054"><span class="annot"><span class="annottext">m :: r
</span><a href="#local-6989586621680053054"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053055"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span id="local-6989586621680053577"><span class="annot"><a href="Geometry.BezierSpline.html#derivative"><span class="hs-identifier hs-type">derivative</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680053577"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680053577"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053577"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053577"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053577"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-640"></span><span id="derivative"><span class="annot"><span class="annottext">derivative :: (r -&gt; r) -&gt; r -&gt; r
</span><a href="Geometry.BezierSpline.html#derivative"><span class="hs-identifier hs-var hs-var">derivative</span></a></span></span><span> </span><span id="local-6989586621680053052"><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053052"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680053051"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053051"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053052"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053051"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053050"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621680053052"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053051"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680053050"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680053050"><span class="annot"><span class="annottext">delta :: r
</span><a href="#local-6989586621680053050"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0.0000001</span></span><span>
</span><span id="line-642"></span></pre></body></html>