<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geometry.PlanarSubdivision.Dynamic</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdge"><span class="hs-identifier">splitEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdge"><span class="hs-identifier">unSplitEdge</span></a></span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFace"><span class="hs-identifier">sproutIntoFace</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFace"><span class="hs-identifier">splitFace</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Point.html"><span class="hs-identifier">Geometry.Point</span></a></span><span> </span><span class="hs-comment">-- hiding (Vector, head, imap)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.PlanarSubdivision.html"><span class="hs-identifier">Geometry.PlanarSubdivision</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html"><span class="hs-identifier">Geometry.PlanarSubdivision.Basic</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html"><span class="hs-identifier">Geometry.PlanarSubdivision.Raw</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">findIndex</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Arc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arc</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Direction</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Positive</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Negative</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.PlaneGraph.html"><span class="hs-identifier">Data.PlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.PlaneGraph.html"><span class="hs-identifier">Data.PlaneGraph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html"><span class="hs-identifier">Data.PlaneGraph.AdjRep</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#vData"><span class="hs-identifier">vData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fData</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">faces</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Face</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html"><span class="hs-identifier">Data.PlaneGraph.AdjRep</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#vData"><span class="hs-identifier">vData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">faces</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(//)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span id="tracingOn"><span class="annot"><span class="annottext">tracingOn :: Bool
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tracingOn"><span class="hs-identifier hs-var hs-var">tracingOn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span id="local-6989586621680055174"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055174"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055174"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055174"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-31"></span><span id="tr"><span class="annot"><span class="annottext">tr :: String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621680054629"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680054629"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680054628"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054628"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tracingOn"><span class="hs-identifier hs-var">tracingOn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\9608 &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680054629"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054628"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054628"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-32"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054628"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- TO DO:</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- ADD EDGE JOINING TWO COMPONENTS</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- CREATE NEW COMPONENT (SINGLE VERTEX)</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- DELETIONS</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Splits a given edge of a planar subdivision by inserting a new vertex on the edges.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--   Increases #vertices and #edges by 1.</span><span>
</span><span id="line-43"></span><span id="local-6989586621680054622"><span id="local-6989586621680054623"><span id="local-6989586621680054624"><span id="local-6989586621680054625"><span id="local-6989586621680054626"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdge"><span class="hs-identifier hs-type">splitEdge</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054624"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054623"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054622"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054622"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680054623"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054626"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054622"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054626"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054624"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054623"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054622"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054626"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054625"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054624"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054623"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span id="splitEdge"><span class="annot"><span class="annottext">splitEdge :: VertexId' s
-&gt; VertexId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdge"><span class="hs-identifier hs-var hs-var">splitEdge</span></a></span></span><span> </span><span id="local-6989586621680054621"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054621"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054620"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054620"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054619"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054619"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054618"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054618"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054617"><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054617"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054616"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054615"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054615"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054621"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-55"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054613"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054613"><span class="hs-identifier hs-var">lb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054620"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span id="local-6989586621680054612"><span class="annot"><span class="annottext">v' :: (VertexId' s, v)
</span><a href="#local-6989586621680054612"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeVertexId"><span class="hs-identifier hs-var">freeVertexId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054618"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>      </span><span id="local-6989586621680054610"><span class="annot"><span class="annottext">fd :: Dart s
</span><a href="#local-6989586621680054610"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Dart s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeDart"><span class="hs-identifier hs-var">freeDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span id="local-6989586621680054608"><span class="annot"><span class="annottext">f' :: (Dart s, e) -&gt; ((Dart s, e), (Dart s, e))
</span><a href="#local-6989586621680054608"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span id="local-6989586621680054607"><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621680054607"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054606"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054606"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621680054607"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054617"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054606"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054610"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054617"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054606"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><a href="#local-6989586621680054608"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span id="local-6989586621680054605"><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621680054605"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054604"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054604"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054610"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054617"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054604"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621680054605"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054617"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054604"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">String
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdge&quot;</span></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054616"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Component' s v e f r)
 -&gt; Identity (Vector (Component' s v e f r)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
Lens' (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-var">components'</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Component' s v e f r)
  -&gt; Identity (Vector (Component' s v e f r)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Component' s v e f r -&gt; Component' s v e f r)
-&gt; Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; Point 2 r
-&gt; (VertexId' s, v)
-&gt; ((Dart s, e) -&gt; ((Dart s, e), (Dart s, e)))
-&gt; Component' s v e f r
-&gt; Component' s v e f r
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
VertexId' s
-&gt; VertexId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInPlaneGraph"><span class="hs-identifier hs-var">splitEdgeInPlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054615"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054613"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054619"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexId' s, v)
</span><a href="#local-6989586621680054612"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s, e) -&gt; ((Dart s, e), (Dart s, e))
</span><a href="#local-6989586621680054608"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Sprouts a new edge from a given vertex into the interior of a given (incident) face.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--   Increases #vertices and #edges by 1.</span><span>
</span><span id="line-64"></span><span id="local-6989586621680054594"><span id="local-6989586621680054595"><span id="local-6989586621680054596"><span id="local-6989586621680054597"><span id="local-6989586621680054598"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFace"><span class="hs-identifier hs-type">sproutIntoFace</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054598"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054596"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054595"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054594"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054594"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680054595"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054598"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054594"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054597"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054596"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054595"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054594"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054597"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054596"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054595"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="sproutIntoFace"><span class="annot"><span class="annottext">sproutIntoFace :: VertexId' s
-&gt; FaceId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFace"><span class="hs-identifier hs-var hs-var">sproutIntoFace</span></a></span></span><span> </span><span id="local-6989586621680054593"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054593"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054592"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054592"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054591"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054591"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054590"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054590"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054589"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054589"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054588"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054588"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680054587"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680054586"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054586"><span class="hs-identifier hs-var">ea</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Dart s] -&gt; [Dart s]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[ea]&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; [Dart s] -&gt; [Dart s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054585"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054585"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054585"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054593"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054585"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054592"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexId' s -&gt; FaceId' s -&gt; [Dart s]
forall k (s :: k) a b v e f r.
(Incident s a (Dart s), Incident s b (Dart s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var">commonDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054593"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054592"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054580"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054580"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054593"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054579"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054579"><span class="hs-identifier hs-var">lc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054586"><span class="hs-identifier hs-var">ea</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span id="local-6989586621680054577"><span class="annot"><span class="annottext">v' :: (VertexId' s, v)
</span><a href="#local-6989586621680054577"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeVertexId"><span class="hs-identifier hs-var">freeVertexId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054590"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621680054576"><span class="annot"><span class="annottext">fd :: Dart s
</span><a href="#local-6989586621680054576"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Dart s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeDart"><span class="hs-identifier hs-var">freeDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621680054575"><span class="annot"><span class="annottext">e1' :: (Dart s, e)
</span><a href="#local-6989586621680054575"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054576"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054589"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>      </span><span id="local-6989586621680054574"><span class="annot"><span class="annottext">e2' :: (Dart s, e)
</span><a href="#local-6989586621680054574"><span class="hs-identifier hs-var hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054576"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054588"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">String
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sproutIntoFace&quot;</span></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054587"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Component' s v e f r)
 -&gt; Identity (Vector (Component' s v e f r)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
Lens' (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-var">components'</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Component' s v e f r)
  -&gt; Identity (Vector (Component' s v e f r)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Component' s v e f r -&gt; Component' s v e f r)
-&gt; Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; Point 2 r
-&gt; (VertexId' s, v)
-&gt; ((Dart s, e), (Dart s, e))
-&gt; Component' s v e f r
-&gt; Component' s v e f r
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
VertexId' s
-&gt; VertexId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFaceInPlaneGraph"><span class="hs-identifier hs-var">sproutIntoFaceInPlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054580"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054579"><span class="hs-identifier hs-var">lc</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054591"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexId' s, v)
</span><a href="#local-6989586621680054577"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s, e)
</span><a href="#local-6989586621680054575"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Dart s, e)
</span><a href="#local-6989586621680054574"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Inserts a new edge between two given vertices, adjacent to a common face.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--   Increases #edges and #faces by 1.</span><span>
</span><span id="line-86"></span><span id="local-6989586621680054568"><span id="local-6989586621680054569"><span id="local-6989586621680054570"><span id="local-6989586621680054571"><span id="local-6989586621680054572"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFace"><span class="hs-identifier hs-type">splitFace</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054572"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054571"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054569"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054568"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054568"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054571"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054571"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054568"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054572"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054571"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054569"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054568"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054572"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054571"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054570"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054569"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="splitFace"><span class="annot"><span class="annottext">splitFace :: VertexId' s
-&gt; VertexId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFace"><span class="hs-identifier hs-var hs-var">splitFace</span></a></span></span><span> </span><span id="local-6989586621680054567"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054567"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054566"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054566"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054565"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054565"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054564"><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054564"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680054563"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054563"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054562"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680054562"><span class="hs-identifier hs-var">ca</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054567"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054563"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680054561"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680054561"><span class="hs-identifier hs-var">cb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054566"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054563"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680054562"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s -&gt; ComponentId s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680054561"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; VertexId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k r v e f (s :: k).
(Show r, Show v, Show e, Show f) =&gt;
VertexId' s
-&gt; VertexId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceSameComponent"><span class="hs-identifier hs-var">splitFaceSameComponent</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054567"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054566"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054565"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054564"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054563"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-99"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; VertexId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall a. a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceDifferentComponents"><span class="hs-identifier hs-var">splitFaceDifferentComponents</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054567"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054566"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054565"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054564"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054563"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="splitFaceSameComponent"><span class="annot"><span class="annottext">splitFaceSameComponent :: VertexId' s
-&gt; VertexId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceSameComponent"><span class="hs-identifier hs-var hs-var">splitFaceSameComponent</span></a></span></span><span> </span><span id="local-6989586621680054558"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054558"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054557"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054557"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054556"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054556"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054555"><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054555"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680054554"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054553"><span class="annot"><span class="annottext">fs :: [FaceId' s]
</span><a href="#local-6989586621680054553"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; VertexId' s -&gt; VertexId' s -&gt; [FaceId' s]
forall k (s :: k) a b v e f r.
(Incident s a (FaceId' s), Incident s b (FaceId' s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [FaceId' s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonFaces"><span class="hs-identifier hs-var">commonFaces</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054558"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054557"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-103"></span><span>      </span><span id="local-6989586621680054551"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FaceId' s] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[FaceId' s]
</span><a href="#local-6989586621680054553"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; FaceId' s -&gt; FaceId' s
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f(a)&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; FaceId' s) -&gt; FaceId' s -&gt; FaceId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [FaceId' s] -&gt; FaceId' s
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceSameComponent f&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FaceId' s]
</span><a href="#local-6989586621680054553"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; FaceId' s -&gt; FaceId' s
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f(b)&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; FaceId' s) -&gt; FaceId' s -&gt; FaceId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [FaceId' s] -&gt; FaceId' s
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceSameComponent f&quot;</span></span><span> </span><span class="annot"><span class="annottext">([FaceId' s] -&gt; FaceId' s) -&gt; [FaceId' s] -&gt; FaceId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; Bool) -&gt; [FaceId' s] -&gt; [FaceId' s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (FaceId' s -&gt; Bool) -&gt; FaceId' s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; Bool
forall k (s :: k). FaceId' s -&gt; Bool
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#isOuterFace"><span class="hs-identifier hs-var">isOuterFace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FaceId' s]
</span><a href="#local-6989586621680054553"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621680054545"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054545"><span class="hs-identifier hs-var">ea</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Dart s] -&gt; [Dart s]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[ea]&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; [Dart s] -&gt; [Dart s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054544"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054544"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054544"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054558"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054544"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexId' s -&gt; FaceId' s -&gt; [Dart s]
forall k (s :: k) a b v e f r.
(Incident s a (Dart s), Incident s b (Dart s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var">commonDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054558"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621680054543"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054543"><span class="hs-identifier hs-var">eb</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Dart s] -&gt; [Dart s]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[eb]&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; [Dart s] -&gt; [Dart s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054542"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054542"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054542"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054557"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054542"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexId' s -&gt; FaceId' s -&gt; [Dart s]
forall k (s :: k) a b v e f r.
(Incident s a (Dart s), Incident s b (Dart s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var">commonDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054557"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054541"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054541"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054558"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054540"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054540"><span class="hs-identifier hs-var">lb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054557"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054539"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054539"><span class="hs-identifier hs-var">lc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054545"><span class="hs-identifier hs-var">ea</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054538"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054538"><span class="hs-identifier hs-var">ld</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054543"><span class="hs-identifier hs-var">eb</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054537"><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680054537"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; NonEmpty
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; NonEmpty (ComponentId s, FaceId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalF"><span class="hs-identifier hs-var">asLocalF</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054551"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-112"></span><span>      </span><span id="local-6989586621680054534"><span class="annot"><span class="annottext">fd :: Dart s
</span><a href="#local-6989586621680054534"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Dart s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeDart"><span class="hs-identifier hs-var">freeDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span id="local-6989586621680054533"><span class="annot"><span class="annottext">e' :: ((Dart s, e), (Dart s, e))
</span><a href="#local-6989586621680054533"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054534"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054556"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054534"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054556"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>      </span><span id="local-6989586621680054532"><span class="annot"><span class="annottext">tf :: FaceId' s
</span><a href="#local-6989586621680054532"><span class="hs-identifier hs-var hs-var">tf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeFaceId"><span class="hs-identifier hs-var">freeFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621680054530"><span class="annot"><span class="annottext">g' :: (FaceId' s, f) -&gt; ((FaceId' s, f), (FaceId' s, f))
</span><a href="#local-6989586621680054530"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054529"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054529"><span class="hs-identifier hs-var">ef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054528"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054528"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054529"><span class="hs-identifier hs-var">ef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(f, f) -&gt; f
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((f, f) -&gt; f) -&gt; (f, f) -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054555"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054528"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054532"><span class="hs-identifier hs-var">tf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(f, f) -&gt; f
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((f, f) -&gt; f) -&gt; (f, f) -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054555"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054528"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceSameComponent&quot;</span></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Component' s v e f r)
 -&gt; Identity (Vector (Component' s v e f r)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
Lens' (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-var">components'</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Component' s v e f r)
  -&gt; Identity (Vector (Component' s v e f r)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Component' s v e f r -&gt; Component' s v e f r)
-&gt; Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; FaceId' (Wrap s)
-&gt; ((Dart s, e), (Dart s, e))
-&gt; ((FaceId' s, f) -&gt; ((FaceId' s, f), (FaceId' s, f)))
-&gt; Component' s v e f r
-&gt; Component' s v e f r
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; FaceId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInPlaneGraph"><span class="hs-identifier hs-var">splitFaceInPlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VertexId' (Wrap s) -&gt; VertexId' (Wrap s)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;la&quot;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054541"><span class="hs-identifier hs-var">la</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VertexId' (Wrap s) -&gt; VertexId' (Wrap s)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lb&quot;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054540"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VertexId' (Wrap s) -&gt; VertexId' (Wrap s)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lc&quot;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054539"><span class="hs-identifier hs-var">lc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VertexId' (Wrap s) -&gt; VertexId' (Wrap s)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ld&quot;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054538"><span class="hs-identifier hs-var">ld</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FaceId' (Wrap s) -&gt; FaceId' (Wrap s)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lf&quot;</span></span><span> </span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680054537"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Dart s, e), (Dart s, e))
</span><a href="#local-6989586621680054533"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">(FaceId' s, f) -&gt; ((FaceId' s, f), (FaceId' s, f))
</span><a href="#local-6989586621680054530"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="splitFaceDifferentComponents"><span class="annot"><span class="annottext">splitFaceDifferentComponents :: a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceDifferentComponents"><span class="hs-identifier hs-var hs-var">splitFaceDifferentComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Splits a given edge of a planar subdivision by inserting a new vertex on the edges.</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   Increases #vertices and #edges by 1.</span><span>
</span><span id="line-123"></span><span id="local-6989586621680054521"><span id="local-6989586621680054522"><span id="local-6989586621680054523"><span id="local-6989586621680054524"><span id="local-6989586621680054525"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdge"><span class="hs-identifier hs-type">unSplitEdge</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054525"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054523"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054522"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054521"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054525"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054522"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054525"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054524"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054522"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="unSplitEdge"><span class="annot"><span class="annottext">unSplitEdge :: VertexId' s
-&gt; ((e, e) -&gt; e)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdge"><span class="hs-identifier hs-var hs-var">unSplitEdge</span></a></span></span><span> </span><span id="local-6989586621680054520"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054520"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054519"><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054519"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054518"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680054517"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054517"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054516"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054516"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [VertexId' s] -&gt; [VertexId' s]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[a, c]&quot;</span></span><span> </span><span class="annot"><span class="annottext">([VertexId' s] -&gt; [VertexId' s]) -&gt; [VertexId' s] -&gt; [VertexId' s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexId' s) -&gt; [VertexId' s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; [VertexId' s])
-&gt; Vector (VertexId' s) -&gt; [VertexId' s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#neighboursOf"><span class="hs-identifier hs-var">neighboursOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054520"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054514"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054514"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054517"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054513"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054513"><span class="hs-identifier hs-var">lb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054520"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054512"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054512"><span class="hs-identifier hs-var">lc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054516"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621680054511"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054511"><span class="hs-identifier hs-var">dab</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; [Dart s] -&gt; [Dart s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054510"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054510"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054510"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054517"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; VertexId' s -&gt; VertexId' s -&gt; [Dart s]
forall k (s :: k) a b v e f r.
(Incident s a (Dart s), Incident s b (Dart s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var">commonDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054517"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054520"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621680054509"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054509"><span class="hs-identifier hs-var">dcb</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; [Dart s] -&gt; [Dart s]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054508"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054508"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054508"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054516"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [Dart s]) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; VertexId' s -&gt; VertexId' s -&gt; [Dart s]
forall k (s :: k) a b v e f r.
(Incident s a (Dart s), Incident s b (Dart s)) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var">commonDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054520"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054516"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span id="local-6989586621680054507"><span class="annot"><span class="annottext">f' :: ((Dart s, e), (Dart s, e)) -&gt; (Dart s, e)
</span><a href="#local-6989586621680054507"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680054506"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054506"><span class="hs-identifier hs-var">di</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054505"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054505"><span class="hs-identifier hs-var">ei</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054504"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054504"><span class="hs-identifier hs-var">dj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054503"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054503"><span class="hs-identifier hs-var">ej</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054506"><span class="hs-identifier hs-var">di</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054511"><span class="hs-identifier hs-var">dab</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>     </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054511"><span class="hs-identifier hs-var">dab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054505"><span class="hs-identifier hs-var">ei</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054503"><span class="hs-identifier hs-var">ej</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054506"><span class="hs-identifier hs-var">di</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054509"><span class="hs-identifier hs-var">dcb</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054511"><span class="hs-identifier hs-var">dab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054505"><span class="hs-identifier hs-var">ei</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054503"><span class="hs-identifier hs-var">ej</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Dart s, e)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;you shouldn't call f' on any other dart&quot;</span></span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-comment">-- no longer used: vertex id b and dart id dcb</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">String
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unSplitEdge&quot;</span></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054518"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Component' s v e f r)
 -&gt; Identity (Vector (Component' s v e f r)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
Lens' (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-var">components'</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Component' s v e f r)
  -&gt; Identity (Vector (Component' s v e f r)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Component' s v e f r -&gt; Component' s v e f r)
-&gt; Vector (Component' s v e f r) -&gt; Vector (Component' s v e f r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; VertexId' (Wrap s)
-&gt; (((Dart s, e), (Dart s, e)) -&gt; (Dart s, e))
-&gt; Component' s v e f r
-&gt; Component' s v e f r
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; ((e, e) -&gt; e)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInPlaneGraph"><span class="hs-identifier hs-var">unSplitEdgeInPlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054514"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054513"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054512"><span class="hs-identifier hs-var">lc</span></a></span><span> </span><span class="annot"><span class="annottext">((Dart s, e), (Dart s, e)) -&gt; (Dart s, e)
</span><a href="#local-6989586621680054507"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- globally, need to restore VertexId and DartIds ???</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- nodig:</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621680055194"><span id="local-6989586621680055195"><span id="local-6989586621680055196"><span id="local-6989586621680055197"><span id="local-6989586621680055198"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#freeVertexId"><span class="hs-identifier hs-type">freeVertexId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055198"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055197"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055196"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055195"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055194"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055198"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-151"></span><span id="local-6989586621680055188"><span id="local-6989586621680055189"><span id="local-6989586621680055190"><span id="local-6989586621680055191"><span id="local-6989586621680055192"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#freeDart"><span class="hs-identifier hs-type">freeDart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055192"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055191"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055190"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055189"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055188"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680055192"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-152"></span><span id="local-6989586621680055071"><span id="local-6989586621680055072"><span id="local-6989586621680055073"><span id="local-6989586621680055074"><span id="local-6989586621680055075"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#freeFaceId"><span class="hs-identifier hs-type">freeFaceId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055075"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055074"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055073"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055072"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055071"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055075"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="freeVertexId"><span class="annot"><span class="annottext">freeVertexId :: PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeVertexId"><span class="hs-identifier hs-var hs-var">freeVertexId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VertexId' s)
-&gt; (PlanarSubdivision s v e f r -&gt; Int)
-&gt; PlanarSubdivision s v e f r
-&gt; VertexId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier hs-var">numVertices</span></a></span><span>
</span><span id="line-155"></span><span id="freeDart"><span class="annot"><span class="annottext">freeDart :: PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeDart"><span class="hs-identifier hs-var hs-var">freeDart</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Arc s -&gt; Direction -&gt; Dart s) -&gt; Direction -&gt; Arc s -&gt; Dart s
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span> </span><span class="annot"><span class="annottext">(Arc s -&gt; Dart s)
-&gt; (PlanarSubdivision s v e f r -&gt; Arc s)
-&gt; PlanarSubdivision s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Arc s)
-&gt; (PlanarSubdivision s v e f r -&gt; Int)
-&gt; PlanarSubdivision s v e f r
-&gt; Arc s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numEdges"><span class="hs-identifier hs-var">numEdges</span></a></span><span>
</span><span id="line-156"></span><span id="freeFaceId"><span class="annot"><span class="annottext">freeFaceId :: PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#freeFaceId"><span class="hs-identifier hs-var hs-var">freeFaceId</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId s 'Dual -&gt; FaceId' s
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s 'Dual -&gt; FaceId' s)
-&gt; (PlanarSubdivision s v e f r -&gt; VertexId s 'Dual)
-&gt; PlanarSubdivision s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VertexId s 'Dual)
-&gt; (PlanarSubdivision s v e f r -&gt; Int)
-&gt; PlanarSubdivision s v e f r
-&gt; VertexId s 'Dual
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier hs-var">numFaces</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621680055163"><span id="local-6989586621680055164"><span id="local-6989586621680055165"><span id="local-6989586621680055166"><span id="local-6989586621680055167"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-type">components'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055167"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055166"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055165"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055163"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055167"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055166"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055165"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055163"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055167"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055166"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055165"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span id="Component%27"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-var">Component'</span></a></span></span><span> </span><span id="local-6989586621680054496"><span class="annot"><a href="#local-6989586621680054496"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680054495"><span class="annot"><a href="#local-6989586621680054495"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680054494"><span class="annot"><a href="#local-6989586621680054494"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680054493"><span class="annot"><a href="#local-6989586621680054493"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680054492"><span class="annot"><a href="#local-6989586621680054492"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054496"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054496"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054495"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680054496"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054494"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054496"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054493"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680054492"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-160"></span><span id="components%27"><span class="annot"><span class="annottext">components' :: Lens' (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#components%27"><span class="hs-identifier hs-var hs-var">components'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; Vector (Component' s v e f r))
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (Component' s v e f r) -&gt; PlanarSubdivision s v e f r)
-&gt; Lens'
     (PlanarSubdivision s v e f r) (Vector (Component' s v e f r))
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Component' s v e f r)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Component' s v e f r)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getComponents%27"><span class="hs-identifier hs-var">getComponents'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (Component' s v e f r) -&gt; PlanarSubdivision s v e f r
forall k v e f r (s :: k).
(Show v, Show e, Show f, Show r) =&gt;
PlanarSubdivision s v e f r
-&gt; Vector (Component' s v e f r) -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#setComponents%27"><span class="hs-identifier hs-var">setComponents'</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621680054983"><span id="local-6989586621680054984"><span id="local-6989586621680054985"><span id="local-6989586621680054986"><span id="local-6989586621680054987"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#getComponents%27"><span class="hs-identifier hs-type">getComponents'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054986"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054985"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054984"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054983"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054986"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054985"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054984"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054983"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-163"></span><span id="getComponents%27"><span class="annot"><span class="annottext">getComponents' :: PlanarSubdivision s v e f r -&gt; Vector (Component' s v e f r)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getComponents%27"><span class="hs-identifier hs-var hs-var">getComponents'</span></a></span></span><span> </span><span id="local-6989586621680054488"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054488"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
 -&gt; Component' s v e f r)
-&gt; Vector
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Component' s v e f r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Component' s v e f r
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Component s r -&gt; Component' s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#addExtraData"><span class="hs-identifier hs-var">addExtraData</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054488"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; Vector (Component' s v e f r))
-&gt; Vector
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Component' s v e f r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054488"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
     (PlanarSubdivision s v e f r)
     (Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; Vector
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
  (PlanarSubdivision s v e f r)
  (Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
forall k (s :: k) v e f r1 r2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f r2)
  (Vector (Component s r1))
  (Vector (Component s r2))
</span><a href="Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier hs-var">components</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621680054965"><span id="local-6989586621680054966"><span id="local-6989586621680054967"><span id="local-6989586621680054968"><span id="local-6989586621680054969"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#addExtraData"><span class="hs-identifier hs-type">addExtraData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054969"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054968"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054967"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054966"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054965"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054969"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054965"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054969"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054968"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054967"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054966"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054965"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-166"></span><span id="addExtraData"><span class="annot"><span class="annottext">addExtraData :: PlanarSubdivision s v e f r
-&gt; Component s r -&gt; Component' s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#addExtraData"><span class="hs-identifier hs-var hs-var">addExtraData</span></a></span></span><span> </span><span id="local-6989586621680054484"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054484"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054483"><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621680054483"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621680054483"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Component s r
-&gt; (Component s r
    -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r)
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; Identity (Vector (VertexId' s, v)))
-&gt; Component s r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">PG.vertexData</span></a></span><span>  </span><span class="annot"><span class="annottext">((Vector (VertexId' s) -&gt; Identity (Vector (VertexId' s, v)))
 -&gt; Component s r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r))
-&gt; ((VertexId' s -&gt; Identity (VertexId' s, v))
    -&gt; Vector (VertexId' s) -&gt; Identity (Vector (VertexId' s, v)))
-&gt; (VertexId' s -&gt; Identity (VertexId' s, v))
-&gt; Component s r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; Identity (VertexId' s, v))
-&gt; Vector (VertexId' s) -&gt; Identity (Vector (VertexId' s, v))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((VertexId' s -&gt; Identity (VertexId' s, v))
 -&gt; Component s r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r))
-&gt; (VertexId' s -&gt; (VertexId' s, v))
-&gt; Component s r
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054480"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054480"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054480"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting v (PlanarSubdivision s v e f r) v -&gt; v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054480"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                     </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
-&gt; (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
    -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r)
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Identity (Vector (Dart s, e)))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector e)
  (Vector e')
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var">PG.rawDartData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Dart s) -&gt; Identity (Vector (Dart s, e)))
 -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r))
-&gt; ((Dart s -&gt; Identity (Dart s, e))
    -&gt; Vector (Dart s) -&gt; Identity (Vector (Dart s, e)))
-&gt; (Dart s -&gt; Identity (Dart s, e))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Identity (Dart s, e))
-&gt; Vector (Dart s) -&gt; Identity (Vector (Dart s, e))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((Dart s -&gt; Identity (Dart s, e))
 -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r))
-&gt; (Dart s -&gt; (Dart s, e))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s) (FaceId' s) r
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054477"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054477"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054477"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting e (PlanarSubdivision s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054477"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>                     </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
-&gt; (PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
    -&gt; Component' s v e f r)
-&gt; Component' s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Identity (Vector (FaceId' s, f)))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
-&gt; Identity (Component' s v e f r)
forall k (s :: k) v e f r f'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (Vector f)
  (Vector f')
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var">PG.faceData</span></a></span><span>    </span><span class="annot"><span class="annottext">((Vector (FaceId' s) -&gt; Identity (Vector (FaceId' s, f)))
 -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
 -&gt; Identity (Component' s v e f r))
-&gt; ((FaceId' s -&gt; Identity (FaceId' s, f))
    -&gt; Vector (FaceId' s) -&gt; Identity (Vector (FaceId' s, f)))
-&gt; (FaceId' s -&gt; Identity (FaceId' s, f))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
-&gt; Identity (Component' s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; Identity (FaceId' s, f))
-&gt; Vector (FaceId' s) -&gt; Identity (Vector (FaceId' s, f))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((FaceId' s -&gt; Identity (FaceId' s, f))
 -&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
 -&gt; Identity (Component' s v e f r))
-&gt; (FaceId' s -&gt; (FaceId' s, f))
-&gt; PlaneGraph (Wrap s) (VertexId' s, v) (Dart s, e) (FaceId' s) r
-&gt; Component' s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054475"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054475"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054475"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting f (PlanarSubdivision s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054475"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621680054977"><span id="local-6989586621680054978"><span id="local-6989586621680054979"><span id="local-6989586621680054980"><span id="local-6989586621680054981"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#setComponents%27"><span class="hs-identifier hs-type">setComponents'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054981"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054980"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054979"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054978"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054977"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054981"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054980"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054979"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054978"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054977"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054981"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054980"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054979"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054978"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054977"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054981"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054980"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054979"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054978"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-171"></span><span id="setComponents%27"><span class="annot"><span class="annottext">setComponents' :: PlanarSubdivision s v e f r
-&gt; Vector (Component' s v e f r) -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#setComponents%27"><span class="hs-identifier hs-var hs-var">setComponents'</span></a></span></span><span> </span><span id="local-6989586621680054474"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054474"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054473"><span class="annot"><span class="annottext">Vector (Component' s v e f r)
</span><a href="#local-6989586621680054473"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680054474"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Component s r) -&gt; Identity (Vector (Component s r)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r1 r2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f r2)
  (Vector (Component s r1))
  (Vector (Component s r2))
</span><a href="Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Component s r) -&gt; Identity (Vector (Component s r)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; Vector (Component s r)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">(Component' s v e f r -&gt; Component s r)
-&gt; Vector (Component' s v e f r) -&gt; Vector (Component s r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r -&gt; Component s r
forall k (s :: k) v e f r. Component' s v e f r -&gt; Component s r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#remExtraData"><span class="hs-identifier hs-var">remExtraData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
</span><a href="#local-6989586621680054473"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-172"></span><span>                        </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r1 v2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v2 e f r1)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v2))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) v)
  -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rawVertexData&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; ([(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall i a. (Enum i, Show i) =&gt; [(i, a)] -&gt; Vector a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#vectorise"><span class="hs-identifier hs-var">vectorise</span></a></span><span> </span><span class="annot"><span class="annottext">([(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
 -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
forall k (s :: k) v e f r.
Vector (Component' s v e f r)
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawVertexData"><span class="hs-identifier hs-var">getRawVertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
</span><a href="#local-6989586621680054473"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                        </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e)
 -&gt; Identity (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r1 e2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e2 f r1)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e2))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span>   </span><span class="annot"><span class="annottext">((Vector (Raw s (Dart (Wrap s)) e)
  -&gt; Identity (Vector (Raw s (Dart (Wrap s)) e)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rawDartData&quot;</span></span><span>   </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e)
 -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; ([(Dart s, Raw s (Dart (Wrap s)) e)]
    -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Dart s, Raw s (Dart (Wrap s)) e)]
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall i a. (Enum i, Show i) =&gt; [(i, a)] -&gt; Vector a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#vectorise"><span class="hs-identifier hs-var">vectorise</span></a></span><span> </span><span class="annot"><span class="annottext">([(Dart s, Raw s (Dart (Wrap s)) e)]
 -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
forall k (s :: k) v e f r.
Vector (Component' s v e f r)
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawEdgeData"><span class="hs-identifier hs-var">getRawEdgeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
</span><a href="#local-6989586621680054473"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                        </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r1 f2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f2 r1)
  (Vector (RawFace s f))
  (Vector (RawFace s f2))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span>   </span><span class="annot"><span class="annottext">((Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rawFaceData&quot;</span></span><span>   </span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; ([(FaceId' s, RawFace s f)] -&gt; Vector (RawFace s f))
-&gt; [(FaceId' s, RawFace s f)]
-&gt; Vector (RawFace s f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(FaceId' s, RawFace s f)] -&gt; Vector (RawFace s f)
forall i a. (Enum i, Show i) =&gt; [(i, a)] -&gt; Vector a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#vectorise"><span class="hs-identifier hs-var">vectorise</span></a></span><span> </span><span class="annot"><span class="annottext">([(FaceId' s, RawFace s f)] -&gt; Vector (RawFace s f))
-&gt; [(FaceId' s, RawFace s f)] -&gt; Vector (RawFace s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r) -&gt; [(FaceId' s, RawFace s f)]
forall k (s :: k) v e f r.
Vector (Component' s v e f r) -&gt; [(FaceId' s, RawFace s f)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawFaceData"><span class="hs-identifier hs-var">getRawFaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r)
</span><a href="#local-6989586621680054473"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621680054893"><span id="local-6989586621680054894"><span id="local-6989586621680054895"><span id="local-6989586621680054896"><span id="local-6989586621680054897"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawVertexData"><span class="hs-identifier hs-type">getRawVertexData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054896"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054895"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054894"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054893"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054897"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054897"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680054896"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-178"></span><span id="getRawVertexData"><span class="annot"><span class="annottext">getRawVertexData :: Vector (Component' s v e f r)
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawVertexData"><span class="hs-identifier hs-var hs-var">getRawVertexData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]]
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]]
 -&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)])
-&gt; (Vector (Component' s v e f r)
    -&gt; [[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]])
-&gt; Vector (Component' s v e f r)
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; Component' s v e f r
 -&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)])
-&gt; [Component' s v e f r]
-&gt; [[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]]
forall i (f :: * -&gt; *) a b.
FunctorWithIndex i f =&gt;
(i -&gt; a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054461"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054461"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680054460"><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054460"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((VertexId' (Wrap s), VertexData r (VertexId' s, v))
 -&gt; (VertexId' s, Raw s (VertexId' (Wrap s)) v))
-&gt; [(VertexId' (Wrap s), VertexData r (VertexId' s, v))]
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680054459"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054459"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054457"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054457"><span class="hs-identifier hs-var">gi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054456"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054456"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054457"><span class="hs-identifier hs-var">gi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId s
-&gt; VertexId' (Wrap s) -&gt; v -&gt; Raw s (VertexId' (Wrap s)) v
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054461"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680054459"><span class="hs-identifier hs-var">li</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054456"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(VertexId' (Wrap s), VertexData r (VertexId' s, v))]
 -&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)])
-&gt; [(VertexId' (Wrap s), VertexData r (VertexId' s, v))]
-&gt; [(VertexId' s, Raw s (VertexId' (Wrap s)) v)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexId' (Wrap s), VertexData r (VertexId' s, v))
-&gt; [(VertexId' (Wrap s), VertexData r (VertexId' s, v))]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' (Wrap s), VertexData r (VertexId' s, v))
 -&gt; [(VertexId' (Wrap s), VertexData r (VertexId' s, v))])
-&gt; Vector (VertexId' (Wrap s), VertexData r (VertexId' s, v))
-&gt; [(VertexId' (Wrap s), VertexData r (VertexId' s, v))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
-&gt; Vector (VertexId' (Wrap s), VertexData r (VertexId' s, v))
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var">PG.vertices</span></a></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054460"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component' s v e f r]
 -&gt; [[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]])
-&gt; (Vector (Component' s v e f r) -&gt; [Component' s v e f r])
-&gt; Vector (Component' s v e f r)
-&gt; [[(VertexId' s, Raw s (VertexId' (Wrap s)) v)]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r) -&gt; [Component' s v e f r]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">--getEdgeData :: Vector (Component' s v e f r) -&gt; [(Dart s, (Dart s, e))]</span><span>
</span><span id="line-181"></span><span class="hs-comment">--getEdgeData = map (\(a, b) -&gt; (a, (a, b))) . concatMap (toList . (^. PG.rawDartData)) . toList</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="local-6989586621680054885"><span id="local-6989586621680054886"><span id="local-6989586621680054887"><span id="local-6989586621680054888"><span id="local-6989586621680054889"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawEdgeData"><span class="hs-identifier hs-type">getRawEdgeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054889"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054888"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054887"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054885"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680054889"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054889"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054889"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680054887"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-185"></span><span id="getRawEdgeData"><span class="annot"><span class="annottext">getRawEdgeData :: Vector (Component' s v e f r)
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawEdgeData"><span class="hs-identifier hs-var hs-var">getRawEdgeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Dart s, Raw s (Dart (Wrap s)) e)]]
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(Dart s, Raw s (Dart (Wrap s)) e)]]
 -&gt; [(Dart s, Raw s (Dart (Wrap s)) e)])
-&gt; (Vector (Component' s v e f r)
    -&gt; [[(Dart s, Raw s (Dart (Wrap s)) e)]])
-&gt; Vector (Component' s v e f r)
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; Component' s v e f r -&gt; [(Dart s, Raw s (Dart (Wrap s)) e)])
-&gt; [Component' s v e f r] -&gt; [[(Dart s, Raw s (Dart (Wrap s)) e)]]
forall i (f :: * -&gt; *) a b.
FunctorWithIndex i f =&gt;
(i -&gt; a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054452"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054452"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680054451"><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054451"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Dart (Wrap s), (Dart s, e)) -&gt; (Dart s, Raw s (Dart (Wrap s)) e))
-&gt; [(Dart (Wrap s), (Dart s, e))]
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680054450"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680054450"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054449"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054449"><span class="hs-identifier hs-var">gi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054448"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054448"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680054449"><span class="hs-identifier hs-var">gi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId s -&gt; Dart (Wrap s) -&gt; e -&gt; Raw s (Dart (Wrap s)) e
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054452"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680054450"><span class="hs-identifier hs-var">li</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054448"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Dart (Wrap s), (Dart s, e))]
 -&gt; [(Dart s, Raw s (Dart (Wrap s)) e)])
-&gt; [(Dart (Wrap s), (Dart s, e))]
-&gt; [(Dart s, Raw s (Dart (Wrap s)) e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart (Wrap s), (Dart s, e))
-&gt; [(Dart (Wrap s), (Dart s, e))]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart (Wrap s), (Dart s, e))
 -&gt; [(Dart (Wrap s), (Dart s, e))])
-&gt; Vector (Dart (Wrap s), (Dart s, e))
-&gt; [(Dart (Wrap s), (Dart s, e))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r -&gt; Vector (Dart (Wrap s), (Dart s, e))
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier hs-var">PG.darts</span></a></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054451"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component' s v e f r] -&gt; [[(Dart s, Raw s (Dart (Wrap s)) e)]])
-&gt; (Vector (Component' s v e f r) -&gt; [Component' s v e f r])
-&gt; Vector (Component' s v e f r)
-&gt; [[(Dart s, Raw s (Dart (Wrap s)) e)]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r) -&gt; [Component' s v e f r]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">--getFaceData :: Vector (Component' s v e f r) -&gt; [(FaceId' s, f)]</span><span>
</span><span id="line-189"></span><span class="hs-comment">--getFaceData = concatMap (toList . (^. PG.faceData)) . toList</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- data RawFace	s f</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- _faceIdx :: !(Maybe (ComponentId s, FaceId' (Wrap s)))</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- _faceDataVal :: !(FaceData (Dart s) f)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Something in this implementation is not right. It makes asLocalF produce an error.</span><span>
</span><span id="line-197"></span><span id="local-6989586621680054876"><span id="local-6989586621680054877"><span id="local-6989586621680054878"><span id="local-6989586621680054879"><span id="local-6989586621680054880"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawFaceData"><span class="hs-identifier hs-type">getRawFaceData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054880"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054879"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054878"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054877"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054876"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680054880"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054880"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054877"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-199"></span><span id="getRawFaceData"><span class="annot"><span class="annottext">getRawFaceData :: Vector (Component' s v e f r) -&gt; [(FaceId' s, RawFace s f)]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#getRawFaceData"><span class="hs-identifier hs-var hs-var">getRawFaceData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(FaceId' s, RawFace s f)]] -&gt; [(FaceId' s, RawFace s f)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(FaceId' s, RawFace s f)]] -&gt; [(FaceId' s, RawFace s f)])
-&gt; (Vector (Component' s v e f r) -&gt; [[(FaceId' s, RawFace s f)]])
-&gt; Vector (Component' s v e f r)
-&gt; [(FaceId' s, RawFace s f)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Component' s v e f r -&gt; [(FaceId' s, RawFace s f)])
-&gt; [Component' s v e f r] -&gt; [[(FaceId' s, RawFace s f)]]
forall i (f :: * -&gt; *) a b.
FunctorWithIndex i f =&gt;
(i -&gt; a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054446"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054446"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680054445"><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054445"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((FaceId' (Wrap s), (FaceId' s, f)) -&gt; (FaceId' s, RawFace s f))
-&gt; [(FaceId' (Wrap s), (FaceId' s, f))]
-&gt; [(FaceId' s, RawFace s f)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; (FaceId' (Wrap s), (FaceId' s, f)) -&gt; (FaceId' s, RawFace s f)
forall k k (s :: k) (s :: k) f.
Int
-&gt; (FaceId' (Wrap s), (FaceId' s, f)) -&gt; (FaceId' s, RawFace s f)
</span><a href="#local-6989586621680054444"><span class="hs-identifier hs-var">bla</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054446"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(FaceId' (Wrap s), (FaceId' s, f))]
 -&gt; [(FaceId' s, RawFace s f)])
-&gt; [(FaceId' (Wrap s), (FaceId' s, f))]
-&gt; [(FaceId' s, RawFace s f)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (FaceId' (Wrap s), (FaceId' s, f))
-&gt; [(FaceId' (Wrap s), (FaceId' s, f))]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' (Wrap s), (FaceId' s, f))
 -&gt; [(FaceId' (Wrap s), (FaceId' s, f))])
-&gt; Vector (FaceId' (Wrap s), (FaceId' s, f))
-&gt; [(FaceId' (Wrap s), (FaceId' s, f))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r -&gt; Vector (FaceId' (Wrap s), (FaceId' s, f))
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-var">PG.faces</span></a></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054445"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component' s v e f r] -&gt; [[(FaceId' s, RawFace s f)]])
-&gt; (Vector (Component' s v e f r) -&gt; [Component' s v e f r])
-&gt; Vector (Component' s v e f r)
-&gt; [[(FaceId' s, RawFace s f)]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component' s v e f r) -&gt; [Component' s v e f r]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621680054444"><span class="annot"><span class="annottext">bla :: Int
-&gt; (FaceId' (Wrap s), (FaceId' s, f)) -&gt; (FaceId' s, RawFace s f)
</span><a href="#local-6989586621680054444"><span class="hs-identifier hs-var hs-var">bla</span></a></span></span><span> </span><span id="local-6989586621680054442"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054442"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054441"><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680054441"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680054440"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054440"><span class="hs-identifier hs-var">gi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054439"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054439"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; Bool
forall k (s :: k). FaceId' s -&gt; Bool
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#isOuterFace"><span class="hs-identifier hs-var">isOuterFace</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054440"><span class="hs-identifier hs-var">gi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054440"><span class="hs-identifier hs-var">gi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall k (s :: k) f.
Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
</span><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-var">RawFace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f. Seq h -&gt; f -&gt; FaceData h f
</span><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
forall s. AsEmpty s =&gt; s
</span><span class="hs-identifier hs-var">Empty</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054439"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054440"><span class="hs-identifier hs-var">gi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall k (s :: k) f.
Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
</span><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-var">RawFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ComponentId s, FaceId' (Wrap s))
-&gt; Maybe (ComponentId s, FaceId' (Wrap s))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054442"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680054441"><span class="hs-identifier hs-var">li</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f. Seq h -&gt; f -&gt; FaceData h f
</span><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
forall s. AsEmpty s =&gt; s
</span><span class="hs-identifier hs-var">Empty</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054439"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- holes are always empty! (where to get them from?)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621680055084"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#isOuterFace"><span class="hs-identifier hs-type">isOuterFace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055084"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-206"></span><span id="isOuterFace"><span class="annot"><span class="annottext">isOuterFace :: FaceId' s -&gt; Bool
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#isOuterFace"><span class="hs-identifier hs-var hs-var">isOuterFace</span></a></span></span><span> </span><span id="local-6989586621680054435"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054435"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054435"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621680054904"><span id="local-6989586621680054905"><span id="local-6989586621680054906"><span id="local-6989586621680054907"><span id="local-6989586621680054908"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#remExtraData"><span class="hs-identifier hs-type">remExtraData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#Component%27"><span class="hs-identifier hs-type">Component'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054908"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054907"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054906"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054904"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054908"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054904"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-209"></span><span id="remExtraData"><span class="annot"><span class="annottext">remExtraData :: Component' s v e f r -&gt; Component s r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#remExtraData"><span class="hs-identifier hs-var hs-var">remExtraData</span></a></span></span><span> </span><span id="local-6989586621680054433"><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054433"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
</span><a href="#local-6989586621680054433"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Component' s v e f r
-&gt; (Component' s v e f r
    -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s, v) -&gt; Identity (Vector (VertexId' s)))
-&gt; Component' s v e f r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">PG.vertexData</span></a></span><span>  </span><span class="annot"><span class="annottext">((Vector (VertexId' s, v) -&gt; Identity (Vector (VertexId' s)))
 -&gt; Component' s v e f r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r))
-&gt; (((VertexId' s, v) -&gt; Identity (VertexId' s))
    -&gt; Vector (VertexId' s, v) -&gt; Identity (Vector (VertexId' s)))
-&gt; ((VertexId' s, v) -&gt; Identity (VertexId' s))
-&gt; Component' s v e f r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((VertexId' s, v) -&gt; Identity (VertexId' s))
-&gt; Vector (VertexId' s, v) -&gt; Identity (Vector (VertexId' s))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(((VertexId' s, v) -&gt; Identity (VertexId' s))
 -&gt; Component' s v e f r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r))
-&gt; ((VertexId' s, v) -&gt; VertexId' s)
-&gt; Component' s v e f r
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s, v) -&gt; VertexId' s
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-210"></span><span>                   </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
-&gt; (PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
    -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; Identity (Vector (Dart s)))
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector e)
  (Vector e')
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var">PG.rawDartData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Dart s, e) -&gt; Identity (Vector (Dart s)))
 -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r))
-&gt; (((Dart s, e) -&gt; Identity (Dart s))
    -&gt; Vector (Dart s, e) -&gt; Identity (Vector (Dart s)))
-&gt; ((Dart s, e) -&gt; Identity (Dart s))
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
-&gt; Identity
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Dart s, e) -&gt; Identity (Dart s))
-&gt; Vector (Dart s, e) -&gt; Identity (Vector (Dart s))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(((Dart s, e) -&gt; Identity (Dart s))
 -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
 -&gt; Identity
      (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r))
-&gt; ((Dart s, e) -&gt; Dart s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s, e) (FaceId' s, f) r
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Dart s, e) -&gt; Dart s
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-211"></span><span>                   </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
-&gt; (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
    -&gt; Component s r)
-&gt; Component s r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s, f) -&gt; Identity (Vector (FaceId' s)))
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
-&gt; Identity (Component s r)
forall k (s :: k) v e f r f'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (Vector f)
  (Vector f')
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var">PG.faceData</span></a></span><span>    </span><span class="annot"><span class="annottext">((Vector (FaceId' s, f) -&gt; Identity (Vector (FaceId' s)))
 -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
 -&gt; Identity (Component s r))
-&gt; (((FaceId' s, f) -&gt; Identity (FaceId' s))
    -&gt; Vector (FaceId' s, f) -&gt; Identity (Vector (FaceId' s)))
-&gt; ((FaceId' s, f) -&gt; Identity (FaceId' s))
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
-&gt; Identity (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((FaceId' s, f) -&gt; Identity (FaceId' s))
-&gt; Vector (FaceId' s, f) -&gt; Identity (Vector (FaceId' s))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(((FaceId' s, f) -&gt; Identity (FaceId' s))
 -&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
 -&gt; Identity (Component s r))
-&gt; ((FaceId' s, f) -&gt; FaceId' s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s, f) r
-&gt; Component s r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s, f) -&gt; FaceId' s
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621680054899"><span id="local-6989586621680054900"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#vectorise"><span class="hs-identifier hs-type">vectorise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621680054900"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054900"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054900"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680054899"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-215"></span><span id="vectorise"><span class="annot"><span class="annottext">vectorise :: [(i, a)] -&gt; Vector a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#vectorise"><span class="hs-identifier hs-var hs-var">vectorise</span></a></span></span><span> </span><span id="local-6989586621680054432"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621680054432"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Vector a
forall a. Int -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(i, a)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621680054432"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [(Int, a)] -&gt; Vector a
forall a. Vector a -&gt; [(Int, a)] -&gt; Vector a
</span><span class="hs-operator hs-var">//</span></span><span> </span><span class="annot"><span class="annottext">((i, a) -&gt; (Int, a)) -&gt; [(i, a)] -&gt; [(Int, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680054430"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621680054430"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680054429"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054429"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621680054430"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054429"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621680054432"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- PLANE GRAPHS --</span><span>
</span><span id="line-222"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- INSERTIONS --</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621680055148"><span id="local-6989586621680055149"><span id="local-6989586621680055150"><span id="local-6989586621680055151"><span id="local-6989586621680055152"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInPlaneGraph"><span class="hs-identifier hs-type">splitEdgeInPlaneGraph</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055152"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055150"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055149"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055148"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055148"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680055149"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055152"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055148"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055150"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055149"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055148"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055151"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055150"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055149"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- LET OP! TEST OF a EN b WEL VOORKOMEN!</span><span>
</span><span id="line-238"></span><span id="splitEdgeInPlaneGraph"><span class="annot"><span class="annottext">splitEdgeInPlaneGraph :: VertexId' s
-&gt; VertexId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInPlaneGraph"><span class="hs-identifier hs-var hs-var">splitEdgeInPlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680054428"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054428"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054427"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054427"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054426"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054426"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054425"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054425"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054424"><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054424"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInPlaneGraph&quot;</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r.
Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.IO.html#fromAdjRep"><span class="hs-identifier hs-var">PG.fromAdjRep</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r)
-&gt; (PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
forall v e f r.
(Show v, Show e, Show f, Show r) =&gt;
Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInAdjRep"><span class="hs-identifier hs-var">splitEdgeInAdjRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054428"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054427"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054426"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054425"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054424"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; (PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f))
-&gt; PlaneGraph s v e f r
-&gt; Gr (Vtx v e r) (Face f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Data.PlaneGraph.IO.html#toAdjRep"><span class="hs-identifier hs-var">PG.toAdjRep</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621680055113"><span id="local-6989586621680055114"><span id="local-6989586621680055115"><span id="local-6989586621680055116"><span id="local-6989586621680055117"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFaceInPlaneGraph"><span class="hs-identifier hs-type">sproutIntoFaceInPlaneGraph</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055117"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055116"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055115"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055114"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055113"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055113"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680055114"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055117"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055116"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680055116"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055113"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055117"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055116"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055115"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055114"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055113"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055117"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055116"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055115"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055114"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-253"></span><span id="sproutIntoFaceInPlaneGraph"><span class="annot"><span class="annottext">sproutIntoFaceInPlaneGraph :: VertexId' s
-&gt; VertexId' s
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutIntoFaceInPlaneGraph"><span class="hs-identifier hs-var hs-var">sproutIntoFaceInPlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680054420"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054420"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054419"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054419"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054418"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054418"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054417"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054417"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054416"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054416"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054415"><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054415"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054414"><span class="annot"><span class="annottext">ai :: Int
</span><a href="#local-6989586621680054414"><span class="hs-identifier hs-var hs-var">ai</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054420"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span id="local-6989586621680054413"><span class="annot"><span class="annottext">ci :: Int
</span><a href="#local-6989586621680054413"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054419"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInPlaneGraph&quot;</span></span><span>
</span><span id="line-257"></span><span>   </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r.
Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.IO.html#fromAdjRep"><span class="hs-identifier hs-var">PG.fromAdjRep</span></a></span><span>
</span><span id="line-258"></span><span>   </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r)
-&gt; Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
forall v e f r.
(Show v, Show e, Show f, Show r) =&gt;
Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutInAdjRep"><span class="hs-identifier hs-var">sproutInAdjRep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054414"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054413"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054418"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054417"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054416"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-259"></span><span>   </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Data.PlaneGraph.IO.html#toAdjRep"><span class="hs-identifier hs-var">PG.toAdjRep</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054415"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- PG.toAdjRep :: PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- PG.fromAdjRep :: proxy s -&gt; Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621680055065"><span id="local-6989586621680055066"><span id="local-6989586621680055067"><span id="local-6989586621680055068"><span id="local-6989586621680055069"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInPlaneGraph"><span class="hs-identifier hs-type">splitFaceInPlaneGraph</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055069"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055068"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055066"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span>             </span><span class="hs-comment">-- index van vertex a</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span>             </span><span class="hs-comment">-- index van vertex b</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span>             </span><span class="hs-comment">-- index van vertex c</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span>             </span><span class="hs-comment">-- index van vertex d</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span>               </span><span class="hs-comment">-- index van te splitsen face</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055068"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680055068"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- extra data voor nieuwe edge ab</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- functie om face data in twee stukken te knippen</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055069"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055068"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055066"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- input graaf</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055065"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055069"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055068"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055067"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055066"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span> </span><span class="hs-comment">-- output graaf</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="splitFaceInPlaneGraph"><span class="annot"><span class="annottext">splitFaceInPlaneGraph :: VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; FaceId' s
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInPlaneGraph"><span class="hs-identifier hs-var hs-var">splitFaceInPlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680054411"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054411"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054410"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054410"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054409"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054409"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054408"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054408"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680054407"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054407"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054406"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054406"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054405"><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054405"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680054404"><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054403"><span class="annot"><span class="annottext">ai :: Int
</span><a href="#local-6989586621680054403"><span class="hs-identifier hs-var hs-var">ai</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054411"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span id="local-6989586621680054402"><span class="annot"><span class="annottext">bi :: Int
</span><a href="#local-6989586621680054402"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054410"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621680054401"><span class="annot"><span class="annottext">ci :: Int
</span><a href="#local-6989586621680054401"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054409"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621680054400"><span class="annot"><span class="annottext">di :: Int
</span><a href="#local-6989586621680054400"><span class="hs-identifier hs-var hs-var">di</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054408"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621680054399"><span class="annot"><span class="annottext">fi :: Int
</span><a href="#local-6989586621680054399"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; Int) -&gt; VertexId' s -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VertexId' s -&gt; VertexId' s
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fi&quot;</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; VertexId' s) -&gt; VertexId' s -&gt; VertexId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; VertexId' s -&gt; VertexId' s
forall a b. Show a =&gt; a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">traceShow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054407"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; VertexId' s) -&gt; VertexId' s -&gt; VertexId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-var">PG.tailOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-var">PG.boundaryDart</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054407"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621680054395"><span class="annot"><span class="annottext">fj :: Int
</span><a href="#local-6989586621680054395"><span class="hs-identifier hs-var hs-var">fj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; Int) -&gt; VertexId' s -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VertexId' s -&gt; VertexId' s
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fj&quot;</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; VertexId' s) -&gt; VertexId' s -&gt; VertexId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-var">PG.headOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-var">PG.boundaryDart</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680054407"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-comment">-- ^ boundaryDart seems not working either</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInPlaneGraph&quot;</span></span><span>
</span><span id="line-287"></span><span>   </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r.
Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.IO.html#fromAdjRep"><span class="hs-identifier hs-var">PG.fromAdjRep</span></a></span><span>
</span><span id="line-288"></span><span>   </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r)
-&gt; Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
forall v e f r.
(Show v, Show e, Show f, Show r) =&gt;
Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInAdjRep"><span class="hs-identifier hs-var">splitFaceInAdjRep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054403"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054402"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054401"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054400"><span class="hs-identifier hs-var">di</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054399"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054395"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054406"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054405"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-289"></span><span>   </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Data.PlaneGraph.IO.html#toAdjRep"><span class="hs-identifier hs-var">PG.toAdjRep</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680054404"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- DELETIONS --</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621680055041"><span id="local-6989586621680055042"><span id="local-6989586621680055043"><span id="local-6989586621680055044"><span id="local-6989586621680055045"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInPlaneGraph"><span class="hs-identifier hs-type">unSplitEdgeInPlaneGraph</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055045"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055043"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680055042"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055041"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055041"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680055041"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055041"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055045"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055043"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055042"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055041"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055045"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055044"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055043"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680055042"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="unSplitEdgeInPlaneGraph"><span class="annot"><span class="annottext">unSplitEdgeInPlaneGraph :: VertexId' s
-&gt; VertexId' s
-&gt; VertexId' s
-&gt; ((e, e) -&gt; e)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInPlaneGraph"><span class="hs-identifier hs-var hs-var">unSplitEdgeInPlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680054392"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054392"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054391"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054391"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054390"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054390"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054389"><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054389"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PlaneGraph s v e f r -&gt; PlaneGraph s v e f r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unSplitEdgeInPlaneGraph&quot;</span></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r.
Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.IO.html#fromAdjRep"><span class="hs-identifier hs-var">PG.fromAdjRep</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; PlaneGraph s v e f r)
-&gt; (PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; ((e, e) -&gt; e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
forall v e f r.
(Show v, Show e, Show f, Show r) =&gt;
Int
-&gt; Int
-&gt; Int
-&gt; ((e, e) -&gt; e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInAdjRep"><span class="hs-identifier hs-var">unSplitEdgeInAdjRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054392"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054391"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680054390"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054389"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; (PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f))
-&gt; PlaneGraph s v e f r
-&gt; Gr (Vtx v e r) (Face f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Data.PlaneGraph.IO.html#toAdjRep"><span class="hs-identifier hs-var">PG.toAdjRep</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- ADJREPS --</span><span>
</span><span id="line-313"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Gr</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- adjacencies :: [v]</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- faces :: [f]</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- Vtx</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- id :: Int</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- loc :: Point 2 r</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- adj :: [(Int, e)]</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- vData :: v</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Face</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- incidentEdge :: (Int, Int)</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- fData :: f</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">--deriving instance (Show v, Show f) =&gt; Show (Gr v f)</span><span>
</span><span id="line-330"></span><span class="hs-comment">--deriving instance (Show v, Show e, Show r) =&gt; Show (Vtx v e r)</span><span>
</span><span id="line-331"></span><span class="hs-comment">--deriving instance Show f =&gt; Show (Face f)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- instance {-# OVERLAPS #-} Show (VertexId s Primal) where show i = 'v' : show (fromEnum i)</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- instance {-# OVERLAPS #-} Show (FaceId   s Primal) where show i = 'f' : show (fromEnum i)</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- instance {-# OVERLAPS #-} Show (Dart s, v) where</span><span>
</span><span id="line-337"></span><span class="hs-comment">--   show (Dart (Arc s) Positive, _) = 'd' : show (fromEnum s) ++ &quot;+&quot;</span><span>
</span><span id="line-338"></span><span class="hs-comment">--   show (Dart (Arc s) Negative, _) = 'd' : show (fromEnum s) ++ &quot;-&quot;</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- instance Show f =&gt; Show (Face f) where show f = (show $ AR.fData f) ++ &quot;~&gt;&quot; ++ (show $ incidentEdge f)</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- instance (Show e, Show r) =&gt; Show (Vtx v e r) where show v = (show $ AR.id v) ++ &quot;~&gt;&quot; ++ (show $ adj v)</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- instance (Show v, Show f) =&gt; Show (Gr v f) where show g = &quot;Gr &quot; ++ (show $ adjacencies g) ++ &quot; &quot; ++ (show $ AR.faces g)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- ik heb:</span><span>
</span><span id="line-345"></span><span id="local-6989586621680054779"><span id="local-6989586621680054780"><span id="local-6989586621680054781"><span id="local-6989586621680054782"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInAdjRep"><span class="hs-identifier hs-type">splitEdgeInAdjRep</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054782"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054780"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054779"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex a</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex b</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680054779"><span class="hs-identifier hs-type">r</span></a></span><span>               </span><span class="hs-comment">-- locatie voor nieuwe vertex c</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054782"><span class="hs-identifier hs-type">v</span></a></span><span>                       </span><span class="hs-comment">-- extra data voor vertex c</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- functie om edge data in twee stukken te knippen</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054779"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054780"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- input graaf</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054781"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054779"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054780"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-comment">-- output graaf</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span id="splitEdgeInAdjRep"><span class="annot"><span class="annottext">splitEdgeInAdjRep :: Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e -&gt; (e, e))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitEdgeInAdjRep"><span class="hs-identifier hs-var hs-var">splitEdgeInAdjRep</span></a></span></span><span> </span><span id="local-6989586621680054387"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054386"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054385"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054385"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054384"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054384"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054383"><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054383"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054382"><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054381"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Int) -&gt; [Vtx v e r] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-comment">-- first find vertices a and b</span><span>
</span><span id="line-358"></span><span>      </span><span id="local-6989586621680054379"><span class="annot"><span class="annottext">oa :: Vtx v e r
</span><a href="#local-6989586621680054379"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInAdjRep oa&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-359"></span><span>      </span><span id="local-6989586621680054378"><span class="annot"><span class="annottext">ob :: Vtx v e r
</span><a href="#local-6989586621680054378"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInAdjRep ob&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span id="local-6989586621680054377"><span class="annot"><span class="annottext">os :: [Vtx v e r]
</span><a href="#local-6989586621680054377"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (Int -&gt; Bool) -&gt; (Int -&gt; Bool) -&gt; Int -&gt; Bool
forall a b c d. (a -&gt; b -&gt; c) -&gt; (d -&gt; a) -&gt; (d -&gt; b) -&gt; d -&gt; c
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-comment">-- find edge data</span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621680054374"><span class="annot"><span class="annottext">e1 :: e
</span><a href="#local-6989586621680054374"><span class="hs-identifier hs-var hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Int, e)] -&gt; (Int, e)
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInAdjRep e1&quot;</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054379"><span class="hs-identifier hs-var">oa</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621680054372"><span class="annot"><span class="annottext">e2 :: e
</span><a href="#local-6989586621680054372"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Int, e)] -&gt; (Int, e)
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInAdjRep e2&quot;</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054378"><span class="hs-identifier hs-var">ob</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-comment">-- create new adjacencies to c in a and b</span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621680054371"><span class="annot"><span class="annottext">na :: Vtx v e r
</span><a href="#local-6989586621680054371"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054379"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool)
-&gt; ((Int, e) -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, e) -&gt; (Int, e) -&gt; (Int, e)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054383"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054374"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054379"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-366"></span><span>      </span><span id="local-6989586621680054368"><span class="annot"><span class="annottext">nb :: Vtx v e r
</span><a href="#local-6989586621680054368"><span class="hs-identifier hs-var hs-var">nb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054378"><span class="hs-identifier hs-var">ob</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool)
-&gt; ((Int, e) -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, e) -&gt; (Int, e) -&gt; (Int, e)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054383"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054372"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054378"><span class="hs-identifier hs-var">ob</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-comment">-- create new vertex c</span><span>
</span><span id="line-368"></span><span>      </span><span id="local-6989586621680054367"><span class="annot"><span class="annottext">nc :: Vtx v e r
</span><a href="#local-6989586621680054367"><span class="hs-identifier hs-var hs-var">nc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx :: forall v e r. Int -&gt; Point 2 r -&gt; [(Int, e)] -&gt; v -&gt; Vtx v e r
</span><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">id :: Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var">AR.id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc :: Point 2 r
</span><a href="Data.PlaneGraph.AdjRep.html#loc"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054385"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054383"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054372"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((e, e) -&gt; e) -&gt; (e, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; (e, e)
</span><a href="#local-6989586621680054383"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054374"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vData :: v
</span><a href="Data.PlaneGraph.AdjRep.html#vData"><span class="hs-identifier hs-var">AR.vData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054384"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-comment">-- update faces (only if incidentEdge happens to point to ab)</span><span>
</span><span id="line-370"></span><span>      </span><span id="local-6989586621680054364"><span class="annot"><span class="annottext">nf :: [Face f]
</span><a href="#local-6989586621680054364"><span class="hs-identifier hs-var hs-var">nf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054362"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054362"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054362"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054361"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054361"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054361"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054381"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitEdgeInAdjRep&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;original&quot;</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054382"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adjacencies :: [Vtx v e r]
</span><span class="hs-identifier hs-var">adjacencies</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Int) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054371"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054368"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054367"><span class="hs-identifier hs-var">nc</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Vtx v e r]
</span><a href="#local-6989586621680054377"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">faces :: [Face f]
</span><span class="hs-identifier hs-var">AR.faces</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Face f]
</span><a href="#local-6989586621680054364"><span class="hs-identifier hs-var">nf</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span id="local-6989586621680054763"><span id="local-6989586621680054764"><span id="local-6989586621680054765"><span id="local-6989586621680054766"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutInAdjRep"><span class="hs-identifier hs-type">sproutInAdjRep</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054766"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054765"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054764"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054763"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex a</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex c (andere kant van edge a)</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680054763"><span class="hs-identifier hs-type">r</span></a></span><span>               </span><span class="hs-comment">-- locatie voor nieuwe vertex c</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054766"><span class="hs-identifier hs-type">v</span></a></span><span>                       </span><span class="hs-comment">-- extra data voor vertex c</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054765"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054765"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- extra data voor nieuwe edge</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054766"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054763"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054764"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- input graaf</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054766"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054763"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054764"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-comment">-- output graaf</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="sproutInAdjRep"><span class="annot"><span class="annottext">sproutInAdjRep :: Int
-&gt; Int
-&gt; Point 2 r
-&gt; v
-&gt; (e, e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#sproutInAdjRep"><span class="hs-identifier hs-var hs-var">sproutInAdjRep</span></a></span></span><span> </span><span id="local-6989586621680054360"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054360"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054359"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054359"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054358"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054358"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680054357"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054357"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054356"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054356"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054355"><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054355"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054354"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680054354"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Int) -&gt; [Vtx v e r] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054355"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-comment">-- first find vertex a</span><span>
</span><span id="line-389"></span><span>      </span><span id="local-6989586621680054353"><span class="annot"><span class="annottext">oa :: Vtx v e r
</span><a href="#local-6989586621680054353"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oa&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sproutInAdjRep oa&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054360"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054355"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-390"></span><span>      </span><span id="local-6989586621680054352"><span class="annot"><span class="annottext">os :: [Vtx v e r]
</span><a href="#local-6989586621680054352"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;os&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054360"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054355"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-391"></span><span>      </span><span class="hs-comment">-- need to find index of c</span><span>
</span><span id="line-392"></span><span>      </span><span id="local-6989586621680054351"><span class="annot"><span class="annottext">fj :: Maybe p -&gt; p
</span><a href="#local-6989586621680054351"><span class="hs-identifier hs-var hs-var">fj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680054350"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680054350"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680054350"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><a href="#local-6989586621680054351"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe p
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep got Nothing&quot;</span></span><span>
</span><span id="line-394"></span><span>      </span><span id="local-6989586621680054349"><span class="annot"><span class="annottext">ci :: Int
</span><a href="#local-6989586621680054349"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ci&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall p. Maybe p -&gt; p
</span><a href="#local-6989586621680054351"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">findIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054359"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; Maybe Int) -&gt; [(Int, e)] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054353"><span class="hs-identifier hs-var">oa</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-comment">-- create new adjacency to new vertex z in a</span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621680054348"><span class="annot"><span class="annottext">na :: Vtx v e r
</span><a href="#local-6989586621680054348"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;na&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054353"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054349"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054353"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054354"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054356"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054349"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054353"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">-- create new vertex z</span><span>
</span><span id="line-398"></span><span>      </span><span id="local-6989586621680054345"><span class="annot"><span class="annottext">nz :: Vtx v e r
</span><a href="#local-6989586621680054345"><span class="hs-identifier hs-var hs-var">nz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx :: forall v e r. Int -&gt; Point 2 r -&gt; [(Int, e)] -&gt; v -&gt; Vtx v e r
</span><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">id :: Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var">AR.id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054354"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc :: Point 2 r
</span><a href="Data.PlaneGraph.AdjRep.html#loc"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680054358"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054360"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054356"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vData :: v
</span><a href="Data.PlaneGraph.AdjRep.html#vData"><span class="hs-identifier hs-var">AR.vData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680054357"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;original&quot;</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054355"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adjacencies :: [Vtx v e r]
</span><span class="hs-identifier hs-var">adjacencies</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Int) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054348"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054345"><span class="hs-identifier hs-var">nz</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Vtx v e r]
</span><a href="#local-6989586621680054352"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621680054739"><span id="local-6989586621680054740"><span id="local-6989586621680054741"><span id="local-6989586621680054742"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInAdjRep"><span class="hs-identifier hs-type">splitFaceInAdjRep</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054742"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054741"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054739"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex a</span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex b</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex c (andere kant van edge a)</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex d (andere kant van edge b)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van face edge start</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van face edge eind</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054741"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054741"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- extra data voor nieuwe edge ab</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- functie om face data in twee stukken te knippen</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054742"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054741"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054739"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- input graaf</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054742"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054741"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054739"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054740"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-comment">-- output graaf</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- is it easier to split a vertex than a face?</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span id="splitFaceInAdjRep"><span class="annot"><span class="annottext">splitFaceInAdjRep :: Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (e, e)
-&gt; (f -&gt; (f, f))
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#splitFaceInAdjRep"><span class="hs-identifier hs-var hs-var">splitFaceInAdjRep</span></a></span></span><span> </span><span id="local-6989586621680054344"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054343"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054342"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054342"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054341"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054341"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680054340"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054340"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680054339"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054339"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680054338"><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054338"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680054337"><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054337"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054336"><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-comment">-- first find vertices a and b</span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621680054335"><span class="annot"><span class="annottext">oa :: Vtx v e r
</span><a href="#local-6989586621680054335"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oa&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep oa&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span id="local-6989586621680054334"><span class="annot"><span class="annottext">ob :: Vtx v e r
</span><a href="#local-6989586621680054334"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ob&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a. String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var">headTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep ob&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span id="local-6989586621680054333"><span class="annot"><span class="annottext">os :: [Vtx v e r]
</span><a href="#local-6989586621680054333"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;os&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (Int -&gt; Bool) -&gt; (Int -&gt; Bool) -&gt; Int -&gt; Bool
forall a b c d. (a -&gt; b -&gt; c) -&gt; (d -&gt; a) -&gt; (d -&gt; b) -&gt; d -&gt; c
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-422"></span><span>      </span><span class="hs-comment">-- insert new adjacency between a and b</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621680054332"><span class="annot"><span class="annottext">fj :: Maybe p -&gt; p
</span><a href="#local-6989586621680054332"><span class="hs-identifier hs-var hs-var">fj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680054331"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680054331"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680054331"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><a href="#local-6989586621680054332"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe p
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep got Nothing&quot;</span></span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-comment">-- need to find indices c and d!</span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621680054330"><span class="annot"><span class="annottext">ci :: Int
</span><a href="#local-6989586621680054330"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ci&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall p. Maybe p -&gt; p
</span><a href="#local-6989586621680054332"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">findIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; Maybe Int) -&gt; [(Int, e)] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054335"><span class="hs-identifier hs-var">oa</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621680054329"><span class="annot"><span class="annottext">di :: Int
</span><a href="#local-6989586621680054329"><span class="hs-identifier hs-var hs-var">di</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;di&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall p. Maybe p -&gt; p
</span><a href="#local-6989586621680054332"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">findIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054341"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; Maybe Int) -&gt; [(Int, e)] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054334"><span class="hs-identifier hs-var">ob</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-comment">-- insert new adjacencies to each other in a and b</span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621680054328"><span class="annot"><span class="annottext">na :: Vtx v e r
</span><a href="#local-6989586621680054328"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;na&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054335"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054330"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054335"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054338"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054330"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054335"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621680054327"><span class="annot"><span class="annottext">nb :: Vtx v e r
</span><a href="#local-6989586621680054327"><span class="hs-identifier hs-var hs-var">nb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Vtx v e r -&gt; Vtx v e r
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nb&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; Vtx v e r -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054334"><span class="hs-identifier hs-var">ob</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054329"><span class="hs-identifier hs-var">di</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054334"><span class="hs-identifier hs-var">ob</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(e, e)
</span><a href="#local-6989586621680054338"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054329"><span class="hs-identifier hs-var">di</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054334"><span class="hs-identifier hs-var">ob</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-comment">-- find the face that is incident to both a and b</span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621680054326"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621680054326"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;i&quot;</span></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall p. Maybe p -&gt; p
</span><a href="#local-6989586621680054332"><span class="hs-identifier hs-var">fj</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; [Face f] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">findIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054340"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054339"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Face f] -&gt; Maybe Int) -&gt; [Face f] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span id="local-6989586621680054325"><span class="annot"><span class="annottext">fd :: f
</span><a href="#local-6989586621680054325"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; f -&gt; f
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fd&quot;</span></span><span> </span><span class="annot"><span class="annottext">(f -&gt; f) -&gt; f -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; f
forall f. Face f -&gt; f
</span><span class="hs-identifier hs-var hs-var">AR.fData</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; f) -&gt; Face f -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[Face f] -&gt; Int -&gt; Face f
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054326"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-434"></span><span>      </span><span id="local-6989586621680054323"><span class="annot"><span class="annottext">ef :: [Face f]
</span><a href="#local-6989586621680054323"><span class="hs-identifier hs-var hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Face f] -&gt; [Face f]
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ef&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Face f] -&gt; [Face f]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054326"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Face f] -&gt; [Face f] -&gt; [Face f]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Face f] -&gt; [Face f]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054326"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>      </span><span id="local-6989586621680054321"><span class="annot"><span class="annottext">f1 :: Face f
</span><a href="#local-6989586621680054321"><span class="hs-identifier hs-var hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Face f -&gt; Face f
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f1&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Face f) -&gt; Face f -&gt; Face f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Face :: forall f. (Int, Int) -&gt; f -&gt; Face f
</span><span class="hs-identifier hs-type">AR.Face</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fData :: f
</span><span class="hs-identifier hs-var">AR.fData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f, f) -&gt; f
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((f, f) -&gt; f) -&gt; (f, f) -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054337"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054325"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621680054319"><span class="annot"><span class="annottext">f2 :: Face f
</span><a href="#local-6989586621680054319"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Face f -&gt; Face f
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f2&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Face f) -&gt; Face f -&gt; Face f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Face :: forall f. (Int, Int) -&gt; f -&gt; Face f
</span><span class="hs-identifier hs-type">AR.Face</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054343"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054344"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fData :: f
</span><span class="hs-identifier hs-var">AR.fData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f, f) -&gt; f
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((f, f) -&gt; f) -&gt; (f, f) -&gt; f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; (f, f)
</span><a href="#local-6989586621680054337"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680054325"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFaceInAdjRep&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;original&quot;</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054336"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adjacencies :: [Vtx v e r]
</span><span class="hs-identifier hs-var">adjacencies</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Int) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054328"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054327"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Vtx v e r]
</span><a href="#local-6989586621680054333"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">faces :: [Face f]
</span><span class="hs-identifier hs-var">AR.faces</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Face f]
</span><a href="#local-6989586621680054323"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">[Face f] -&gt; [Face f] -&gt; [Face f]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054321"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054319"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span id="local-6989586621680054729"><span id="local-6989586621680054730"><span id="local-6989586621680054731"><span id="local-6989586621680054732"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInAdjRep"><span class="hs-identifier hs-type">unSplitEdgeInAdjRep</span></a></span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054732"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054730"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680054729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex a</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex b (te verwijderen)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                     </span><span class="hs-comment">-- index van vertex c</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- functie om edge data te mergen</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054732"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054730"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- input graaf</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054732"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054731"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054730"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-comment">-- output graaf</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span id="unSplitEdgeInAdjRep"><span class="annot"><span class="annottext">unSplitEdgeInAdjRep :: Int
-&gt; Int
-&gt; Int
-&gt; ((e, e) -&gt; e)
-&gt; Gr (Vtx v e r) (Face f)
-&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#unSplitEdgeInAdjRep"><span class="hs-identifier hs-var hs-var">unSplitEdgeInAdjRep</span></a></span></span><span> </span><span id="local-6989586621680054318"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680054317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680054316"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680054315"><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054315"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054314"><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680054313"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680054313"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Int) -&gt; [Vtx v e r] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- first find vertices a, b and c</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621680054312"><span class="annot"><span class="annottext">oa :: Vtx v e r
</span><a href="#local-6989586621680054312"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Vtx v e r
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span id="local-6989586621680054310"><span class="annot"><span class="annottext">ob :: Vtx v e r
</span><a href="#local-6989586621680054310"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Vtx v e r
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-457"></span><span>      </span><span id="local-6989586621680054309"><span class="annot"><span class="annottext">oc :: Vtx v e r
</span><a href="#local-6989586621680054309"><span class="hs-identifier hs-var hs-var">oc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r] -&gt; Vtx v e r
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; Vtx v e r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-458"></span><span>      </span><span id="local-6989586621680054308"><span class="annot"><span class="annottext">os :: [Vtx v e r]
</span><a href="#local-6989586621680054308"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Bool) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054307"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054307"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054307"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054307"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Vtx v e r -&gt; Int) -&gt; Vtx v e r -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-comment">-- find edge data</span><span>
</span><span id="line-460"></span><span>      </span><span id="local-6989586621680054306"><span class="annot"><span class="annottext">eab :: e
</span><a href="#local-6989586621680054306"><span class="hs-identifier hs-var hs-var">eab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; (Int, e)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054312"><span class="hs-identifier hs-var">oa</span></a></span><span>
</span><span id="line-461"></span><span>      </span><span id="local-6989586621680054305"><span class="annot"><span class="annottext">eba :: e
</span><a href="#local-6989586621680054305"><span class="hs-identifier hs-var hs-var">eba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; (Int, e)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054310"><span class="hs-identifier hs-var">ob</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span id="local-6989586621680054304"><span class="annot"><span class="annottext">ebc :: e
</span><a href="#local-6989586621680054304"><span class="hs-identifier hs-var hs-var">ebc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; (Int, e)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054310"><span class="hs-identifier hs-var">ob</span></a></span><span>
</span><span id="line-463"></span><span>      </span><span id="local-6989586621680054303"><span class="annot"><span class="annottext">ecb :: e
</span><a href="#local-6989586621680054303"><span class="hs-identifier hs-var hs-var">ecb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; e) -&gt; (Int, e) -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, e)] -&gt; (Int, e)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; (Int, e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054309"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-comment">-- create new adjacencies between a and c</span><span>
</span><span id="line-465"></span><span>      </span><span id="local-6989586621680054302"><span class="annot"><span class="annottext">na :: Vtx v e r
</span><a href="#local-6989586621680054302"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054312"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool)
-&gt; ((Int, e) -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, e) -&gt; (Int, e) -&gt; (Int, e)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054306"><span class="hs-identifier hs-var">eab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054304"><span class="hs-identifier hs-var">ebc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054312"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621680054301"><span class="annot"><span class="annottext">nc :: Vtx v e r
</span><a href="#local-6989586621680054301"><span class="hs-identifier hs-var hs-var">nc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054309"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool)
-&gt; ((Int, e) -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, e) -&gt; (Int, e) -&gt; (Int, e)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(e, e) -&gt; e
</span><a href="#local-6989586621680054315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054303"><span class="hs-identifier hs-var">ecb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680054305"><span class="hs-identifier hs-var">eba</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054309"><span class="hs-identifier hs-var">oc</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621680054300"><span class="annot"><span class="annottext">nv :: [Vtx v e r]
</span><a href="#local-6989586621680054300"><span class="hs-identifier hs-var hs-var">nv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Int) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054302"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054301"><span class="hs-identifier hs-var">nc</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Vtx v e r]
</span><a href="#local-6989586621680054308"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-comment">-- update faces (only if incidentEdge happens to point to ab or bc)</span><span>
</span><span id="line-469"></span><span>      </span><span id="local-6989586621680054299"><span class="annot"><span class="annottext">nf :: [Face f]
</span><a href="#local-6989586621680054299"><span class="hs-identifier hs-var hs-var">nf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054298"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054298"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054298"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054297"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054297"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054297"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054296"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054296"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054296"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Bool) -&gt; (Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool) -&gt; (Face f -&gt; (Int, Int)) -&gt; Face f -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680054295"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054295"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054295"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054318"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>         </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-comment">-- restore consecutive numbering: replace vertex n-1 by b</span><span>
</span><span id="line-475"></span><span>      </span><span id="local-6989586621680054294"><span class="annot"><span class="annottext">ng :: Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054294"><span class="hs-identifier hs-var hs-var">ng</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall v e r f.
Int -&gt; Int -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndex"><span class="hs-identifier hs-var">replaceIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054313"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054317"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;original&quot;</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054314"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">adjacencies :: [Vtx v e r]
</span><span class="hs-identifier hs-var">adjacencies</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vtx v e r]
</span><a href="#local-6989586621680054300"><span class="hs-identifier hs-var">nv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">faces :: [Face f]
</span><span class="hs-identifier hs-var">AR.faces</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Face f]
</span><a href="#local-6989586621680054299"><span class="hs-identifier hs-var">nf</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a. Show a =&gt; String -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#tr"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unSplitEdgeInAdjRep&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f))
-&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054294"><span class="hs-identifier hs-var">ng</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- Gr</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- adjacencies :: [v]</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- faces :: [f]</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- Vtx</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- id :: Int</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- loc :: Point 2 r</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- adj :: [(Int, e)]</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- vData :: v</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- Face</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- incidentEdge :: (Int, Int)</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- fData :: f</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span id="local-6989586621680054683"><span id="local-6989586621680054684"><span id="local-6989586621680054685"><span id="local-6989586621680054686"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndex"><span class="hs-identifier hs-type">replaceIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054686"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054685"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054684"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054683"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054686"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054685"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054684"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054683"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-493"></span><span id="replaceIndex"><span class="annot"><span class="annottext">replaceIndex :: Int -&gt; Int -&gt; Gr (Vtx v e r) (Face f) -&gt; Gr (Vtx v e r) (Face f)
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndex"><span class="hs-identifier hs-var hs-var">replaceIndex</span></a></span></span><span> </span><span id="local-6989586621680054292"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054292"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680054291"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054291"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621680054290"><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054290"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054290"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">adjacencies :: [Vtx v e r]
</span><span class="hs-identifier hs-var">adjacencies</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vtx v e r -&gt; Vtx v e r) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vtx v e r -&gt; Vtx v e r
forall v e r. Int -&gt; Int -&gt; Vtx v e r -&gt; Vtx v e r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexAdjacency"><span class="hs-identifier hs-var">replaceIndexAdjacency</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054292"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054291"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vtx v e r] -&gt; [Vtx v e r]) -&gt; [Vtx v e r] -&gt; [Vtx v e r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Vtx v e r]
forall v f. Gr v f -&gt; [v]
</span><span class="hs-identifier hs-var hs-var">adjacencies</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054290"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-494"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">faces :: [Face f]
</span><span class="hs-identifier hs-var">AR.faces</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Face f -&gt; Face f) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Face f -&gt; Face f
forall f. Int -&gt; Int -&gt; Face f -&gt; Face f
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexFace"><span class="hs-identifier hs-var">replaceIndexFace</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054292"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054291"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Face f] -&gt; [Face f]) -&gt; [Face f] -&gt; [Face f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f) -&gt; [Face f]
forall v f. Gr v f -&gt; [f]
</span><span class="hs-identifier hs-var hs-var">AR.faces</span></span><span>    </span><span class="annot"><span class="annottext">Gr (Vtx v e r) (Face f)
</span><a href="#local-6989586621680054290"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-495"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span id="local-6989586621680054676"><span id="local-6989586621680054677"><span id="local-6989586621680054678"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexAdjacency"><span class="hs-identifier hs-type">replaceIndexAdjacency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054678"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054677"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054676"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.AdjRep.html#Vtx"><span class="hs-identifier hs-type">Vtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054678"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054677"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680054676"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-498"></span><span id="replaceIndexAdjacency"><span class="annot"><span class="annottext">replaceIndexAdjacency :: Int -&gt; Int -&gt; Vtx v e r -&gt; Vtx v e r
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexAdjacency"><span class="hs-identifier hs-var hs-var">replaceIndexAdjacency</span></a></span></span><span> </span><span id="local-6989586621680054287"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054287"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680054286"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054286"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621680054285"><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054285"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054285"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">id :: Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var">AR.id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054285"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054287"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054286"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; Int
forall v e r. Vtx v e r -&gt; Int
</span><a href="Data.PlaneGraph.AdjRep.html#id"><span class="hs-identifier hs-var hs-var">AR.id</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054285"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-499"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adj :: [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var">adj</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, e) -&gt; Bool)
-&gt; ((Int, e) -&gt; (Int, e)) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054287"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, e) -&gt; Int) -&gt; (Int, e) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, e) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter (Int, e) (Int, e) Int Int -&gt; Int -&gt; (Int, e) -&gt; (Int, e)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Int, e) (Int, e) Int Int
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054286"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, e)] -&gt; [(Int, e)]) -&gt; [(Int, e)] -&gt; [(Int, e)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vtx v e r -&gt; [(Int, e)]
forall v e r. Vtx v e r -&gt; [(Int, e)]
</span><a href="Data.PlaneGraph.AdjRep.html#adj"><span class="hs-identifier hs-var hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">Vtx v e r
</span><a href="#local-6989586621680054285"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-500"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span id="local-6989586621680054675"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexFace"><span class="hs-identifier hs-type">replaceIndexFace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054675"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Face</span></span><span> </span><span class="annot"><a href="#local-6989586621680054675"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-503"></span><span id="replaceIndexFace"><span class="annot"><span class="annottext">replaceIndexFace :: Int -&gt; Int -&gt; Face f -&gt; Face f
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replaceIndexFace"><span class="hs-identifier hs-var hs-var">replaceIndexFace</span></a></span></span><span> </span><span id="local-6989586621680054282"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054282"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680054281"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054281"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621680054280"><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054282"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; ((Int, Int) -&gt; (Int, Int)) -&gt; (Int, Int)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Int, Int) (Int, Int) Int Int
-&gt; Int -&gt; (Int, Int) -&gt; (Int, Int)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Int, Int) (Int, Int) Int Int
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054281"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-504"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054282"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">incidentEdge :: (Int, Int)
</span><span class="hs-identifier hs-var">incidentEdge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Face f -&gt; (Int, Int)
forall f. Face f -&gt; (Int, Int)
</span><span class="hs-identifier hs-var hs-var">incidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; ((Int, Int) -&gt; (Int, Int)) -&gt; (Int, Int)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Int, Int) (Int, Int) Int Int
-&gt; Int -&gt; (Int, Int) -&gt; (Int, Int)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Int, Int) (Int, Int) Int Int
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680054281"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-505"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Face f
</span><a href="#local-6989586621680054280"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- HELPERS --</span><span>
</span><span id="line-510"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span id="local-6989586621680054715"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-type">replace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680054715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680054715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-513"></span><span id="replace"><span class="annot"><span class="annottext">replace :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span id="local-6989586621680054278"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680054278"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054277"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621680054277"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; [a] -&gt; [a]) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace%27"><span class="hs-identifier hs-var">replace'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680054278"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621680054277"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span id="local-6989586621680054659"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#replace%27"><span class="hs-identifier hs-type">replace'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054659"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054659"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-516"></span><span id="replace%27"><span class="annot"><span class="annottext">replace' :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#replace%27"><span class="hs-identifier hs-var hs-var">replace'</span></a></span></span><span> </span><span id="local-6989586621680054275"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680054275"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054274"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621680054274"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680054273"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054273"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680054275"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054273"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621680054274"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054273"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-517"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680054273"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span id="local-6989586621680054716"><span id="local-6989586621680054717"><span id="local-6989586621680054718"><span id="local-6989586621680054719"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#lift"><span class="hs-identifier hs-type">lift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054718"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054717"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054716"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680054716"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054718"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054716"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680054717"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-520"></span><span id="lift"><span class="annot"><span class="annottext">lift :: (a -&gt; b -&gt; c) -&gt; (d -&gt; a) -&gt; (d -&gt; b) -&gt; d -&gt; c
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#lift"><span class="hs-identifier hs-var hs-var">lift</span></a></span></span><span> </span><span id="local-6989586621680054272"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621680054272"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680054271"><span class="annot"><span class="annottext">d -&gt; a
</span><a href="#local-6989586621680054271"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680054270"><span class="annot"><span class="annottext">d -&gt; b
</span><a href="#local-6989586621680054270"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680054269"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680054269"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621680054272"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; a
</span><a href="#local-6989586621680054271"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680054269"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; b
</span><a href="#local-6989586621680054270"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680054269"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span id="local-6989586621680055089"><span class="annot"><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-type">headTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680055089"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680055089"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-525"></span><span id="headTrace"><span class="annot"><span class="annottext">headTrace :: String -&gt; [a] -&gt; a
</span><a href="Geometry.PlanarSubdivision.Dynamic.html#headTrace"><span class="hs-identifier hs-var hs-var">headTrace</span></a></span></span><span> </span><span id="local-6989586621680054268"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680054268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680054267"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680054267"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680054267"><span class="hs-identifier hs-var">xs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680054268"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: head of empty list&quot;</span></span><span>
</span><span id="line-526"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680054267"><span class="hs-identifier hs-var">xs</span></a></span></pre></body></html>