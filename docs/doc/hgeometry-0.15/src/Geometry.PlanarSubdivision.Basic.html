<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Geometry.PlnarSubdivision.Basic</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Description :  Basic data types to represent a PlanarSubdivision</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geometry.PlanarSubdivision.Basic</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- $setup</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier">PlanarSubdivision</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier">PlanarSubdivision</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier">ComponentId</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constructing Planar Subdivisions</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier">fromSimplePolygon</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromConnectedSegments"><span class="hs-identifier">fromConnectedSegments</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph"><span class="hs-identifier">fromPlaneGraph</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph%27"><span class="hs-identifier">fromPlaneGraph'</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Quering the Planar Subdivision</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numComponents"><span class="hs-identifier">numComponents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier">numVertices</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numEdges"><span class="hs-identifier">numEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier">numFaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numDarts"><span class="hs-identifier">numDarts</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier">components</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier">component</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertices%27"><span class="hs-identifier">vertices'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertices"><span class="hs-identifier">vertices</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edges%27"><span class="hs-identifier">edges'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edges"><span class="hs-identifier">edges</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faces%27"><span class="hs-identifier">faces'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces%27"><span class="hs-identifier">internalFaces'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faces"><span class="hs-identifier">faces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces"><span class="hs-identifier">internalFaces</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#darts%27"><span class="hs-identifier">darts'</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Incidences and Adjacencies</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier">headOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier">tailOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier">incidentEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incomingEdges"><span class="hs-identifier">incomingEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outgoingEdges"><span class="hs-identifier">outgoingEdges</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdge"><span class="hs-identifier">nextIncidentEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdge"><span class="hs-identifier">prevIncidentEdge</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdgeFrom"><span class="hs-identifier">nextIncidentEdgeFrom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdgeFrom"><span class="hs-identifier">prevIncidentEdgeFrom</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#neighboursOf"><span class="hs-identifier">neighboursOf</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier">leftFace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#rightFace"><span class="hs-identifier">rightFace</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier">outerBoundaryDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#boundaryVertices"><span class="hs-identifier">boundaryVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#holesOf"><span class="hs-identifier">holesOf</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier">outerFaceId</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#boundary%27"><span class="hs-identifier">boundary'</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier">Incident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incidences"><span class="hs-identifier">incidences</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier">common</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonVertices"><span class="hs-identifier">commonVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier">commonDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonFaces"><span class="hs-identifier">commonFaces</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Data</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#locationOf"><span class="hs-identifier">locationOf</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPointsOf"><span class="hs-identifier">endPointsOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPointData"><span class="hs-identifier">endPointData</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier">faceDataOf</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseVertices"><span class="hs-identifier">traverseVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseDarts"><span class="hs-identifier">traverseDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseFaces"><span class="hs-identifier">traverseFaces</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapVertices"><span class="hs-identifier">mapVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapDarts"><span class="hs-identifier">mapDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapEdges"><span class="hs-identifier">mapEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapFaces"><span class="hs-identifier">mapFaces</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Obtaining a Geometric Representation</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegment"><span class="hs-identifier">edgeSegment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegments"><span class="hs-identifier">edgeSegments</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceBoundary"><span class="hs-identifier">faceBoundary</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygon"><span class="hs-identifier">internalFacePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygons"><span class="hs-identifier">internalFacePolygons</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon"><span class="hs-identifier">outerFacePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon%27"><span class="hs-identifier">outerFacePolygon'</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#facePolygons"><span class="hs-identifier">facePolygons</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-comment">-- * IO</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-comment">-- * ReExports</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier">PG.vData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier">PG.location</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Helper; dealing with the Raw types</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PolygonFaceData"><span class="hs-identifier">PolygonFaceData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier">FaceData</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier">FaceData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#holes"><span class="hs-identifier">holes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#fData"><span class="hs-identifier">fData</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier">Wrap</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier">rawVertexData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier">rawDartData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier">rawFaceData</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertexData"><span class="hs-identifier">vertexData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#dartData"><span class="hs-identifier">dartData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceData"><span class="hs-identifier">faceData</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier">dataVal</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#dartMapping"><span class="hs-identifier">dartMapping</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier">Raw</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier">asLocalD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier">asLocalV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalF"><span class="hs-identifier">asLocalF</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">holes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">holesOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Box.html"><span class="hs-identifier">Geometry.Box</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.LineSegment.html"><span class="hs-identifier">Geometry.LineSegment</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.LineSegment.Internal.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html"><span class="hs-identifier">Geometry.PlanarSubdivision.Raw</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Point.html"><span class="hs-identifier">Geometry.Point</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Polygon.html"><span class="hs-identifier">Geometry.Polygon</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Geometry.Properties.html"><span class="hs-identifier">Geometry.Properties</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph.Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">allDarts</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isPositive</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.PlaneGraph.html"><span class="hs-identifier">Data.PlaneGraph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.PlaneGraph.html"><span class="hs-identifier">Data.PlaneGraph</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span>
</span><span id="line-103"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span>
</span><span id="line-104"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span>
</span><span id="line-106"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier">location</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier">vData</span></a></span><span>
</span><span id="line-107"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Mutable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MV</span></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-118"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | A connected component.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- For every face f, and every hole in this face, the facedata points to a dart</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- d on the hole s.t. this dart has the face f on its left. i.e.</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- leftFace d = f</span><span>
</span><span id="line-125"></span><span class="hs-keyword">type</span><span> </span><span id="Component"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-var">Component</span></a></span></span><span> </span><span id="local-6989586621680052153"><span class="annot"><a href="#local-6989586621680052153"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052152"><span class="annot"><a href="#local-6989586621680052152"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052153"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052153"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052153"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052153"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                                </span><span class="annot"><a href="#local-6989586621680052152"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | A planarsubdivision is essentially a bunch of plane-graphs; one for every</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- connected component. These graphs store the global ID's (darts, vertexId's, faceId's)</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- in their data values. This essentially gives us a mapping between the two.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- note that a face may actually occur in multiple graphs, hence when we store</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- the edges to the the holes, we store the global edgeId's rather than the</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- 'local' edgeId (dart)'s.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- invariant: the outerface has faceId 0</span><span>
</span><span id="line-139"></span><span id="local-6989586621680052150"><span id="local-6989586621680052151"></span></span><span class="hs-keyword">data</span><span> </span><span id="PlanarSubdivision"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-var">PlanarSubdivision</span></a></span></span><span> </span><span id="local-6989586621680053430"><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680053429"><span class="annot"><a href="#local-6989586621680053429"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680053428"><span class="annot"><a href="#local-6989586621680053428"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680053427"><span class="annot"><a href="#local-6989586621680053427"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680053426"><span class="annot"><a href="#local-6989586621680053426"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span id="PlanarSubdivision"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-var">PlanarSubdivision</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_components"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_components"><span class="hs-identifier hs-var hs-var">_components</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053426"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_rawVertexData"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawVertexData"><span class="hs-identifier hs-var hs-var">_rawVertexData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053429"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_rawDartData"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawDartData"><span class="hs-identifier hs-var hs-var">_rawDartData</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053428"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_rawFaceData"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (RawFace s f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawFaceData"><span class="hs-identifier hs-var hs-var">_rawFaceData</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053430"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053427"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680052140"><span id="local-6989586621680052142"><span id="local-6989586621680052144"><span class="annot"><span class="annottext">Int -&gt; PlanarSubdivision s v e f r -&gt; ShowS
[PlanarSubdivision s v e f r] -&gt; ShowS
PlanarSubdivision s v e f r -&gt; String
(Int -&gt; PlanarSubdivision s v e f r -&gt; ShowS)
-&gt; (PlanarSubdivision s v e f r -&gt; String)
-&gt; ([PlanarSubdivision s v e f r] -&gt; ShowS)
-&gt; Show (PlanarSubdivision s v e f r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlanarSubdivision s v e f r -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlanarSubdivision s v e f r] -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlanarSubdivision s v e f r -&gt; String
showList :: [PlanarSubdivision s v e f r] -&gt; ShowS
$cshowList :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlanarSubdivision s v e f r] -&gt; ShowS
show :: PlanarSubdivision s v e f r -&gt; String
$cshow :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlanarSubdivision s v e f r -&gt; String
showsPrec :: Int -&gt; PlanarSubdivision s v e f r -&gt; ShowS
$cshowsPrec :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlanarSubdivision s v e f r -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680052135"><span id="local-6989586621680052137"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
(PlanarSubdivision s v e f r
 -&gt; PlanarSubdivision s v e f r -&gt; Bool)
-&gt; (PlanarSubdivision s v e f r
    -&gt; PlanarSubdivision s v e f r -&gt; Bool)
-&gt; Eq (PlanarSubdivision s v e f r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
/= :: PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
$c/= :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
== :: PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
$c== :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680052130"><span id="local-6989586621680052132"><span class="annot"><span class="annottext">a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a
(a -&gt; b)
-&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b
(forall a b.
 (a -&gt; b)
 -&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b)
-&gt; (forall a b.
    a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a)
-&gt; Functor (PlanarSubdivision s v e f)
forall k (s :: k) v e f a b.
a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a
forall k (s :: k) v e f a b.
(a -&gt; b)
-&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b
forall a b.
a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a
forall a b.
(a -&gt; b)
-&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a
$c&lt;$ :: forall k (s :: k) v e f a b.
a -&gt; PlanarSubdivision s v e f b -&gt; PlanarSubdivision s v e f a
fmap :: (a -&gt; b)
-&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b
$cfmap :: forall k (s :: k) v e f a b.
(a -&gt; b)
-&gt; PlanarSubdivision s v e f a -&gt; PlanarSubdivision s v e f b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x.
 PlanarSubdivision s v e f r -&gt; Rep (PlanarSubdivision s v e f r) x)
-&gt; (forall x.
    Rep (PlanarSubdivision s v e f r) x -&gt; PlanarSubdivision s v e f r)
-&gt; Generic (PlanarSubdivision s v e f r)
forall x.
Rep (PlanarSubdivision s v e f r) x -&gt; PlanarSubdivision s v e f r
forall x.
PlanarSubdivision s v e f r -&gt; Rep (PlanarSubdivision s v e f r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall k (s :: k) v e f r x.
Rep (PlanarSubdivision s v e f r) x -&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r x.
PlanarSubdivision s v e f r -&gt; Rep (PlanarSubdivision s v e f r) x
$cto :: forall k (s :: k) v e f r x.
Rep (PlanarSubdivision s v e f r) x -&gt; PlanarSubdivision s v e f r
$cfrom :: forall k (s :: k) v e f r x.
PlanarSubdivision s v e f r -&gt; Rep (PlanarSubdivision s v e f r) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span id="rawFaceData"><span id="rawDartData"><span id="rawVertexData"><span id="components"><span id="local-6989586621680052975"><span id="local-6989586621680052998"><span id="local-6989586621680053057"><span id="local-6989586621680053415"><span id="local-6989586621680053426"><span id="local-6989586621680053427"><span id="local-6989586621680053428"><span id="local-6989586621680053429"><span id="local-6989586621680053430"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PlanarSubdivision</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="Geometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span id="local-6989586621680052125"><span class="annot"><a href="#local-6989586621680052125"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052124"><span class="annot"><a href="#local-6989586621680052124"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680052123"><span class="annot"><a href="#local-6989586621680052123"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680052122"><span class="annot"><a href="#local-6989586621680052122"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680052121"><span class="annot"><a href="#local-6989586621680052121"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680052121"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-149"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="Geometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span id="local-6989586621680052120"><span class="annot"><a href="#local-6989586621680052120"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052119"><span class="annot"><a href="#local-6989586621680052119"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680052118"><span class="annot"><a href="#local-6989586621680052118"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680052117"><span class="annot"><a href="#local-6989586621680052117"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680052116"><span class="annot"><a href="#local-6989586621680052116"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621680052111"><span id="local-6989586621680052112"><span id="local-6989586621680052113"><span id="local-6989586621680052114"><span id="local-6989586621680052115"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.Box.Internal.html#IsBoxable"><span class="hs-identifier hs-type">IsBoxable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052115"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052114"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052113"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052112"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052111"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621680052108"><span class="annot"><span class="annottext">boundingBox :: PlanarSubdivision s v e f r
-&gt; Box
     (Dimension (PlanarSubdivision s v e f r))
     ()
     (NumType (PlanarSubdivision s v e f r))
</span><a href="Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var hs-var hs-var hs-var">boundingBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r]
-&gt; Box 2 () r
forall g (c :: * -&gt; *).
(IsBoxable g, Foldable c, Ord (NumType g), Arity (Dimension g)) =&gt;
c g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Geometry.Box.Internal.html#boundingBoxList%27"><span class="hs-identifier hs-var">boundingBoxList'</span></a></span><span> </span><span class="annot"><span class="annottext">([PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r]
 -&gt; Box 2 () r)
-&gt; (PlanarSubdivision s v e f r
    -&gt; [PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r])
-&gt; PlanarSubdivision s v e f r
-&gt; Box 2 () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; [PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; [PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r])
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector
         (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; PlanarSubdivision s v e f r
-&gt; [PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_components"><span class="hs-identifier hs-var hs-var">_components</span></a></span></span></span></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Lens to access a particular component of the planar subdivision.</span><span>
</span><span id="line-156"></span><span id="local-6989586621680052807"><span id="local-6989586621680052808"><span id="local-6989586621680052809"><span id="local-6989586621680052810"><span id="local-6989586621680052811"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-type">component</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052811"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052811"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052810"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052809"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052808"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052807"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052811"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052807"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-158"></span><span id="component"><span class="annot"><span class="annottext">component :: ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var hs-var">component</span></a></span></span><span> </span><span id="local-6989586621680052103"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680052103"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector (Component s r) -&gt; f (Vector (Component s r)))
-&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r r.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Component s r))
  (Vector (Component s r))
</span><a href="Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier hs-var">components</span></a></span><span class="annot"><span class="annottext">((Vector (Component s r) -&gt; f (Vector (Component s r)))
 -&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r))
-&gt; ((Component s r -&gt; f (Component s r))
    -&gt; Vector (Component s r) -&gt; f (Vector (Component s r)))
-&gt; (Component s r -&gt; f (Component s r))
-&gt; PlanarSubdivision s v e f r
-&gt; f (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Traversing
  (-&gt;)
  f
  (Vector (Component s r))
  (Vector (Component s r))
  (Component s r)
  (Component s r)
-&gt; (Component s r -&gt; f (Component s r))
-&gt; Vector (Component s r)
-&gt; f (Vector (Component s r))
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s t a.
(HasCallStack, Conjoined p, Functor f) =&gt;
Traversing p f s t a a -&gt; Over p f s t a a
</span><span class="hs-identifier hs-var">singular</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index (Vector (Component s r))
-&gt; Traversal'
     (Vector (Component s r)) (IxValue (Vector (Component s r)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">(Index (Vector (Component s r))
 -&gt; Traversal'
      (Vector (Component s r)) (IxValue (Vector (Component s r))))
-&gt; Index (Vector (Component s r))
-&gt; Traversal'
     (Vector (Component s r)) (IxValue (Vector (Component s r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ComponentId s -&gt; Int
forall k (s :: k). ComponentId s -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Raw.html#unCI"><span class="hs-identifier hs-var hs-var">unCI</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680052103"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- instance (ToJSON v, ToJSON v, ToJSON e, ToJSON f, ToJSON r)</span><span>
</span><span id="line-161"></span><span class="hs-comment">--          =&gt; ToJSON (PlanarSubdivision s v e f r) where</span><span>
</span><span id="line-162"></span><span class="hs-comment">--   toEncoding = genericToEncoding defaultOptions</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Constructs a planarsubdivision from a PlaneGraph</span><span>
</span><span id="line-169"></span><span class="hs-comment">--</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- runningTime: \(O(n)\)</span><span>
</span><span id="line-171"></span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph"><span class="hs-identifier hs-type">fromPlaneGraph</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053264"><span class="annot"><a href="#local-6989586621680053264"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680053263"><span class="annot"><a href="#local-6989586621680053263"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680053262"><span class="annot"><a href="#local-6989586621680053262"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680053261"><span class="annot"><a href="#local-6989586621680053261"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680053265"><span class="annot"><a href="#local-6989586621680053265"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680053265"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680053265"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053264"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053263"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053262"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053261"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053265"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053264"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053263"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053262"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053261"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053265"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-173"></span><span id="fromPlaneGraph"><span class="annot"><span class="annottext">fromPlaneGraph :: PlaneGraph s v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph"><span class="hs-identifier hs-var hs-var">fromPlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680052099"><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052099"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Dart s -&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Dart s -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph%27"><span class="hs-identifier hs-var">fromPlaneGraph'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052099"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Dart s
forall k r (s :: k) v e f.
(Ord r, Num r) =&gt;
PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-var">PG.outerFaceDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052099"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">{- HLINT ignore fromPlaneGraph' -}</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Given a (connected) PlaneGraph and a dart that has the outerface on its left</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Constructs a planarsubdivision</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- runningTime: \(O(n)\)</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph%27"><span class="hs-identifier hs-type">fromPlaneGraph'</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053387"><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680053386"><span class="annot"><a href="#local-6989586621680053386"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680053385"><span class="annot"><a href="#local-6989586621680053385"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680053384"><span class="annot"><a href="#local-6989586621680053384"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680053383"><span class="annot"><a href="#local-6989586621680053383"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053386"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053385"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053384"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053383"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-181"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053386"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053385"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053384"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053383"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-182"></span><span id="fromPlaneGraph%27"><span class="annot"><span class="annottext">fromPlaneGraph' :: PlaneGraph s v e f r -&gt; Dart s -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph%27"><span class="hs-identifier hs-var hs-var">fromPlaneGraph'</span></a></span></span><span> </span><span id="local-6989586621680052097"><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680052096"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680052096"><span class="hs-identifier hs-var">ofD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r.
Vector (Component s r)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-var">PlanarSubdivision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component s r -&gt; Vector (Component s r)
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Component s r -&gt; Vector (Component s r))
-&gt; (PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
    -&gt; Component s r)
-&gt; PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Vector (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r -&gt; Component s r
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
 -&gt; Vector (Component s r))
-&gt; PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Vector (Component s r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680052094"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621680052093"><span class="hs-identifier hs-var">vd</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621680052092"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621680052091"><span class="hs-identifier hs-var">fd</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680052090"><span class="annot"><span class="annottext">c :: ComponentId s
</span><a href="#local-6989586621680052090"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall k (s :: k). Int -&gt; ComponentId s
</span><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-var">ComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621680052093"><span class="annot"><span class="annottext">vd :: Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621680052093"><span class="hs-identifier hs-var hs-var">vd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; v -&gt; Raw s (VertexId' (Wrap s)) v)
-&gt; Vector v -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680052087"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052087"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680052086"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680052086"><span class="hs-identifier hs-var">v</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComponentId s
-&gt; VertexId' (Wrap s) -&gt; v -&gt; Raw s (VertexId' (Wrap s)) v
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
forall k (s :: k). ComponentId s
</span><a href="#local-6989586621680052090"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VertexId' (Wrap s)
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052087"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680052086"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>                   </span><span class="annot"><span class="annottext">(Vector v -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Vector v -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting (Vector v) (PlaneGraph s v e f r) (Vector v) -&gt; Vector v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Vector v) (PlaneGraph s v e f r) (Vector v)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">PG.vertexData</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621680052092"><span class="annot"><span class="annottext">ed :: Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621680052092"><span class="hs-identifier hs-var hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart (Wrap s) -&gt; e -&gt; Raw s (Dart (Wrap s)) e)
-&gt; Vector (Dart (Wrap s))
-&gt; Vector e
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680052080"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680052080"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680052079"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680052079"><span class="hs-identifier hs-var">dd</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComponentId s -&gt; Dart (Wrap s) -&gt; e -&gt; Raw s (Dart (Wrap s)) e
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
forall k (s :: k). ComponentId s
</span><a href="#local-6989586621680052090"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680052080"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680052079"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Dart (Wrap s))
forall k (s' :: k). Vector (Dart s')
</span><a href="#local-6989586621680052078"><span class="hs-identifier hs-var">allDarts''</span></a></span><span>                  </span><span class="annot"><span class="annottext">(Vector e -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; Vector e -&gt; Vector (Raw s (Dart (Wrap s)) e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting (Vector e) (PlaneGraph s v e f r) (Vector e) -&gt; Vector e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Vector e) (PlaneGraph s v e f r) (Vector e)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector e)
  (Vector e')
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var">PG.rawDartData</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621680052091"><span class="annot"><span class="annottext">fd :: Vector (RawFace s f)
</span><a href="#local-6989586621680052091"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f -&gt; RawFace s f) -&gt; Vector f -&gt; Vector (RawFace s f)
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680052076"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052076"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680052075"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052075"><span class="hs-identifier hs-var">f</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall k (s :: k) f1.
Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f1 -&gt; RawFace s f1
</span><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-var">RawFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621680052073"><span class="hs-identifier hs-var">mkFaceIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052076"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621680052072"><span class="hs-identifier hs-var">mkFaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052076"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052075"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector f -&gt; Vector (RawFace s f))
-&gt; Vector f -&gt; Vector (RawFace s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting (Vector f) (PlaneGraph s v e f r) (Vector f) -&gt; Vector f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Vector f) (PlaneGraph s v e f r) (Vector f)
forall k (s :: k) v e f r f'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (Vector f)
  (Vector f')
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var">PG.faceData</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="#local-6989586621680052094"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053383"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621680052094"><span class="annot"><span class="annottext">g' :: PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680052094"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e (FaceId' s) r)
-&gt; PlaneGraph s v e (FaceId' s) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector f -&gt; Identity (Vector (FaceId' s)))
-&gt; PlaneGraph s v e f r
-&gt; Identity (PlaneGraph s v e (FaceId' s) r)
forall k (s :: k) v e f r f'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (Vector f)
  (Vector f')
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var">PG.faceData</span></a></span><span>    </span><span class="annot"><span class="annottext">((Vector f -&gt; Identity (Vector (FaceId' s)))
 -&gt; PlaneGraph s v e f r
 -&gt; Identity (PlaneGraph s v e (FaceId' s) r))
-&gt; (Vector f -&gt; Vector (FaceId' s))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e (FaceId' s) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f -&gt; FaceId' s) -&gt; Vector f -&gt; Vector (FaceId' s)
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680052068"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052068"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FaceId' s
forall k (s' :: k). Int -&gt; FaceId' s'
</span><a href="#local-6989586621680052067"><span class="hs-identifier hs-var">mkFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId' s) -&gt; Int -&gt; FaceId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621680052066"><span class="hs-identifier hs-var">flipID</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052068"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>          </span><span class="annot"><span class="annottext">PlaneGraph s v e (FaceId' s) r
-&gt; (PlaneGraph s v e (FaceId' s) r
    -&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r)
-&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector v -&gt; Identity (Vector (VertexId' s)))
-&gt; PlaneGraph s v e (FaceId' s) r
-&gt; Identity (PlaneGraph s (VertexId' s) e (FaceId' s) r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">PG.vertexData</span></a></span><span>  </span><span class="annot"><span class="annottext">((Vector v -&gt; Identity (Vector (VertexId' s)))
 -&gt; PlaneGraph s v e (FaceId' s) r
 -&gt; Identity (PlaneGraph s (VertexId' s) e (FaceId' s) r))
-&gt; (Vector v -&gt; Vector (VertexId' s))
-&gt; PlaneGraph s v e (FaceId' s) r
-&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; v -&gt; VertexId' s) -&gt; Vector v -&gt; Vector (VertexId' s)
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680052065"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052065"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052065"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>          </span><span class="annot"><span class="annottext">PlaneGraph s (VertexId' s) e (FaceId' s) r
-&gt; (PlaneGraph s (VertexId' s) e (FaceId' s) r
    -&gt; PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector e -&gt; Identity (Vector (Dart s)))
-&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r
-&gt; Identity (PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector e)
  (Vector e')
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var">PG.rawDartData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector e -&gt; Identity (Vector (Dart s)))
 -&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r
 -&gt; Identity (PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; Vector (Dart s)
-&gt; PlaneGraph s (VertexId' s) e (FaceId' s) r
-&gt; PlaneGraph s (VertexId' s) (Dart s) (FaceId' s) r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart s)
forall k (s' :: k). Vector (Dart s')
</span><a href="#local-6989586621680052078"><span class="hs-identifier hs-var">allDarts''</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621680052078"><span class="hs-identifier hs-type">allDarts''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053339"><span class="annot"><a href="#local-6989586621680053339"><span class="hs-identifier hs-type">s'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053339"><span class="hs-identifier hs-type">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621680052078"><span class="annot"><span class="annottext">allDarts'' :: Vector (Dart s')
</span><a href="#local-6989586621680052078"><span class="hs-identifier hs-var hs-var">allDarts''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector (Dart s')
forall k (s' :: k). Int -&gt; Vector (Dart s')
</span><a href="Geometry.PlanarSubdivision.Basic.html#allDarts%27"><span class="hs-identifier hs-var">allDarts'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Int
forall k (s :: k) v e f r. PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier hs-var">PG.numDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- make sure the outerFaceId is 0</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621680052061"><span class="annot"><span class="annottext">oF :: FaceId' s
</span><a href="#local-6989586621680052061"><span class="hs-identifier hs-var">oF</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621680052059"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052059"><span class="hs-identifier hs-var">of'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var">PG.leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680052096"><span class="hs-identifier hs-var">ofD</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621680052073"><span class="annot"><span class="annottext">mkFaceIdx :: Int -&gt; Maybe (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621680052073"><span class="hs-identifier hs-var hs-var">mkFaceIdx</span></a></span></span><span> </span><span id="local-6989586621680052057"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052057"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052057"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-201"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ComponentId s, FaceId' (Wrap s))
-&gt; Maybe (ComponentId s, FaceId' (Wrap s))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
forall k (s :: k). ComponentId s
</span><a href="#local-6989586621680052090"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; FaceId' (Wrap s)
forall k (s' :: k). Int -&gt; FaceId' s'
</span><a href="#local-6989586621680052067"><span class="hs-identifier hs-var">mkFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId' (Wrap s))
-&gt; (Int -&gt; Int) -&gt; Int -&gt; FaceId' (Wrap s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621680052066"><span class="hs-identifier hs-var">flipID</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId' (Wrap s)) -&gt; Int -&gt; FaceId' (Wrap s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052057"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- at index i we are storing the outerface</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="#local-6989586621680052072"><span class="hs-identifier hs-type">mkFaceData</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680053384"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053384"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621680052072"><span class="annot"><span class="annottext">mkFaceData :: Int -&gt; f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621680052072"><span class="hs-identifier hs-var hs-var">mkFaceData</span></a></span></span><span> </span><span id="local-6989586621680052056"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052056"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680052055"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052055"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052056"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f1. Seq h -&gt; f1 -&gt; FaceData h f1
</span><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Seq (Dart s)
forall a. a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.singleton</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680052096"><span class="hs-identifier hs-var">ofD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680052061"><span class="hs-identifier hs-var">oF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052056"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052059"><span class="hs-identifier hs-var">of'</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f1. Seq h -&gt; f1 -&gt; FaceData h f1
</span><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680052097"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FaceId' s
forall k (s' :: k). Int -&gt; FaceId' s'
</span><a href="#local-6989586621680052067"><span class="hs-identifier hs-var">mkFaceId</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680053387"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f1. Seq h -&gt; f1 -&gt; FaceData h f1
</span><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>              </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052055"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="#local-6989586621680052067"><span class="hs-identifier hs-type">mkFaceId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053311"><span class="annot"><a href="#local-6989586621680053311"><span class="hs-identifier hs-type">s'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053311"><span class="hs-identifier hs-type">s'</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621680052067"><span class="annot"><span class="annottext">mkFaceId :: Int -&gt; FaceId' s'
</span><a href="#local-6989586621680052067"><span class="hs-identifier hs-var hs-var">mkFaceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId s' 'Dual -&gt; FaceId' s'
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s' 'Dual -&gt; FaceId' s')
-&gt; (Int -&gt; VertexId s' 'Dual) -&gt; Int -&gt; FaceId' s'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s' 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621680052066"><span class="annot"><span class="annottext">flipID :: Int -&gt; Int
</span><a href="#local-6989586621680052066"><span class="hs-identifier hs-var hs-var">flipID</span></a></span></span><span> </span><span id="local-6989586621680052052"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052052"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052059"><span class="hs-identifier hs-var">of'</span></a></span><span>
</span><span id="line-213"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052059"><span class="hs-identifier hs-var">of'</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-214"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680052052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Construct a plane graph from a simple polygon. It is assumed that the</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- polygon is given in counterclockwise order.</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- the interior of the polygon will have faceId 0</span><span>
</span><span id="line-220"></span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- pre: the input polygon is given in counterclockwise order</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- running time: \(O(n)\).</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-type">fromSimplePolygon</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680052051"><span class="annot"><a href="#local-6989586621680052051"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052050"><span class="annot"><a href="#local-6989586621680052050"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621680052049"><span class="annot"><a href="#local-6989586621680052049"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680052048"><span class="annot"><a href="#local-6989586621680052048"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680052048"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680052048"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052050"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052048"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-225"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052049"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data inside</span><span>
</span><span id="line-226"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052049"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data outside the polygon</span><span>
</span><span id="line-227"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052051"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052050"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052049"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052048"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-228"></span><span id="fromSimplePolygon"><span class="annot"><span class="annottext">fromSimplePolygon :: SimplePolygon p r -&gt; f -&gt; f -&gt; PlanarSubdivision s p () f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-var hs-var">fromSimplePolygon</span></a></span></span><span> </span><span id="local-6989586621680052047"><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680052047"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span id="local-6989586621680052046"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052046"><span class="hs-identifier hs-var">iD</span></a></span></span><span> </span><span id="local-6989586621680052045"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052045"><span class="hs-identifier hs-var">oD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">PlaneGraph s p () f r -&gt; PlanarSubdivision s p () f r
forall k (s :: k) v e f r.
(Ord r, Num r) =&gt;
PlaneGraph s v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph"><span class="hs-identifier hs-var">fromPlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimplePolygon p r -&gt; f -&gt; f -&gt; PlaneGraph s p () f r
forall k (s :: k) p r f.
SimplePolygon p r -&gt; f -&gt; f -&gt; PlaneGraph s p () f r
</span><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier hs-var">PG.fromSimplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680052047"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052046"><span class="hs-identifier hs-var">iD</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680052045"><span class="hs-identifier hs-var">oD</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Constructs a connected planar subdivision.</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- pre: the segments form a single connected component</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- running time: \(O(n\log n)\)</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#fromConnectedSegments"><span class="hs-identifier hs-type">fromConnectedSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680052043"><span class="annot"><a href="#local-6989586621680052043"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052042"><span class="annot"><a href="#local-6989586621680052042"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621680052041"><span class="annot"><a href="#local-6989586621680052041"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680052040"><span class="annot"><a href="#local-6989586621680052040"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621680052039"><span class="annot"><a href="#local-6989586621680052039"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621680052039"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680052040"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680052040"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052039"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680052042"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052040"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052041"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052043"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621680052042"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052041"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052040"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-238"></span><span id="fromConnectedSegments"><span class="annot"><span class="annottext">fromConnectedSegments :: f (LineSegment 2 p r :+ e)
-&gt; PlanarSubdivision s (NonEmpty p) e () r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromConnectedSegments"><span class="hs-identifier hs-var hs-var">fromConnectedSegments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s (NonEmpty p) e () r
-&gt; PlanarSubdivision s (NonEmpty p) e () r
forall k (s :: k) v e f r.
(Ord r, Num r) =&gt;
PlaneGraph s v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#fromPlaneGraph"><span class="hs-identifier hs-var">fromPlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s (NonEmpty p) e () r
 -&gt; PlanarSubdivision s (NonEmpty p) e () r)
-&gt; (f (LineSegment 2 p r :+ e) -&gt; PlaneGraph s (NonEmpty p) e () r)
-&gt; f (LineSegment 2 p r :+ e)
-&gt; PlanarSubdivision s (NonEmpty p) e () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (LineSegment 2 p r :+ e) -&gt; PlaneGraph s (NonEmpty p) e () r
forall k (s :: k) p r e (f :: * -&gt; *).
(Foldable f, Ord r, Num r) =&gt;
f (LineSegment 2 p r :+ e) -&gt; PlaneGraph s (NonEmpty p) e () r
</span><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier hs-var">PG.fromConnectedSegments</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- g1 = PG.fromConnectedSegments (Identity Test1) testSegs</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- ps1 = fromConnectedSegments (Identity Test1) testSegs</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- data Test1 = Test1</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- draw = V.filter isEmpty . rawFacePolygons</span><span>
</span><span id="line-246"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-247"></span><span class="hs-comment">--     isEmpty (_,Left  p :+ _) = (&lt; 3) . length . polygonVertices $ p</span><span>
</span><span id="line-248"></span><span class="hs-comment">--     isEmpty (_,Right p :+ _) = (&lt; 3) . length . polygonVertices $ p</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- testSegs = map (\(p,q) -&gt; ClosedLineSegment (ext p) (ext q) :+ ())</span><span>
</span><span id="line-251"></span><span class="hs-comment">--                    [ (origin, Point2 10 10)</span><span>
</span><span id="line-252"></span><span class="hs-comment">--                    , (origin, Point2 12 10)</span><span>
</span><span id="line-253"></span><span class="hs-comment">--                    , (origin, Point2 20 5)</span><span>
</span><span id="line-254"></span><span class="hs-comment">--                    , (origin, Point2 13 20)</span><span>
</span><span id="line-255"></span><span class="hs-comment">--                    , (Point2 10 10, Point2 12 10)</span><span>
</span><span id="line-256"></span><span class="hs-comment">--                    , (Point2 10 10, Point2 13 20)</span><span>
</span><span id="line-257"></span><span class="hs-comment">--                    , (Point2 12 10, Point2 20 5)</span><span>
</span><span id="line-258"></span><span class="hs-comment">--                    ]</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- | Data type that expresses whether or not we are inside or outside the</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- polygon.</span><span>
</span><span id="line-265"></span><span class="hs-keyword">data</span><span> </span><span id="PolygonFaceData"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PolygonFaceData"><span class="hs-identifier hs-var">PolygonFaceData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Inside"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Inside"><span class="hs-identifier hs-var">Inside</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Outside"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Outside"><span class="hs-identifier hs-var">Outside</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680052030"><span id="local-6989586621680052032"><span id="local-6989586621680052034"><span class="annot"><span class="annottext">Int -&gt; PolygonFaceData -&gt; ShowS
[PolygonFaceData] -&gt; ShowS
PolygonFaceData -&gt; String
(Int -&gt; PolygonFaceData -&gt; ShowS)
-&gt; (PolygonFaceData -&gt; String)
-&gt; ([PolygonFaceData] -&gt; ShowS)
-&gt; Show PolygonFaceData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PolygonFaceData] -&gt; ShowS
$cshowList :: [PolygonFaceData] -&gt; ShowS
show :: PolygonFaceData -&gt; String
$cshow :: PolygonFaceData -&gt; String
showsPrec :: Int -&gt; PolygonFaceData -&gt; ShowS
$cshowsPrec :: Int -&gt; PolygonFaceData -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680052022"><span id="local-6989586621680052024"><span id="local-6989586621680052026"><span id="local-6989586621680052028"><span class="annot"><span class="annottext">ReadPrec [PolygonFaceData]
ReadPrec PolygonFaceData
Int -&gt; ReadS PolygonFaceData
ReadS [PolygonFaceData]
(Int -&gt; ReadS PolygonFaceData)
-&gt; ReadS [PolygonFaceData]
-&gt; ReadPrec PolygonFaceData
-&gt; ReadPrec [PolygonFaceData]
-&gt; Read PolygonFaceData
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [PolygonFaceData]
$creadListPrec :: ReadPrec [PolygonFaceData]
readPrec :: ReadPrec PolygonFaceData
$creadPrec :: ReadPrec PolygonFaceData
readList :: ReadS [PolygonFaceData]
$creadList :: ReadS [PolygonFaceData]
readsPrec :: Int -&gt; ReadS PolygonFaceData
$creadsPrec :: Int -&gt; ReadS PolygonFaceData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680052017"><span id="local-6989586621680052019"><span class="annot"><span class="annottext">PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
(PolygonFaceData -&gt; PolygonFaceData -&gt; Bool)
-&gt; (PolygonFaceData -&gt; PolygonFaceData -&gt; Bool)
-&gt; Eq PolygonFaceData
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
$c/= :: PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
== :: PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
$c== :: PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- * Basic Graph information</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Get the number of vertices</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- &gt;&gt;&gt; numVertices myGraph</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- 1</span><span>
</span><span id="line-275"></span><span id="local-6989586621680052012"><span id="local-6989586621680052013"><span id="local-6989586621680052014"><span id="local-6989586621680052015"><span id="local-6989586621680052016"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numComponents"><span class="hs-identifier hs-type">numComponents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052016"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052015"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052014"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052013"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052012"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-276"></span><span id="numComponents"><span class="annot"><span class="annottext">numComponents :: PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numComponents"><span class="hs-identifier hs-var hs-var">numComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; Int)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector
         (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_components"><span class="hs-identifier hs-var hs-var">_components</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Get the number of vertices</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- &gt;&gt;&gt; numVertices myGraph</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- 4</span><span>
</span><span id="line-282"></span><span id="local-6989586621680053193"><span id="local-6989586621680053194"><span id="local-6989586621680053195"><span id="local-6989586621680053196"><span id="local-6989586621680053197"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier hs-type">numVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053197"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053196"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053195"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053194"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053193"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-283"></span><span id="numVertices"><span class="annot"><span class="annottext">numVertices :: PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier hs-var hs-var">numVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v) -&gt; Int)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawVertexData"><span class="hs-identifier hs-var hs-var">_rawVertexData</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Get the number of Darts</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- &gt;&gt;&gt; numDarts myGraph</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- 12</span><span>
</span><span id="line-289"></span><span id="local-6989586621680052006"><span id="local-6989586621680052007"><span id="local-6989586621680052008"><span id="local-6989586621680052009"><span id="local-6989586621680052010"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numDarts"><span class="hs-identifier hs-type">numDarts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052010"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052009"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052008"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052007"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052006"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-290"></span><span id="numDarts"><span class="annot"><span class="annottext">numDarts :: PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numDarts"><span class="hs-identifier hs-var hs-var">numDarts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e) -&gt; Int)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawDartData"><span class="hs-identifier hs-var hs-var">_rawDartData</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | Get the number of Edges</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- &gt;&gt;&gt; numEdges myGraph</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- 6</span><span>
</span><span id="line-296"></span><span id="local-6989586621680052001"><span id="local-6989586621680052002"><span id="local-6989586621680052003"><span id="local-6989586621680052004"><span id="local-6989586621680052005"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numEdges"><span class="hs-identifier hs-type">numEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052005"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052004"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052003"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052002"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052001"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-297"></span><span id="numEdges"><span class="annot"><span class="annottext">numEdges :: PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numEdges"><span class="hs-identifier hs-var hs-var">numEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int)
-&gt; (PlanarSubdivision s v e f r -&gt; Int)
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e) -&gt; Int)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawDartData"><span class="hs-identifier hs-var hs-var">_rawDartData</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | \( O(1) \). Get the number of faces</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- &gt;&gt;&gt; numFaces myGraph</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- 4</span><span>
</span><span id="line-303"></span><span id="local-6989586621680051995"><span id="local-6989586621680051996"><span id="local-6989586621680051997"><span id="local-6989586621680051998"><span id="local-6989586621680051999"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier hs-type">numFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051999"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051998"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051997"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051996"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051995"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-304"></span><span id="numFaces"><span class="annot"><span class="annottext">numFaces :: PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier hs-var hs-var">numFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; Int)
-&gt; (PlanarSubdivision s v e f r -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (RawFace s f)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (RawFace s f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawFaceData"><span class="hs-identifier hs-var hs-var">_rawFaceData</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Enumerate all vertices</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- &gt;&gt;&gt; vertices' myGraph</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- [VertexId 0,VertexId 1,VertexId 2,VertexId 3]</span><span>
</span><span id="line-310"></span><span id="local-6989586621680053167"><span id="local-6989586621680053168"><span id="local-6989586621680053169"><span id="local-6989586621680053170"><span id="local-6989586621680053171"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertices%27"><span class="hs-identifier hs-type">vertices'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053171"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053170"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053169"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053168"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053167"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053171"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-311"></span><span id="vertices%27"><span class="annot"><span class="annottext">vertices' :: PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertices%27"><span class="hs-identifier hs-var hs-var">vertices'</span></a></span></span><span> </span><span id="local-6989586621680051994"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051994"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680051993"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680051993"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier hs-var">numVertices</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051994"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-312"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[VertexId' s] -&gt; Vector (VertexId' s)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([VertexId' s] -&gt; Vector (VertexId' s))
-&gt; [VertexId' s] -&gt; Vector (VertexId' s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VertexId' s) -&gt; [Int] -&gt; [VertexId' s]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051993"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Enumerate all vertices, together with their vertex data</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- &gt;&gt;&gt; vertices myGraph</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- [(VertexId 0,()),(VertexId 1,()),(VertexId 2,()),(VertexId 3,())]</span><span>
</span><span id="line-318"></span><span id="local-6989586621680051987"><span id="local-6989586621680051988"><span id="local-6989586621680051989"><span id="local-6989586621680051990"><span id="local-6989586621680051991"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051991"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051990"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051989"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051988"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051987"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051991"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051987"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051990"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-319"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: PlanarSubdivision s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span id="local-6989586621680051986"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051986"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051985"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051985"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051985"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051986"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v) (PlanarSubdivision s v e f r) (VertexData r v)
-&gt; VertexData r v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051985"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; (VertexId' s, VertexData r v))
-&gt; Vector (VertexId' s) -&gt; Vector (VertexId' s, VertexData r v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertices%27"><span class="hs-identifier hs-var">vertices'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051986"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Enumerate all darts</span><span>
</span><span id="line-322"></span><span id="local-6989586621680053141"><span id="local-6989586621680053142"><span id="local-6989586621680053143"><span id="local-6989586621680053144"><span id="local-6989586621680053145"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#darts%27"><span class="hs-identifier hs-type">darts'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053145"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053144"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053143"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053142"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053141"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053145"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-323"></span><span id="darts%27"><span class="annot"><span class="annottext">darts' :: PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#darts%27"><span class="hs-identifier hs-var hs-var">darts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector (Dart s)
forall k (s' :: k). Int -&gt; Vector (Dart s')
</span><a href="Geometry.PlanarSubdivision.Basic.html#allDarts%27"><span class="hs-identifier hs-var">allDarts'</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Vector (Dart s))
-&gt; (PlanarSubdivision s v e f r -&gt; Int)
-&gt; PlanarSubdivision s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numDarts"><span class="hs-identifier hs-var">numDarts</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#allDarts%27"><span class="hs-identifier hs-type">allDarts'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680053303"><span class="annot"><a href="#local-6989586621680053303"><span class="hs-identifier hs-type">s'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053303"><span class="hs-identifier hs-type">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="allDarts%27"><span class="annot"><span class="annottext">allDarts' :: Int -&gt; Vector (Dart s')
</span><a href="Geometry.PlanarSubdivision.Basic.html#allDarts%27"><span class="hs-identifier hs-var hs-var">allDarts'</span></a></span></span><span> </span><span id="local-6989586621680051982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051982"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dart s'] -&gt; Vector (Dart s')
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Dart s'] -&gt; Vector (Dart s')) -&gt; [Dart s'] -&gt; Vector (Dart s')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Dart s'] -&gt; [Dart s']
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051982"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dart s']
forall k (s :: k). [Dart s]
</span><span class="hs-identifier hs-var">allDarts</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Enumerate all edges. We report only the Positive darts</span><span>
</span><span id="line-330"></span><span id="local-6989586621680051976"><span id="local-6989586621680051977"><span id="local-6989586621680051978"><span id="local-6989586621680051979"><span id="local-6989586621680051980"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edges%27"><span class="hs-identifier hs-type">edges'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051980"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051979"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051978"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051977"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051976"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051980"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-331"></span><span id="edges%27"><span class="annot"><span class="annottext">edges' :: PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#edges%27"><span class="hs-identifier hs-var hs-var">edges'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; Vector (Dart s) -&gt; Vector (Dart s)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Bool
forall k (s :: k). Dart s -&gt; Bool
</span><span class="hs-identifier hs-var">isPositive</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Vector (Dart s))
-&gt; (PlanarSubdivision s v e f r -&gt; Vector (Dart s))
-&gt; PlanarSubdivision s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#darts%27"><span class="hs-identifier hs-var">darts'</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Enumerate all edges with their edge data. We report only the Positive</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- darts.</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edges myGraph</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- (Dart (Arc 2) +1,&quot;c+&quot;)</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- (Dart (Arc 1) +1,&quot;b+&quot;)</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- (Dart (Arc 0) +1,&quot;a+&quot;)</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- (Dart (Arc 5) +1,&quot;g+&quot;)</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- (Dart (Arc 4) +1,&quot;e+&quot;)</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- (Dart (Arc 3) +1,&quot;d+&quot;)</span><span>
</span><span id="line-343"></span><span id="local-6989586621680051970"><span id="local-6989586621680051971"><span id="local-6989586621680051972"><span id="local-6989586621680051973"><span id="local-6989586621680051974"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051974"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051973"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051972"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051971"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051970"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051974"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680051972"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-344"></span><span id="edges"><span class="annot"><span class="annottext">edges :: PlanarSubdivision s v e f r -&gt; Vector (Dart s, e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span id="local-6989586621680051969"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051969"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051968"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051968"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051968"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051969"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting e (PlanarSubdivision s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051968"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; (Dart s, e)) -&gt; Vector (Dart s) -&gt; Vector (Dart s, e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#edges%27"><span class="hs-identifier hs-var">edges'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051969"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | \( O(n) \). Vector of all primal faces.</span><span>
</span><span id="line-347"></span><span id="local-6989586621680053116"><span id="local-6989586621680053117"><span id="local-6989586621680053118"><span id="local-6989586621680053119"><span id="local-6989586621680053120"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faces%27"><span class="hs-identifier hs-type">faces'</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053118"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053117"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053116"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053120"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-348"></span><span id="faces%27"><span class="annot"><span class="annottext">faces' :: PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faces%27"><span class="hs-identifier hs-var hs-var">faces'</span></a></span></span><span> </span><span id="local-6989586621680051967"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051967"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680051966"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680051966"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier hs-var">numFaces</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051967"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[FaceId' s] -&gt; Vector (FaceId' s)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([FaceId' s] -&gt; Vector (FaceId' s))
-&gt; [FaceId' s] -&gt; Vector (FaceId' s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId' s) -&gt; [Int] -&gt; [FaceId' s]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId s 'Dual -&gt; FaceId' s
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s 'Dual -&gt; FaceId' s)
-&gt; (Int -&gt; VertexId s 'Dual) -&gt; Int -&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051966"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | \( O(n) \). Vector of all primal faces.</span><span>
</span><span id="line-352"></span><span id="local-6989586621680051961"><span id="local-6989586621680051962"><span id="local-6989586621680051963"><span id="local-6989586621680051964"><span id="local-6989586621680051965"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces%27"><span class="hs-identifier hs-type">internalFaces'</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051965"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051964"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051963"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051962"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051961"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051965"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-353"></span><span id="internalFaces%27"><span class="annot"><span class="annottext">internalFaces' :: PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces%27"><span class="hs-identifier hs-var hs-var">internalFaces'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (FaceId' s) -&gt; Vector (FaceId' s)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Vector (FaceId' s))
-&gt; (PlanarSubdivision s v e f r -&gt; Vector (FaceId' s))
-&gt; PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faces%27"><span class="hs-identifier hs-var">faces'</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">-- | \( O(n) \). Vector of all primal faces with associated data.</span><span>
</span><span id="line-356"></span><span id="local-6989586621680053092"><span id="local-6989586621680053093"><span id="local-6989586621680053094"><span id="local-6989586621680053095"><span id="local-6989586621680053096"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faces"><span class="hs-identifier hs-type">faces</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053096"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053095"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053094"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053093"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053092"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053096"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053096"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053093"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-357"></span><span id="faces"><span class="annot"><span class="annottext">faces :: PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faces"><span class="hs-identifier hs-var hs-var">faces</span></a></span></span><span> </span><span id="local-6989586621680051959"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051959"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051958"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051958"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051958"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051959"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (FaceData (Dart s) f)
     (PlanarSubdivision s v e f r)
     (FaceData (Dart s) f)
-&gt; FaceData (Dart s) f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
forall k (s :: k) v e f r.
FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier hs-var">faceDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051958"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; (FaceId' s, FaceData (Dart s) f))
-&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s, FaceData (Dart s) f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (FaceId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faces%27"><span class="hs-identifier hs-var">faces'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051959"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | Enumerates all faces with their face data exlcluding  the outer face</span><span>
</span><span id="line-363"></span><span id="local-6989586621680051953"><span id="local-6989586621680051954"><span id="local-6989586621680051955"><span id="local-6989586621680051956"><span id="local-6989586621680051957"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces"><span class="hs-identifier hs-type">internalFaces</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051957"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051956"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051954"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051953"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-364"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051957"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051957"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680051954"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-365"></span><span id="internalFaces"><span class="annot"><span class="annottext">internalFaces :: PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces"><span class="hs-identifier hs-var hs-var">internalFaces</span></a></span></span><span> </span><span id="local-6989586621680051952"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051952"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (FaceId' s, FaceData (Dart s) f)
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s, FaceData (Dart s) f)
 -&gt; Vector (FaceId' s, FaceData (Dart s) f))
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faces"><span class="hs-identifier hs-var">faces</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051952"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-comment">-- this uses that the outerfaceId is 0, and thus it is the first face in the vector.</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | lens to access the Dart Data</span><span>
</span><span id="line-369"></span><span id="local-6989586621680051946"><span id="local-6989586621680051947"><span id="local-6989586621680051948"><span id="local-6989586621680051949"><span id="local-6989586621680051950"><span id="local-6989586621680051951"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#dartData"><span class="hs-identifier hs-type">dartData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051951"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051950"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051949"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051948"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051947"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051951"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051950"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051946"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051948"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051947"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051951"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680051949"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051951"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680051946"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-371"></span><span id="dartData"><span class="annot"><span class="annottext">dartData :: (Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e' f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#dartData"><span class="hs-identifier hs-var hs-var">dartData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; Vector (Dart s, e))
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (Dart s, e') -&gt; PlanarSubdivision s v e' f r)
-&gt; Lens
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v e' f r)
     (Vector (Dart s, e))
     (Vector (Dart s, e'))
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Dart s, e)
forall k (s :: k) v b f r.
PlanarSubdivision s v b f r -&gt; Vector (Dart s, b)
</span><a href="#local-6989586621680051944"><span class="hs-identifier hs-var">getF</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (Dart s, e') -&gt; PlanarSubdivision s v e' f r
forall k (t :: * -&gt; *) a (s :: k) v a f r e.
(Foldable t, Enum a) =&gt;
PlanarSubdivision s v a f r
-&gt; t (a, e) -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051943"><span class="hs-identifier hs-var">setF</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621680051944"><span class="annot"><span class="annottext">getF :: PlanarSubdivision s v b f r -&gt; Vector (Dart s, b)
</span><a href="#local-6989586621680051944"><span class="hs-identifier hs-var hs-var">getF</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Raw s (Dart (Wrap s)) b -&gt; (Dart s, b))
-&gt; Vector (Raw s (Dart (Wrap s)) b) -&gt; Vector (Dart s, b)
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051942"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051942"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051941"><span class="annot"><span class="annottext">Raw s (Dart (Wrap s)) b
</span><a href="#local-6989586621680051941"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Dart s
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051942"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Raw s (Dart (Wrap s)) b
</span><a href="#local-6989586621680051941"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Raw s (Dart (Wrap s)) b
-&gt; Getting b (Raw s (Dart (Wrap s)) b) b -&gt; b
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting b (Raw s (Dart (Wrap s)) b) b
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) b) -&gt; Vector (Dart s, b))
-&gt; (PlanarSubdivision s v b f r
    -&gt; Vector (Raw s (Dart (Wrap s)) b))
-&gt; PlanarSubdivision s v b f r
-&gt; Vector (Dart s, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v b f r -&gt; Vector (Raw s (Dart (Wrap s)) b)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Raw s (Dart (Wrap s)) e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawDartData"><span class="hs-identifier hs-var hs-var">_rawDartData</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621680051943"><span class="annot"><span class="annottext">setF :: PlanarSubdivision s v a f r
-&gt; t (a, e) -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051943"><span class="hs-identifier hs-var hs-var">setF</span></a></span></span><span> </span><span id="local-6989586621680051939"><span class="annot"><span class="annottext">PlanarSubdivision s v a f r
</span><a href="#local-6989586621680051939"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680051938"><span class="annot"><span class="annottext">t (a, e)
</span><a href="#local-6989586621680051938"><span class="hs-identifier hs-var">ds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v a f r
</span><a href="#local-6989586621680051939"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v a f r
-&gt; (PlanarSubdivision s v a f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) a)
 -&gt; Identity (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; PlanarSubdivision s v a f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r e.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Raw s (Dart (Wrap s)) a)
  -&gt; Identity (Vector (Raw s (Dart (Wrap s)) e)))
 -&gt; PlanarSubdivision s v a f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Raw s (Dart (Wrap s)) a)
    -&gt; Vector (Raw s (Dart (Wrap s)) e))
-&gt; PlanarSubdivision s v a f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">t (a, e)
-&gt; Vector (Raw s (Dart (Wrap s)) a)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall k (t :: * -&gt; *) a b (s :: k) ia a.
(Foldable t, Enum a) =&gt;
t (a, b) -&gt; Vector (Raw s ia a) -&gt; Vector (Raw s ia b)
</span><a href="#local-6989586621680051937"><span class="hs-identifier hs-var">mkDS'</span></a></span><span> </span><span class="annot"><span class="annottext">t (a, e)
</span><a href="#local-6989586621680051938"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- create a new dartData vector to assign the values to</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621680051937"><span class="annot"><span class="annottext">mkDS' :: t (a, b) -&gt; Vector (Raw s ia a) -&gt; Vector (Raw s ia b)
</span><a href="#local-6989586621680051937"><span class="hs-identifier hs-var hs-var">mkDS'</span></a></span></span><span> </span><span id="local-6989586621680051936"><span class="annot"><span class="annottext">t (a, b)
</span><a href="#local-6989586621680051936"><span class="hs-identifier hs-var">ds'</span></a></span></span><span> </span><span id="local-6989586621680051935"><span class="annot"><span class="annottext">Vector (Raw s ia a)
</span><a href="#local-6989586621680051935"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s (Raw s ia b))) -&gt; Vector (Raw s ia b)
forall a. (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s (Raw s ia b))) -&gt; Vector (Raw s ia b))
-&gt; (forall s. ST s (MVector s (Raw s ia b))) -&gt; Vector (Raw s ia b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>                     </span><span id="local-6989586621680051933"><span class="annot"><span class="annottext">MVector s (Raw s ia b)
</span><a href="#local-6989586621680051933"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) (Raw s ia b))
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.new</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Raw s ia a) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s ia a)
</span><a href="#local-6989586621680051935"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                     </span><span class="annot"><span class="annottext">((a, b) -&gt; ST s ()) -&gt; t (a, b) -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Raw s ia a)
-&gt; MVector (PrimState (ST s)) (Raw s ia b) -&gt; (a, b) -&gt; ST s ()
forall k a (m :: * -&gt; *) (s :: k) ia a b.
(Enum a, PrimMonad m) =&gt;
Vector (Raw s ia a)
-&gt; MVector (PrimState m) (Raw s ia b) -&gt; (a, b) -&gt; m ()
</span><a href="#local-6989586621680051930"><span class="hs-identifier hs-var">assignDart</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s ia a)
</span><a href="#local-6989586621680051935"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s (Raw s ia b)
MVector (PrimState (ST s)) (Raw s ia b)
</span><a href="#local-6989586621680051933"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (a, b)
</span><a href="#local-6989586621680051936"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-380"></span><span>                     </span><span class="annot"><span class="annottext">MVector s (Raw s ia b) -&gt; ST s (MVector s (Raw s ia b))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">MVector s (Raw s ia b)
</span><a href="#local-6989586621680051933"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621680051930"><span class="annot"><span class="annottext">assignDart :: Vector (Raw s ia a)
-&gt; MVector (PrimState m) (Raw s ia b) -&gt; (a, b) -&gt; m ()
</span><a href="#local-6989586621680051930"><span class="hs-identifier hs-var hs-var">assignDart</span></a></span></span><span> </span><span id="local-6989586621680051929"><span class="annot"><span class="annottext">Vector (Raw s ia a)
</span><a href="#local-6989586621680051929"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621680051928"><span class="annot"><span class="annottext">MVector (PrimState m) (Raw s ia b)
</span><a href="#local-6989586621680051928"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680051927"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051926"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680051926"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680051925"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621680051925"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680051927"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-383"></span><span>                                </span><span id="local-6989586621680051923"><span class="annot"><span class="annottext">y :: Raw s ia a
</span><a href="#local-6989586621680051923"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Raw s ia a)
</span><a href="#local-6989586621680051929"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s ia a) -&gt; Int -&gt; Raw s ia a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051925"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-384"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) (Raw s ia b) -&gt; Int -&gt; Raw s ia b -&gt; m ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) (Raw s ia b)
</span><a href="#local-6989586621680051928"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051925"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Raw s ia a
</span><a href="#local-6989586621680051923"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Raw s ia a -&gt; (Raw s ia a -&gt; Raw s ia b) -&gt; Raw s ia b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(a -&gt; Identity b) -&gt; Raw s ia a -&gt; Identity (Raw s ia b)
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Identity b) -&gt; Raw s ia a -&gt; Identity (Raw s ia b))
-&gt; b -&gt; Raw s ia a -&gt; Raw s ia b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680051926"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Lens to the facedata of the faces themselves. The indices correspond to the faceIds</span><span>
</span><span id="line-388"></span><span id="local-6989586621680051915"><span id="local-6989586621680051916"><span id="local-6989586621680051917"><span id="local-6989586621680051918"><span id="local-6989586621680051919"><span id="local-6989586621680051920"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceData"><span class="hs-identifier hs-type">faceData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051920"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051919"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051918"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051917"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051916"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051920"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051919"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051918"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051915"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051916"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680051917"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680051915"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-390"></span><span id="faceData"><span class="annot"><span class="annottext">faceData :: (Vector f -&gt; f (Vector f'))
-&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f' r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceData"><span class="hs-identifier hs-var hs-var">faceData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; Vector f)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector f' -&gt; PlanarSubdivision s v e f' r)
-&gt; Lens
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v e f' r)
     (Vector f)
     (Vector f')
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector f
forall k (s :: k) v e f1 r.
PlanarSubdivision s v e f1 r -&gt; Vector f1
</span><a href="#local-6989586621680051914"><span class="hs-identifier hs-var">getF</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector f' -&gt; PlanarSubdivision s v e f' r
forall k (s :: k) v e f1 r f.
PlanarSubdivision s v e f1 r
-&gt; Vector f -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051913"><span class="hs-identifier hs-var">setF</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621680051914"><span class="annot"><span class="annottext">getF :: PlanarSubdivision s v e f1 r -&gt; Vector f1
</span><a href="#local-6989586621680051914"><span class="hs-identifier hs-var hs-var">getF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RawFace s f1 -&gt; f1) -&gt; Vector (RawFace s f1) -&gt; Vector f1
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawFace s f1 -&gt; Getting f1 (RawFace s f1) f1 -&gt; f1
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f1 -&gt; Const f1 (FaceData (Dart s) f1))
-&gt; RawFace s f1 -&gt; Const f1 (RawFace s f1)
forall k (s :: k) f1 f2.
Lens
  (RawFace s f1)
  (RawFace s f2)
  (FaceData (Dart s) f1)
  (FaceData (Dart s) f2)
</span><a href="Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span class="annot"><span class="annottext">((FaceData (Dart s) f1 -&gt; Const f1 (FaceData (Dart s) f1))
 -&gt; RawFace s f1 -&gt; Const f1 (RawFace s f1))
-&gt; ((f1 -&gt; Const f1 f1)
    -&gt; FaceData (Dart s) f1 -&gt; Const f1 (FaceData (Dart s) f1))
-&gt; Getting f1 (RawFace s f1) f1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(f1 -&gt; Const f1 f1)
-&gt; FaceData (Dart s) f1 -&gt; Const f1 (FaceData (Dart s) f1)
forall h f1 f2. Lens (FaceData h f1) (FaceData h f2) f1 f2
</span><a href="Geometry.PlanarSubdivision.Raw.html#fData"><span class="hs-identifier hs-var">fData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (RawFace s f1) -&gt; Vector f1)
-&gt; (PlanarSubdivision s v e f1 r -&gt; Vector (RawFace s f1))
-&gt; PlanarSubdivision s v e f1 r
-&gt; Vector f1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f1 r -&gt; Vector (RawFace s f1)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (RawFace s f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawFaceData"><span class="hs-identifier hs-var hs-var">_rawFaceData</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621680051913"><span class="annot"><span class="annottext">setF :: PlanarSubdivision s v e f1 r
-&gt; Vector f -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051913"><span class="hs-identifier hs-var hs-var">setF</span></a></span></span><span> </span><span id="local-6989586621680051911"><span class="annot"><span class="annottext">PlanarSubdivision s v e f1 r
</span><a href="#local-6989586621680051911"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680051910"><span class="annot"><span class="annottext">Vector f
</span><a href="#local-6989586621680051910"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f1 r
</span><a href="#local-6989586621680051911"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f1 r
-&gt; (PlanarSubdivision s v e f1 r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f1) -&gt; Identity (Vector (RawFace s f)))
-&gt; PlanarSubdivision s v e f1 r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r f.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
  (Vector (RawFace s f))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (RawFace s f1) -&gt; Identity (Vector (RawFace s f)))
 -&gt; PlanarSubdivision s v e f1 r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (RawFace s f1) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f1 r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(f -&gt; RawFace s f1 -&gt; RawFace s f)
-&gt; Vector f -&gt; Vector (RawFace s f1) -&gt; Vector (RawFace s f)
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051909"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051909"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621680051908"><span class="annot"><span class="annottext">RawFace s f1
</span><a href="#local-6989586621680051908"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RawFace s f1
</span><a href="#local-6989586621680051908"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">RawFace s f1 -&gt; (RawFace s f1 -&gt; RawFace s f) -&gt; RawFace s f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f1 -&gt; Identity (FaceData (Dart s) f))
-&gt; RawFace s f1 -&gt; Identity (RawFace s f)
forall k (s :: k) f1 f2.
Lens
  (RawFace s f1)
  (RawFace s f2)
  (FaceData (Dart s) f1)
  (FaceData (Dart s) f2)
</span><a href="Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span class="annot"><span class="annottext">((FaceData (Dart s) f1 -&gt; Identity (FaceData (Dart s) f))
 -&gt; RawFace s f1 -&gt; Identity (RawFace s f))
-&gt; ((f1 -&gt; Identity f)
    -&gt; FaceData (Dart s) f1 -&gt; Identity (FaceData (Dart s) f))
-&gt; (f1 -&gt; Identity f)
-&gt; RawFace s f1
-&gt; Identity (RawFace s f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(f1 -&gt; Identity f)
-&gt; FaceData (Dart s) f1 -&gt; Identity (FaceData (Dart s) f)
forall h f1 f2. Lens (FaceData h f1) (FaceData h f2) f1 f2
</span><a href="Geometry.PlanarSubdivision.Raw.html#fData"><span class="hs-identifier hs-var">fData</span></a></span><span> </span><span class="annot"><span class="annottext">((f1 -&gt; Identity f) -&gt; RawFace s f1 -&gt; Identity (RawFace s f))
-&gt; f -&gt; RawFace s f1 -&gt; RawFace s f
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051909"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector f
</span><a href="#local-6989586621680051910"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Lens to the facedata of the vertexdata themselves. The indices correspond to the vertexId's</span><span>
</span><span id="line-396"></span><span id="local-6989586621680051902"><span id="local-6989586621680051903"><span id="local-6989586621680051904"><span id="local-6989586621680051905"><span id="local-6989586621680051906"><span id="local-6989586621680051907"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertexData"><span class="hs-identifier hs-type">vertexData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051907"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051906"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051905"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051904"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051903"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051907"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051902"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051905"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051904"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051903"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680051906"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680051902"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-398"></span><span id="vertexData"><span class="annot"><span class="annottext">vertexData :: (Vector v -&gt; f (Vector v'))
-&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v' e f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexData"><span class="hs-identifier hs-var hs-var">vertexData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; Vector v)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector v' -&gt; PlanarSubdivision s v' e f r)
-&gt; Lens
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v' e f r)
     (Vector v)
     (Vector v')
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector v
forall k (s :: k) a e f r. PlanarSubdivision s a e f r -&gt; Vector a
</span><a href="#local-6989586621680051901"><span class="hs-identifier hs-var">getF</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector v' -&gt; PlanarSubdivision s v' e f r
forall k (s :: k) a e f r v.
PlanarSubdivision s a e f r
-&gt; Vector v -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051900"><span class="hs-identifier hs-var">setF</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621680051901"><span class="annot"><span class="annottext">getF :: PlanarSubdivision s a e f r -&gt; Vector a
</span><a href="#local-6989586621680051901"><span class="hs-identifier hs-var hs-var">getF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Raw s (VertexId' (Wrap s)) a -&gt; a)
-&gt; Vector (Raw s (VertexId' (Wrap s)) a) -&gt; Vector a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Raw s (VertexId' (Wrap s)) a
-&gt; Getting a (Raw s (VertexId' (Wrap s)) a) a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting a (Raw s (VertexId' (Wrap s)) a) a
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) a) -&gt; Vector a)
-&gt; (PlanarSubdivision s a e f r
    -&gt; Vector (Raw s (VertexId' (Wrap s)) a))
-&gt; PlanarSubdivision s a e f r
-&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s a e f r
-&gt; Vector (Raw s (VertexId' (Wrap s)) a)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#_rawVertexData"><span class="hs-identifier hs-var hs-var">_rawVertexData</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621680051900"><span class="annot"><span class="annottext">setF :: PlanarSubdivision s a e f r
-&gt; Vector v -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051900"><span class="hs-identifier hs-var hs-var">setF</span></a></span></span><span> </span><span id="local-6989586621680051899"><span class="annot"><span class="annottext">PlanarSubdivision s a e f r
</span><a href="#local-6989586621680051899"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680051898"><span class="annot"><span class="annottext">Vector v
</span><a href="#local-6989586621680051898"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s a e f r
</span><a href="#local-6989586621680051899"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s a e f r
-&gt; (PlanarSubdivision s a e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) a)
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s a e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) a)
  -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s a e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; (Vector (Raw s (VertexId' (Wrap s)) a)
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; PlanarSubdivision s a e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; Raw s (VertexId' (Wrap s)) a -&gt; Raw s (VertexId' (Wrap s)) v)
-&gt; Vector v
-&gt; Vector (Raw s (VertexId' (Wrap s)) a)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051897"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051897"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621680051896"><span class="annot"><span class="annottext">Raw s (VertexId' (Wrap s)) a
</span><a href="#local-6989586621680051896"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Raw s (VertexId' (Wrap s)) a
</span><a href="#local-6989586621680051896"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Raw s (VertexId' (Wrap s)) a
-&gt; (Raw s (VertexId' (Wrap s)) a -&gt; Raw s (VertexId' (Wrap s)) v)
-&gt; Raw s (VertexId' (Wrap s)) v
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(a -&gt; Identity v)
-&gt; Raw s (VertexId' (Wrap s)) a
-&gt; Identity (Raw s (VertexId' (Wrap s)) v)
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Identity v)
 -&gt; Raw s (VertexId' (Wrap s)) a
 -&gt; Identity (Raw s (VertexId' (Wrap s)) v))
-&gt; v
-&gt; Raw s (VertexId' (Wrap s)) a
-&gt; Raw s (VertexId' (Wrap s)) v
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051897"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector v
</span><a href="#local-6989586621680051898"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | The tail of a dart, i.e. the vertex this dart is leaving from</span><span>
</span><span id="line-405"></span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-407"></span><span id="local-6989586621680052939"><span id="local-6989586621680052940"><span id="local-6989586621680052941"><span id="local-6989586621680052942"><span id="local-6989586621680052943"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-type">tailOf</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052943"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052943"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052942"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052941"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052940"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052939"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052943"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-408"></span><span id="tailOf"><span class="annot"><span class="annottext">tailOf :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var hs-var">tailOf</span></a></span></span><span> </span><span id="local-6989586621680051895"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051895"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051894"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051894"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051893"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051893"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051892"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051892"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051895"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051894"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-409"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051892"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (VertexId' s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (VertexId' s)
-&gt; VertexId' s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (VertexId' (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; VertexId' (Wrap s)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-var">PG.tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051893"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051892"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- | The vertex this dart is heading in to</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-415"></span><span id="local-6989586621680051886"><span id="local-6989586621680051887"><span id="local-6989586621680051888"><span id="local-6989586621680051889"><span id="local-6989586621680051890"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-type">headOf</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051890"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051890"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051889"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051888"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051887"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051886"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051890"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-416"></span><span id="headOf"><span class="annot"><span class="annottext">headOf :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var hs-var">headOf</span></a></span></span><span> </span><span id="local-6989586621680051885"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051885"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051884"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051884"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051883"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051883"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051882"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051882"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051885"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051884"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-417"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051882"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (VertexId' s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (VertexId' s)
-&gt; VertexId' s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (VertexId' (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; VertexId' (Wrap s)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-var">PG.headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051883"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051882"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | endPoints d g = (tailOf d g, headOf d g)</span><span>
</span><span id="line-421"></span><span class="hs-comment">--</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-423"></span><span id="local-6989586621680052550"><span id="local-6989586621680052551"><span id="local-6989586621680052552"><span id="local-6989586621680052553"><span id="local-6989586621680052554"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPoints"><span class="hs-identifier hs-type">endPoints</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052552"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052551"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052550"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-424"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-425"></span><span id="endPoints"><span class="annot"><span class="annottext">endPoints :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; (VertexId' s, VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPoints"><span class="hs-identifier hs-var hs-var">endPoints</span></a></span></span><span> </span><span id="local-6989586621680051880"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051880"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051879"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051879"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051880"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051879"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051880"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051879"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | All edges incident to vertex v, in counterclockwise order around v.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the number of edges reported.</span><span>
</span><span id="line-431"></span><span id="local-6989586621680052879"><span id="local-6989586621680052880"><span id="local-6989586621680052881"><span id="local-6989586621680052882"><span id="local-6989586621680052883"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-type">incidentEdges</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052883"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052883"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052882"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052881"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052879"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-432"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052883"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-433"></span><span id="incidentEdges"><span class="annot"><span class="annottext">incidentEdges :: VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var hs-var">incidentEdges</span></a></span></span><span> </span><span id="local-6989586621680051878"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051878"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680051877"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051877"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051876"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051876"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051875"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051875"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var">asLocalV</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051878"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051877"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-434"></span><span>                         </span><span id="local-6989586621680051874"><span class="annot"><span class="annottext">ds :: Vector (Dart (Wrap s))
</span><a href="#local-6989586621680051874"><span class="hs-identifier hs-var hs-var">ds</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Vector (Dart (Wrap s))
forall k (s :: k) v e f r.
VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-var">PG.incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051876"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051875"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-435"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051872"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051872"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051875"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051872"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart (Wrap s) -&gt; Dart s)
-&gt; Vector (Dart (Wrap s)) -&gt; Vector (Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart (Wrap s))
</span><a href="#local-6989586621680051874"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the next dart in the</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-440"></span><span class="hs-comment">--</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-442"></span><span id="local-6989586621680051867"><span id="local-6989586621680051868"><span id="local-6989586621680051869"><span id="local-6989586621680051870"><span id="local-6989586621680051871"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdge"><span class="hs-identifier hs-type">nextIncidentEdge</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051871"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051871"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051870"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051869"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051868"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051867"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051871"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-443"></span><span id="nextIncidentEdge"><span class="annot"><span class="annottext">nextIncidentEdge :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdge"><span class="hs-identifier hs-var hs-var">nextIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621680051866"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051866"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051865"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051865"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051864"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051864"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051863"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051863"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051866"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051865"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-444"></span><span>                            </span><span id="local-6989586621680051862"><span class="annot"><span class="annottext">d'' :: Dart (Wrap s)
</span><a href="#local-6989586621680051862"><span class="hs-identifier hs-var hs-var">d''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Dart (Wrap s)
forall k (s :: k) v e f r. Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier hs-var">PG.nextIncidentEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051864"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051863"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-445"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051863"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051862"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- previous dart in the cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-451"></span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- Dart (Arc 3) +1</span><span>
</span><span id="line-454"></span><span id="local-6989586621680051856"><span id="local-6989586621680051857"><span id="local-6989586621680051858"><span id="local-6989586621680051859"><span id="local-6989586621680051860"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdge"><span class="hs-identifier hs-type">prevIncidentEdge</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051860"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051860"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051859"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051858"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051856"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051860"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-455"></span><span id="prevIncidentEdge"><span class="annot"><span class="annottext">prevIncidentEdge :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdge"><span class="hs-identifier hs-var hs-var">prevIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621680051855"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051855"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051854"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051854"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051853"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051853"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051852"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051852"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051855"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051854"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-456"></span><span>                            </span><span id="local-6989586621680051851"><span class="annot"><span class="annottext">d'' :: Dart (Wrap s)
</span><a href="#local-6989586621680051851"><span class="hs-identifier hs-var hs-var">d''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Dart (Wrap s)
forall k (s :: k) v e f r. Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier hs-var">PG.prevIncidentEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051853"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051852"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-457"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051852"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051851"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | Given a dart d that points away from some vertex v, report the</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- next dart in the cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-461"></span><span class="hs-comment">--</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-464"></span><span class="hs-comment">--</span><span>
</span><span id="line-465"></span><span id="local-6989586621680051845"><span id="local-6989586621680051846"><span id="local-6989586621680051847"><span id="local-6989586621680051848"><span id="local-6989586621680051849"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdgeFrom"><span class="hs-identifier hs-type">nextIncidentEdgeFrom</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051849"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051849"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051848"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051847"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051846"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051849"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-466"></span><span id="nextIncidentEdgeFrom"><span class="annot"><span class="annottext">nextIncidentEdgeFrom :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Basic.html#nextIncidentEdgeFrom"><span class="hs-identifier hs-var hs-var">nextIncidentEdgeFrom</span></a></span></span><span> </span><span id="local-6989586621680051844"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051844"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051843"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051843"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051842"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051842"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051841"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051841"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051844"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051843"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-467"></span><span>                                </span><span id="local-6989586621680051840"><span class="annot"><span class="annottext">d'' :: Dart (Wrap s)
</span><a href="#local-6989586621680051840"><span class="hs-identifier hs-var hs-var">d''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Dart (Wrap s)
forall k (s :: k) v e f r. Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextIncidentEdgeFrom"><span class="hs-identifier hs-var">PG.nextIncidentEdgeFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051842"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051841"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-468"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051841"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051840"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Given a dart d that points into away from vertex v, report the previous dart in the</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-472"></span><span class="hs-comment">--</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-474"></span><span class="hs-comment">--</span><span>
</span><span id="line-475"></span><span id="local-6989586621680051834"><span id="local-6989586621680051835"><span id="local-6989586621680051836"><span id="local-6989586621680051837"><span id="local-6989586621680051838"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdgeFrom"><span class="hs-identifier hs-type">prevIncidentEdgeFrom</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051838"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051838"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051837"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051836"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051835"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051834"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051838"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-476"></span><span id="prevIncidentEdgeFrom"><span class="annot"><span class="annottext">prevIncidentEdgeFrom :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; Dart s
</span><a href="Geometry.PlanarSubdivision.Basic.html#prevIncidentEdgeFrom"><span class="hs-identifier hs-var hs-var">prevIncidentEdgeFrom</span></a></span></span><span> </span><span id="local-6989586621680051833"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051833"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051832"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051832"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051831"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051831"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051830"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051830"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051833"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051832"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-477"></span><span>                                </span><span id="local-6989586621680051829"><span class="annot"><span class="annottext">d'' :: Dart (Wrap s)
</span><a href="#local-6989586621680051829"><span class="hs-identifier hs-var hs-var">d''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Dart (Wrap s)
forall k (s :: k) v e f r. Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevIncidentEdgeFrom"><span class="hs-identifier hs-var">PG.prevIncidentEdgeFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051831"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051830"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-478"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051830"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051829"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">-- | All edges incident to vertex v in incoming direction</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- (i.e. pointing into v) in counterclockwise order around v.</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-485"></span><span id="local-6989586621680051823"><span id="local-6989586621680051824"><span id="local-6989586621680051825"><span id="local-6989586621680051826"><span id="local-6989586621680051827"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incomingEdges"><span class="hs-identifier hs-type">incomingEdges</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051827"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051827"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051826"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051825"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051824"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051823"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051827"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-486"></span><span id="incomingEdges"><span class="annot"><span class="annottext">incomingEdges :: VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incomingEdges"><span class="hs-identifier hs-var hs-var">incomingEdges</span></a></span></span><span> </span><span id="local-6989586621680051822"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051822"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680051821"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051821"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
</span><a href="#local-6989586621680051820"><span class="hs-identifier hs-var">orient</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s) -&gt; Vector (Dart s) -&gt; Vector (Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051822"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051821"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621680051820"><span class="annot"><span class="annottext">orient :: Dart s -&gt; Dart s
</span><a href="#local-6989586621680051820"><span class="hs-identifier hs-var hs-var">orient</span></a></span></span><span> </span><span id="local-6989586621680051819"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051819"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051819"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051821"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051822"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051819"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051819"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | All edges incident to vertex v in outgoing direction</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- (i.e. pointing away from v) in counterclockwise order around v.</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-494"></span><span id="local-6989586621680051814"><span id="local-6989586621680051815"><span id="local-6989586621680051816"><span id="local-6989586621680051817"><span id="local-6989586621680051818"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outgoingEdges"><span class="hs-identifier hs-type">outgoingEdges</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051818"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051818"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051817"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051816"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051814"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051818"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-495"></span><span id="outgoingEdges"><span class="annot"><span class="annottext">outgoingEdges :: VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outgoingEdges"><span class="hs-identifier hs-var hs-var">outgoingEdges</span></a></span></span><span> </span><span id="local-6989586621680051813"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051813"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680051812"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051812"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
</span><a href="#local-6989586621680051811"><span class="hs-identifier hs-var">orient</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s) -&gt; Vector (Dart s) -&gt; Vector (Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051813"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051812"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621680051811"><span class="annot"><span class="annottext">orient :: Dart s -&gt; Dart s
</span><a href="#local-6989586621680051811"><span class="hs-identifier hs-var hs-var">orient</span></a></span></span><span> </span><span id="local-6989586621680051810"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051810"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051810"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051812"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; VertexId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051813"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051810"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051810"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- | Gets the neighbours of a particular vertex, in counterclockwise order</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- around the vertex.</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size</span><span>
</span><span id="line-504"></span><span id="local-6989586621680051805"><span id="local-6989586621680051806"><span id="local-6989586621680051807"><span id="local-6989586621680051808"><span id="local-6989586621680051809"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#neighboursOf"><span class="hs-identifier hs-type">neighboursOf</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051808"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051807"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051806"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051805"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051809"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-505"></span><span id="neighboursOf"><span class="annot"><span class="annottext">neighboursOf :: VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#neighboursOf"><span class="hs-identifier hs-var hs-var">neighboursOf</span></a></span></span><span> </span><span id="local-6989586621680051804"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051804"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680051803"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051803"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s)
-&gt; PlanarSubdivision s v e f r -&gt; Dart s -&gt; VertexId' s
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051803"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; VertexId' s) -&gt; Vector (Dart s) -&gt; Vector (VertexId' s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incomingEdges"><span class="hs-identifier hs-var">incomingEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051803"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- | The face to the left of the dart</span><span>
</span><span id="line-508"></span><span class="hs-comment">--</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-510"></span><span id="local-6989586621680052449"><span id="local-6989586621680052450"><span id="local-6989586621680052451"><span id="local-6989586621680052452"><span id="local-6989586621680052453"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-type">leftFace</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052453"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052453"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052452"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052451"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052450"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052449"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052453"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-511"></span><span id="leftFace"><span class="annot"><span class="annottext">leftFace :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var hs-var">leftFace</span></a></span></span><span> </span><span id="local-6989586621680051801"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051801"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051800"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051800"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051799"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051799"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051798"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051798"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051801"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051800"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-512"></span><span>                    </span><span id="local-6989586621680051797"><span class="annot"><span class="annottext">fi :: FaceId' (Wrap s)
</span><a href="#local-6989586621680051797"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; FaceId' (Wrap s)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var">PG.leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051799"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051798"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-513"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051798"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (FaceId' s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (FaceId' s)
-&gt; FaceId' s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (FaceId' (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680051797"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | The face to the right of the dart</span><span>
</span><span id="line-516"></span><span class="hs-comment">--</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-518"></span><span id="local-6989586621680051792"><span id="local-6989586621680051793"><span id="local-6989586621680051794"><span id="local-6989586621680051795"><span id="local-6989586621680051796"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#rightFace"><span class="hs-identifier hs-type">rightFace</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051795"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051794"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051793"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051792"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051796"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-519"></span><span id="rightFace"><span class="annot"><span class="annottext">rightFace :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#rightFace"><span class="hs-identifier hs-var hs-var">rightFace</span></a></span></span><span> </span><span id="local-6989586621680051791"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051791"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051790"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051790"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051789"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051789"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051788"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051788"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051791"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051790"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-520"></span><span>                     </span><span id="local-6989586621680051787"><span class="annot"><span class="annottext">fi :: FaceId' (Wrap s)
</span><a href="#local-6989586621680051787"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; FaceId' (Wrap s)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier hs-var">PG.rightFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051789"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051788"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-521"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051788"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (FaceId' s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (FaceId' s)
-&gt; FaceId' s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (FaceId' (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680051787"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | The darts on the outer boundary of this face. The darts are</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- reported in order along the face. This means that for internal</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- faces the darts are reported in *clockwise* order along the</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- boundary, whereas for the outer face the darts are reported in</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- counter clockwise order.</span><span>
</span><span id="line-528"></span><span class="hs-comment">--</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-530"></span><span id="local-6989586621680052791"><span id="local-6989586621680052792"><span id="local-6989586621680052793"><span id="local-6989586621680052794"><span id="local-6989586621680052795"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-type">outerBoundaryDarts</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052795"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052795"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052794"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052793"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052792"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052791"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052795"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-531"></span><span id="outerBoundaryDarts"><span class="annot"><span class="annottext">outerBoundaryDarts :: FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-var hs-var">outerBoundaryDarts</span></a></span></span><span> </span><span id="local-6989586621680051785"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051785"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680051784"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051784"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ComponentId s, FaceId' (Wrap s),
  PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; Vector (Dart s))
-&gt; Vector
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Dart s)
forall a b. (a -&gt; Vector b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.concatMap</span></span><span> </span><span class="annot"><span class="annottext">(ComponentId s, FaceId' (Wrap s),
 PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Dart s)
forall k a (s :: k) v e f r.
(a, FaceId' s, PlaneGraph s v e f r) -&gt; Vector e
</span><a href="#local-6989586621680051782"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector
   (ComponentId s, FaceId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; Vector (Dart s))
-&gt; (NonEmpty
      (ComponentId s, FaceId' (Wrap s),
       PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
    -&gt; Vector
         (ComponentId s, FaceId' (Wrap s),
          PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; NonEmpty
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(ComponentId s, FaceId' (Wrap s),
  PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)]
-&gt; Vector
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(ComponentId s, FaceId' (Wrap s),
   PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)]
 -&gt; Vector
      (ComponentId s, FaceId' (Wrap s),
       PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r))
-&gt; (NonEmpty
      (ComponentId s, FaceId' (Wrap s),
       PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
    -&gt; [(ComponentId s, FaceId' (Wrap s),
         PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)])
-&gt; NonEmpty
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty
  (ComponentId s, FaceId' (Wrap s),
   PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; [(ComponentId s, FaceId' (Wrap s),
     PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty
   (ComponentId s, FaceId' (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
 -&gt; Vector (Dart s))
-&gt; NonEmpty
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
-&gt; Vector (Dart s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; NonEmpty
     (ComponentId s, FaceId' (Wrap s),
      PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; NonEmpty (ComponentId s, FaceId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalF"><span class="hs-identifier hs-var">asLocalF</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051785"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051784"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621680051782"><span class="annot"><span class="annottext">single :: (a, FaceId' s, PlaneGraph s v e f r) -&gt; Vector e
</span><a href="#local-6989586621680051782"><span class="hs-identifier hs-var hs-var">single</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051780"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051780"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051779"><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680051779"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051778"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051778"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680051779"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting e (PlaneGraph s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051778"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; e) -&gt; Vector (Dart s) -&gt; Vector e
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier hs-var">PG.boundary</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051780"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680051779"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | Get the local face and component from a given face.</span><span>
</span><span id="line-537"></span><span id="local-6989586621680052828"><span id="local-6989586621680052829"><span id="local-6989586621680052830"><span id="local-6989586621680052831"><span id="local-6989586621680052832"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalF"><span class="hs-identifier hs-type">asLocalF</span></a></span><span>                          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052832"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052832"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052831"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052830"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052829"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052828"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-538"></span><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052832"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052832"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052832"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052828"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-539"></span><span id="asLocalF"><span class="annot"><span class="annottext">asLocalF :: FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; NonEmpty (ComponentId s, FaceId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalF"><span class="hs-identifier hs-var hs-var">asLocalF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621680051776"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051776"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680051775"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051775"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051775"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (RawFace s f)) (PlanarSubdivision s v e f r) (RawFace s f)
-&gt; RawFace s f
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f)
 -&gt; Const (Endo (RawFace s f)) (Vector (RawFace s f)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const (Endo (RawFace s f)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r f.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
  (Vector (RawFace s f))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span class="annot"><span class="annottext">((Vector (RawFace s f)
  -&gt; Const (Endo (RawFace s f)) (Vector (RawFace s f)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const (Endo (RawFace s f)) (PlanarSubdivision s v e f r))
-&gt; ((RawFace s f -&gt; Const (Endo (RawFace s f)) (RawFace s f))
    -&gt; Vector (RawFace s f)
    -&gt; Const (Endo (RawFace s f)) (Vector (RawFace s f)))
-&gt; Getting
     (Endo (RawFace s f)) (PlanarSubdivision s v e f r) (RawFace s f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (RawFace s f))
-&gt; Traversal'
     (Vector (RawFace s f)) (IxValue (Vector (RawFace s f)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (RawFace s f))
</span><a href="#local-6989586621680051776"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051773"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051773"><span class="hs-identifier hs-var">ci</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051772"><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680051772"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051773"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621680051772"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051775"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Component s r) (PlanarSubdivision s v e f r) (Component s r)
-&gt; Component s r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051773"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ComponentId s, FaceId' (Wrap s), Component s r)
-&gt; [(ComponentId s, FaceId' (Wrap s), Component s r)]
-&gt; NonEmpty (ComponentId s, FaceId' (Wrap s), Component s r)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621680051770"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621680051770"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; (ComponentId s, FaceId' (Wrap s), Component s r)
</span><a href="#local-6989586621680051769"><span class="hs-identifier hs-var">toLocalF</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; (ComponentId s, FaceId' (Wrap s), Component s r))
-&gt; NonEmpty (Dart s)
-&gt; NonEmpty (ComponentId s, FaceId' (Wrap s), Component s r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Dart s] -&gt; NonEmpty (Dart s)
forall a. [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; [Dart s]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621680051770"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621680051769"><span class="annot"><span class="annottext">toLocalF :: Dart s -&gt; (ComponentId s, FaceId' (Wrap s), Component s r)
</span><a href="#local-6989586621680051769"><span class="hs-identifier hs-var hs-var">toLocalF</span></a></span></span><span> </span><span id="local-6989586621680051766"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051766"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051765"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051765"><span class="hs-identifier hs-var">ci</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051764"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051764"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051763"><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621680051763"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051766"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051775"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051765"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dart (Wrap s) -&gt; Component s r -&gt; FaceId' (Wrap s)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var">PG.leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051764"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621680051763"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621680051763"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-comment">-- | The vertices of the outer boundary of the face, for internal</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- faces in clockwise order, for the outer face in counter clockwise</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- order.</span><span>
</span><span id="line-548"></span><span class="hs-comment">--</span><span>
</span><span id="line-549"></span><span class="hs-comment">--</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-551"></span><span id="local-6989586621680052297"><span id="local-6989586621680052298"><span id="local-6989586621680052299"><span id="local-6989586621680052300"><span id="local-6989586621680052301"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#boundaryVertices"><span class="hs-identifier hs-type">boundaryVertices</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052301"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052301"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052299"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052298"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052297"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-552"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052301"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-553"></span><span id="boundaryVertices"><span class="annot"><span class="annottext">boundaryVertices :: FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#boundaryVertices"><span class="hs-identifier hs-var hs-var">boundaryVertices</span></a></span></span><span> </span><span id="local-6989586621680051762"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051762"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680051761"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051761"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-operator hs-var">`headOf`</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051761"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; VertexId' s) -&gt; Vector (Dart s) -&gt; Vector (VertexId' s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-var">outerBoundaryDarts</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051762"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051761"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">-- | Lists the holes in this face, given as a list of darts to arbitrary darts</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- on those faces. The returned darts are on the outside of the hole, i.e. they are</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- incident to the given input face:</span><span>
</span><span id="line-559"></span><span class="hs-comment">--</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- prop&gt; all (\d -&gt; leftFace d ps == fi) $ holesOf fi ps</span><span>
</span><span id="line-561"></span><span class="hs-comment">--</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the number of darts returned.</span><span>
</span><span id="line-563"></span><span id="local-6989586621680052464"><span id="local-6989586621680052465"><span id="local-6989586621680052466"><span id="local-6989586621680052467"><span id="local-6989586621680052468"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#holesOf"><span class="hs-identifier hs-type">holesOf</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052468"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052468"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052467"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052466"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052465"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052464"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052468"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-564"></span><span id="holesOf"><span class="annot"><span class="annottext">holesOf :: FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Seq (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#holesOf"><span class="hs-identifier hs-var hs-var">holesOf</span></a></span></span><span> </span><span id="local-6989586621680051760"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051760"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span id="local-6989586621680051759"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051759"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051759"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Seq (Dart s)) (PlanarSubdivision s v e f r) (Seq (Dart s))
-&gt; Seq (Dart s)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
forall k (s :: k) v e f r.
FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier hs-var">faceDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051760"><span class="hs-identifier hs-var">fi</span></a></span><span class="annot"><span class="annottext">((FaceData (Dart s) f
  -&gt; Const (Seq (Dart s)) (FaceData (Dart s) f))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const (Seq (Dart s)) (PlanarSubdivision s v e f r))
-&gt; ((Seq (Dart s) -&gt; Const (Seq (Dart s)) (Seq (Dart s)))
    -&gt; FaceData (Dart s) f
    -&gt; Const (Seq (Dart s)) (FaceData (Dart s) f))
-&gt; Getting
     (Seq (Dart s)) (PlanarSubdivision s v e f r) (Seq (Dart s))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Seq (Dart s) -&gt; Const (Seq (Dart s)) (Seq (Dart s)))
-&gt; FaceData (Dart s) f
-&gt; Const (Seq (Dart s)) (FaceData (Dart s) f)
forall h f1 h2.
Lens (FaceData h f1) (FaceData h2 f1) (Seq h) (Seq h2)
</span><a href="Geometry.PlanarSubdivision.Raw.html#holes"><span class="hs-identifier hs-var">holes</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- * Access data</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span id="local-6989586621680052963"><span id="local-6989586621680052964"><span id="local-6989586621680052965"><span id="local-6989586621680052966"><span id="local-6989586621680052967"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-type">asLocalD</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052967"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052967"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052966"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052965"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052963"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-573"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052967"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052967"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052967"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052963"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-574"></span><span id="asLocalD"><span class="annot"><span class="annottext">asLocalD :: Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var hs-var">asLocalD</span></a></span></span><span> </span><span id="local-6989586621680051758"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051758"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051757"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051757"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621680051756"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051756"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680051755"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051755"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051757"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (Raw s (Dart (Wrap s)) e))
     (PlanarSubdivision s v e f r)
     (Raw s (Dart (Wrap s)) e)
-&gt; Raw s (Dart (Wrap s)) e
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e)
 -&gt; Const
      (Endo (Raw s (Dart (Wrap s)) e))
      (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const
     (Endo (Raw s (Dart (Wrap s)) e)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r e.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (Dart (Wrap s)) e)
  -&gt; Const
       (Endo (Raw s (Dart (Wrap s)) e))
       (Vector (Raw s (Dart (Wrap s)) e)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Endo (Raw s (Dart (Wrap s)) e)) (PlanarSubdivision s v e f r))
-&gt; ((Raw s (Dart (Wrap s)) e
     -&gt; Const
          (Endo (Raw s (Dart (Wrap s)) e)) (Raw s (Dart (Wrap s)) e))
    -&gt; Vector (Raw s (Dart (Wrap s)) e)
    -&gt; Const
         (Endo (Raw s (Dart (Wrap s)) e))
         (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; Getting
     (Endo (Raw s (Dart (Wrap s)) e))
     (PlanarSubdivision s v e f r)
     (Raw s (Dart (Wrap s)) e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (Raw s (Dart (Wrap s)) e))
-&gt; Traversal'
     (Vector (Raw s (Dart (Wrap s)) e))
     (IxValue (Vector (Raw s (Dart (Wrap s)) e)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051758"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051756"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051755"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051757"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Component s r) (PlanarSubdivision s v e f r) (Component s r)
-&gt; Component s r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051756"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span id="local-6989586621680052927"><span id="local-6989586621680052928"><span id="local-6989586621680052929"><span id="local-6989586621680052930"><span id="local-6989586621680052931"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-type">asLocalV</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052930"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052929"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052928"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052927"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-581"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052931"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052931"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052927"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-582"></span><span id="asLocalV"><span class="annot"><span class="annottext">asLocalV :: VertexId' s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, VertexId' (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalV"><span class="hs-identifier hs-var hs-var">asLocalV</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621680051754"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051754"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680051753"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051753"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621680051752"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051752"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680051751"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051751"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051753"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
-&gt; Raw s (VertexId' (Wrap s)) v
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const
     (Endo (Raw s (VertexId' (Wrap s)) v)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) v)
  -&gt; Const
       (Endo (Raw s (VertexId' (Wrap s)) v))
       (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (PlanarSubdivision s v e f r))
-&gt; ((Raw s (VertexId' (Wrap s)) v
     -&gt; Const
          (Endo (Raw s (VertexId' (Wrap s)) v))
          (Raw s (VertexId' (Wrap s)) v))
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
    -&gt; Const
         (Endo (Raw s (VertexId' (Wrap s)) v))
         (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Traversal'
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (IxValue (Vector (Raw s (VertexId' (Wrap s)) v)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="#local-6989586621680051754"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-583"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051752"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051751"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051753"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Component s r) (PlanarSubdivision s v e f r) (Component s r)
-&gt; Component s r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051752"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- | Lens to access the vertex data</span><span>
</span><span id="line-586"></span><span class="hs-comment">--</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- Note that using the setting part of this lens may be very</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- expensive!!  (O(n))</span><span>
</span><span id="line-589"></span><span id="local-6989586621680053176"><span id="local-6989586621680053177"><span id="local-6989586621680053178"><span id="local-6989586621680053179"><span id="local-6989586621680053180"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-type">vertexDataOf</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-590"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053180"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053179"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053178"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053177"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053176"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053176"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053179"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-591"></span><span id="vertexDataOf"><span class="annot"><span class="annottext">vertexDataOf :: VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var hs-var">vertexDataOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621680051750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051750"><span class="hs-identifier hs-var">vi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; VertexData r v)
-&gt; (PlanarSubdivision s v e f r
    -&gt; VertexData r v -&gt; PlanarSubdivision s v e f r)
-&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; VertexData r v
</span><a href="#local-6989586621680051749"><span class="hs-identifier hs-var">get'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; VertexData r v -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051748"><span class="hs-identifier hs-var">set''</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621680051749"><span class="annot"><span class="annottext">get' :: PlanarSubdivision s v e f r -&gt; VertexData r v
</span><a href="#local-6989586621680051749"><span class="hs-identifier hs-var hs-var">get'</span></a></span></span><span> </span><span id="local-6989586621680051747"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051747"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621680051746"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051746"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680051745"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051745"><span class="hs-identifier hs-var">wvdi</span></a></span></span><span> </span><span id="local-6989586621680051744"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051744"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051747"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
-&gt; Raw s (VertexId' (Wrap s)) v
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const
     (Endo (Raw s (VertexId' (Wrap s)) v)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) v)
  -&gt; Const
       (Endo (Raw s (VertexId' (Wrap s)) v))
       (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (PlanarSubdivision s v e f r))
-&gt; ((Raw s (VertexId' (Wrap s)) v
     -&gt; Const
          (Endo (Raw s (VertexId' (Wrap s)) v))
          (Raw s (VertexId' (Wrap s)) v))
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
    -&gt; Const
         (Endo (Raw s (VertexId' (Wrap s)) v))
         (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Traversal'
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (IxValue (Vector (Raw s (VertexId' (Wrap s)) v)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="#local-6989586621680051750"><span class="hs-identifier hs-var">vi</span></a></span><span>
</span><span id="line-594"></span><span>                  </span><span id="local-6989586621680051743"><span class="annot"><span class="annottext">vd :: VertexData r (VertexId' s)
</span><a href="#local-6989586621680051743"><span class="hs-identifier hs-var hs-var">vd</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051747"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r (VertexId' s))
     (PlanarSubdivision s v e f r)
     (VertexData r (VertexId' s))
-&gt; VertexData r (VertexId' s)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051746"><span class="hs-identifier hs-var">ci</span></a></span><span class="annot"><span class="annottext">((Component s r
  -&gt; Const (VertexData r (VertexId' s)) (Component s r))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (VertexData r (VertexId' s)) (PlanarSubdivision s v e f r))
-&gt; ((VertexData r (VertexId' s)
     -&gt; Const (VertexData r (VertexId' s)) (VertexData r (VertexId' s)))
    -&gt; Component s r
    -&gt; Const (VertexData r (VertexId' s)) (Component s r))
-&gt; Getting
     (VertexData r (VertexId' s))
     (PlanarSubdivision s v e f r)
     (VertexData r (VertexId' s))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; Lens' (Component s r) (VertexData r (VertexId' s))
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var">PG.vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051745"><span class="hs-identifier hs-var">wvdi</span></a></span><span>
</span><span id="line-595"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">VertexData r (VertexId' s)
</span><a href="#local-6989586621680051743"><span class="hs-identifier hs-var">vd</span></a></span><span class="annot"><span class="annottext">VertexData r (VertexId' s)
-&gt; (VertexData r (VertexId' s) -&gt; VertexData r v) -&gt; VertexData r v
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(VertexId' s -&gt; Identity v)
-&gt; VertexData r (VertexId' s) -&gt; Identity (VertexData r v)
forall r v1 v2. Lens (VertexData r v1) (VertexData r v2) v1 v2
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span><span> </span><span class="annot"><span class="annottext">((VertexId' s -&gt; Identity v)
 -&gt; VertexData r (VertexId' s) -&gt; Identity (VertexData r v))
-&gt; v -&gt; VertexData r (VertexId' s) -&gt; VertexData r v
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051744"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621680051748"><span class="annot"><span class="annottext">set'' :: PlanarSubdivision s v e f r
-&gt; VertexData r v -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051748"><span class="hs-identifier hs-var hs-var">set''</span></a></span></span><span> </span><span id="local-6989586621680051741"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051741"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680051740"><span class="annot"><span class="annottext">VertexData r v
</span><a href="#local-6989586621680051740"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621680051739"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051739"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621680051738"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051738"><span class="hs-identifier hs-var">wvdi</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051741"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
-&gt; Raw s (VertexId' (Wrap s)) v
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const
     (Endo (Raw s (VertexId' (Wrap s)) v)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) v)
  -&gt; Const
       (Endo (Raw s (VertexId' (Wrap s)) v))
       (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Endo (Raw s (VertexId' (Wrap s)) v))
      (PlanarSubdivision s v e f r))
-&gt; ((Raw s (VertexId' (Wrap s)) v
     -&gt; Const
          (Endo (Raw s (VertexId' (Wrap s)) v))
          (Raw s (VertexId' (Wrap s)) v))
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
    -&gt; Const
         (Endo (Raw s (VertexId' (Wrap s)) v))
         (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; Getting
     (Endo (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Raw s (VertexId' (Wrap s)) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Traversal'
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (IxValue (Vector (Raw s (VertexId' (Wrap s)) v)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="#local-6989586621680051750"><span class="hs-identifier hs-var">vi</span></a></span><span>
</span><span id="line-597"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051741"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) v)
  -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; ((v -&gt; Identity v)
    -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
    -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; (v -&gt; Identity v)
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Traversal'
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (IxValue (Vector (Raw s (VertexId' (Wrap s)) v)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="#local-6989586621680051750"><span class="hs-identifier hs-var">vi</span></a></span><span class="annot"><span class="annottext">((Raw s (VertexId' (Wrap s)) v
  -&gt; Identity (Raw s (VertexId' (Wrap s)) v))
 -&gt; Vector (Raw s (VertexId' (Wrap s)) v)
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v)))
-&gt; ((v -&gt; Identity v)
    -&gt; Raw s (VertexId' (Wrap s)) v
    -&gt; Identity (Raw s (VertexId' (Wrap s)) v))
-&gt; (v -&gt; Identity v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) v))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(v -&gt; Identity v)
-&gt; Raw s (VertexId' (Wrap s)) v
-&gt; Identity (Raw s (VertexId' (Wrap s)) v)
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span>                </span><span class="annot"><span class="annottext">((v -&gt; Identity v)
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; v -&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r v
</span><a href="#local-6989586621680051740"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">VertexData r v -&gt; Getting v (VertexData r v) v -&gt; v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting v (VertexData r v) v
forall r v1 v2. Lens (VertexData r v1) (VertexData r v2) v1 v2
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>                      </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621680051739"><span class="hs-identifier hs-var">ci</span></a></span><span class="annot"><span class="annottext">((Component s r -&gt; Identity (Component s r))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; ((Point 2 r -&gt; Identity (Point 2 r))
    -&gt; Component s r -&gt; Identity (Component s r))
-&gt; (Point 2 r -&gt; Identity (Point 2 r))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' (Wrap s)
-&gt; Lens' (Component s r) (VertexData r (VertexId' s))
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var">PG.vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621680051738"><span class="hs-identifier hs-var">wvdi</span></a></span><span class="annot"><span class="annottext">((VertexData r (VertexId' s)
  -&gt; Identity (VertexData r (VertexId' s)))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; ((Point 2 r -&gt; Identity (Point 2 r))
    -&gt; VertexData r (VertexId' s)
    -&gt; Identity (VertexData r (VertexId' s)))
-&gt; (Point 2 r -&gt; Identity (Point 2 r))
-&gt; Component s r
-&gt; Identity (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Identity (Point 2 r))
-&gt; VertexData r (VertexId' s)
-&gt; Identity (VertexData r (VertexId' s))
forall r v1 r2.
Lens (VertexData r v1) (VertexData r2 v1) (Point 2 r) (Point 2 r2)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">((Point 2 r -&gt; Identity (Point 2 r))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; Point 2 r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r v
</span><a href="#local-6989586621680051740"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">VertexData r v
-&gt; Getting (Point 2 r) (VertexData r v) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (VertexData r v) (Point 2 r)
forall r v1 r2.
Lens (VertexData r v1) (VertexData r2 v1) (Point 2 r) (Point 2 r2)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-comment">-- | Get the location of a vertex in the planar subdivision.</span><span>
</span><span id="line-602"></span><span class="hs-comment">--</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- Note that the setting part of this lens may be very expensive!</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- Moreover, use with care (as this may destroy planarity etc.)</span><span>
</span><span id="line-605"></span><span id="local-6989586621680051733"><span id="local-6989586621680051734"><span id="local-6989586621680051735"><span id="local-6989586621680051736"><span id="local-6989586621680051737"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#locationOf"><span class="hs-identifier hs-type">locationOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051736"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051735"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051734"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051733"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680051733"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-606"></span><span id="locationOf"><span class="annot"><span class="annottext">locationOf :: VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (Point 2 r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#locationOf"><span class="hs-identifier hs-var hs-var">locationOf</span></a></span></span><span> </span><span id="local-6989586621680051732"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051732"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051732"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r))
-&gt; ((Point 2 r -&gt; f (Point 2 r))
    -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (Point 2 r -&gt; f (Point 2 r))
-&gt; PlanarSubdivision s v e f r
-&gt; f (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; f (Point 2 r))
-&gt; VertexData r v -&gt; f (VertexData r v)
forall r v1 r2.
Lens (VertexData r v1) (VertexData r2 v1) (Point 2 r) (Point 2 r2)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-comment">-- | Lens to get the face data of a particular face. Note that the</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- setting part of this lens may be very expensive! (O(n))</span><span>
</span><span id="line-611"></span><span id="local-6989586621680053104"><span id="local-6989586621680053105"><span id="local-6989586621680053106"><span id="local-6989586621680053107"><span id="local-6989586621680053108"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier hs-type">faceDataOf</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680053108"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053108"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053107"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053106"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053105"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680053104"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680053108"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680053105"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-613"></span><span id="faceDataOf"><span class="annot"><span class="annottext">faceDataOf :: FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier hs-var hs-var">faceDataOf</span></a></span></span><span> </span><span id="local-6989586621680051731"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051731"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; FaceData (Dart s) f)
-&gt; (PlanarSubdivision s v e f r
    -&gt; FaceData (Dart s) f -&gt; PlanarSubdivision s v e f r)
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621680051730"><span class="hs-identifier hs-var">getF</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; FaceData (Dart s) f -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051729"><span class="hs-identifier hs-var">setF</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621680051728"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051728"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051731"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621680051730"><span class="annot"><span class="annottext">getF :: PlanarSubdivision s v e f r -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621680051730"><span class="hs-identifier hs-var hs-var">getF</span></a></span></span><span> </span><span id="local-6989586621680051727"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051727"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051727"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Endo (FaceData (Dart s) f))
     (PlanarSubdivision s v e f r)
     (FaceData (Dart s) f)
-&gt; FaceData (Dart s) f
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f)
 -&gt; Const (Endo (FaceData (Dart s) f)) (Vector (RawFace s f)))
-&gt; PlanarSubdivision s v e f r
-&gt; Const (Endo (FaceData (Dart s) f)) (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r f.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
  (Vector (RawFace s f))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span class="annot"><span class="annottext">((Vector (RawFace s f)
  -&gt; Const (Endo (FaceData (Dart s) f)) (Vector (RawFace s f)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Endo (FaceData (Dart s) f)) (PlanarSubdivision s v e f r))
-&gt; ((FaceData (Dart s) f
     -&gt; Const (Endo (FaceData (Dart s) f)) (FaceData (Dart s) f))
    -&gt; Vector (RawFace s f)
    -&gt; Const (Endo (FaceData (Dart s) f)) (Vector (RawFace s f)))
-&gt; Getting
     (Endo (FaceData (Dart s) f))
     (PlanarSubdivision s v e f r)
     (FaceData (Dart s) f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (RawFace s f))
-&gt; Traversal'
     (Vector (RawFace s f)) (IxValue (Vector (RawFace s f)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (RawFace s f))
</span><a href="#local-6989586621680051728"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">((RawFace s f -&gt; Const (Endo (FaceData (Dart s) f)) (RawFace s f))
 -&gt; Vector (RawFace s f)
 -&gt; Const (Endo (FaceData (Dart s) f)) (Vector (RawFace s f)))
-&gt; ((FaceData (Dart s) f
     -&gt; Const (Endo (FaceData (Dart s) f)) (FaceData (Dart s) f))
    -&gt; RawFace s f -&gt; Const (Endo (FaceData (Dart s) f)) (RawFace s f))
-&gt; (FaceData (Dart s) f
    -&gt; Const (Endo (FaceData (Dart s) f)) (FaceData (Dart s) f))
-&gt; Vector (RawFace s f)
-&gt; Const (Endo (FaceData (Dart s) f)) (Vector (RawFace s f))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f
 -&gt; Const (Endo (FaceData (Dart s) f)) (FaceData (Dart s) f))
-&gt; RawFace s f -&gt; Const (Endo (FaceData (Dart s) f)) (RawFace s f)
forall k (s :: k) f1 f2.
Lens
  (RawFace s f1)
  (RawFace s f2)
  (FaceData (Dart s) f1)
  (FaceData (Dart s) f2)
</span><a href="Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span>
</span><span id="line-617"></span><span>    </span><span id="local-6989586621680051729"><span class="annot"><span class="annottext">setF :: PlanarSubdivision s v e f r
-&gt; FaceData (Dart s) f -&gt; PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051729"><span class="hs-identifier hs-var hs-var">setF</span></a></span></span><span> </span><span id="local-6989586621680051726"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051726"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680051725"><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><a href="#local-6989586621680051725"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051726"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r f.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
  (Vector (RawFace s f))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span class="annot"><span class="annottext">((Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; ((FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
    -&gt; Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; (FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Vector (RawFace s f))
-&gt; Traversal'
     (Vector (RawFace s f)) (IxValue (Vector (RawFace s f)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (RawFace s f))
</span><a href="#local-6989586621680051728"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">((RawFace s f -&gt; Identity (RawFace s f))
 -&gt; Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; ((FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
    -&gt; RawFace s f -&gt; Identity (RawFace s f))
-&gt; (FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
-&gt; Vector (RawFace s f)
-&gt; Identity (Vector (RawFace s f))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
-&gt; RawFace s f -&gt; Identity (RawFace s f)
forall k (s :: k) f1 f2.
Lens
  (RawFace s f1)
  (RawFace s f2)
  (FaceData (Dart s) f1)
  (FaceData (Dart s) f2)
</span><a href="Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span> </span><span class="annot"><span class="annottext">((FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Identity (PlanarSubdivision s v e f r))
-&gt; FaceData (Dart s) f
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><a href="#local-6989586621680051725"><span class="hs-identifier hs-var">fd</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span id="local-6989586621680051720"><span id="local-6989586621680051721"><span id="local-6989586621680051722"><span id="local-6989586621680051723"><span id="local-6989586621680051724"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051724"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051723"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051722"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051720"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051724"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051724"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051723"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051722"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051720"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051724"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680051723"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span id="local-6989586621680051717"><span class="annot"><span class="annottext">dataOf :: VertexId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (VertexId' s))
</span><a href="#local-6989586621680051717"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680051716"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051716"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051716"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r))
-&gt; ((v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (v -&gt; f v)
-&gt; PlanarSubdivision s v e f r
-&gt; f (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v)
forall r v1 v2. Lens (VertexData r v1) (VertexData r v2) v1 v2
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span></span></span></span></span></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span id="local-6989586621680051711"><span id="local-6989586621680051712"><span id="local-6989586621680051713"><span id="local-6989586621680051714"><span id="local-6989586621680051715"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051714"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051713"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051715"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051714"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051713"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051715"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680051713"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-625"></span><span>  </span><span id="local-6989586621680051709"><span class="annot"><span class="annottext">dataOf :: Dart s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (Dart s))
</span><a href="#local-6989586621680051709"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680051708"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051708"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (Dart (Wrap s)) e)
 -&gt; f (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r)
forall k (s :: k) v e f r e.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (Dart (Wrap s)) e)
  -&gt; f (Vector (Raw s (Dart (Wrap s)) e)))
 -&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r))
-&gt; ((e -&gt; f e)
    -&gt; Vector (Raw s (Dart (Wrap s)) e)
    -&gt; f (Vector (Raw s (Dart (Wrap s)) e)))
-&gt; (e -&gt; f e)
-&gt; PlanarSubdivision s v e f r
-&gt; f (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Traversing
  (-&gt;)
  f
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
  (Raw s (Dart (Wrap s)) e)
  (Raw s (Dart (Wrap s)) e)
-&gt; Over
     (-&gt;)
     f
     (Vector (Raw s (Dart (Wrap s)) e))
     (Vector (Raw s (Dart (Wrap s)) e))
     (Raw s (Dart (Wrap s)) e)
     (Raw s (Dart (Wrap s)) e)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s t a.
(HasCallStack, Conjoined p, Functor f) =&gt;
Traversing p f s t a a -&gt; Over p f s t a a
</span><span class="hs-identifier hs-var">singular</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index (Vector (Raw s (Dart (Wrap s)) e))
-&gt; Traversal'
     (Vector (Raw s (Dart (Wrap s)) e))
     (IxValue (Vector (Raw s (Dart (Wrap s)) e)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051708"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Over
  (-&gt;)
  f
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
  (Raw s (Dart (Wrap s)) e)
  (Raw s (Dart (Wrap s)) e)
-&gt; ((e -&gt; f e)
    -&gt; Raw s (Dart (Wrap s)) e -&gt; f (Raw s (Dart (Wrap s)) e))
-&gt; (e -&gt; f e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; f (Vector (Raw s (Dart (Wrap s)) e))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(e -&gt; f e)
-&gt; Raw s (Dart (Wrap s)) e -&gt; f (Raw s (Dart (Wrap s)) e)
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span></span></span></span></span></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span id="local-6989586621680051703"><span id="local-6989586621680051704"><span id="local-6989586621680051705"><span id="local-6989586621680051706"><span id="local-6989586621680051707"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051706"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051705"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051704"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051703"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051707"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051706"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051705"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051704"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051703"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051707"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680051704"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621680051701"><span class="annot"><span class="annottext">dataOf :: FaceId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (FaceId' s))
</span><a href="#local-6989586621680051701"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680051700"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051700"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
forall k (s :: k) v e f r.
FaceId' s
-&gt; Lens' (PlanarSubdivision s v e f r) (FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceDataOf"><span class="hs-identifier hs-var">faceDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051700"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">((FaceData (Dart s) f -&gt; f (FaceData (Dart s) f))
 -&gt; PlanarSubdivision s v e f r -&gt; f (PlanarSubdivision s v e f r))
-&gt; ((f -&gt; f f) -&gt; FaceData (Dart s) f -&gt; f (FaceData (Dart s) f))
-&gt; (f -&gt; f f)
-&gt; PlanarSubdivision s v e f r
-&gt; f (PlanarSubdivision s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(f -&gt; f f) -&gt; FaceData (Dart s) f -&gt; f (FaceData (Dart s) f)
forall h f1 f2. Lens (FaceData h f1) (FaceData h f2) f1 f2
</span><a href="Geometry.PlanarSubdivision.Raw.html#fData"><span class="hs-identifier hs-var">fData</span></a></span></span></span></span></span></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-comment">-- | Traverse the vertices of the planar subdivision</span><span>
</span><span id="line-632"></span><span id="local-6989586621680052622"><span id="local-6989586621680052623"><span id="local-6989586621680052624"><span id="local-6989586621680052625"><span id="local-6989586621680052626"><span id="local-6989586621680052627"><span id="local-6989586621680052628"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseVertices"><span class="hs-identifier hs-type">traverseVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680052628"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-633"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052627"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052626"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052625"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052627"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052626"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052624"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052623"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052622"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052627"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052625"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052624"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052623"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052622"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-635"></span><span id="traverseVertices"><span class="annot"><span class="annottext">traverseVertices :: (VertexId' s -&gt; v -&gt; g v')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v' e f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseVertices"><span class="hs-identifier hs-var hs-var">traverseVertices</span></a></span></span><span> </span><span id="local-6989586621680051699"><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; g v'
</span><a href="#local-6989586621680051699"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v' e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v'))
-&gt; LensLike
     g
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v' e f r)
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (Vector (Raw s (VertexId' (Wrap s)) v'))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v' e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v'))
forall k (s :: k) v e f r v.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; VertexId' s)
-&gt; (VertexId' s -&gt; v -&gt; g v')
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; g (Vector (Raw s (VertexId' (Wrap s)) v'))
forall k k (g :: * -&gt; *) (w :: k -&gt; *) (s :: k) v v' (ci :: k) i.
Applicative g =&gt;
(Int -&gt; w s)
-&gt; (w s -&gt; v -&gt; g v')
-&gt; Vector (Raw ci i v)
-&gt; g (Vector (Raw ci i v'))
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseWith"><span class="hs-identifier hs-var">traverseWith</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; g v'
</span><a href="#local-6989586621680051699"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | Traverse the darts of the Planar subdivision</span><span>
</span><span id="line-638"></span><span id="local-6989586621680052607"><span id="local-6989586621680052608"><span id="local-6989586621680052609"><span id="local-6989586621680052610"><span id="local-6989586621680052611"><span id="local-6989586621680052612"><span id="local-6989586621680052613"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseDarts"><span class="hs-identifier hs-type">traverseDarts</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680052613"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-639"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052612"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052611"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052613"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052610"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052612"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052609"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052611"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052608"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052607"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052613"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052612"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052609"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052610"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052608"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052607"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-641"></span><span id="traverseDarts"><span class="annot"><span class="annottext">traverseDarts :: (Dart s -&gt; e -&gt; g e')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v e' f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseDarts"><span class="hs-identifier hs-var hs-var">traverseDarts</span></a></span></span><span> </span><span id="local-6989586621680051696"><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; g e'
</span><a href="#local-6989586621680051696"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e' f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e'))
-&gt; LensLike
     g
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v e' f r)
     (Vector (Raw s (Dart (Wrap s)) e))
     (Vector (Raw s (Dart (Wrap s)) e'))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e' f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e'))
forall k (s :: k) v e f r e.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Dart s)
-&gt; (Dart s -&gt; e -&gt; g e')
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; g (Vector (Raw s (Dart (Wrap s)) e'))
forall k k (g :: * -&gt; *) (w :: k -&gt; *) (s :: k) v v' (ci :: k) i.
Applicative g =&gt;
(Int -&gt; w s)
-&gt; (w s -&gt; v -&gt; g v')
-&gt; Vector (Raw ci i v)
-&gt; g (Vector (Raw ci i v'))
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseWith"><span class="hs-identifier hs-var">traverseWith</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Dart s
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; g e'
</span><a href="#local-6989586621680051696"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">-- | Traverse the faces of the planar subdivision.</span><span>
</span><span id="line-645"></span><span id="local-6989586621680052638"><span id="local-6989586621680052639"><span id="local-6989586621680052640"><span id="local-6989586621680052641"><span id="local-6989586621680052642"><span id="local-6989586621680052643"><span id="local-6989586621680052644"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseFaces"><span class="hs-identifier hs-type">traverseFaces</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680052644"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-646"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052644"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052641"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052640"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052639"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052644"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052640"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052639"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052641"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-648"></span><span id="traverseFaces"><span class="annot"><span class="annottext">traverseFaces :: (FaceId' s -&gt; f -&gt; g f')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v e f' r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseFaces"><span class="hs-identifier hs-var hs-var">traverseFaces</span></a></span></span><span> </span><span id="local-6989586621680051695"><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; g f'
</span><a href="#local-6989586621680051695"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f' r)
  (Vector (RawFace s f))
  (Vector (RawFace s f'))
-&gt; LensLike
     g
     (PlanarSubdivision s v e f r)
     (PlanarSubdivision s v e f' r)
     (Vector (RawFace s f))
     (Vector (RawFace s f'))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  g
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f' r)
  (Vector (RawFace s f))
  (Vector (RawFace s f'))
forall k (s :: k) v e f r f.
Lens
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
  (Vector (RawFace s f))
</span><a href="Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FaceId' s -&gt; f -&gt; g f')
-&gt; Vector (RawFace s f) -&gt; g (Vector (RawFace s f'))
forall k (t :: * -&gt; *) (f :: * -&gt; *) (t :: * -&gt; *) (s :: k)
       (w :: World) a b.
(TraversableWithIndex Int t, Applicative f, Traversable t) =&gt;
(FaceId s w -&gt; a -&gt; f b) -&gt; t (t a) -&gt; f (t (t b))
</span><a href="#local-6989586621680051694"><span class="hs-identifier hs-var">traverseFaces'</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; g f'
</span><a href="#local-6989586621680051695"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621680051694"><span class="annot"><span class="annottext">traverseFaces' :: (FaceId s w -&gt; a -&gt; f b) -&gt; t (t a) -&gt; f (t (t b))
</span><a href="#local-6989586621680051694"><span class="hs-identifier hs-var hs-var">traverseFaces'</span></a></span></span><span> </span><span id="local-6989586621680051693"><span class="annot"><span class="annottext">FaceId s w -&gt; a -&gt; f b
</span><a href="#local-6989586621680051693"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; t a -&gt; f (t b)) -&gt; t (t a) -&gt; f (t (t b))
forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Applicative f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">itraverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051691"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051691"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId s w -&gt; a -&gt; f b
</span><a href="#local-6989586621680051693"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId s (DualOf w) -&gt; FaceId s w
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s (DualOf w) -&gt; FaceId s w)
-&gt; (Int -&gt; VertexId s (DualOf w)) -&gt; Int -&gt; FaceId s w
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s (DualOf w)
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId s w) -&gt; Int -&gt; FaceId s w
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051691"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">-- | Helper function to implement traver(vertertices|darts|faces)</span><span>
</span><span id="line-653"></span><span id="local-6989586621680052696"><span id="local-6989586621680052697"><span id="local-6989586621680052698"><span id="local-6989586621680052699"><span id="local-6989586621680052700"><span id="local-6989586621680052701"><span id="local-6989586621680052702"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#traverseWith"><span class="hs-identifier hs-type">traverseWith</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680052702"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-654"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052701"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052700"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680052701"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052700"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052699"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052702"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052698"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052697"><span class="hs-identifier hs-type">ci</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052696"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052699"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052702"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052697"><span class="hs-identifier hs-type">ci</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052696"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052698"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-658"></span><span id="traverseWith"><span class="annot"><span class="annottext">traverseWith :: (Int -&gt; w s)
-&gt; (w s -&gt; v -&gt; g v')
-&gt; Vector (Raw ci i v)
-&gt; g (Vector (Raw ci i v'))
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseWith"><span class="hs-identifier hs-var hs-var">traverseWith</span></a></span></span><span> </span><span id="local-6989586621680051689"><span class="annot"><span class="annottext">Int -&gt; w s
</span><a href="#local-6989586621680051689"><span class="hs-identifier hs-var">mkIdx</span></a></span></span><span> </span><span id="local-6989586621680051688"><span class="annot"><span class="annottext">w s -&gt; v -&gt; g v'
</span><a href="#local-6989586621680051688"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Raw ci i v -&gt; g (Raw ci i v'))
-&gt; Vector (Raw ci i v) -&gt; g (Vector (Raw ci i v'))
forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Applicative f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">itraverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051687"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051687"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(v -&gt; g v') -&gt; Raw ci i v -&gt; g (Raw ci i v')
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w s -&gt; v -&gt; g v'
</span><a href="#local-6989586621680051688"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(w s -&gt; v -&gt; g v') -&gt; w s -&gt; v -&gt; g v'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; w s
</span><a href="#local-6989586621680051689"><span class="hs-identifier hs-var">mkIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680051687"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-comment">-- | Map with index over all faces</span><span>
</span><span id="line-663"></span><span id="local-6989586621680051681"><span id="local-6989586621680051682"><span id="local-6989586621680051683"><span id="local-6989586621680051684"><span id="local-6989586621680051685"><span id="local-6989586621680051686"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapFaces"><span class="hs-identifier hs-type">mapFaces</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051686"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051685"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051684"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051686"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051683"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051682"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051685"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051681"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051686"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051683"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051682"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051684"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051681"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-665"></span><span id="mapFaces"><span class="annot"><span class="annottext">mapFaces :: (FaceId' s -&gt; f -&gt; f')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f' r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapFaces"><span class="hs-identifier hs-var hs-var">mapFaces</span></a></span></span><span> </span><span id="local-6989586621680051680"><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; f'
</span><a href="#local-6989586621680051680"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (PlanarSubdivision s v e f' r)
-&gt; PlanarSubdivision s v e f' r
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (PlanarSubdivision s v e f' r)
 -&gt; PlanarSubdivision s v e f' r)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Identity (PlanarSubdivision s v e f' r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f' r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; f -&gt; Identity f')
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e f' r)
forall k (g :: * -&gt; *) (s :: k) f f' v e r.
Applicative g =&gt;
(FaceId' s -&gt; f -&gt; g f')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v e f' r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseFaces"><span class="hs-identifier hs-var">traverseFaces</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051678"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051678"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051677"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f' -&gt; Identity f'
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">(f' -&gt; Identity f') -&gt; f' -&gt; Identity f'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; f'
</span><a href="#local-6989586621680051680"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051678"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051677"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">-- | Map with index over all vertices</span><span>
</span><span id="line-668"></span><span id="local-6989586621680051670"><span id="local-6989586621680051671"><span id="local-6989586621680051672"><span id="local-6989586621680051673"><span id="local-6989586621680051674"><span id="local-6989586621680051675"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapVertices"><span class="hs-identifier hs-type">mapVertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051675"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051674"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051673"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051675"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051674"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051672"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051671"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051675"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051673"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051672"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051671"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051670"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-670"></span><span id="mapVertices"><span class="annot"><span class="annottext">mapVertices :: (VertexId' s -&gt; v -&gt; v')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v' e f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapVertices"><span class="hs-identifier hs-var hs-var">mapVertices</span></a></span></span><span> </span><span id="local-6989586621680051669"><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; v'
</span><a href="#local-6989586621680051669"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (PlanarSubdivision s v' e f r)
-&gt; PlanarSubdivision s v' e f r
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (PlanarSubdivision s v' e f r)
 -&gt; PlanarSubdivision s v' e f r)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Identity (PlanarSubdivision s v' e f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v' e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; v -&gt; Identity v')
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v' e f r)
forall k (g :: * -&gt; *) (s :: k) v v' e f r.
Applicative g =&gt;
(VertexId' s -&gt; v -&gt; g v')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v' e f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseVertices"><span class="hs-identifier hs-var">traverseVertices</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051668"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051668"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051667"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v' -&gt; Identity v'
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">(v' -&gt; Identity v') -&gt; v' -&gt; Identity v'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; v'
</span><a href="#local-6989586621680051669"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051668"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680051667"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-comment">-- | Map with index over all darts</span><span>
</span><span id="line-673"></span><span id="local-6989586621680052593"><span id="local-6989586621680052594"><span id="local-6989586621680052595"><span id="local-6989586621680052596"><span id="local-6989586621680052597"><span id="local-6989586621680052598"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapDarts"><span class="hs-identifier hs-type">mapDarts</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052597"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052596"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052595"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052597"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052593"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052595"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052596"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052593"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-675"></span><span id="mapDarts"><span class="annot"><span class="annottext">mapDarts :: (Dart s -&gt; e -&gt; e')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e' f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapDarts"><span class="hs-identifier hs-var hs-var">mapDarts</span></a></span></span><span> </span><span id="local-6989586621680051666"><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; e'
</span><a href="#local-6989586621680051666"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (PlanarSubdivision s v e' f r)
-&gt; PlanarSubdivision s v e' f r
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (PlanarSubdivision s v e' f r)
 -&gt; PlanarSubdivision s v e' f r)
-&gt; (PlanarSubdivision s v e f r
    -&gt; Identity (PlanarSubdivision s v e' f r))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e' f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; e -&gt; Identity e')
-&gt; PlanarSubdivision s v e f r
-&gt; Identity (PlanarSubdivision s v e' f r)
forall k (g :: * -&gt; *) (s :: k) e e' v f r.
Applicative g =&gt;
(Dart s -&gt; e -&gt; g e')
-&gt; PlanarSubdivision s v e f r -&gt; g (PlanarSubdivision s v e' f r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#traverseDarts"><span class="hs-identifier hs-var">traverseDarts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051665"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051665"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051664"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680051664"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e' -&gt; Identity e'
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">(e' -&gt; Identity e') -&gt; e' -&gt; Identity e'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; e'
</span><a href="#local-6989586621680051666"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051665"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680051664"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | Map a function over all positive darts. The negative darts are</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- simply set to look up the value of their corresponding positive dart</span><span>
</span><span id="line-679"></span><span id="local-6989586621680051658"><span id="local-6989586621680051659"><span id="local-6989586621680051660"><span id="local-6989586621680051661"><span id="local-6989586621680051662"><span id="local-6989586621680051663"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#mapEdges"><span class="hs-identifier hs-type">mapEdges</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051663"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051662"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051661"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051663"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051660"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051662"><span class="hs-identifier hs-type">e</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680051659"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051658"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-681"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051663"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051660"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051661"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051659"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051658"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-682"></span><span id="mapEdges"><span class="annot"><span class="annottext">mapEdges :: (Dart s -&gt; e -&gt; e')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e' f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapEdges"><span class="hs-identifier hs-var hs-var">mapEdges</span></a></span></span><span> </span><span id="local-6989586621680051657"><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; e'
</span><a href="#local-6989586621680051657"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680051656"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051656"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Either e e' -&gt; e')
-&gt; PlanarSubdivision s v (Either e e') f r
-&gt; PlanarSubdivision s v e' f r
forall k (s :: k) e e' v f r.
(Dart s -&gt; e -&gt; e')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e' f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapDarts"><span class="hs-identifier hs-var">mapDarts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051655"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051655"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-683"></span><span>                             </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either e e' -&gt; e'
forall a c. Either a c -&gt; c
</span><a href="#local-6989586621680051654"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e e' -&gt; e') -&gt; Either e e' -&gt; e'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Either e e') f r
</span><a href="#local-6989586621680051653"><span class="hs-identifier hs-var">ps'</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v (Either e e') f r
-&gt; Getting
     (Either e e')
     (PlanarSubdivision s v (Either e e') f r)
     (Either e e')
-&gt; Either e e'
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarSubdivision s v (Either e e') f r)
     (DataOf (PlanarSubdivision s v (Either e e') f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051655"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>                             </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680051652"><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621680051652"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621680051652"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-685"></span><span>                         </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Either e e') f r
</span><a href="#local-6989586621680051653"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>    </span><span id="local-6989586621680051653"><span class="annot"><span class="annottext">ps' :: PlanarSubdivision s v (Either e e') f r
</span><a href="#local-6989586621680051653"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; e -&gt; Either e e')
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v (Either e e') f r
forall k (s :: k) e e' v f r.
(Dart s -&gt; e -&gt; e')
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e' f r
</span><a href="Geometry.PlanarSubdivision.Basic.html#mapDarts"><span class="hs-identifier hs-var">mapDarts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051651"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051651"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051650"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680051650"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Bool
forall k (s :: k). Dart s -&gt; Bool
</span><span class="hs-identifier hs-var">isPositive</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051651"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">e' -&gt; Either e e'
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; e'
</span><a href="#local-6989586621680051657"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051651"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680051650"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e e'
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680051650"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051656"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621680051654"><span class="annot"><span class="annottext">fromRight :: Either a c -&gt; c
</span><a href="#local-6989586621680051654"><span class="hs-identifier hs-var hs-var">fromRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; c) -&gt; (c -&gt; c) -&gt; Either a c -&gt; c
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mapEdges: absurd&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-comment">-- | Getter for the data at the endpoints of a dart</span><span>
</span><span id="line-693"></span><span class="hs-comment">--</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-695"></span><span id="local-6989586621680052510"><span id="local-6989586621680052511"><span id="local-6989586621680052512"><span id="local-6989586621680052513"><span id="local-6989586621680052514"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPointsOf"><span class="hs-identifier hs-type">endPointsOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052513"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052512"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052511"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052510"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052510"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052513"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052510"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052513"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-697"></span><span id="endPointsOf"><span class="annot"><span class="annottext">endPointsOf :: Dart s
-&gt; Getter
     (PlanarSubdivision s v e f r) (VertexData r v, VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPointsOf"><span class="hs-identifier hs-var hs-var">endPointsOf</span></a></span></span><span> </span><span id="local-6989586621680051646"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051646"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v))
-&gt; Optic'
     (-&gt;)
     f
     (PlanarSubdivision s v e f r)
     (VertexData r v, VertexData r v)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPointData"><span class="hs-identifier hs-var">endPointData</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051646"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- | data corresponding to the endpoints of the dart</span><span>
</span><span id="line-700"></span><span class="hs-comment">--</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-702"></span><span id="local-6989586621680052562"><span id="local-6989586621680052563"><span id="local-6989586621680052564"><span id="local-6989586621680052565"><span id="local-6989586621680052566"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#endPointData"><span class="hs-identifier hs-type">endPointData</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052565"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052564"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052563"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052562"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-703"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052562"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052565"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052562"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052565"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-704"></span><span id="endPointData"><span class="annot"><span class="annottext">endPointData :: Dart s
-&gt; PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPointData"><span class="hs-identifier hs-var hs-var">endPointData</span></a></span></span><span> </span><span id="local-6989586621680051644"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051644"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051643"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051643"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051642"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051642"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051641"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051641"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; (VertexId' s, VertexId' s)
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; (VertexId' s, VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPoints"><span class="hs-identifier hs-var">endPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051644"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051643"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-705"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051643"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v) (PlanarSubdivision s v e f r) (VertexData r v)
-&gt; VertexData r v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051642"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051643"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v) (PlanarSubdivision s v e f r) (VertexData r v)
-&gt; VertexData r v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051641"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-comment">-- | gets the id of the outer face</span><span>
</span><span id="line-711"></span><span class="hs-comment">--</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-713"></span><span id="local-6989586621680052409"><span id="local-6989586621680052410"><span id="local-6989586621680052411"><span id="local-6989586621680052412"><span id="local-6989586621680052413"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-type">outerFaceId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052413"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052412"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052411"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052410"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052409"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052413"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-714"></span><span id="outerFaceId"><span class="annot"><span class="annottext">outerFaceId :: PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-var hs-var">outerFaceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s)
-&gt; (Int -&gt; FaceId' s)
-&gt; Int
-&gt; PlanarSubdivision s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexId s 'Dual -&gt; FaceId' s
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s 'Dual -&gt; FaceId' s)
-&gt; (Int -&gt; VertexId s 'Dual) -&gt; Int -&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s)
-&gt; Int -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-comment">-- our invariant tells us the outerface is always at faceId 0</span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">-- | Reports all edges as line segments</span><span>
</span><span id="line-720"></span><span id="local-6989586621680051635"><span id="local-6989586621680051636"><span id="local-6989586621680051637"><span id="local-6989586621680051638"><span id="local-6989586621680051639"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegments"><span class="hs-identifier hs-type">edgeSegments</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051639"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051638"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051637"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051636"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051635"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051639"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680051638"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051635"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680051637"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-721"></span><span id="edgeSegments"><span class="annot"><span class="annottext">edgeSegments :: PlanarSubdivision s v e f r
-&gt; Vector (Dart s, LineSegment 2 v r :+ e)
</span><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegments"><span class="hs-identifier hs-var hs-var">edgeSegments</span></a></span></span><span> </span><span id="local-6989586621680051634"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051634"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051633"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051633"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051633"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; LineSegment 2 v r :+ e
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegment"><span class="hs-identifier hs-var">edgeSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051633"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051634"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; (Dart s, LineSegment 2 v r :+ e))
-&gt; Vector (Dart s) -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#edges%27"><span class="hs-identifier hs-var">edges'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051634"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-comment">-- | Given a dart and the subdivision constructs the line segment</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- representing it. The segment \(\overline{uv})\) is has \(u\) as its</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- tail and \(v\) as its head.</span><span>
</span><span id="line-727"></span><span class="hs-comment">--</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- \(O(1)\)</span><span>
</span><span id="line-729"></span><span id="local-6989586621680052530"><span id="local-6989586621680052531"><span id="local-6989586621680052532"><span id="local-6989586621680052533"><span id="local-6989586621680052534"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegment"><span class="hs-identifier hs-type">edgeSegment</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052534"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052534"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052533"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052532"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052530"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680052533"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052530"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052532"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span></span><span>
</span><span id="line-730"></span><span id="edgeSegment"><span class="annot"><span class="annottext">edgeSegment :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Geometry.PlanarSubdivision.Basic.html#edgeSegment"><span class="hs-identifier hs-var hs-var">edgeSegment</span></a></span></span><span> </span><span id="local-6989586621680051632"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051632"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051631"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051631"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051630"><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680051630"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051629"><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680051629"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">PG.vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">PG.vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v)
 -&gt; (Point 2 r :+ v, Point 2 r :+ v))
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051631"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v, VertexData r v)
     (PlanarSubdivision s v e f r)
     (VertexData r v, VertexData r v)
-&gt; (VertexData r v, VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter
     (PlanarSubdivision s v e f r) (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; Getter
     (PlanarSubdivision s v e f r) (VertexData r v, VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051632"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-731"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; (Point 2 r :+ v) -&gt; LineSegment 2 v r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Geometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680051630"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680051629"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; e -&gt; LineSegment 2 v r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051631"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting e (PlanarSubdivision s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051632"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="hs-comment">-- | Given a dart d, generates the darts on (the current component of)</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- the boundary of the the face that is to the right of the given</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- dart. The darts are reported in order along the face. This means</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- that for</span><span>
</span><span id="line-738"></span><span class="hs-comment">--</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- - (the outer boundary of an) internal faces the darts are reported</span><span>
</span><span id="line-740"></span><span class="hs-comment">--   in *clockwise* order along the boundary,</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- - the &quot;inner&quot; boundary of a face, i.e. the boundary of ahole, the</span><span>
</span><span id="line-742"></span><span class="hs-comment">--   darts are reported in *counter clockwise* order.</span><span>
</span><span id="line-743"></span><span class="hs-comment">--</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- Note that this latter case means that in the darts of a a component</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- of the outer face are reported in counter clockwise order.</span><span>
</span><span id="line-746"></span><span class="hs-comment">--</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- \(O(k)\), where \(k\) is the number of darts reported</span><span>
</span><span id="line-748"></span><span id="local-6989586621680052477"><span id="local-6989586621680052478"><span id="local-6989586621680052479"><span id="local-6989586621680052480"><span id="local-6989586621680052481"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#boundary%27"><span class="hs-identifier hs-type">boundary'</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052481"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052481"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052480"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052479"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052478"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052477"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680052481"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-749"></span><span id="boundary%27"><span class="annot"><span class="annottext">boundary' :: Dart s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#boundary%27"><span class="hs-identifier hs-var hs-var">boundary'</span></a></span></span><span> </span><span id="local-6989586621680051624"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051624"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680051623"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051623"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680051622"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051622"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680051621"><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051621"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s),
    PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r
-&gt; (ComponentId s, Dart (Wrap s), Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#asLocalD"><span class="hs-identifier hs-var">asLocalD</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051624"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051623"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-750"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051620"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051620"><span class="hs-identifier hs-var">d''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051621"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Getting
     (Dart s)
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (Dart s)
-&gt; Dart s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; Lens'
     (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
     (DataOf
        (PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r)
        (Dart (Wrap s)))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051620"><span class="hs-identifier hs-var">d''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dart (Wrap s) -&gt; Dart s)
-&gt; Vector (Dart (Wrap s)) -&gt; Vector (Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
-&gt; PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
-&gt; Vector (Dart (Wrap s))
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier hs-var">PG.boundary'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621680051622"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph (Wrap s) (VertexId' s) (Dart s) (FaceId' s) r
</span><a href="#local-6989586621680051621"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-comment">-- | The outerboundary of the face as a simple polygon. For internal</span><span>
</span><span id="line-753"></span><span class="hs-comment">-- faces the polygon that is reported has its vertices stored in CCW</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- order (as expected).</span><span>
</span><span id="line-755"></span><span class="hs-comment">--</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- pre: FaceId refers to an internal face.</span><span>
</span><span id="line-757"></span><span class="hs-comment">--</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- \(O(k)\), where \(k\) is the complexity of the outer boundary of</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- the face</span><span>
</span><span id="line-760"></span><span id="local-6989586621680052455"><span id="local-6989586621680052456"><span id="local-6989586621680052457"><span id="local-6989586621680052458"><span id="local-6989586621680052459"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#faceBoundary"><span class="hs-identifier hs-type">faceBoundary</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052459"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052459"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052458"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052457"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052456"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052455"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052458"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052455"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052456"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-761"></span><span id="faceBoundary"><span class="annot"><span class="annottext">faceBoundary :: FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceBoundary"><span class="hs-identifier hs-var hs-var">faceBoundary</span></a></span></span><span> </span><span id="local-6989586621680051618"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051618"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051617"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ v] -&gt; SimplePolygon v r
forall r p. [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Core.html#unsafeFromPoints"><span class="hs-identifier hs-var">unsafeFromPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point 2 r :+ v] -&gt; [Point 2 r :+ v]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ v]
</span><a href="#local-6989586621680051614"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r -&gt; f -&gt; SimplePolygon v r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting f (PlanarSubdivision s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051618"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-763"></span><span>    </span><span id="local-6989586621680051613"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680051613"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; Dart s
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Dart s) -&gt; Vector (Dart s) -&gt; Dart s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-var">outerBoundaryDarts</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051618"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621680051614"><span class="annot"><span class="annottext">pts :: [Point 2 r :+ v]
</span><a href="#local-6989586621680051614"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051611"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051611"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">PG.vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; VertexData r v -&gt; Point 2 r :+ v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v) (PlanarSubdivision s v e f r) (VertexData r v)
-&gt; VertexData r v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051611"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>       </span><span class="annot"><span class="annottext">(Dart s -&gt; Point 2 r :+ v) -&gt; [Dart s] -&gt; [Point 2 r :+ v]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#boundary%27"><span class="hs-identifier hs-var">boundary'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051613"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051617"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>    </span><span class="hs-comment">-- for internal faces boundary' produces the boundary darts in</span><span>
</span><span id="line-767"></span><span>    </span><span class="hs-comment">-- clockwise order. Hence, we reverse the sequence of points we</span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-comment">-- obtain to get the points/vertices in CCW order, so that we can</span><span>
</span><span id="line-769"></span><span>    </span><span class="hs-comment">-- construct a simplepolygon out of them.</span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">-- | Constructs the boundary of the given face.</span><span>
</span><span id="line-772"></span><span class="hs-comment">--</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- \(O(k)\), where \(k\) is the complexity of the face</span><span>
</span><span id="line-774"></span><span id="local-6989586621680052394"><span id="local-6989586621680052395"><span id="local-6989586621680052396"><span id="local-6989586621680052397"><span id="local-6989586621680052398"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygon"><span class="hs-identifier hs-type">internalFacePolygon</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052398"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052398"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052397"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052396"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052395"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052394"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-775"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SomePolygon"><span class="hs-identifier hs-type">SomePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052397"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052394"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052395"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-776"></span><span id="internalFacePolygon"><span class="annot"><span class="annottext">internalFacePolygon :: FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SomePolygon v r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygon"><span class="hs-identifier hs-var hs-var">internalFacePolygon</span></a></span></span><span> </span><span id="local-6989586621680051610"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051610"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680051609"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051609"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; [Dart s]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Seq (Dart s) -&gt; [Dart s]) -&gt; Seq (Dart s) -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Seq (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Seq (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#holesOf"><span class="hs-identifier hs-var">holesOf</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051610"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051609"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-777"></span><span>                        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r -&gt; SomePolygon v r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>  </span><span class="annot"><span class="annottext">SimplePolygon v r
</span><a href="#local-6989586621680051608"><span class="hs-identifier hs-var">res</span></a></span><span>                               </span><span class="annot"><span class="annottext">SomePolygon v r -&gt; f -&gt; SomePolygon v r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051607"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-778"></span><span>                        </span><span id="local-6989586621680051606"><span class="annot"><span class="annottext">[Dart s]
</span><a href="#local-6989586621680051606"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MultiPolygon v r -&gt; SomePolygon v r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimplePolygon v r -&gt; [SimplePolygon v r] -&gt; MultiPolygon v r
forall p r.
SimplePolygon p r -&gt; [SimplePolygon p r] -&gt; MultiPolygon p r
</span><a href="Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-var">MultiPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r
</span><a href="#local-6989586621680051608"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">([SimplePolygon v r] -&gt; MultiPolygon v r)
-&gt; [SimplePolygon v r] -&gt; MultiPolygon v r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; SimplePolygon v r) -&gt; [Dart s] -&gt; [SimplePolygon v r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; SimplePolygon v r
</span><a href="#local-6989586621680051604"><span class="hs-identifier hs-var">toHole</span></a></span><span> </span><span class="annot"><span class="annottext">[Dart s]
</span><a href="#local-6989586621680051606"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SomePolygon v r -&gt; f -&gt; SomePolygon v r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051607"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>    </span><span id="local-6989586621680051608"><span class="annot"><span class="annottext">SimplePolygon v r
</span><a href="#local-6989586621680051608"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680051607"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051607"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceBoundary"><span class="hs-identifier hs-var">faceBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051610"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051609"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621680051604"><span class="annot"><span class="annottext">toHole :: Dart s -&gt; SimplePolygon v r
</span><a href="#local-6989586621680051604"><span class="hs-identifier hs-var hs-var">toHole</span></a></span></span><span> </span><span id="local-6989586621680051603"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051603"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#faceBoundary"><span class="hs-identifier hs-var">faceBoundary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051603"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051609"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051609"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon v r :+ f)
-&gt; Getting
     (SimplePolygon v r) (SimplePolygon v r :+ f) (SimplePolygon v r)
-&gt; SimplePolygon v r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (SimplePolygon v r) (SimplePolygon v r :+ f) (SimplePolygon v r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span>
</span><span id="line-782"></span><span class="hs-comment">-- TODO: Verify that holes are in the right orientation.</span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">-- | Returns a sufficiently large, rectangular, polygon that contains</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- the entire planar subdivision. Each component corresponds to a hole</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- in this polygon.</span><span>
</span><span id="line-788"></span><span id="local-6989586621680052381"><span id="local-6989586621680052382"><span id="local-6989586621680052383"><span id="local-6989586621680052384"><span id="local-6989586621680052385"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon"><span class="hs-identifier hs-type">outerFacePolygon</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680052385"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680052385"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052384"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052383"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052382"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052381"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052385"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-type">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680052383"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052385"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052381"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-790"></span><span id="outerFacePolygon"><span class="annot"><span class="annottext">outerFacePolygon :: PlanarSubdivision s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon"><span class="hs-identifier hs-var hs-var">outerFacePolygon</span></a></span></span><span> </span><span id="local-6989586621680051601"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051601"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
-&gt; PlanarSubdivision s v e f r -&gt; MultiPolygon (Either () v) r :+ f
forall k v' r (s :: k) v e f.
SimplePolygon v' r
-&gt; PlanarSubdivision s v e f r -&gt; MultiPolygon (Either v' v) r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon%27"><span class="hs-identifier hs-var">outerFacePolygon'</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680051600"><span class="hs-identifier hs-var">outer</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051601"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(MultiPolygon (Either () v) r :+ f)
-&gt; ((MultiPolygon (Either () v) r :+ f)
    -&gt; MultiPolygon (Maybe v) r :+ f)
-&gt; MultiPolygon (Maybe v) r :+ f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(MultiPolygon (Either () v) r
 -&gt; Identity (MultiPolygon (Maybe v) r))
-&gt; (MultiPolygon (Either () v) r :+ f)
-&gt; Identity (MultiPolygon (Maybe v) r :+ f)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span> </span><span class="annot"><span class="annottext">((MultiPolygon (Either () v) r
  -&gt; Identity (MultiPolygon (Maybe v) r))
 -&gt; (MultiPolygon (Either () v) r :+ f)
 -&gt; Identity (MultiPolygon (Maybe v) r :+ f))
-&gt; (MultiPolygon (Either () v) r -&gt; MultiPolygon (Maybe v) r)
-&gt; (MultiPolygon (Either () v) r :+ f)
-&gt; MultiPolygon (Maybe v) r :+ f
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Either () v -&gt; Maybe v)
-&gt; MultiPolygon (Either () v) r -&gt; MultiPolygon (Maybe v) r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() -&gt; Maybe v) -&gt; (v -&gt; Maybe v) -&gt; Either () v -&gt; Maybe v
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe v -&gt; () -&gt; Maybe v
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe v
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v -&gt; Maybe v
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-792"></span><span>    </span><span id="local-6989586621680051600"><span class="annot"><span class="annottext">outer :: SimplePolygon () r
</span><a href="#local-6989586621680051600"><span class="hs-identifier hs-var hs-var">outer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; SimplePolygon () r
forall p. Rectangle p r -&gt; SimplePolygon p r
</span><a href="#local-6989586621680051599"><span class="hs-identifier hs-var">rectToPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; SimplePolygon () r)
-&gt; (PlanarSubdivision s v e f r -&gt; Rectangle () r)
-&gt; PlanarSubdivision s v e f r
-&gt; SimplePolygon () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Rectangle () r -&gt; Rectangle () r
forall r (d :: Nat) p.
(Num r, Arity d) =&gt;
r -&gt; Box d p r -&gt; Box d p r
</span><a href="Geometry.Box.Internal.html#grow"><span class="hs-identifier hs-var">grow</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; Rectangle () r)
-&gt; (PlanarSubdivision s v e f r -&gt; Rectangle () r)
-&gt; PlanarSubdivision s v e f r
-&gt; Rectangle () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Rectangle () r
forall g.
(IsBoxable g, Ord (NumType g)) =&gt;
g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var">boundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r -&gt; SimplePolygon () r)
-&gt; PlanarSubdivision s v e f r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051601"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span id="local-6989586621680051599"><span class="annot"><span class="annottext">rectToPolygon :: Rectangle p r -&gt; SimplePolygon p r
</span><a href="#local-6989586621680051599"><span class="hs-identifier hs-var hs-var">rectToPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ p] -&gt; SimplePolygon p r
forall r p. [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Core.html#unsafeFromPoints"><span class="hs-identifier hs-var">unsafeFromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; SimplePolygon p r)
-&gt; (Rectangle p r -&gt; [Point 2 r :+ p])
-&gt; Rectangle p r
-&gt; SimplePolygon p r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ p] -&gt; [Point 2 r :+ p]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [Point 2 r :+ p])
-&gt; (Rectangle p r -&gt; [Point 2 r :+ p])
-&gt; Rectangle p r
-&gt; [Point 2 r :+ p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Corners (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Corners (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; (Rectangle p r -&gt; Corners (Point 2 r :+ p))
-&gt; Rectangle p r
-&gt; [Point 2 r :+ p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rectangle p r -&gt; Corners (Point 2 r :+ p)
forall r p. Num r =&gt; Rectangle p r -&gt; Corners (Point 2 r :+ p)
</span><a href="Geometry.Box.Corners.html#corners"><span class="hs-identifier hs-var">corners</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- | Given a sufficiently large outer boundary, draw the outerface as</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- a polygon with a hole.</span><span>
</span><span id="line-797"></span><span id="local-6989586621680052433"><span id="local-6989586621680052434"><span id="local-6989586621680052435"><span id="local-6989586621680052436"><span id="local-6989586621680052437"><span id="local-6989586621680052438"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon%27"><span class="hs-identifier hs-type">outerFacePolygon'</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052438"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052437"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-798"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052436"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052435"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052434"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052433"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052437"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-type">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621680052438"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052435"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052437"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052433"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-799"></span><span id="outerFacePolygon%27"><span class="annot"><span class="annottext">outerFacePolygon' :: SimplePolygon v' r
-&gt; PlanarSubdivision s v e f r -&gt; MultiPolygon (Either v' v) r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon%27"><span class="hs-identifier hs-var hs-var">outerFacePolygon'</span></a></span></span><span> </span><span id="local-6989586621680051596"><span class="annot"><span class="annottext">SimplePolygon v' r
</span><a href="#local-6989586621680051596"><span class="hs-identifier hs-var">outer</span></a></span></span><span> </span><span id="local-6989586621680051595"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Either v' v) r
-&gt; [SimplePolygon (Either v' v) r] -&gt; MultiPolygon (Either v' v) r
forall p r.
SimplePolygon p r -&gt; [SimplePolygon p r] -&gt; MultiPolygon p r
</span><a href="Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-var">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v' -&gt; Either v' v)
-&gt; SimplePolygon v' r -&gt; SimplePolygon (Either v' v) r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">v' -&gt; Either v' v
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon v' r
</span><a href="#local-6989586621680051596"><span class="hs-identifier hs-var">outer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SimplePolygon (Either v' v) r]
</span><a href="#local-6989586621680051594"><span class="hs-identifier hs-var">holePgs</span></a></span><span> </span><span class="annot"><span class="annottext">MultiPolygon (Either v' v) r
-&gt; f -&gt; MultiPolygon (Either v' v) r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting f (PlanarSubdivision s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlanarSubdivision s v e f r)
     (DataOf (PlanarSubdivision s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051593"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-801"></span><span>    </span><span id="local-6989586621680051593"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680051593"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-802"></span><span>    </span><span id="local-6989586621680051594"><span class="annot"><span class="annottext">holePgs :: [SimplePolygon (Either v' v) r]
</span><a href="#local-6989586621680051594"><span class="hs-identifier hs-var hs-var">holePgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; SimplePolygon (Either v' v) r)
-&gt; [Dart s] -&gt; [SimplePolygon (Either v' v) r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; SimplePolygon (Either v' v) r
</span><a href="#local-6989586621680051592"><span class="hs-identifier hs-var">getBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [SimplePolygon (Either v' v) r])
-&gt; (Seq (Dart s) -&gt; [Dart s])
-&gt; Seq (Dart s)
-&gt; [SimplePolygon (Either v' v) r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; [Dart s]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Seq (Dart s) -&gt; [SimplePolygon (Either v' v) r])
-&gt; Seq (Dart s) -&gt; [SimplePolygon (Either v' v) r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Seq (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Seq (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#holesOf"><span class="hs-identifier hs-var">holesOf</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051593"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-803"></span><span>    </span><span class="hs-comment">-- get the bondary of a hole. Note that for holes, the function</span><span>
</span><span id="line-804"></span><span>    </span><span class="hs-comment">-- 'boundary' promisses to report the darts, and therefore the</span><span>
</span><span id="line-805"></span><span>    </span><span class="hs-comment">-- vertices in CCW order. Hence, we can directly construct a SimplePolygon out of it.</span><span>
</span><span id="line-806"></span><span>    </span><span id="local-6989586621680051592"><span class="annot"><span class="annottext">getBoundary :: Dart s -&gt; SimplePolygon (Either v' v) r
</span><a href="#local-6989586621680051592"><span class="hs-identifier hs-var hs-var">getBoundary</span></a></span></span><span> </span><span id="local-6989586621680051591"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051591"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ Either v' v] -&gt; SimplePolygon (Either v' v) r
forall r p. [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Geometry.Polygon.Core.html#unsafeFromPoints"><span class="hs-identifier hs-var">unsafeFromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ Either v' v] -&gt; SimplePolygon (Either v' v) r)
-&gt; ([Point 2 r :+ v] -&gt; [Point 2 r :+ Either v' v])
-&gt; [Point 2 r :+ v]
-&gt; SimplePolygon (Either v' v) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; Point 2 r :+ Either v' v)
-&gt; [Point 2 r :+ v] -&gt; [Point 2 r :+ Either v' v]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; Either v' v) -&gt; (Point 2 r :+ v) -&gt; Point 2 r :+ Either v' v
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Either v' v
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ v] -&gt; SimplePolygon (Either v' v) r)
-&gt; [Point 2 r :+ v] -&gt; SimplePolygon (Either v' v) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; [Point 2 r :+ v]
</span><a href="#local-6989586621680051590"><span class="hs-identifier hs-var">faceBoundary'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051591"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>    </span><span id="local-6989586621680051590"><span class="annot"><span class="annottext">faceBoundary' :: Dart s -&gt; [Point 2 r :+ v]
</span><a href="#local-6989586621680051590"><span class="hs-identifier hs-var hs-var">faceBoundary'</span></a></span></span><span> </span><span id="local-6989586621680051589"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051589"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680051588"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051588"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">PG.vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; VertexData r v -&gt; Point 2 r :+ v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (VertexData r v) (PlanarSubdivision s v e f r) (VertexData r v)
-&gt; VertexData r v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (VertexData r v)
</span><a href="Geometry.PlanarSubdivision.Basic.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051588"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>                      </span><span class="annot"><span class="annottext">(Dart s -&gt; Point 2 r :+ v) -&gt; [Dart s] -&gt; [Point 2 r :+ v]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#boundary%27"><span class="hs-identifier hs-var">boundary'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051589"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051595"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="hs-comment">-- | Procuces a polygon for each *internal* face of the planar</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- subdivision.</span><span>
</span><span id="line-812"></span><span id="local-6989586621680052370"><span id="local-6989586621680052371"><span id="local-6989586621680052372"><span id="local-6989586621680052373"><span id="local-6989586621680052374"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygons"><span class="hs-identifier hs-type">internalFacePolygons</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052374"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052373"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052372"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052371"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052370"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-813"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052374"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SomePolygon"><span class="hs-identifier hs-type">SomePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052373"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052370"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052371"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-814"></span><span id="internalFacePolygons"><span class="annot"><span class="annottext">internalFacePolygons :: PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygons"><span class="hs-identifier hs-var hs-var">internalFacePolygons</span></a></span></span><span> </span><span id="local-6989586621680051587"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051587"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FaceId' s, FaceData (Dart s) f)
 -&gt; (FaceId' s, SomePolygon v r :+ f))
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680051586"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051586"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051586"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SomePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; SomePolygon v r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygon"><span class="hs-identifier hs-var">internalFacePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051586"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051587"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s, FaceData (Dart s) f)
 -&gt; Vector (FaceId' s, SomePolygon v r :+ f))
-&gt; (PlanarSubdivision s v e f r
    -&gt; Vector (FaceId' s, FaceData (Dart s) f))
-&gt; PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, FaceData (Dart s) f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFaces"><span class="hs-identifier hs-var">internalFaces</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r
 -&gt; Vector (FaceId' s, SomePolygon v r :+ f))
-&gt; PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051587"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span class="hs-comment">-- | Procuces a polygon for each face of the planar subdivision.</span><span>
</span><span id="line-818"></span><span id="local-6989586621680051581"><span id="local-6989586621680051582"><span id="local-6989586621680051583"><span id="local-6989586621680051584"><span id="local-6989586621680051585"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#facePolygons"><span class="hs-identifier hs-type">facePolygons</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680051585"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680051585"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051583"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051582"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051585"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-820"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051584"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SomePolygon"><span class="hs-identifier hs-type">SomePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680051583"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680051585"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680051581"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-821"></span><span id="facePolygons"><span class="annot"><span class="annottext">facePolygons :: PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#facePolygons"><span class="hs-identifier hs-var hs-var">facePolygons</span></a></span></span><span> </span><span id="local-6989586621680051580"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051580"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FaceId' s, SomePolygon (Maybe v) r :+ f)
-&gt; Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
-&gt; Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.cons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051580"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MultiPolygon (Maybe v) r -&gt; SomePolygon (Maybe v) r)
-&gt; (MultiPolygon (Maybe v) r :+ f) -&gt; SomePolygon (Maybe v) r :+ f
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">MultiPolygon (Maybe v) r -&gt; SomePolygon (Maybe v) r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((MultiPolygon (Maybe v) r :+ f) -&gt; SomePolygon (Maybe v) r :+ f)
-&gt; (MultiPolygon (Maybe v) r :+ f) -&gt; SomePolygon (Maybe v) r :+ f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
forall k r (s :: k) v e f.
(Num r, Ord r) =&gt;
PlanarSubdivision s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerFacePolygon"><span class="hs-identifier hs-var">outerFacePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051580"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
</span><a href="#local-6989586621680051578"><span class="hs-identifier hs-var">ifs</span></a></span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-823"></span><span>    </span><span id="local-6989586621680051578"><span class="annot"><span class="annottext">ifs :: Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
</span><a href="#local-6989586621680051578"><span class="hs-identifier hs-var hs-var">ifs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FaceId' s, SomePolygon v r :+ f)
-&gt; (FaceId' s, SomePolygon (Maybe v) r :+ f)
forall k (s :: k) v r f.
(FaceId' s, SomePolygon v r :+ f)
-&gt; (FaceId' s, SomePolygon (Maybe v) r :+ f)
</span><a href="#local-6989586621680051577"><span class="hs-identifier hs-var">wrapJust</span></a></span><span> </span><span class="annot"><span class="annottext">((FaceId' s, SomePolygon v r :+ f)
 -&gt; (FaceId' s, SomePolygon (Maybe v) r :+ f))
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
-&gt; Vector (FaceId' s, SomePolygon (Maybe v) r :+ f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; Vector (FaceId' s, SomePolygon v r :+ f)
</span><a href="Geometry.PlanarSubdivision.Basic.html#internalFacePolygons"><span class="hs-identifier hs-var">internalFacePolygons</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051580"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-824"></span><span>    </span><span id="local-6989586621680052356"><span id="local-6989586621680052357"><span id="local-6989586621680052358"><span class="annot"><a href="#local-6989586621680051576"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="#local-6989586621680052358"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052358"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052357"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052356"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052358"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680052357"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052356"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-825"></span><span>    </span><span id="local-6989586621680051576"><span class="annot"><span class="annottext">g :: g a b -&gt; g (Maybe a) b
</span><a href="#local-6989586621680051576"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; g a b -&gt; g (Maybe a) b
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span>    </span><span id="local-6989586621680052376"><span id="local-6989586621680052377"><span id="local-6989586621680052378"><span id="local-6989586621680052379"><span class="annot"><a href="#local-6989586621680051577"><span class="hs-identifier hs-type">wrapJust</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052379"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SomePolygon"><span class="hs-identifier hs-type">SomePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052378"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052377"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052376"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680052379"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.Polygon.Core.html#SomePolygon"><span class="hs-identifier hs-type">SomePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680052378"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680052377"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680052376"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-829"></span><span>    </span><span id="local-6989586621680051577"><span class="annot"><span class="annottext">wrapJust :: (FaceId' s, SomePolygon v r :+ f)
-&gt; (FaceId' s, SomePolygon (Maybe v) r :+ f)
</span><a href="#local-6989586621680051577"><span class="hs-identifier hs-var hs-var">wrapJust</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680051575"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051575"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680051574"><span class="annot"><span class="annottext">SomePolygon v r
</span><a href="#local-6989586621680051574"><span class="hs-identifier hs-var">spg</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680051573"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051573"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051575"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Polygon 'Simple v r -&gt; Polygon 'Simple (Maybe v) r)
-&gt; (Polygon 'Multi v r -&gt; Polygon 'Multi (Maybe v) r)
-&gt; SomePolygon v r
-&gt; SomePolygon (Maybe v) r
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">Polygon 'Simple v r -&gt; Polygon 'Simple (Maybe v) r
forall (g :: * -&gt; * -&gt; *) a b.
Bifunctor g =&gt;
g a b -&gt; g (Maybe a) b
</span><a href="#local-6989586621680051576"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon 'Multi v r -&gt; Polygon 'Multi (Maybe v) r
forall (g :: * -&gt; * -&gt; *) a b.
Bifunctor g =&gt;
g a b -&gt; g (Maybe a) b
</span><a href="#local-6989586621680051576"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">SomePolygon v r
</span><a href="#local-6989586621680051574"><span class="hs-identifier hs-var">spg</span></a></span><span> </span><span class="annot"><span class="annottext">SomePolygon (Maybe v) r -&gt; f -&gt; SomePolygon (Maybe v) r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680051573"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="hs-comment">-- | Mapping between the internal and extenral darts</span><span>
</span><span id="line-834"></span><span id="local-6989586621680051568"><span id="local-6989586621680051569"><span id="local-6989586621680051570"><span id="local-6989586621680051571"><span id="local-6989586621680051572"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#dartMapping"><span class="hs-identifier hs-type">dartMapping</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051572"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051571"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051570"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051569"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051568"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Raw.html#Wrap"><span class="hs-identifier hs-type">Wrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051572"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051572"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-835"></span><span id="dartMapping"><span class="annot"><span class="annottext">dartMapping :: PlanarSubdivision s v e f r -&gt; Vector (Dart (Wrap s), Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#dartMapping"><span class="hs-identifier hs-var hs-var">dartMapping</span></a></span></span><span> </span><span id="local-6989586621680051567"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051567"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051567"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Dart (Wrap s), Dart s))
     (PlanarSubdivision s v e f r)
     (Vector (Dart (Wrap s), Dart s))
-&gt; Vector (Dart (Wrap s), Dart s)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
forall k (s :: k) v e f r.
ComponentId s
-&gt; Lens' (PlanarSubdivision s v e f r) (Component s r)
</span><a href="Geometry.PlanarSubdivision.Basic.html#component"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall k (s :: k). Int -&gt; ComponentId s
</span><a href="Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-var">ComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">((Component s r
  -&gt; Const (Vector (Dart (Wrap s), Dart s)) (Component s r))
 -&gt; PlanarSubdivision s v e f r
 -&gt; Const
      (Vector (Dart (Wrap s), Dart s)) (PlanarSubdivision s v e f r))
-&gt; ((Vector (Dart (Wrap s), Dart s)
     -&gt; Const
          (Vector (Dart (Wrap s), Dart s)) (Vector (Dart (Wrap s), Dart s)))
    -&gt; Component s r
    -&gt; Const (Vector (Dart (Wrap s), Dart s)) (Component s r))
-&gt; Getting
     (Vector (Dart (Wrap s), Dart s))
     (PlanarSubdivision s v e f r)
     (Vector (Dart (Wrap s), Dart s))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (Dart (Wrap s), Dart s)
 -&gt; Const
      (Vector (Dart (Wrap s), Dart s)) (Vector (Dart (Wrap s), Dart s)))
-&gt; Component s r
-&gt; Const (Vector (Dart (Wrap s), Dart s)) (Component s r)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector (Dart s, e))
  (Vector (Dart s, e'))
</span><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier hs-var">PG.dartData</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span class="hs-comment">-- data Id a = Id a</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- data Test = Test</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span class="hs-comment">-- triangle :: PlanarSubdivision Test () () PolygonFaceData Rational</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- triangle = (\pg -&gt; fromSimplePolygon (Id Test) pg Inside Outside)</span><span>
</span><span id="line-846"></span><span class="hs-comment">--          $ trianglePG</span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- trianglePG = fromPoints . map ext $ [origin, Point2 10 0, Point2 10 10]</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-comment">-- | A class for describing which features (vertex, edge, face) of a planar subdivision</span><span>
</span><span id="line-867"></span><span class="hs-comment">--   can be incident to each other.</span><span>
</span><span id="line-868"></span><span class="hs-keyword">class</span><span> </span><span id="Incident"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-var">Incident</span></a></span></span><span> </span><span id="local-6989586621680052334"><span class="annot"><a href="#local-6989586621680052334"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680052333"><span class="annot"><a href="#local-6989586621680052333"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680052332"><span class="annot"><a href="#local-6989586621680052332"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-869"></span><span>  </span><span id="local-6989586621680052337"><span id="local-6989586621680052338"><span id="local-6989586621680052339"><span id="local-6989586621680052340"><span id="incidences"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#incidences"><span class="hs-identifier hs-type">incidences</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052334"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052340"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052339"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052338"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052337"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680052332"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-870"></span><span>
</span><span id="line-871"></span><span id="local-6989586621680051565"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051565"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051565"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051565"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621680051562"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; VertexId' s -&gt; [Dart s]
</span><a href="#local-6989586621680051562"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051561"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051561"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051560"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051560"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051560"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051561"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dart s] -&gt; [Dart s] -&gt; [Dart s]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; [Dart s]) -&gt; Vector (Dart s) -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051560"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051561"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-873"></span><span>
</span><span id="line-874"></span><span id="local-6989586621680051559"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051559"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051559"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051559"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-875"></span><span>  </span><span id="local-6989586621680051557"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; VertexId' s -&gt; [FaceId' s]
</span><a href="#local-6989586621680051557"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051556"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051556"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051555"><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051555"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; FaceId' s) -&gt; [Dart s] -&gt; [FaceId' s]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s)
-&gt; PlanarSubdivision s v e f r -&gt; Dart s -&gt; FaceId' s
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051556"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dart s] -&gt; [FaceId' s]) -&gt; [Dart s] -&gt; [FaceId' s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; [Dart s]) -&gt; Vector (Dart s) -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680051555"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051556"><span class="hs-identifier hs-var">psd</span></a></span></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span id="local-6989586621680051554"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>  </span><span id="local-6989586621680051552"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; Dart s -&gt; [VertexId' s]
</span><a href="#local-6989586621680051552"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051551"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051551"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051550"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051550"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051550"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051551"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#tailOf"><span class="hs-identifier hs-var">tailOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051550"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051551"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-879"></span><span>
</span><span id="line-880"></span><span id="local-6989586621680051549"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051549"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051549"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051549"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-881"></span><span>  </span><span id="local-6989586621680051547"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; Dart s -&gt; [FaceId' s]
</span><a href="#local-6989586621680051547"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051546"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051546"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051545"><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051545"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051545"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051546"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Geometry.PlanarSubdivision.Basic.html#rightFace"><span class="hs-identifier hs-var">rightFace</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680051545"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051546"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span id="local-6989586621680051544"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-884"></span><span>  </span><span id="local-6989586621680051542"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; FaceId' s -&gt; [VertexId' s]
</span><a href="#local-6989586621680051542"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051541"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051541"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051540"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051540"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (VertexId' s) -&gt; [VertexId' s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; [VertexId' s])
-&gt; Vector (VertexId' s) -&gt; [VertexId' s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#boundaryVertices"><span class="hs-identifier hs-var">boundaryVertices</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051540"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051541"><span class="hs-identifier hs-var">psd</span></a></span></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span id="local-6989586621680051539"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051539"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051539"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051539"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-887"></span><span>  </span><span id="local-6989586621680051537"><span class="annot"><span class="annottext">incidences :: PlanarSubdivision s v e f r -&gt; FaceId' s -&gt; [Dart s]
</span><a href="#local-6989586621680051537"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidences</span></a></span></span><span> </span><span id="local-6989586621680051536"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051536"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051535"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051535"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-var">outerBoundaryDarts</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051535"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051536"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dart s] -&gt; [Dart s] -&gt; [Dart s]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s) -&gt; [Dart s] -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Dart s) -&gt; [Dart s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; [Dart s]) -&gt; Vector (Dart s) -&gt; [Dart s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Geometry.PlanarSubdivision.Basic.html#outerBoundaryDarts"><span class="hs-identifier hs-var">outerBoundaryDarts</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680051535"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051536"><span class="hs-identifier hs-var">psd</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">-- | Given two features (vertex, edge, or face) of a subdivision,</span><span>
</span><span id="line-890"></span><span class="hs-comment">--   report all features of a given type that are incident to both.</span><span>
</span><span id="line-891"></span><span id="local-6989586621680052261"><span id="local-6989586621680052262"><span id="local-6989586621680052263"><span id="local-6989586621680052264"><span id="local-6989586621680052265"><span id="local-6989586621680052266"><span id="local-6989586621680052267"><span id="local-6989586621680052268"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier hs-type">common</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052268"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052267"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052266"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052268"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052265"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052266"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680052266"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052268"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052264"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052263"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052262"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680052261"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052267"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680052265"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680052266"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-892"></span><span id="common"><span class="annot"><span class="annottext">common :: PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [c]
</span><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier hs-var hs-var">common</span></a></span></span><span> </span><span id="local-6989586621680051534"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051534"><span class="hs-identifier hs-var">psd</span></a></span></span><span> </span><span id="local-6989586621680051533"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680051533"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680051532"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680051532"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set c -&gt; [c]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set c -&gt; [c]) -&gt; Set c -&gt; [c]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set c -&gt; Set c -&gt; Set c
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[c] -&gt; Set c
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([c] -&gt; Set c) -&gt; [c] -&gt; Set c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; a -&gt; [c]
forall k (s :: k) a b v e f r.
Incident s a b =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; [b]
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidences"><span class="hs-identifier hs-var">incidences</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051534"><span class="hs-identifier hs-var">psd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680051533"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[c] -&gt; Set c
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([c] -&gt; Set c) -&gt; [c] -&gt; Set c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; b -&gt; [c]
forall k (s :: k) a b v e f r.
Incident s a b =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; [b]
</span><a href="Geometry.PlanarSubdivision.Basic.html#incidences"><span class="hs-identifier hs-var">incidences</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621680051534"><span class="hs-identifier hs-var">psd</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680051532"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-comment">-- | Given two features (edge or face) of a subdivision, report all</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- vertices that are incident to both.</span><span>
</span><span id="line-896"></span><span id="local-6989586621680051522"><span id="local-6989586621680051523"><span id="local-6989586621680051524"><span id="local-6989586621680051525"><span id="local-6989586621680051526"><span id="local-6989586621680051527"><span id="local-6989586621680051528"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonVertices"><span class="hs-identifier hs-type">commonVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051526"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051525"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051524"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051522"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051526"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051528"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-897"></span><span id="commonVertices"><span class="annot"><span class="annottext">commonVertices :: PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [VertexId' s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonVertices"><span class="hs-identifier hs-var hs-var">commonVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [VertexId' s]
forall k (s :: k) a c b v e f r.
(Incident s a c, Incident s b c, Ord c) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [c]
</span><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | Given two features (vertex or face) of a subdivision, report all</span><span>
</span><span id="line-900"></span><span class="hs-comment">--   edges that are incident to both.  Returns both darts of each</span><span>
</span><span id="line-901"></span><span class="hs-comment">--   qualifying edge.</span><span>
</span><span id="line-902"></span><span id="local-6989586621680051515"><span id="local-6989586621680051516"><span id="local-6989586621680051517"><span id="local-6989586621680051518"><span id="local-6989586621680051519"><span id="local-6989586621680051520"><span id="local-6989586621680051521"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-type">commonDarts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051519"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051518"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051517"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051515"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051519"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680051521"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-903"></span><span id="commonDarts"><span class="annot"><span class="annottext">commonDarts :: PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonDarts"><span class="hs-identifier hs-var hs-var">commonDarts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [Dart s]
forall k (s :: k) a c b v e f r.
(Incident s a c, Incident s b c, Ord c) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [c]
</span><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-comment">-- | Given two features (vertex or edge) of a subdivision, report all</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- faces that are incident to both.</span><span>
</span><span id="line-907"></span><span id="local-6989586621680051508"><span id="local-6989586621680051509"><span id="local-6989586621680051510"><span id="local-6989586621680051511"><span id="local-6989586621680051512"><span id="local-6989586621680051513"><span id="local-6989586621680051514"><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#commonFaces"><span class="hs-identifier hs-type">commonFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#Incident"><span class="hs-identifier hs-type">Incident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051512"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051511"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051510"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051509"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680051508"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680051512"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680051514"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-908"></span><span id="commonFaces"><span class="annot"><span class="annottext">commonFaces :: PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [FaceId' s]
</span><a href="Geometry.PlanarSubdivision.Basic.html#commonFaces"><span class="hs-identifier hs-var hs-var">commonFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [FaceId' s]
forall k (s :: k) a c b v e f r.
(Incident s a c, Incident s b c, Ord c) =&gt;
PlanarSubdivision s v e f r -&gt; a -&gt; b -&gt; [c]
</span><a href="Geometry.PlanarSubdivision.Basic.html#common"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-909"></span></pre></body></html>