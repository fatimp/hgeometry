<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Util.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Utility functions for th-desugar package.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable, RankNTypes, ScopedTypeVariables, TupleSections #-}</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier">newUniqueName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier">impossible</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier">nameOccursIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier">allNamesIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier">mkTypeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier">mkDataName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier">mkNameWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier">isDataName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier">stripVarP_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier">extractBoundNamesStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier">concatMapM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier">mapAccumLM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier">mapMaybeM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier">expectJustM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier">stripPlainTV_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier">thirdOf3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier">splitAtList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier">extractBoundNamesDec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier">extractBoundNamesPat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier">tvbToType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier">tvbToTypeWithSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier">tvbToTANormalWithSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier">nameMatches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier">thdOf3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier">liftFst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier">liftSnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier">firstMatch</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier">unboxedSumDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier">unboxedSumNameDegree_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier">tupleDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier">tupleNameDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier">unboxedTupleDegree_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier">unboxedTupleNameDegree_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier">splitTuple_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier">topEverywhereM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier">isInfixDataCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier">isTypeKindName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier">typeKindName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier">unSigType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier">unfoldType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVisFlag"><span class="hs-identifier">ForallVisFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier">FunArgs</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier">VisFunArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier">filterVisFunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier">ravelType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier">unravelType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier">TypeArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier">applyType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier">filterTANormals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier">probablyWrongUnTypeArg</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier">bindIP</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">cxt</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tvName</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OS</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier">OSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Fixity</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Kind</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IP</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-65"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- TH manipulations</span><span>
</span><span id="line-67"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Like newName, but even more unique (unique across different splices),</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- and with unique @nameBase@s. Precondition: the string is a valid Haskell</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- alphanumeric identifier (could be upper- or lower-case).</span><span>
</span><span id="line-72"></span><span id="local-6989586621679398525"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-type">newUniqueName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679398525"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398525"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-73"></span><span id="newUniqueName"><span class="annot"><span class="annottext">newUniqueName :: String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var hs-var">newUniqueName</span></a></span></span><span> </span><span id="local-6989586621679398524"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398524"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679398523"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398523"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (m :: * -&gt; *). Quasi m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398524"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (m :: * -&gt; *). Quasi m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q Name) -&gt; String -&gt; q Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398523"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | @mkNameWith lookup_fun mkName_fun str@ looks up the exact 'Name' of @str@</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- using the function @lookup_fun@. If it finds 'Just' the 'Name', meaning</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- that it is bound in the current scope, then it is returned. If it finds</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- 'Nothing', it assumes that @str@ is declared in the current module, and</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- uses @mkName_fun@ to construct the appropriate 'Name' to return.</span><span>
</span><span id="line-82"></span><span id="local-6989586621679398791"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-type">mkNameWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679398791"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398791"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398791"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-85"></span><span id="mkNameWith"><span class="annot"><span class="annottext">mkNameWith :: (String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var hs-var">mkNameWith</span></a></span></span><span> </span><span id="local-6989586621679398520"><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
</span><a href="#local-6989586621679398520"><span class="hs-identifier hs-var">lookup_fun</span></a></span></span><span> </span><span id="local-6989586621679398519"><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><a href="#local-6989586621679398519"><span class="hs-identifier hs-var">mkName_fun</span></a></span></span><span> </span><span id="local-6989586621679398518"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398518"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679398517"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679398517"><span class="hs-identifier hs-var">m_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
</span><a href="#local-6989586621679398520"><span class="hs-identifier hs-var">lookup_fun</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398518"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679398517"><span class="hs-identifier hs-var">m_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679398516"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398516"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398516"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Loc</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">loc_package :: Loc -&gt; String
</span><span class="hs-identifier hs-var">loc_package</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679398513"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398513"><span class="hs-identifier hs-var">pkg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc_module :: Loc -&gt; String
</span><span class="hs-identifier hs-var">loc_module</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679398511"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398511"><span class="hs-identifier hs-var">modu</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Loc
forall (m :: * -&gt; *). Quasi m =&gt; m Loc
</span><span class="hs-identifier hs-var">qLocation</span></span><span>
</span><span id="line-91"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; q Name) -&gt; Name -&gt; q Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><a href="#local-6989586621679398519"><span class="hs-identifier hs-var">mkName_fun</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398513"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398511"><span class="hs-identifier hs-var">modu</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398518"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Like TH's @lookupTypeName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679398509"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier hs-type">mkTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679398509"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398509"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-96"></span><span id="mkTypeName"><span class="annot"><span class="annottext">mkTypeName :: String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkTypeName"><span class="hs-identifier hs-var hs-var">mkTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; q (Maybe Name)
forall (m :: * -&gt; *). Quasi m =&gt; Bool -&gt; String -&gt; m (Maybe Name)
</span><span class="hs-identifier hs-var">qLookupName</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_tc</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Like TH's @lookupDataName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679398507"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier hs-type">mkDataName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679398507"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398507"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-101"></span><span id="mkDataName"><span class="annot"><span class="annottext">mkDataName :: String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkDataName"><span class="hs-identifier hs-var hs-var">mkDataName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; q (Maybe Name)
forall (m :: * -&gt; *). Quasi m =&gt; Bool -&gt; String -&gt; m (Maybe Name)
</span><span class="hs-identifier hs-var">qLookupName</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_d</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Is this name a data constructor name? A 'False' answer means &quot;unsure&quot;.</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-type">isDataName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-105"></span><span id="isDataName"><span class="annot"><span class="annottext">isDataName :: Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var hs-var">isDataName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">DataName</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var">isDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Extracts the name out of a variable pattern, or returns @Nothing@</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-type">stripVarP_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-110"></span><span id="stripVarP_maybe"><span class="annot"><span class="annottext">stripVarP_maybe :: Pat -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var hs-var">stripVarP_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679398502"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398502"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398502"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var">stripVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Extracts the name out of a @PlainTV@, or returns @Nothing@</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier hs-type">stripPlainTV_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-115"></span><span id="stripPlainTV_maybe"><span class="annot"><span class="annottext">stripPlainTV_maybe :: TyVarBndr -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier hs-var hs-var">stripPlainTV_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span id="local-6989586621679398500"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398500"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398500"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#stripPlainTV_maybe"><span class="hs-identifier hs-var">stripPlainTV_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarBndr
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Report that a certain TH construct is impossible</span><span>
</span><span id="line-119"></span><span id="local-6989586621679398498"><span id="local-6989586621679398499"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679398499"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398499"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398498"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-120"></span><span id="impossible"><span class="annot"><span class="annottext">impossible :: String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var hs-var">impossible</span></a></span></span><span> </span><span id="local-6989586621679398497"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398497"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">Fail.fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398497"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n    This should not happen in Haskell.\n    Please email rae@cs.brynmawr.edu with your code if you see this.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'Type', dropping the kind signature</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- (if it has one).</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-type">tvbToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-125"></span><span id="tvbToType"><span class="annot"><span class="annottext">tvbToType :: TyVarBndr -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var hs-var">tvbToType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; (TyVarBndr -&gt; Name) -&gt; TyVarBndr -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; Name
forall flag. TyVarBndr -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'Type', preserving the kind signature</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- (if it has one).</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-type">tvbToTypeWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-130"></span><span id="tvbToTypeWithSig"><span class="annot"><span class="annottext">tvbToTypeWithSig :: TyVarBndr -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var hs-var">tvbToTypeWithSig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span id="local-6989586621679398494"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398494"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398494"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var">tvbToTypeWithSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span id="local-6989586621679398492"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398492"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679398491"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398491"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398492"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398491"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Convert a 'TyVarBndr' into a 'TypeArg' (specifically, a 'TANormal'),</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- preserving the kind signature (if it has one).</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-type">tvbToTANormalWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span>
</span><span id="line-136"></span><span id="tvbToTANormalWithSig"><span class="annot"><span class="annottext">tvbToTANormalWithSig :: TyVarBndr -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-var hs-var">tvbToTANormalWithSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TypeArg) -&gt; (TyVarBndr -&gt; Type) -&gt; TyVarBndr -&gt; TypeArg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var">tvbToTypeWithSig</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Do two names name the same thing?</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-type">nameMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-140"></span><span id="nameMatches"><span class="annot"><span class="annottext">nameMatches :: Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var hs-var">nameMatches</span></a></span></span><span> </span><span id="local-6989586621679398488"><span class="annot"><span class="annottext">n1 :: Name
</span><a href="#local-6989586621679398488"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span id="local-6989586621679398487"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span></span><span> </span><span id="local-6989586621679398486"><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398486"><span class="hs-identifier hs-var">flav1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679398485"><span class="annot"><span class="annottext">n2 :: Name
</span><a href="#local-6989586621679398485"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span id="local-6989586621679398484"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span></span><span> </span><span id="local-6989586621679398483"><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398483"><span class="hs-identifier hs-var">flav2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><span class="hs-identifier hs-var">NameS</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398486"><span class="hs-identifier hs-var">flav1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><span class="hs-identifier hs-var">NameS</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398483"><span class="hs-identifier hs-var">flav2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679398480"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398480"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398486"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679398479"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398479"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398483"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398480"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">ModName -&gt; ModName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398479"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679398477"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398477"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398486"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398476"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398476"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398483"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398477"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">ModName -&gt; ModName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398476"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398475"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398475"><span class="hs-identifier hs-var">mod1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398486"><span class="hs-identifier hs-var">flav1</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameQ</span></span><span> </span><span id="local-6989586621679398474"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398474"><span class="hs-identifier hs-var">mod2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679398483"><span class="hs-identifier hs-var">flav2</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398475"><span class="hs-identifier hs-var">mod1</span></a></span><span> </span><span class="annot"><span class="annottext">ModName -&gt; ModName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679398474"><span class="hs-identifier hs-var">mod2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398487"><span class="hs-identifier hs-var">occ1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679398484"><span class="hs-identifier hs-var">occ2</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398488"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398485"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Extract the degree of a tuple</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-type">tupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-157"></span><span id="tupleDegree_maybe"><span class="annot"><span class="annottext">tupleDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-var hs-var">tupleDegree_maybe</span></a></span></span><span> </span><span id="local-6989586621679398473"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398473"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679398472"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398472"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398473"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679398471"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398471"><span class="hs-identifier hs-var">commas</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; Maybe (String, String))
-&gt; (String, String) -&gt; Maybe (String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398472"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679398469"><span class="annot"><span class="annottext">degree :: Int
</span><a href="#local-6989586621679398469"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398471"><span class="hs-identifier hs-var">commas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398471"><span class="hs-identifier hs-var">commas</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398469"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Extract the degree of a tuple name</span><span>
</span><span id="line-166"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-type">tupleNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-167"></span><span id="tupleNameDegree_maybe"><span class="annot"><span class="annottext">tupleNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var hs-var">tupleNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleDegree_maybe"><span class="hs-identifier hs-var">tupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int) -&gt; (Name -&gt; String) -&gt; Name -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-type">unboxedSumDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-171"></span><span id="unboxedSumDegree_maybe"><span class="annot"><span class="annottext">unboxedSumDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'|'</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum name</span><span>
</span><span id="line-174"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-type">unboxedSumNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-175"></span><span id="unboxedSumNameDegree_maybe"><span class="annot"><span class="annottext">unboxedSumNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumDegree_maybe"><span class="hs-identifier hs-var">unboxedSumDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int) -&gt; (Name -&gt; String) -&gt; Name -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Extract the degree of an unboxed tuple</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-type">unboxedTupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-179"></span><span id="unboxedTupleDegree_maybe"><span class="annot"><span class="annottext">unboxedTupleDegree_maybe :: String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedTupleDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Extract the degree of an unboxed sum or tuple</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-type">unboxedSumTupleDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-183"></span><span id="unboxedSumTupleDegree_maybe"><span class="annot"><span class="annottext">unboxedSumTupleDegree_maybe :: Char -&gt; String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumTupleDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedSumTupleDegree_maybe</span></a></span></span><span> </span><span id="local-6989586621679398464"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679398464"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621679398463"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398463"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679398462"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398462"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398463"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679398461"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398461"><span class="hs-identifier hs-var">seps</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; Maybe (String, String))
-&gt; (String, String) -&gt; Maybe (String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679398464"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398462"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679398460"><span class="annot"><span class="annottext">degree :: Int
</span><a href="#local-6989586621679398460"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398461"><span class="hs-identifier hs-var">seps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398461"><span class="hs-identifier hs-var">seps</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398460"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Extract the degree of an unboxed tuple name</span><span>
</span><span id="line-192"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-type">unboxedTupleNameDegree_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-193"></span><span id="unboxedTupleNameDegree_maybe"><span class="annot"><span class="annottext">unboxedTupleNameDegree_maybe :: Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-var hs-var">unboxedTupleNameDegree_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleDegree_maybe"><span class="hs-identifier hs-var">unboxedTupleDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int) -&gt; (Name -&gt; String) -&gt; Name -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | If the argument is a tuple type, return the components</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-type">splitTuple_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span id="splitTuple_maybe"><span class="annot"><span class="annottext">splitTuple_maybe :: Type -&gt; Maybe [Type]
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-var hs-var">splitTuple_maybe</span></a></span></span><span> </span><span id="local-6989586621679398459"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398459"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Maybe [Type]
</span><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398459"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679398458"><span class="annot"><span class="annottext">go :: [Type] -&gt; Type -&gt; Maybe [Type]
</span><a href="#local-6989586621679398458"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679398457"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398457"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398456"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398456"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span id="local-6989586621679398454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398454"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Maybe [Type]
</span><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398454"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398457"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398456"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398453"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398453"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398452"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398452"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`SigT`</span></span><span> </span><span id="local-6989586621679398451"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398451"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Maybe [Type]
</span><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398453"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398452"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398450"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398450"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679398448"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398448"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679398447"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398447"><span class="hs-identifier hs-var">degree</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var">tupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398448"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-202"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398450"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398447"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398450"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398446"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398446"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679398444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398444"><span class="hs-identifier hs-var">degree</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398446"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679398444"><span class="hs-identifier hs-var">degree</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398446"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><a href="#local-6989586621679398458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Type]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Is a @forall@ invisible (e.g., @forall a b. {...}@, with a dot) or visible</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- (e.g., @forall a b -&gt; {...}@, with an arrow)?</span><span>
</span><span id="line-211"></span><span class="hs-keyword">data</span><span> </span><span id="ForallVisFlag"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVisFlag"><span class="hs-identifier hs-var">ForallVisFlag</span></a></span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ForallVis"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span></span><span>   </span><span class="hs-comment">-- ^ A visible @forall@ (with an arrow)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForallInvis"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span></span><span> </span><span class="hs-comment">-- ^ An invisible @forall@ (with a dot)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398438"><span id="local-6989586621679398440"><span class="annot"><span class="annottext">ForallVisFlag -&gt; ForallVisFlag -&gt; Bool
(ForallVisFlag -&gt; ForallVisFlag -&gt; Bool)
-&gt; (ForallVisFlag -&gt; ForallVisFlag -&gt; Bool) -&gt; Eq ForallVisFlag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ForallVisFlag -&gt; ForallVisFlag -&gt; Bool
$c/= :: ForallVisFlag -&gt; ForallVisFlag -&gt; Bool
== :: ForallVisFlag -&gt; ForallVisFlag -&gt; Bool
$c== :: ForallVisFlag -&gt; ForallVisFlag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398431"><span id="local-6989586621679398433"><span id="local-6989586621679398435"><span class="annot"><span class="annottext">Int -&gt; ForallVisFlag -&gt; String -&gt; String
[ForallVisFlag] -&gt; String -&gt; String
ForallVisFlag -&gt; String
(Int -&gt; ForallVisFlag -&gt; String -&gt; String)
-&gt; (ForallVisFlag -&gt; String)
-&gt; ([ForallVisFlag] -&gt; String -&gt; String)
-&gt; Show ForallVisFlag
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [ForallVisFlag] -&gt; String -&gt; String
$cshowList :: [ForallVisFlag] -&gt; String -&gt; String
show :: ForallVisFlag -&gt; String
$cshow :: ForallVisFlag -&gt; String
showsPrec :: Int -&gt; ForallVisFlag -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; ForallVisFlag -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cForallInvis"><span id="%24cForallVis"><span id="%24tForallVisFlag"><span id="local-6989586621679398401"><span id="local-6989586621679398403"><span id="local-6989586621679398405"><span id="local-6989586621679398407"><span id="local-6989586621679398409"><span id="local-6989586621679398411"><span id="local-6989586621679398413"><span id="local-6989586621679398415"><span id="local-6989586621679398417"><span id="local-6989586621679398419"><span id="local-6989586621679398421"><span id="local-6989586621679398423"><span id="local-6989586621679398425"><span id="local-6989586621679398427"><span class="annot"><span class="annottext">Typeable ForallVisFlag
DataType
Constr
Typeable ForallVisFlag
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; ForallVisFlag -&gt; c ForallVisFlag)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallVisFlag)
-&gt; (ForallVisFlag -&gt; Constr)
-&gt; (ForallVisFlag -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallVisFlag))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c ForallVisFlag))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; ForallVisFlag -&gt; ForallVisFlag)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag)
-&gt; Data ForallVisFlag
ForallVisFlag -&gt; DataType
ForallVisFlag -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; ForallVisFlag -&gt; ForallVisFlag
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallVisFlag -&gt; c ForallVisFlag
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallVisFlag
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallVisFlag
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallVisFlag -&gt; c ForallVisFlag
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallVisFlag)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallVisFlag)
$cForallInvis :: Constr
$cForallVis :: Constr
$tForallVisFlag :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; ForallVisFlag -&gt; m ForallVisFlag
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ForallVisFlag -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ForallVisFlag -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; ForallVisFlag -&gt; ForallVisFlag
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; ForallVisFlag -&gt; ForallVisFlag
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallVisFlag)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ForallVisFlag)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallVisFlag)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ForallVisFlag)
dataTypeOf :: ForallVisFlag -&gt; DataType
$cdataTypeOf :: ForallVisFlag -&gt; DataType
toConstr :: ForallVisFlag -&gt; Constr
$ctoConstr :: ForallVisFlag -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallVisFlag
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ForallVisFlag
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallVisFlag -&gt; c ForallVisFlag
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ForallVisFlag -&gt; c ForallVisFlag
$cp1Data :: Typeable ForallVisFlag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | The list of arguments in a function 'Type'.</span><span>
</span><span id="line-217"></span><span class="hs-keyword">data</span><span> </span><span id="FunArgs"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-var">FunArgs</span></a></span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FANil"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- ^ No more arguments.</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FAForalls"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVisFlag"><span class="hs-identifier hs-type">ForallVisFlag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-comment">-- ^ A series of @forall@ed type variables followed by a dot (if</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">--   'ForallInvis') or an arrow (if 'ForallVis'). For example,</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-comment">--   the type variables @a1 ... an@ in @forall a1 ... an. r@.</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FACxt"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-var">FACxt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-comment">-- ^ A series of constraint arguments followed by @=&gt;@. For example,</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">--   the @(c1, ..., cn)@ in @(c1, ..., cn) =&gt; r@.</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-var">FAAnon</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow. For example, the @a@</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">--   in @a -&gt; r@.</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398388"><span id="local-6989586621679398390"><span class="annot"><span class="annottext">FunArgs -&gt; FunArgs -&gt; Bool
(FunArgs -&gt; FunArgs -&gt; Bool)
-&gt; (FunArgs -&gt; FunArgs -&gt; Bool) -&gt; Eq FunArgs
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FunArgs -&gt; FunArgs -&gt; Bool
$c/= :: FunArgs -&gt; FunArgs -&gt; Bool
== :: FunArgs -&gt; FunArgs -&gt; Bool
$c== :: FunArgs -&gt; FunArgs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398382"><span id="local-6989586621679398384"><span id="local-6989586621679398386"><span class="annot"><span class="annottext">Int -&gt; FunArgs -&gt; String -&gt; String
[FunArgs] -&gt; String -&gt; String
FunArgs -&gt; String
(Int -&gt; FunArgs -&gt; String -&gt; String)
-&gt; (FunArgs -&gt; String)
-&gt; ([FunArgs] -&gt; String -&gt; String)
-&gt; Show FunArgs
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [FunArgs] -&gt; String -&gt; String
$cshowList :: [FunArgs] -&gt; String -&gt; String
show :: FunArgs -&gt; String
$cshow :: FunArgs -&gt; String
showsPrec :: Int -&gt; FunArgs -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; FunArgs -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cFAAnon"><span id="%24cFACxt"><span id="%24cFAForalls"><span id="%24cFANil"><span id="%24tFunArgs"><span id="local-6989586621679398353"><span id="local-6989586621679398355"><span id="local-6989586621679398357"><span id="local-6989586621679398359"><span id="local-6989586621679398361"><span id="local-6989586621679398363"><span id="local-6989586621679398365"><span id="local-6989586621679398367"><span id="local-6989586621679398369"><span id="local-6989586621679398371"><span id="local-6989586621679398373"><span id="local-6989586621679398375"><span id="local-6989586621679398377"><span id="local-6989586621679398379"><span class="annot"><span class="annottext">Typeable FunArgs
DataType
Constr
Typeable FunArgs
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs)
-&gt; (FunArgs -&gt; Constr)
-&gt; (FunArgs -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs)
-&gt; Data FunArgs
FunArgs -&gt; DataType
FunArgs -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
$cFAAnon :: Constr
$cFACxt :: Constr
$cFAForalls :: Constr
$cFANil :: Constr
$tFunArgs :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; FunArgs -&gt; m FunArgs
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; FunArgs -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; FunArgs -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; FunArgs -&gt; FunArgs
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c FunArgs)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c FunArgs)
dataTypeOf :: FunArgs -&gt; DataType
$cdataTypeOf :: FunArgs -&gt; DataType
toConstr :: FunArgs -&gt; Constr
$ctoConstr :: FunArgs -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c FunArgs
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; FunArgs -&gt; c FunArgs
$cp1Data :: Typeable FunArgs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | A /visible/ function argument type (i.e., one that must be supplied</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- explicitly in the source code). This is in contrast to /invisible/</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- arguments (e.g., the @c@ in @c =&gt; r@), which are instantiated without</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- the need for explicit user input.</span><span>
</span><span id="line-236"></span><span class="hs-keyword">data</span><span> </span><span id="VisFunArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier hs-var">VisFunArg</span></a></span></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VisFADep"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFADep"><span class="hs-identifier hs-var">VisFADep</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">-- ^ A visible @forall@ (e.g., @forall a -&gt; a@).</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VisFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFAAnon"><span class="hs-identifier hs-var">VisFAAnon</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow (e.g., @a -&gt; r@).</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398342"><span id="local-6989586621679398344"><span class="annot"><span class="annottext">VisFunArg -&gt; VisFunArg -&gt; Bool
(VisFunArg -&gt; VisFunArg -&gt; Bool)
-&gt; (VisFunArg -&gt; VisFunArg -&gt; Bool) -&gt; Eq VisFunArg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VisFunArg -&gt; VisFunArg -&gt; Bool
$c/= :: VisFunArg -&gt; VisFunArg -&gt; Bool
== :: VisFunArg -&gt; VisFunArg -&gt; Bool
$c== :: VisFunArg -&gt; VisFunArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398336"><span id="local-6989586621679398338"><span id="local-6989586621679398340"><span class="annot"><span class="annottext">Int -&gt; VisFunArg -&gt; String -&gt; String
[VisFunArg] -&gt; String -&gt; String
VisFunArg -&gt; String
(Int -&gt; VisFunArg -&gt; String -&gt; String)
-&gt; (VisFunArg -&gt; String)
-&gt; ([VisFunArg] -&gt; String -&gt; String)
-&gt; Show VisFunArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [VisFunArg] -&gt; String -&gt; String
$cshowList :: [VisFunArg] -&gt; String -&gt; String
show :: VisFunArg -&gt; String
$cshow :: VisFunArg -&gt; String
showsPrec :: Int -&gt; VisFunArg -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; VisFunArg -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cVisFAAnon"><span id="%24cVisFADep"><span id="%24tVisFunArg"><span id="local-6989586621679398307"><span id="local-6989586621679398309"><span id="local-6989586621679398311"><span id="local-6989586621679398313"><span id="local-6989586621679398315"><span id="local-6989586621679398317"><span id="local-6989586621679398319"><span id="local-6989586621679398321"><span id="local-6989586621679398323"><span id="local-6989586621679398325"><span id="local-6989586621679398327"><span id="local-6989586621679398329"><span id="local-6989586621679398331"><span id="local-6989586621679398333"><span class="annot"><span class="annottext">Typeable VisFunArg
DataType
Constr
Typeable VisFunArg
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg)
-&gt; (VisFunArg -&gt; Constr)
-&gt; (VisFunArg -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg)
-&gt; Data VisFunArg
VisFunArg -&gt; DataType
VisFunArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
$cVisFAAnon :: Constr
$cVisFADep :: Constr
$tVisFunArg :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; VisFunArg -&gt; m VisFunArg
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; VisFunArg -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; VisFunArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; VisFunArg -&gt; VisFunArg
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c VisFunArg)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c VisFunArg)
dataTypeOf :: VisFunArg -&gt; DataType
$cdataTypeOf :: VisFunArg -&gt; DataType
toConstr :: VisFunArg -&gt; Constr
$ctoConstr :: VisFunArg -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c VisFunArg
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; VisFunArg -&gt; c VisFunArg
$cp1Data :: Typeable VisFunArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Filter the visible function arguments from a list of 'FunArgs'.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-type">filterVisFunArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#VisFunArg"><span class="hs-identifier hs-type">VisFunArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-245"></span><span id="filterVisFunArgs"><span class="annot"><span class="annottext">filterVisFunArgs :: FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var hs-var">filterVisFunArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span id="local-6989586621679398303"><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679398303"><span class="hs-identifier hs-var">fvf</span></a></span></span><span> </span><span id="local-6989586621679398302"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398302"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679398301"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398301"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679398303"><span class="hs-identifier hs-var">fvf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; VisFunArg) -&gt; [TyVarBndr] -&gt; [VisFunArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; VisFunArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#VisFADep"><span class="hs-identifier hs-var">VisFADep</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398302"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[VisFunArg] -&gt; [VisFunArg] -&gt; [VisFunArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[VisFunArg]
</span><a href="#local-6989586621679398300"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VisFunArg]
</span><a href="#local-6989586621679398300"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679398300"><span class="annot"><span class="annottext">args' :: [VisFunArg]
</span><a href="#local-6989586621679398300"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398301"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398299"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398299"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398299"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-type">FAAnon</span></a></span><span> </span><span id="local-6989586621679398298"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398298"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679398297"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398297"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; VisFunArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#VisFAAnon"><span class="hs-identifier hs-var">VisFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398298"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">VisFunArg -&gt; [VisFunArg] -&gt; [VisFunArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FunArgs -&gt; [VisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterVisFunArgs"><span class="hs-identifier hs-var">filterVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398297"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Reconstruct an arrow 'Type' from its argument and result types.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-type">ravelType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-259"></span><span id="ravelType"><span class="annot"><span class="annottext">ravelType :: FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var hs-var">ravelType</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span> </span><span id="local-6989586621679398296"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398296"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398296"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- We need a special case for FAForalls ForallInvis followed by FACxt so that we may</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- collapse them into a single ForallT when raveling.</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- See Note [Desugaring and sweetening ForallT] in L.H.T.Desugar.Core.</span><span>
</span><span id="line-263"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span id="local-6989586621679398295"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398295"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span id="local-6989586621679398294"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398294"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679398293"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398293"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679398292"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398292"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398295"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398294"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398293"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398292"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span>  </span><span id="local-6989586621679398290"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398290"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span>  </span><span id="local-6989586621679398289"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398289"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679398288"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398288"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398290"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398289"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398288"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-type">FAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span>   </span><span id="local-6989586621679398287"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398287"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span> </span><span id="local-6989586621679398286"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398286"><span class="hs-identifier hs-var">_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679398285"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398285"><span class="hs-identifier hs-var">_res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span>      </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallVisT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398287"><span class="hs-identifier hs-var">_tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398286"><span class="hs-identifier hs-var">_args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398285"><span class="hs-identifier hs-var">_res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Visible dependent quantification supported only on GHC 8.10+&quot;</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-type">FACxt</span></a></span><span> </span><span id="local-6989586621679398283"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398283"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679398282"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398282"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679398281"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398281"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398283"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398282"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398281"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-type">FAAnon</span></a></span><span> </span><span id="local-6989586621679398280"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398280"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679398279"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398279"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679398278"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398278"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398280"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#ravelType"><span class="hs-identifier hs-var">ravelType</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398279"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398278"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Decompose a function 'Type' into its arguments (the 'FunArgs') and its</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- result type (the 'Type).</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-type">unravelType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#FunArgs"><span class="hs-identifier hs-type">FunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="unravelType"><span class="annot"><span class="annottext">unravelType :: Type -&gt; (FunArgs, Type)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var hs-var">unravelType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679398276"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398276"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679398275"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398275"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679398274"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398274"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398273"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398273"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398272"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398272"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (FunArgs, Type)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398274"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [TyVarBndr] -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398276"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FACxt"><span class="hs-identifier hs-var">FACxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398275"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398273"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398272"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span id="local-6989586621679398271"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398271"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679398270"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398270"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398269"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398269"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398268"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398268"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (FunArgs, Type)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398270"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAAnon"><span class="hs-identifier hs-var">FAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398271"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398269"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398268"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span id="local-6989586621679398267"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398267"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679398266"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398266"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398265"><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398265"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398264"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398264"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (FunArgs, Type)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398266"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [TyVarBndr] -&gt; FunArgs -&gt; FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FAForalls"><span class="hs-identifier hs-var">FAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398267"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">FunArgs
</span><a href="#local-6989586621679398265"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398264"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span id="local-6989586621679398263"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398263"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunArgs
</span><a href="Language.Haskell.TH.Desugar.Util.html#FANil"><span class="hs-identifier hs-var">FANil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398263"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Remove all of the explicit kind signatures from a 'Type'.</span><span>
</span><span id="line-292"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-type">unSigType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-293"></span><span id="unSigType"><span class="annot"><span class="annottext">unSigType :: Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var hs-var">unSigType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679398262"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398262"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398262"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679398261"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398261"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679398260"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398260"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398261"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398260"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679398259"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398259"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679398258"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398258"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679398257"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398257"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [Type] -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679398259"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-var">unSigPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679398258"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398257"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679398254"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398254"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679398253"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398253"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679398252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398252"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">InfixT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398254"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398253"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398252"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span id="local-6989586621679398250"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398250"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679398249"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398249"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679398248"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398248"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">UInfixT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398250"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398249"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398248"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679398246"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398246"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><span class="hs-identifier hs-var">ParensT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398246"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679398244"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398244"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679398243"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398243"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398244"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398243"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679398241"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398241"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679398240"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398240"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ImplicitParamT</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398241"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398240"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span> </span><span id="local-6989586621679398239"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398239"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398239"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Remove all of the explicit kind signatures from a 'Pred'.</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-type">unSigPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 710
</span><span id="unSigPred"><span class="annot"><span class="annottext">unSigPred :: Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigPred"><span class="hs-identifier hs-var hs-var">unSigPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigType"><span class="hs-identifier hs-var">unSigType</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">unSigPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span class="hs-identifier">unSigPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">t1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSigType</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Decompose an applied type into its individual components. For example, this:</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- Proxy \@Type Char</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- would be unfolded to this:</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- ('ConT' ''Proxy, ['TyArg' ('ConT' ''Type), 'TANormal' ('ConT' ''Char)])</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-type">unfoldType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span id="unfoldType"><span class="annot"><span class="annottext">unfoldType :: Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var hs-var">unfoldType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679398238"><span class="annot"><span class="annottext">go :: [TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679398237"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398237"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398236"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398236"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398237"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398236"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398235"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398235"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679398234"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398234"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679398233"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398233"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398233"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">TypeArg -&gt; [TypeArg] -&gt; [TypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398235"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398234"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398232"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398232"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679398231"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398231"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398232"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398231"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398230"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398230"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679398229"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398229"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398230"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398229"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398228"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398228"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679398227"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398227"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679398226"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398226"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Type -&gt; (Type, [TypeArg])
</span><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398226"><span class="hs-identifier hs-var">ki</span></a></span><span class="annot"><span class="annottext">TypeArg -&gt; [TypeArg] -&gt; [TypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398228"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398227"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679398238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679398224"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398224"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679398223"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398223"><span class="hs-identifier hs-var">ty</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398223"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679398224"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | An argument to a type, either a normal type ('TANormal') or a visible</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- kind application ('TyArg').</span><span>
</span><span id="line-345"></span><span class="hs-comment">--</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- 'TypeArg' is useful when decomposing an application of a 'Type' to its</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- arguments (e.g., in 'unfoldType').</span><span>
</span><span id="line-348"></span><span class="hs-keyword">data</span><span> </span><span id="TypeArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-var">TypeArg</span></a></span></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TANormal"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TyArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398218"><span id="local-6989586621679398220"><span class="annot"><span class="annottext">TypeArg -&gt; TypeArg -&gt; Bool
(TypeArg -&gt; TypeArg -&gt; Bool)
-&gt; (TypeArg -&gt; TypeArg -&gt; Bool) -&gt; Eq TypeArg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeArg -&gt; TypeArg -&gt; Bool
$c/= :: TypeArg -&gt; TypeArg -&gt; Bool
== :: TypeArg -&gt; TypeArg -&gt; Bool
$c== :: TypeArg -&gt; TypeArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398212"><span id="local-6989586621679398214"><span id="local-6989586621679398216"><span class="annot"><span class="annottext">Int -&gt; TypeArg -&gt; String -&gt; String
[TypeArg] -&gt; String -&gt; String
TypeArg -&gt; String
(Int -&gt; TypeArg -&gt; String -&gt; String)
-&gt; (TypeArg -&gt; String)
-&gt; ([TypeArg] -&gt; String -&gt; String)
-&gt; Show TypeArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [TypeArg] -&gt; String -&gt; String
$cshowList :: [TypeArg] -&gt; String -&gt; String
show :: TypeArg -&gt; String
$cshow :: TypeArg -&gt; String
showsPrec :: Int -&gt; TypeArg -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; TypeArg -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cTyArg"><span id="%24cTANormal"><span id="%24tTypeArg"><span id="local-6989586621679398183"><span id="local-6989586621679398185"><span id="local-6989586621679398187"><span id="local-6989586621679398189"><span id="local-6989586621679398191"><span id="local-6989586621679398193"><span id="local-6989586621679398195"><span id="local-6989586621679398197"><span id="local-6989586621679398199"><span id="local-6989586621679398201"><span id="local-6989586621679398203"><span id="local-6989586621679398205"><span id="local-6989586621679398207"><span id="local-6989586621679398209"><span class="annot"><span class="annottext">Typeable TypeArg
DataType
Constr
Typeable TypeArg
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg)
-&gt; (TypeArg -&gt; Constr)
-&gt; (TypeArg -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg)
-&gt; Data TypeArg
TypeArg -&gt; DataType
TypeArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
$cTyArg :: Constr
$cTANormal :: Constr
$tTypeArg :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeArg -&gt; m TypeArg
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeArg -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeArg -&gt; TypeArg
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeArg)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeArg)
dataTypeOf :: TypeArg -&gt; DataType
$cdataTypeOf :: TypeArg -&gt; DataType
toConstr :: TypeArg -&gt; Constr
$ctoConstr :: TypeArg -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeArg
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeArg -&gt; c TypeArg
$cp1Data :: Typeable TypeArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Apply one 'Type' to a list of arguments.</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier hs-type">applyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-355"></span><span id="applyType"><span class="annot"><span class="annottext">applyType :: Type -&gt; [TypeArg] -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier hs-var hs-var">applyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TypeArg -&gt; Type) -&gt; Type -&gt; [TypeArg] -&gt; Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg -&gt; Type
</span><a href="#local-6989586621679398179"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679398179"><span class="annot"><span class="annottext">apply :: Type -&gt; TypeArg -&gt; Type
</span><a href="#local-6989586621679398179"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679398178"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398178"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679398177"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398177"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398178"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398177"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span id="local-6989586621679398176"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679398175"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398175"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>                           </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppKindT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398175"><span class="hs-identifier hs-var">_x</span></a></span><span class="hs-cpp">
#else
</span><span>                           </span><span class="hs-comment">-- VKA isn't supported, so</span><span>
</span><span id="line-364"></span><span>                           </span><span class="hs-comment">-- conservatively drop the argument</span><span>
</span><span id="line-365"></span><span>                           </span><span class="hs-identifier">f</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Filter the normal type arguments from a list of 'TypeArg's.</span><span>
</span><span id="line-369"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-type">filterTANormals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span id="filterTANormals"><span class="annot"><span class="annottext">filterTANormals :: [TypeArg] -&gt; [Type]
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-var hs-var">filterTANormals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeArg -&gt; Maybe Type) -&gt; [TypeArg] -&gt; [Type]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; Maybe Type
</span><a href="#local-6989586621679398173"><span class="hs-identifier hs-var">getTANormal</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621679398173"><span class="hs-identifier hs-type">getTANormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679398173"><span class="annot"><span class="annottext">getTANormal :: TypeArg -&gt; Maybe Type
</span><a href="#local-6989586621679398173"><span class="hs-identifier hs-var hs-var">getTANormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679398172"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398172"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398172"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="#local-6989586621679398173"><span class="hs-identifier hs-var">getTANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Extract the underlying 'Type' or 'Kind' from a 'TypeArg'. This forgets</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- information about whether a type is a normal argument or not, so use with</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- caution.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-type">probablyWrongUnTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-380"></span><span id="probablyWrongUnTypeArg"><span class="annot"><span class="annottext">probablyWrongUnTypeArg :: TypeArg -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-var hs-var">probablyWrongUnTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679398171"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398171"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398171"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-381"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-var">probablyWrongUnTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679398170"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398170"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679398170"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- Free names, etc.</span><span>
</span><span id="line-385"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Check if a name occurs anywhere within a TH tree.</span><span>
</span><span id="line-388"></span><span id="local-6989586621679398169"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier hs-type">nameOccursIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679398169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-389"></span><span id="nameOccursIn"><span class="annot"><span class="annottext">nameOccursIn :: Name -&gt; a -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameOccursIn"><span class="hs-identifier hs-var hs-var">nameOccursIn</span></a></span></span><span> </span><span id="local-6989586621679398168"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398168"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool) -&gt; GenericQ Bool -&gt; GenericQ Bool
forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="annot"><span class="annottext">(GenericQ Bool -&gt; GenericQ Bool) -&gt; GenericQ Bool -&gt; GenericQ Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Name -&gt; Bool) -&gt; a -&gt; Bool
forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398168"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Extract all Names mentioned in a TH tree.</span><span>
</span><span id="line-392"></span><span id="local-6989586621679398164"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier hs-type">allNamesIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679398164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-393"></span><span id="allNamesIn"><span class="annot"><span class="annottext">allNamesIn :: a -&gt; [Name]
</span><a href="Language.Haskell.TH.Desugar.Util.html#allNamesIn"><span class="hs-identifier hs-var hs-var">allNamesIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [Name] -&gt; [Name]) -&gt; GenericQ [Name] -&gt; GenericQ [Name]
forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">(GenericQ [Name] -&gt; GenericQ [Name])
-&gt; GenericQ [Name] -&gt; GenericQ [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; (Name -&gt; [Name]) -&gt; a -&gt; [Name]
forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Extract the names bound in a @Stmt@</span><span>
</span><span id="line-396"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-type">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-397"></span><span id="extractBoundNamesStmt"><span class="annot"><span class="annottext">extractBoundNamesStmt :: Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var hs-var">extractBoundNamesStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679398162"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398162"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398162"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679398160"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679398160"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; OSet Name) -&gt; [Dec] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679398160"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name
forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span id="local-6989586621679398155"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679398155"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Stmt] -&gt; OSet Name) -&gt; [[Stmt]] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679398155"><span class="hs-identifier hs-var">stmtss</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span id="local-6989586621679398153"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679398153"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679398153"><span class="hs-identifier hs-var">stmtss</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | Extract the names bound in a @Dec@ that could appear in a @let@ expression.</span><span>
</span><span id="line-406"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-type">extractBoundNamesDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-407"></span><span id="extractBoundNamesDec"><span class="annot"><span class="annottext">extractBoundNamesDec :: Dec -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var hs-var">extractBoundNamesDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679398151"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398151"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OSet Name
forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398151"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-408"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679398148"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398148"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Body
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398148"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-409"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesDec"><span class="hs-identifier hs-var">extractBoundNamesDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name
forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Extract the names bound in a @Pat@</span><span>
</span><span id="line-412"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-type">extractBoundNamesPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-413"></span><span id="extractBoundNamesPat"><span class="annot"><span class="annottext">extractBoundNamesPat :: Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var hs-var">extractBoundNamesPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitP</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name
forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-414"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679398146"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398146"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OSet Name
forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398146"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-415"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupP</span></span><span> </span><span id="local-6989586621679398144"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398144"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; OSet Name) -&gt; [Pat] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398144"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupP</span></span><span> </span><span id="local-6989586621679398142"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398142"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; OSet Name) -&gt; [Pat] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398142"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398140"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398140"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; OSet Name) -&gt; [Pat] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398140"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixP</span></span><span> </span><span id="local-6989586621679398138"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398138"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398137"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398137"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398138"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name -&gt; OSet Name -&gt; OSet Name
forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-419"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398137"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixP</span></span><span> </span><span id="local-6989586621679398134"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398134"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398133"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398133"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398134"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name -&gt; OSet Name -&gt; OSet Name
forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-421"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398133"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-422"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensP</span></span><span> </span><span id="local-6989586621679398131"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398131"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398131"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TildeP</span></span><span> </span><span id="local-6989586621679398129"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398129"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398129"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BangP</span></span><span> </span><span id="local-6989586621679398127"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398127"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398127"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsP</span></span><span> </span><span id="local-6989586621679398125"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398125"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679398124"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398124"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OSet Name
forall a. a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#singleton"><span class="hs-identifier hs-var">OS.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398125"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name -&gt; OSet Name -&gt; OSet Name
forall a. Ord a =&gt; OSet a -&gt; OSet a -&gt; OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#union"><span class="hs-operator hs-var">`OS.union`</span></a></span><span>
</span><span id="line-426"></span><span>                                             </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398124"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name
forall a. OSet a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#empty"><span class="hs-identifier hs-var">OS.empty</span></a></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398121"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679398121"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398120"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398120"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldPat] -&gt; ([Name], [Pat])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679398121"><span class="hs-identifier hs-var">field_pats</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-429"></span><span>                                             </span><span class="annot"><span class="annottext">(Pat -&gt; OSet Name) -&gt; [Pat] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398120"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListP</span></span><span> </span><span id="local-6989586621679398117"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398117"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; OSet Name) -&gt; [Pat] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679398117"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigP</span></span><span> </span><span id="local-6989586621679398115"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398115"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398115"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViewP</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398113"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398113"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398113"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumP</span></span><span> </span><span id="local-6989586621679398111"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398111"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679398111"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-437"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- General utility</span><span>
</span><span id="line-439"></span><span class="hs-comment">----------------------------------------</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-comment">-- dirty implementation of explicit-to-implicit conversion</span><span>
</span><span id="line-443"></span><span class="hs-keyword">newtype</span><span> </span><span id="MagicIP"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span></span><span> </span><span id="local-6989586621679398637"><span class="annot"><a href="#local-6989586621679398637"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span id="local-6989586621679398636"><span class="annot"><a href="#local-6989586621679398636"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679398635"><span class="annot"><a href="#local-6989586621679398635"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MagicIP"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IP</span></span><span> </span><span class="annot"><a href="#local-6989586621679398637"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398636"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398635"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Get an implicit param constraint (@IP name a@, which is the desugared</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- form of @(?name :: a)@) from an explicit value.</span><span>
</span><span id="line-447"></span><span class="hs-comment">--</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- This function is only available with GHC 8.0 or later.</span><span>
</span><span id="line-449"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier hs-type">bindIP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679398109"><span class="annot"><a href="#local-6989586621679398109"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span id="local-6989586621679398108"><span class="annot"><a href="#local-6989586621679398108"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679398107"><span class="annot"><a href="#local-6989586621679398107"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679398108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IP</span></span><span> </span><span class="annot"><a href="#local-6989586621679398109"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398107"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398107"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-450"></span><span id="bindIP"><span class="annot"><span class="annottext">bindIP :: a -&gt; (IP name a =&gt; r) -&gt; r
</span><a href="Language.Haskell.TH.Desugar.Util.html#bindIP"><span class="hs-identifier hs-var hs-var">bindIP</span></a></span></span><span> </span><span id="local-6989586621679398106"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398106"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679398105"><span class="annot"><span class="annottext">IP name a =&gt; r
</span><a href="#local-6989586621679398105"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MagicIP name a r -&gt; a -&gt; r
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IP name a =&gt; r) -&gt; MagicIP name a r
forall (name :: Symbol) a r. (IP name a =&gt; r) -&gt; MagicIP name a r
</span><a href="Language.Haskell.TH.Desugar.Util.html#MagicIP"><span class="hs-identifier hs-var">MagicIP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679398109"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="annottext">IP name a =&gt; r
</span><a href="#local-6989586621679398105"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679398108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398107"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398106"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-454"></span><span id="local-6989586621679398631"><span id="local-6989586621679398632"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-type">splitAtList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398632"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398631"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398631"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398631"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-455"></span><span id="splitAtList"><span class="annot"><span class="annottext">splitAtList :: [a] -&gt; [b] -&gt; ([b], [b])
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var hs-var">splitAtList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679398104"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398104"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398104"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679398103"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398103"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398102"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679398102"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679398101"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398101"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398100"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398100"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398099"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398099"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b] -&gt; ([b], [b])
forall a b. [a] -&gt; [b] -&gt; ([b], [b])
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398103"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398101"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679398102"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398100"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398099"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span id="local-6989586621679398096"><span id="local-6989586621679398097"><span id="local-6989586621679398098"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-type">thdOf3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398098"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679398097"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679398096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398096"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-462"></span><span id="thdOf3"><span class="annot"><span class="annottext">thdOf3 :: (a, b, c) -&gt; c
</span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var hs-var">thdOf3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679398095"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398095"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398095"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span id="local-6989586621679398092"><span id="local-6989586621679398093"><span id="local-6989586621679398094"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier hs-type">liftFst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398094"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398093"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398094"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398092"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398093"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398092"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-465"></span><span id="liftFst"><span class="annot"><span class="annottext">liftFst :: (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
</span><a href="Language.Haskell.TH.Desugar.Util.html#liftFst"><span class="hs-identifier hs-var hs-var">liftFst</span></a></span></span><span> </span><span id="local-6989586621679398091"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398091"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398090"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679398089"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398089"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398091"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398090"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398089"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span id="local-6989586621679398086"><span id="local-6989586621679398087"><span id="local-6989586621679398088"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier hs-type">liftSnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398087"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398086"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398086"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398087"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-468"></span><span id="liftSnd"><span class="annot"><span class="annottext">liftSnd :: (a -&gt; b) -&gt; (c, a) -&gt; (c, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#liftSnd"><span class="hs-identifier hs-var hs-var">liftSnd</span></a></span></span><span> </span><span id="local-6989586621679398085"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398084"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398084"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679398083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398083"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398084"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398083"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span id="local-6989586621679398079"><span id="local-6989586621679398080"><span id="local-6989586621679398081"><span id="local-6989586621679398082"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-type">thirdOf3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398082"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398081"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398080"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398079"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398080"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398079"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398081"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-471"></span><span id="thirdOf3"><span class="annot"><span class="annottext">thirdOf3 :: (a -&gt; b) -&gt; (c, d, a) -&gt; (c, d, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-var hs-var">thirdOf3</span></a></span></span><span> </span><span id="local-6989586621679398078"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398078"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398077"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398077"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398076"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679398076"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398075"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679398077"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679398076"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679398078"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398075"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- lift concatMap into a monad</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- could this be more efficient?</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- | Concatenate the result of a @mapM@</span><span>
</span><span id="line-476"></span><span id="local-6989586621679398071"><span id="local-6989586621679398072"><span id="local-6989586621679398073"><span id="local-6989586621679398074"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-type">concatMapM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679398074"><span class="hs-identifier hs-type">monad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679398073"><span class="hs-identifier hs-type">monoid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679398072"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398074"><span class="hs-identifier hs-type">monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398073"><span class="hs-identifier hs-type">monoid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398072"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398074"><span class="hs-identifier hs-type">monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398073"><span class="hs-identifier hs-type">monoid</span></a></span></span></span></span></span><span>
</span><span id="line-478"></span><span id="concatMapM"><span class="annot"><span class="annottext">concatMapM :: (a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var hs-var">concatMapM</span></a></span></span><span> </span><span id="local-6989586621679398070"><span class="annot"><span class="annottext">a -&gt; monad monoid
</span><a href="#local-6989586621679398070"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679398069"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679398069"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621679398068"><span class="annot"><span class="annottext">t monoid
</span><a href="#local-6989586621679398068"><span class="hs-identifier hs-var">bss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; monad monoid) -&gt; t a -&gt; monad (t monoid)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; monad monoid
</span><a href="#local-6989586621679398070"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679398069"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><span class="annottext">monoid -&gt; monad monoid
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(monoid -&gt; monad monoid) -&gt; monoid -&gt; monad monoid
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t monoid -&gt; monoid
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">t monoid
</span><a href="#local-6989586621679398068"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | Monadic version of mapAccumL</span><span>
</span><span id="line-484"></span><span id="local-6989586621679398601"><span id="local-6989586621679398602"><span id="local-6989586621679398603"><span id="local-6989586621679398604"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-type">mapAccumLM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679398604"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-485"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398603"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398602"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398603"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398601"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ combining function</span><span>
</span><span id="line-486"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398603"><span class="hs-identifier hs-type">acc</span></a></span><span>                      </span><span class="hs-comment">-- ^ initial state</span><span>
</span><span id="line-487"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398602"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>                      </span><span class="hs-comment">-- ^ inputs</span><span>
</span><span id="line-488"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398603"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398601"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- ^ final state, outputs</span></span></span></span></span><span>
</span><span id="line-489"></span><span id="mapAccumLM"><span class="annot"><span class="annottext">mapAccumLM :: (acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; [x] -&gt; m (acc, [y])
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var hs-var">mapAccumLM</span></a></span></span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679398066"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398066"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(acc, [y]) -&gt; m (acc, [y])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398066"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span id="local-6989586621679398065"><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679398065"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679398064"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398064"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398063"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679398063"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679398062"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679398062"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679398061"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398061"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398060"><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679398060"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679398065"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398064"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679398063"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679398059"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398059"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679398058"><span class="annot"><span class="annottext">[y]
</span><a href="#local-6989586621679398058"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; [x] -&gt; m (acc, [y])
forall (m :: * -&gt; *) acc x y.
Monad m =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; [x] -&gt; m (acc, [y])
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="annot"><span class="annottext">acc -&gt; x -&gt; m (acc, y)
</span><a href="#local-6989586621679398065"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398061"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679398062"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><span class="annottext">(acc, [y]) -&gt; m (acc, [y])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679398059"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679398060"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">y -&gt; [y] -&gt; [y]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[y]
</span><a href="#local-6989586621679398058"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- like GHC's</span><span>
</span><span id="line-496"></span><span id="local-6989586621679398595"><span id="local-6989586621679398596"><span id="local-6989586621679398597"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-type">mapMaybeM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679398597"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398597"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679398595"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398597"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398595"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-497"></span><span id="mapMaybeM"><span class="annot"><span class="annottext">mapMaybeM :: (a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var hs-var">mapMaybeM</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; m [b]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span id="local-6989586621679398057"><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679398057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679398056"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398056"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679398055"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398055"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679398054"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679398054"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679398057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398056"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679398053"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398053"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679398057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398055"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">[b] -&gt; m [b]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; m [b]) -&gt; [b] -&gt; m [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679398054"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398053"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679398052"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679398052"><span class="hs-identifier hs-var">z</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679398052"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679398053"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span id="local-6989586621679398050"><span id="local-6989586621679398051"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-type">expectJustM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679398051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679398050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398050"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-506"></span><span id="expectJustM"><span class="annot"><span class="annottext">expectJustM :: String -&gt; Maybe a -&gt; m a
</span><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-var hs-var">expectJustM</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679398049"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398049"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398049"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-507"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#expectJustM"><span class="hs-identifier hs-var">expectJustM</span></a></span><span> </span><span id="local-6989586621679398048"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398048"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">Fail.fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679398048"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span id="local-6989586621679398046"><span id="local-6989586621679398047"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-type">firstMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398047"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679398046"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398047"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679398046"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-510"></span><span id="firstMatch"><span class="annot"><span class="annottext">firstMatch :: (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var hs-var">firstMatch</span></a></span></span><span> </span><span id="local-6989586621679398045"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679398045"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679398044"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398044"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Maybe b
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Maybe b) -&gt; [b] -&gt; Maybe b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679398045"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679398044"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Semi-shallow version of 'everywhereM' - does not recurse into children of nodes of type @a@ (only applies the handler to them).</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- &gt;&gt;&gt; topEverywhereM (pure . fmap (*10) :: [Integer] -&gt; Identity [Integer]) ([1,2,3] :: [Integer], &quot;foo&quot; :: String)</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- Identity ([10,20,30],&quot;foo&quot;)</span><span>
</span><span id="line-516"></span><span class="hs-comment">--</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- &gt;&gt;&gt; everywhereM (mkM (pure . fmap (*10) :: [Integer] -&gt; Identity [Integer])) ([1,2,3] :: [Integer], &quot;foo&quot; :: String)</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- Identity ([10,200,3000],&quot;foo&quot;)</span><span>
</span><span id="line-519"></span><span id="local-6989586621679398583"><span id="local-6989586621679398584"><span id="local-6989586621679398585"><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-type">topEverywhereM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679398585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679398584"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679398583"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398584"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398584"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-520"></span><span id="topEverywhereM"><span class="annot"><span class="annottext">topEverywhereM :: (a -&gt; m a) -&gt; b -&gt; m b
</span><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-var hs-var">topEverywhereM</span></a></span></span><span> </span><span id="local-6989586621679398042"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679398042"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-521"></span><span>  </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; m d) -&gt; b -&gt; m b
forall a (m :: * -&gt; *).
(Data a, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">gmapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m a) -&gt; d -&gt; m d
forall a b (m :: * -&gt; *).
(Typeable a, Data b, Monad m) =&gt;
(a -&gt; m a) -&gt; b -&gt; m b
</span><a href="Language.Haskell.TH.Desugar.Util.html#topEverywhereM"><span class="hs-identifier hs-var">topEverywhereM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679398042"><span class="hs-identifier hs-var">handler</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; m b) -&gt; (a -&gt; m a) -&gt; b -&gt; m b
forall (m :: * -&gt; *) a b.
(Monad m, Typeable a, Typeable b) =&gt;
(a -&gt; m a) -&gt; (b -&gt; m b) -&gt; a -&gt; m a
</span><span class="hs-operator hs-var">`extM`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679398042"><span class="hs-identifier hs-var">handler</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- Checks if a String names a valid Haskell infix data constructor</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- (i.e., does it begin with a colon?).</span><span>
</span><span id="line-525"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-type">isInfixDataCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-526"></span><span id="isInfixDataCon"><span class="annot"><span class="annottext">isInfixDataCon :: String -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var hs-var">isInfixDataCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-527"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var">isInfixDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-comment">-- | Returns 'True' if the argument 'Name' is that of 'Kind.Type'</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- (or @*@ or 'Kind.&#9733;', to support older GHCs).</span><span>
</span><span id="line-531"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier hs-type">isTypeKindName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-532"></span><span id="isTypeKindName"><span class="annot"><span class="annottext">isTypeKindName :: Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isTypeKindName"><span class="hs-identifier hs-var hs-var">isTypeKindName</span></a></span></span><span> </span><span id="local-6989586621679398039"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398039"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679398039"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 805
</span><span>                </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">starKindName</span><span>
</span><span id="line-535"></span><span>                </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">uniStarKindName</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- | The 'Name' of:</span><span>
</span><span id="line-539"></span><span class="hs-comment">--</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- 1. The kind 'Kind.Type', on GHC 8.0 or later.</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- 2. The kind @*@ on older GHCs.</span><span>
</span><span id="line-542"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-type">typeKindName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span id="typeKindName"><span class="annot"><span class="annottext">typeKindName :: Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var hs-var">typeKindName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Kind.Type</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">typeKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">starKindName</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 805
</span><span class="hs-comment">-- | The 'Name' of the kind @*@.</span><span>
</span><span id="line-551"></span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">Kind.*</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkNameG_tc</span><span> </span><span class="hs-string">&quot;ghc-prim&quot;</span><span> </span><span class="hs-string">&quot;GHC.Prim&quot;</span><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- | The 'Name' of:</span><span>
</span><span id="line-559"></span><span class="hs-comment">--</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- 1. The kind 'Kind.&#9733;', on GHC 8.0 or later.</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- 2. The kind @*@ on older GHCs.</span><span>
</span><span id="line-562"></span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">Kind.&#9733;</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">uniStarKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">starKindName</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span></pre></body></html>