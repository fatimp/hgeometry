<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Core.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Desugars full Template Haskell syntax into a smaller core syntax for further
processing. The desugared types and constructors are prefixed with a D.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell, LambdaCase, CPP, ScopedTypeVariables,
             TupleSections, DeriveDataTypeable, DeriveGeneric #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Core</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">and</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">match</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clause</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cxt</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Zip</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">notElem</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.OverloadedLabels</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromLabel</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IP</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.AST</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.FV.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.FV</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OS</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier">OSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Reify</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Desugar an expression</span><span>
</span><span id="line-63"></span><span id="local-6989586621679403495"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-type">dsExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403495"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403495"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-64"></span><span id="dsExp"><span class="annot"><span class="annottext">dsExp :: Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var hs-var">dsExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679403045"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403045"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403045"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679403042"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403042"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403042"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitE</span></span><span> </span><span id="local-6989586621679403039"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679403039"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679403039"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppE</span></span><span> </span><span id="local-6989586621679403036"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403036"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679403035"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403035"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403036"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403035"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679403031"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403031"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403031"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403030"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403030"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679403029"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403029"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403029"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403030"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679403028"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403028"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403027"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403027"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679403026"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403026"><span class="hs-identifier hs-var">lhsName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lhs&quot;</span></span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679403024"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679403024"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403028"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679403023"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679403023"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403027"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403026"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679403024"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403026"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679403023"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403021"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403021"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679403020"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403020"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403019"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403019"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403020"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403021"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403019"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensE</span></span><span> </span><span id="local-6989586621679403016"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403016"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403016"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamE</span></span><span> </span><span id="local-6989586621679403014"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679403014"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679403013"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403013"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679403014"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; q DExp -&gt; q DExp
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679403013"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamCaseE</span></span><span> </span><span id="local-6989586621679403009"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679403009"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679403008"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403008"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679403007"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679403007"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403008"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679403009"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403008"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679403008"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679403007"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupE</span></span><span> </span><span id="local-6989586621679403003"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679403003"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679403003"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupE</span></span><span> </span><span id="local-6989586621679402999"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679402999"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679402999"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CondE</span></span><span> </span><span id="local-6989586621679402996"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402996"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679402995"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402995"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679402994"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402994"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402996"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402995"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402994"><span class="hs-identifier hs-var">e3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MultiIfE</span></span><span> </span><span id="local-6989586621679402988"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402988"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402987"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679402987"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive guards in multi-way if&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402988"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402987"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetE</span></span><span> </span><span id="local-6989586621679402983"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402983"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679402982"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402982"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402981"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402981"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402980"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402980"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402983"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679402978"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402978"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402982"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402981"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402980"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402978"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- the following special case avoids creating a new &quot;let&quot; when it's not</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- necessary. See #34.</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679402976"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402976"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402975"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402975"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679402974"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402974"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402976"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402975"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402976"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402974"><span class="hs-identifier hs-var">matches'</span></a></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span id="local-6989586621679402973"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402973"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679402972"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402972"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679402971"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402971"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scrutinee&quot;</span></span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679402970"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402970"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402973"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679402969"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402969"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402971"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402972"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402971"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402970"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-107"></span><span>           </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402971"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402969"><span class="hs-identifier hs-var">matches'</span></a></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DoE</span></span><span> </span><span id="local-6989586621679402965"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402965"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402965"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompE</span></span><span> </span><span id="local-6989586621679402962"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402962"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402962"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromR</span></span><span> </span><span id="local-6989586621679402958"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402958"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFrom</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402958"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenR</span></span><span> </span><span id="local-6989586621679402956"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402956"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679402955"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402955"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThen</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402956"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402955"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromToR</span></span><span> </span><span id="local-6989586621679402953"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402953"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679402952"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402952"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402953"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402952"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenToR</span></span><span> </span><span id="local-6989586621679402950"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402950"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679402949"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402949"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679402948"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402948"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThenTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402950"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-117"></span><span>                               </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402949"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402948"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListE</span></span><span> </span><span id="local-6989586621679402946"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679402946"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; q DExp
forall (m :: * -&gt; *). DsMonad m =&gt; [Exp] -&gt; m DExp
</span><a href="#local-6989586621679402945"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679402946"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679402945"><span class="annot"><span class="annottext">go :: [Exp] -&gt; m DExp
</span><a href="#local-6989586621679402945"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; m DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; m DExp) -&gt; DExp -&gt; m DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="#local-6989586621679402945"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402944"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402944"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402943"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679402943"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; m DExp -&gt; m (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; m DExp -&gt; m DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402944"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (DExp -&gt; DExp) -&gt; m DExp -&gt; m DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; m DExp
</span><a href="#local-6989586621679402945"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679402943"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigE</span></span><span> </span><span id="local-6989586621679402941"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402941"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679402940"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402940"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DType -&gt; DExp) -&gt; q DExp -&gt; q (DType -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402941"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DExp) -&gt; q DType -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402940"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecConE</span></span><span> </span><span id="local-6989586621679402936"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402936"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679402935"><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402935"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679402934"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402934"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Con
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402936"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679402932"><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679402932"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [DExp]
forall (m :: * -&gt; *). DsMonad m =&gt; Con -&gt; m [DExp]
</span><a href="#local-6989586621679402931"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402934"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402936"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679402932"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679402931"><span class="annot"><span class="annottext">reorder :: Con -&gt; m [DExp]
</span><a href="#local-6989586621679402931"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679402930"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402930"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402930"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679402928"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402928"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402927"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402927"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679402926"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402927"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-130"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679402924"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402924"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679402923"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402923"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402922"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402922"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679402926"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402924"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402922"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679402920"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402920"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402919"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402919"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; m [DExp]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679402918"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402919"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-132"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402916"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402916"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; m [DExp]
</span><a href="#local-6989586621679402931"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402916"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679402914"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402914"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679402913"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402913"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679402912"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402912"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679402926"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402913"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-135"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679402910"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402910"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679402909"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402909"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679402908"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402908"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; m [DExp]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679402918"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402909"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679402918"><span class="annot"><span class="annottext">reorder_fields :: [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679402918"><span class="hs-identifier hs-var hs-var">reorder_fields</span></a></span></span><span> </span><span id="local-6989586621679402907"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402907"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402936"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402907"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402935"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-139"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DExp]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; [DExp]) -&gt; DExp -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679402926"><span class="annot"><span class="annottext">non_record :: t a -&gt; m [DExp]
</span><a href="#local-6989586621679402926"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679402904"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679402904"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldExp] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402935"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-142"></span><span>                        </span><span class="hs-comment">-- Special case: record construction is allowed for any</span><span>
</span><span id="line-143"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-144"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that no</span><span>
</span><span id="line-145"></span><span>                        </span><span class="hs-comment">-- records are given in the expression itself. (See #59).</span><span>
</span><span id="line-146"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con undefined ... undefined.</span><span>
</span><span id="line-148"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; m [DExp]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DExp] -&gt; m [DExp]) -&gt; [DExp] -&gt; m [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DExp -&gt; [DExp]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679402904"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; [DExp]) -&gt; DExp -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; m [DExp]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m [DExp]) -&gt; String -&gt; m [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-152"></span><span>                                       </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402936"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecUpdE</span></span><span> </span><span id="local-6989586621679402897"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402897"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679402896"><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- here, we need to use one of the field names to find the tycon, somewhat dodgily</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679402895"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402895"><span class="hs-identifier hs-var">first_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679402894"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402894"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402894"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-158"></span><span>                  </span><span class="annot"><span class="annottext">[FieldExp]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record update with no fields listed.&quot;</span></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679402893"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679402893"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402895"><span class="hs-identifier hs-var">first_name</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679402891"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402891"><span class="hs-identifier hs-var">applied_type</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679402893"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679402889"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402889"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402888"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402888"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402887"><span class="annot"><span class="annottext">Maybe Dec
</span><a href="#local-6989586621679402887"><span class="hs-identifier hs-var">_m_dec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402888"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span>                    </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_m_dec</span><span> </span><span class="hs-identifier">_fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">extract_first_arg</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>                    </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Type
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record update with an invalid field name.&quot;</span></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679402885"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402885"><span class="hs-identifier hs-var">type_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402891"><span class="hs-identifier hs-var">applied_type</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402883"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402883"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; q ([TyVarBndr], [Con])
forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This seems to be an error in GHC.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402885"><span class="hs-identifier hs-var">type_name</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402881"><span class="annot"><span class="annottext">filtered_cons :: [Con]
</span><a href="#local-6989586621679402881"><span class="hs-identifier hs-var hs-var">filtered_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; [Name] -&gt; [Con]
forall (t :: * -&gt; *). Foldable t =&gt; [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679402880"><span class="hs-identifier hs-var">filter_cons_with_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402883"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldExp -&gt; Name) -&gt; [FieldExp] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldExp -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">field_exps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679402879"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402879"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402897"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679402878"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402878"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q DMatch) -&gt; [Con] -&gt; q [DMatch]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; q DMatch
forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402881"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402876"><span class="annot"><span class="annottext">all_matches :: [DMatch]
</span><a href="#local-6989586621679402876"><span class="hs-identifier hs-var hs-var">all_matches</span></a></span></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402881"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402883"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402878"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402878"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; [DMatch] -&gt; [DMatch]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679402875"><span class="hs-identifier hs-var">error_match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402879"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402876"><span class="hs-identifier hs-var">all_matches</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679403440"><span class="annot"><a href="#local-6989586621679402886"><span class="hs-identifier hs-type">extract_first_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403440"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403440"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679402886"><span class="annot"><span class="annottext">extract_first_arg :: Type -&gt; q Type
</span><a href="#local-6989586621679402886"><span class="hs-identifier hs-var hs-var">extract_first_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span id="local-6989586621679402872"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402872"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402872"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402870"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402870"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402870"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679402868"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402868"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402868"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621679402886"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Type
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record selector not a function.&quot;</span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679403439"><span class="annot"><a href="#local-6989586621679402884"><span class="hs-identifier hs-type">extract_type_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403439"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403439"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679402884"><span class="annot"><span class="annottext">extract_type_name :: Type -&gt; q Name
</span><a href="#local-6989586621679402884"><span class="hs-identifier hs-var hs-var">extract_type_name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679402867"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402867"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402867"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679402866"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402866"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402866"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679402864"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402864"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402864"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679402884"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record selector domain not a datatype.&quot;</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679402880"><span class="annot"><span class="annottext">filter_cons_with_names :: [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679402880"><span class="hs-identifier hs-var hs-var">filter_cons_with_names</span></a></span></span><span> </span><span id="local-6989586621679402863"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402863"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679402862"><span class="annot"><span class="annottext">t Name
</span><a href="#local-6989586621679402862"><span class="hs-identifier hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">(Con -&gt; Bool) -&gt; [Con] -&gt; [Con]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402863"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>        </span><span id="local-6989586621679402860"><span class="annot"><span class="annottext">args_contain_names :: [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679402860"><span class="hs-identifier hs-var hs-var">args_contain_names</span></a></span></span><span> </span><span id="local-6989586621679402859"><span class="annot"><span class="annottext">[(Name, b, c)]
</span><a href="#local-6989586621679402859"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402858"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679402858"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, b, c) -&gt; Name) -&gt; [(Name, b, c)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Name, b, c) -&gt; Name
forall a b c. (a, b, c) -&gt; a
</span><a href="#local-6989586621679402857"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, b, c)]
</span><a href="#local-6989586621679402859"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-194"></span><span>          </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; t Name -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402858"><span class="hs-identifier hs-var">con_field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Name
</span><a href="#local-6989586621679402862"><span class="hs-identifier hs-var">field_names</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621679402861"><span class="annot"><span class="annottext">has_names :: Con -&gt; Bool
</span><a href="#local-6989586621679402861"><span class="hs-identifier hs-var hs-var">has_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679402856"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402856"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679402855"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402855"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">[VarBangType] -&gt; Bool
forall b c. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679402860"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402855"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="annot"><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679402854"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402854"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679402853"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402853"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679402852"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402852"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>          </span><span class="annot"><span class="annottext">[VarBangType] -&gt; Bool
forall b c. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679402860"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402853"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>        </span><span class="annot"><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402851"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402851"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402851"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="#local-6989586621679402861"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679402850"><span class="annot"><span class="annottext">rec_con_to_dmatch :: Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679402850"><span class="hs-identifier hs-var hs-var">rec_con_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679402849"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402849"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679402848"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402848"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402847"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679402847"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Name) -&gt; [VarBangType] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Name
forall a b c. (a, b, c) -&gt; a
</span><a href="#local-6989586621679402857"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402848"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span id="local-6989586621679402846"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402846"><span class="hs-identifier hs-var">field_var_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Name) -&gt; [Name] -&gt; m [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m Name) -&gt; (Name -&gt; String) -&gt; Name -&gt; m Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402847"><span class="hs-identifier hs-var">con_field_names</span></a></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402849"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; [Name] -&gt; [DPat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402846"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DMatch) -&gt; m DExp -&gt; m DMatch
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-209"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402849"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DExp] -&gt; DExp) -&gt; m [DExp] -&gt; m DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-210"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; m [DExp]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402849"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402848"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679402896"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402846"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679403428"><span class="annot"><a href="#local-6989586621679402877"><span class="hs-identifier hs-type">con_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403428"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403428"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679402877"><span class="annot"><span class="annottext">con_to_dmatch :: Con -&gt; q DMatch
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var hs-var">con_to_dmatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679402841"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402841"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679402840"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402840"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; q DMatch
forall (m :: * -&gt; *).
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679402850"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402841"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402840"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-comment">-- We're assuming the GADT constructor has only one Name here, but since</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- this constructor was reified, this assumption should always hold true.</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679402839"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402839"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679402838"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402838"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679402837"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402837"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; q DMatch
forall (m :: * -&gt; *).
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679402850"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402839"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402838"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402836"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402836"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q DMatch
forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402836"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="#local-6989586621679402877"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DMatch
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error within th-desugar.&quot;</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679402875"><span class="annot"><span class="annottext">error_match :: DMatch
</span><a href="#local-6989586621679402875"><span class="hs-identifier hs-var hs-var">error_match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns in record update&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679402857"><span class="annot"><span class="annottext">fst_of_3 :: (a, b, c) -&gt; a
</span><a href="#local-6989586621679402857"><span class="hs-identifier hs-var hs-var">fst_of_3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402834"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402834"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679402834"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StaticE</span></span><span> </span><span id="local-6989586621679402832"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402832"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStaticE"><span class="hs-identifier hs-var">DStaticE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402832"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboundVarE</span></span><span> </span><span id="local-6989586621679402829"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402829"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402829"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppTypeE</span></span><span> </span><span id="local-6989586621679402827"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402827"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679402826"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402826"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-var">DAppTypeE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DType -&gt; DExp) -&gt; q DExp -&gt; q (DType -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402827"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DExp) -&gt; q DType -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402826"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumE</span></span><span> </span><span id="local-6989586621679402823"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402823"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679402822"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402822"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679402821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402821"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402822"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402821"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402823"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LabelE</span></span><span> </span><span id="local-6989586621679402818"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402818"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">fromLabel</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402818"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamVarE</span></span><span> </span><span id="local-6989586621679402814"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402814"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ip</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402814"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MDoE</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span id="local-6989586621679403476"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-type">dsTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403476"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403476"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-247"></span><span id="dsTup"><span class="annot"><span class="annottext">dsTup :: (Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var hs-var">dsTup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var">ds_tup</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Exp</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DExp</span><span>
</span><span id="line-250"></span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-identifier">tuple_data_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ds_tup</span><span> </span><span class="hs-identifier">tuple_data_name</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Just</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Desugar a tuple (or tuple section) expression.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-type">ds_tup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679402811"><span class="annot"><a href="#local-6989586621679402811"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402811"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-255"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Compute the 'Name' of a tuple (boxed or unboxed)</span><span>
</span><span id="line-256"></span><span>                        </span><span class="hs-comment">--   data constructor from its arity.</span><span>
</span><span id="line-257"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ The tuple's subexpressions. 'Nothing' entries</span><span>
</span><span id="line-258"></span><span>                        </span><span class="hs-comment">--   denote empty fields in a tuple section.</span><span>
</span><span id="line-259"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402811"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-260"></span><span id="ds_tup"><span class="annot"><span class="annottext">ds_tup :: (Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var hs-var">ds_tup</span></a></span></span><span> </span><span id="local-6989586621679402810"><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679402810"><span class="hs-identifier hs-var">tuple_data_name</span></a></span></span><span> </span><span id="local-6989586621679402809"><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679402809"><span class="hs-identifier hs-var">mb_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679402808"><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402808"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Maybe Exp -&gt; q (Either Name DExp))
-&gt; [Maybe Exp] -&gt; q [Either Name DExp]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679402807"><span class="hs-identifier hs-var">ds_section_exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679402809"><span class="hs-identifier hs-var">mb_exps</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402806"><span class="annot"><span class="annottext">section_vars :: [Name]
</span><a href="#local-6989586621679402806"><span class="hs-identifier hs-var hs-var">section_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; [Name]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402808"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621679402805"><span class="annot"><span class="annottext">tup_body :: DExp
</span><a href="#local-6989586621679402805"><span class="hs-identifier hs-var hs-var">tup_body</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679402804"><span class="hs-identifier hs-var">mk_tup_body</span></a></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402808"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402806"><span class="hs-identifier hs-var">section_vars</span></a></span><span>
</span><span id="line-265"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402805"><span class="hs-identifier hs-var">tup_body</span></a></span><span> </span><span class="hs-comment">-- If this isn't a tuple section,</span><span>
</span><span id="line-266"></span><span>                          </span><span class="hs-comment">-- don't create a lambda.</span><span>
</span><span id="line-267"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; [Name] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402806"><span class="hs-identifier hs-var">section_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402805"><span class="hs-identifier hs-var">tup_body</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- If dealing with an empty field in a tuple section (Nothing), create a</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- unique name and return Left. These names will be used to construct the</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- lambda expression that it desugars to.</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- (For example, `(,5)` desugars to `\ts -&gt; (,) ts 5`.)</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">-- If dealing with a tuple subexpression (Just), desugar it and return</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- Right.</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621679402807"><span class="hs-identifier hs-type">ds_section_exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402811"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679402807"><span class="annot"><span class="annottext">ds_section_exp :: Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679402807"><span class="hs-identifier hs-var hs-var">ds_section_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q (Either Name DExp)
-&gt; (Exp -&gt; q (Either Name DExp))
-&gt; Maybe Exp
-&gt; q (Either Name DExp)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Either Name DExp
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Either Name DExp) -&gt; q Name -&gt; q (Either Name DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ts&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; Either Name DExp) -&gt; q DExp -&gt; q (Either Name DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; Either Name DExp
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(q DExp -&gt; q (Either Name DExp))
-&gt; (Exp -&gt; q DExp) -&gt; Exp -&gt; q (Either Name DExp)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="#local-6989586621679402804"><span class="hs-identifier hs-type">mk_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679402804"><span class="annot"><span class="annottext">mk_tup_body :: [Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679402804"><span class="hs-identifier hs-var hs-var">mk_tup_body</span></a></span></span><span> </span><span id="local-6989586621679402800"><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402800"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">(DExp -&gt; Either Name DExp -&gt; DExp)
-&gt; DExp -&gt; [Either Name DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679402798"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679402810"><span class="hs-identifier hs-var">tuple_data_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402800"><span class="hs-identifier hs-var">section_exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>             </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679402800"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621679402798"><span class="hs-identifier hs-type">apply_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679402798"><span class="annot"><span class="annottext">apply_tup_body :: DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679402798"><span class="hs-identifier hs-var hs-var">apply_tup_body</span></a></span></span><span> </span><span id="local-6989586621679402797"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402797"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679402796"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402796"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402797"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402796"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="#local-6989586621679402798"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span id="local-6989586621679402795"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402795"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679402794"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402794"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402795"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402794"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Desugar a lambda expression, where the body has already been desugared</span><span>
</span><span id="line-289"></span><span id="local-6989586621679403482"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-type">dsLam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403482"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403482"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-290"></span><span id="dsLam"><span class="annot"><span class="annottext">dsLam :: [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var hs-var">dsLam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; Maybe Name)
-&gt; ([Pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *) pat.
DsMonad q =&gt;
(pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var">mkLam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var">stripVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | Convert a list of 'DPat' arguments and a 'DExp' body into a 'DLamE'. This</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- is needed since 'DLamE' takes a list of 'Name's for its bound variables</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- instead of 'DPat's, so some reorganization is needed.</span><span>
</span><span id="line-295"></span><span id="local-6989586621679403374"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-type">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403374"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403374"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-296"></span><span id="mkDLamEFromDPats"><span class="annot"><span class="annottext">mkDLamEFromDPats :: [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var hs-var">mkDLamEFromDPats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; Maybe Name)
-&gt; ([DPat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [DPat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *) pat.
DsMonad q =&gt;
(pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var">mkLam</span></a></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Maybe Name
</span><a href="#local-6989586621679402789"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402788"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402788"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679402787"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402787"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([DPat], DExp) -&gt; q ([DPat], DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402788"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402787"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="#local-6989586621679402789"><span class="hs-identifier hs-type">stripDVarP_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679402789"><span class="annot"><span class="annottext">stripDVarP_maybe :: DPat -&gt; Maybe Name
</span><a href="#local-6989586621679402789"><span class="hs-identifier hs-var hs-var">stripDVarP_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679402786"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402786"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402786"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621679402789"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Generalizes 'dsLam' and 'mkDLamEFromDPats' to work over an arbitrary</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- pattern type.</span><span>
</span><span id="line-304"></span><span id="local-6989586621679403396"><span id="local-6989586621679403397"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-type">mkLam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403397"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403396"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Should return @'Just' n@ if the argument is a</span><span>
</span><span id="line-306"></span><span>                             </span><span class="hs-comment">--   variable pattern, and 'Nothing' otherwise.</span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403396"><span class="hs-identifier hs-type">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403397"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                             </span><span class="hs-comment">-- ^ Should process a list of @pat@ arguments and</span><span>
</span><span id="line-309"></span><span>                             </span><span class="hs-comment">--   a 'DExp' body. (This might do some internal</span><span>
</span><span id="line-310"></span><span>                             </span><span class="hs-comment">--   reorganization if there are as-patterns, as</span><span>
</span><span id="line-311"></span><span>                             </span><span class="hs-comment">--   in the case of 'dsPatsOverExp'.)</span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403396"><span class="hs-identifier hs-type">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403397"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span></span><span>
</span><span id="line-313"></span><span id="mkLam"><span class="annot"><span class="annottext">mkLam :: (pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var hs-var">mkLam</span></a></span></span><span> </span><span id="local-6989586621679402785"><span class="annot"><span class="annottext">pat -&gt; Maybe Name
</span><a href="#local-6989586621679402785"><span class="hs-identifier hs-var">mb_strip_var_pat</span></a></span></span><span> </span><span id="local-6989586621679402784"><span class="annot"><span class="annottext">[pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="#local-6989586621679402784"><span class="hs-identifier hs-var">process_pats_over_exp</span></a></span></span><span> </span><span id="local-6989586621679402783"><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679402782"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402782"><span class="hs-identifier hs-var">exp</span></a></span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679402781"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402781"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(pat -&gt; Maybe Name) -&gt; [pat] -&gt; Maybe [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">pat -&gt; Maybe Name
</span><a href="#local-6989586621679402785"><span class="hs-identifier hs-var">mb_strip_var_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402781"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402782"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679402780"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402780"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; q Name -&gt; q [Name]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402778"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679402778"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402780"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679402776"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402776"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402775"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402775"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="#local-6989586621679402784"><span class="hs-identifier hs-var">process_pats_over_exp</span></a></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679402783"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402782"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-320"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402774"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679402774"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402776"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402775"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-321"></span><span>       </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402780"><span class="hs-identifier hs-var">arg_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402778"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679402774"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | Desugar a list of matches for a @case@ statement</span><span>
</span><span id="line-324"></span><span id="local-6989586621679403477"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-type">dsMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403477"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-325"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>     </span><span class="hs-comment">-- ^ Name of the scrutinee, which must be a bare var</span><span>
</span><span id="line-326"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Matches of the @case@ statement</span><span>
</span><span id="line-327"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403477"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-328"></span><span id="dsMatches"><span class="annot"><span class="annottext">dsMatches :: Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var hs-var">dsMatches</span></a></span></span><span> </span><span id="local-6989586621679402772"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402772"><span class="hs-identifier hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679402771"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679403388"><span class="annot"><a href="#local-6989586621679402771"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403388"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403388"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679402771"><span class="annot"><span class="annottext">go :: [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679402771"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621679402771"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span> </span><span id="local-6989586621679402770"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402770"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402769"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402769"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679402768"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402768"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402767"><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402767"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679402766"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402766"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679402771"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679402767"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402765"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679402765"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402772"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402766"><span class="hs-identifier hs-var">rest'</span></a></span><span>  </span><span class="hs-comment">-- this might be an empty case.</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621679402764"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402764"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402769"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402768"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402765"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679402762"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402762"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402761"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402761"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402770"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402764"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span id="local-6989586621679402759"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402759"><span class="hs-identifier hs-var">uni_pattern</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402762"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="hs-comment">-- incomplete attempt at #6</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402759"><span class="hs-identifier hs-var">uni_pattern</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402762"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402761"><span class="hs-identifier hs-var">exp''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402762"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402761"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; [DMatch] -&gt; [DMatch]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402766"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Desugar a @Body@</span><span>
</span><span id="line-343"></span><span id="local-6989586621679403386"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-type">dsBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403386"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-344"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Body</span></span><span>      </span><span class="hs-comment">-- ^ body to desugar</span><span>
</span><span id="line-345"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ &quot;where&quot; declarations</span><span>
</span><span id="line-346"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>      </span><span class="hs-comment">-- ^ what to do if the guards don't match</span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403386"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-348"></span><span id="dsBody"><span class="annot"><span class="annottext">dsBody :: Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var hs-var">dsBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679402757"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402757"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402756"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402756"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402755"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402755"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402754"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402754"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402756"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679402753"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402753"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402757"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402755"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402754"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402753"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-352"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GuardedB</span></span><span> </span><span id="local-6989586621679402750"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402750"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402749"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402749"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679402748"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402748"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402747"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402747"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402746"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402746"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402749"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621679402745"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402745"><span class="hs-identifier hs-var">guarded_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402750"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402748"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402747"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402746"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402745"><span class="hs-identifier hs-var">guarded_exp'</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | If decs is non-empty, delcare them in a let:</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-type">maybeDLetE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-359"></span><span id="maybeDLetE"><span class="annot"><span class="annottext">maybeDLetE :: [DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var hs-var">maybeDLetE</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679402744"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402744"><span class="hs-identifier hs-var">exp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402744"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span id="local-6989586621679402743"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402743"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679402742"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402742"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402743"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402742"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | If matches is non-empty, make a case statement; otherwise make an error statement</span><span>
</span><span id="line-363"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-type">maybeDCaseE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-364"></span><span id="maybeDCaseE"><span class="annot"><span class="annottext">maybeDCaseE :: String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var hs-var">maybeDCaseE</span></a></span></span><span> </span><span id="local-6989586621679402740"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402740"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402740"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621679402739"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402739"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621679402738"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402739"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402738"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Desugar guarded expressions</span><span>
</span><span id="line-368"></span><span id="local-6989586621679403472"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-type">dsGuards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403472"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-369"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Guarded expressions</span><span>
</span><span id="line-370"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>            </span><span class="hs-comment">-- ^ What to do if none of the guards match</span><span>
</span><span id="line-371"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403472"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-372"></span><span id="dsGuards"><span class="annot"><span class="annottext">dsGuards :: [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var hs-var">dsGuards</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679402737"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402737"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402737"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalG</span></span><span> </span><span id="local-6989586621679402735"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402735"><span class="hs-identifier hs-var">gd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402734"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402734"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402733"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402733"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402732"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402732"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt] -&gt; Guard
</span><span class="hs-identifier hs-var">PatG</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402735"><span class="hs-identifier hs-var">gd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402734"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Guard, Exp) -&gt; [(Guard, Exp)] -&gt; [(Guard, Exp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402733"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402732"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-375"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatG</span></span><span> </span><span id="local-6989586621679402729"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402729"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402728"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402728"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402727"><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402727"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402726"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402726"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679402725"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402725"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402728"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679402724"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402724"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679402727"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402726"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402729"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402725"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402724"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a guard</span><span>
</span><span id="line-381"></span><span id="local-6989586621679403381"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-type">dsGuardStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403381"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-382"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The @Stmt@s to desugar</span><span>
</span><span id="line-383"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield success</span><span>
</span><span id="line-384"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield failure</span><span>
</span><span id="line-385"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403381"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-386"></span><span id="dsGuardStmts"><span class="annot"><span class="annottext">dsGuardStmts :: [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var hs-var">dsGuardStmts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679402722"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402722"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679402721"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402721"><span class="hs-identifier hs-var">_failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402722"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-387"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679402719"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402719"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402718"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402718"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402717"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402717"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402716"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679402715"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402715"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621679402714"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402714"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402717"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402715"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402713"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402713"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402712"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402712"><span class="hs-identifier hs-var">success''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402719"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402714"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621679402711"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402711"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402718"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402711"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402713"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402712"><span class="hs-identifier hs-var">success''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402715"><span class="hs-identifier hs-var">failure</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679402709"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402709"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402708"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402708"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402707"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402707"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679402706"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402706"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402705"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402705"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402704"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402704"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402709"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679402703"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402703"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402708"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402707"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402706"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402705"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402704"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402703"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-comment">-- special-case a final pattern containing &quot;otherwise&quot; or &quot;True&quot;</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- note that GHC does this special-casing, too, in DsGRHSs.isTrueLHsExpr</span><span>
</span><span id="line-398"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402702"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679402701"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402701"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679402700"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402700"><span class="hs-identifier hs-var">_failure</span></a></span></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679402699"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402699"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402699"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402701"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679402698"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402698"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402698"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402701"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402697"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402696"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402696"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402695"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679402694"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679402693"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402693"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402697"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679402692"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402692"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402696"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402695"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402693"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402692"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-410"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402694"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Parallel comprehension in a pattern guard.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a @do@ expression</span><span>
</span><span id="line-417"></span><span id="local-6989586621679403467"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-type">dsDoStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403467"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403467"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-418"></span><span id="dsDoStmts"><span class="annot"><span class="annottext">dsDoStmts :: [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var hs-var">dsDoStmts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;do-expression ended with something other than bare statement.&quot;</span></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402689"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402689"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402689"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679402688"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402688"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402687"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402686"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679402685"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402685"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402688"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402685"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;do expression&quot;</span></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679402683"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402683"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402682"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402682"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402681"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402681"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402680"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402680"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402683"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679402679"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402679"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402682"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402681"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402680"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402679"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402678"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402678"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402677"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402677"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679402676"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402676"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402678"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621679402675"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402675"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402677"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402676"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402675"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Parallel comprehension in a do-statement.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a list or monad comprehension</span><span>
</span><span id="line-437"></span><span id="local-6989586621679402674"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-type">dsComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402674"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402674"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-438"></span><span id="dsComp"><span class="annot"><span class="annottext">dsComp :: [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var hs-var">dsComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List/monad comprehension ended with something other than a bare statement.&quot;</span></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402673"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">return</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679402672"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402672"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402671"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402671"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402670"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402670"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621679402669"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402669"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402670"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402671"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402672"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402669"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;monad comprehension&quot;</span></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679402668"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402667"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402666"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402666"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402665"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402665"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402668"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621679402664"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402664"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402667"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402666"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402665"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402664"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679402663"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402663"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402662"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402662"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679402661"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402663"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621679402660"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402660"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402662"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">guard</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402660"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-451"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span id="local-6989586621679402659"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679402659"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402658"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402658"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402657"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402657"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402656"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402656"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Stmt]] -&gt; q (Pat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679402659"><span class="hs-identifier hs-var">stmtss</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621679402654"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402654"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402658"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402656"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402657"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402654"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- Desugar a binding statement in a do- or list comprehension.</span><span>
</span><span id="line-460"></span><span class="hs-comment">--</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- In the event that the pattern in the statement is partial, the desugared</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- case expression will contain a catch-all case that calls 'fail' from either</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- 'MonadFail' or 'Monad', depending on whether the @MonadFailDesugaring@</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- language extension is enabled or not. (On GHCs older than 8.0, 'fail' from</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- 'Monad' is always used.)</span><span>
</span><span id="line-466"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-type">dsBindS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679403378"><span class="annot"><a href="#local-6989586621679403378"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403378"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403378"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-467"></span><span id="dsBindS"><span class="annot"><span class="annottext">dsBindS :: Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var hs-var">dsBindS</span></a></span></span><span> </span><span id="local-6989586621679402653"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span></span><span> </span><span id="local-6989586621679402652"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402652"><span class="hs-identifier hs-var">success_pat</span></a></span></span><span> </span><span id="local-6989586621679402651"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402651"><span class="hs-identifier hs-var">success_exp</span></a></span></span><span> </span><span id="local-6989586621679402650"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402650"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621679402649"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402649"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402653"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402648"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">success_pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402647"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">success_exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402652"><span class="hs-identifier hs-var">success_pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402651"><span class="hs-identifier hs-var">success_exp</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679402646"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">is_univ_pat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">success_pat'</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402645"><span class="annot"><span class="annottext">bind_into :: DExp -&gt; DExp
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var hs-var">bind_into</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402649"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">is_univ_pat</span></a></span><span>
</span><span id="line-473"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">success_pat'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-474"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679402644"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402644"><span class="hs-identifier hs-var">arg_name</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-475"></span><span>             </span><span id="local-6989586621679402643"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402643"><span class="hs-identifier hs-var">fail_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Name
</span><a href="#local-6989586621679402642"><span class="hs-identifier hs-var">mk_fail_name</span></a></span><span>
</span><span id="line-476"></span><span>             </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402644"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402644"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402648"><span class="hs-identifier hs-var">success_pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-478"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DMatch) -&gt; DExp -&gt; DMatch
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-479"></span><span>                 </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402643"><span class="hs-identifier hs-var">fail_name</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-480"></span><span>                   </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Lit) -&gt; String -&gt; Lit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern match failure in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402650"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><a href="#local-6989586621679402642"><span class="hs-identifier hs-type">mk_fail_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679403378"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="hs-comment">-- GHC 8.8 deprecates the MonadFailDesugaring extension since its effects</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-comment">-- are always enabled. Furthermore, MonadFailDesugaring is no longer</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- enabled by default, so simply use MonadFail.fail. (That happens to</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-comment">-- be the same as Prelude.fail in 8.8+.)</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679402642"><span class="annot"><span class="annottext">mk_fail_name :: q Name
</span><a href="#local-6989586621679402642"><span class="hs-identifier hs-var hs-var">mk_fail_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MonadFail.fail</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">qIsExtEnabled</span><span> </span><span class="hs-identifier">MonadFailDesugaring</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MonadFail.fail</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Prelude.fail</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Prelude.fail</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | Desugar the contents of a parallel comprehension.</span><span>
</span><span id="line-499"></span><span class="hs-comment">--   Returns a @Pat@ containing a tuple of all bound variables and an expression</span><span>
</span><span id="line-500"></span><span class="hs-comment">--   to produce the values for those variables</span><span>
</span><span id="line-501"></span><span id="local-6989586621679403376"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-type">dsParComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403376"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403376"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-502"></span><span id="dsParComp"><span class="annot"><span class="annottext">dsParComp :: [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var hs-var">dsParComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Pat, DExp)
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty list of parallel comprehension statements.&quot;</span></span><span>
</span><span id="line-503"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679402641"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402641"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402640"><span class="annot"><span class="annottext">rv :: OSet Name
</span><a href="#local-6989586621679402640"><span class="hs-identifier hs-var hs-var">rv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621679402637"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402637"><span class="hs-identifier hs-var">dsR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402641"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; [Stmt] -&gt; [Stmt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402640"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><span class="annottext">(Pat, DExp) -&gt; q (Pat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var">mk_tuple_pat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402640"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402637"><span class="hs-identifier hs-var">dsR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402634"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402634"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402633"><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679402633"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402632"><span class="annot"><span class="annottext">qv :: OSet Name
</span><a href="#local-6989586621679402632"><span class="hs-identifier hs-var hs-var">qv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402634"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402631"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402631"><span class="hs-identifier hs-var">rest_pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402630"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402630"><span class="hs-identifier hs-var">rest_exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Stmt]] -&gt; q (Pat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679402633"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span id="local-6989586621679402629"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402629"><span class="hs-identifier hs-var">dsQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679402634"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; [Stmt] -&gt; [Stmt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402632"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402628"><span class="annot"><span class="annottext">zipped :: DExp
</span><a href="#local-6989586621679402628"><span class="hs-identifier hs-var hs-var">zipped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">mzip</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402629"><span class="hs-identifier hs-var">dsQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402630"><span class="hs-identifier hs-var">rest_exp</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="annottext">(Pat, DExp) -&gt; q (Pat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var">mk_tuple_pat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402632"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402631"><span class="hs-identifier hs-var">rest_pat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402628"><span class="hs-identifier hs-var">zipped</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-515"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-type">mk_tuple_stmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span>
</span><span id="line-516"></span><span id="mk_tuple_stmt"><span class="annot"><span class="annottext">mk_tuple_stmt :: OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var hs-var">mk_tuple_stmt</span></a></span></span><span> </span><span id="local-6989586621679402627"><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402627"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; [Exp] -&gt; [Exp]) -&gt; [Exp] -&gt; OSet Name -&gt; [Exp]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; [Exp] -&gt; [Exp]) -&gt; (Name -&gt; Exp) -&gt; Name -&gt; [Exp] -&gt; [Exp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402627"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-520"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-type">mk_tuple_pat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-521"></span><span id="mk_tuple_pat"><span class="annot"><span class="annottext">mk_tuple_pat :: OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var hs-var">mk_tuple_pat</span></a></span></span><span> </span><span id="local-6989586621679402625"><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402625"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><span class="annottext">[Pat] -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var">mkTuplePat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; [Pat] -&gt; [Pat]) -&gt; [Pat] -&gt; OSet Name -&gt; [Pat]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; [Pat] -&gt; [Pat]) -&gt; (Name -&gt; Pat) -&gt; Name -&gt; [Pat] -&gt; [Pat]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679402625"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-- | Desugar a pattern, along with processing a (desugared) expression that</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- is the entire scope of the variables bound in the pattern.</span><span>
</span><span id="line-526"></span><span id="local-6989586621679403385"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-type">dsPatOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403385"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403385"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-527"></span><span id="dsPatOverExp"><span class="annot"><span class="annottext">dsPatOverExp :: Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var hs-var">dsPatOverExp</span></a></span></span><span> </span><span id="local-6989586621679402623"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402623"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402622"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402622"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402621"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402621"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402620"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402620"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)]))
-&gt; WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402623"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402617"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679402617"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402620"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><span class="annottext">(DPat, DExp) -&gt; q (DPat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402621"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402617"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402622"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- | Desugar multiple patterns. Like 'dsPatOverExp'.</span><span>
</span><span id="line-533"></span><span id="local-6989586621679403395"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-type">dsPatsOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403395"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403395"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-534"></span><span id="dsPatsOverExp"><span class="annot"><span class="annottext">dsPatsOverExp :: [Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var hs-var">dsPatsOverExp</span></a></span></span><span> </span><span id="local-6989586621679402613"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402613"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679402612"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402612"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402611"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402611"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402610"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402610"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)]))
-&gt; WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402613"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402609"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679402609"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402610"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="annottext">([DPat], DExp) -&gt; q ([DPat], DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402611"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402609"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402612"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | Desugar a pattern, returning a list of (Name, DExp) pairs of extra</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- variables that must be bound within the scope of the pattern</span><span>
</span><span id="line-541"></span><span id="local-6989586621679403291"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-type">dsPatX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403291"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403291"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-542"></span><span id="dsPatX"><span class="annot"><span class="annottext">dsPatX :: Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var hs-var">dsPatX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)]))
-&gt; (Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; Pat
-&gt; q (DPat, [(Name, DExp)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-comment">-- | Desugaring a pattern also returns the list of variables bound in as-patterns</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- and the values they should be bound to. This variables must be brought into</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- scope in the &quot;body&quot; of the pattern.</span><span>
</span><span id="line-547"></span><span class="hs-keyword">type</span><span> </span><span id="PatM"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-var">PatM</span></a></span></span><span> </span><span id="local-6989586621679402607"><span class="annot"><a href="#local-6989586621679402607"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679402607"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- | Desugar a pattern.</span><span>
</span><span id="line-550"></span><span id="local-6989586621679403362"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-type">dsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403362"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403362"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-551"></span><span id="dsPat"><span class="annot"><span class="annottext">dsPat :: Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var hs-var">dsPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitP</span></span><span> </span><span id="local-6989586621679402605"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679402605"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-var">DLitP</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679402605"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679402603"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402603"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402603"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupP</span></span><span> </span><span id="local-6989586621679402601"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402601"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402601"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402601"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-554"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupP</span></span><span> </span><span id="local-6989586621679402599"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402599"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402599"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-555"></span><span>                           </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402599"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-556"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConP</span></span><span> </span><span id="local-6989586621679402598"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402598"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402597"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402597"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402598"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402597"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-557"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixP</span></span><span> </span><span id="local-6989586621679402595"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402595"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679402594"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402594"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402593"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402594"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402595"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402593"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-558"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixP</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; PatM q DPat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-560"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensP</span></span><span> </span><span id="local-6989586621679402590"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402590"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402590"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-561"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TildeP</span></span><span> </span><span id="local-6989586621679402588"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402588"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; PatM q DPat -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402588"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-562"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BangP</span></span><span> </span><span id="local-6989586621679402585"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402585"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; PatM q DPat -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402585"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-563"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsP</span></span><span> </span><span id="local-6989586621679402582"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402582"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402581"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402581"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-564"></span><span>  </span><span id="local-6989586621679402580"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402580"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402581"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679402579"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402579"><span class="hs-identifier hs-var">pat''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q DPat -&gt; PatM q DPat
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(q DPat -&gt; PatM q DPat) -&gt; q DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402580"><span class="hs-identifier hs-var">pat'</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; WriterT [(Name, DExp)] q ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402582"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402579"><span class="hs-identifier hs-var">pat''</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402579"><span class="hs-identifier hs-var">pat''</span></a></span><span>
</span><span id="line-568"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecP</span></span><span> </span><span id="local-6989586621679402572"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402572"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679402571"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679402571"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621679402570"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Con -&gt; WriterT [(Name, DExp)] q Con
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(q Con -&gt; WriterT [(Name, DExp)] q Con)
-&gt; q Con -&gt; WriterT [(Name, DExp)] q Con
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Con
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402572"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679402569"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402569"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; WriterT [(Name, DExp)] q [DPat]
forall (m :: * -&gt; *).
DsMonad m =&gt;
Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679402568"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402572"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402569"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621679402568"><span class="annot"><span class="annottext">reorder :: Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679402568"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679402567"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402567"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402567"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-575"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679402566"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402566"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402565"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402565"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679402564"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402565"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-576"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679402563"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402563"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679402562"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402562"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402561"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402561"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679402564"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402563"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402561"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679402560"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402560"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679402559"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402559"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679402558"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402559"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-578"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402557"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402557"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679402568"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402557"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679402556"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402556"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679402555"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402555"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679402554"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402554"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679402564"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402555"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-581"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679402553"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402553"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679402552"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402552"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679402551"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402551"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679402558"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402552"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621679402558"><span class="annot"><span class="annottext">reorder_fields_pat :: [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679402558"><span class="hs-identifier hs-var hs-var">reorder_fields_pat</span></a></span></span><span> </span><span id="local-6989586621679402550"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402550"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var">reorderFieldsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402572"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402550"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679402571"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621679402564"><span class="annot"><span class="annottext">non_record :: t a -&gt; t m [DPat]
</span><a href="#local-6989586621679402564"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679402548"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679402548"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldPat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679402571"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-587"></span><span>                        </span><span class="hs-comment">-- Special case: record patterns are allowed for any</span><span>
</span><span id="line-588"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-589"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that</span><span>
</span><span id="line-590"></span><span>                        </span><span class="hs-comment">-- no records are given in the pattern itself. (See #59).</span><span>
</span><span id="line-591"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-592"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con _ ... _.</span><span>
</span><span id="line-593"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; t m [DPat]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; t m [DPat]) -&gt; [DPat] -&gt; t m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DPat -&gt; [DPat]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679402548"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-594"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [DPat] -&gt; t m [DPat]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [DPat] -&gt; t m [DPat]) -&gt; m [DPat] -&gt; t m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m [DPat]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span>
</span><span id="line-595"></span><span>                                         </span><span class="annot"><span class="annottext">(String -&gt; m [DPat]) -&gt; String -&gt; m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-596"></span><span>                                           </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402572"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListP</span></span><span> </span><span id="local-6989586621679402546"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402546"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; PatM q DPat
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679402545"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402546"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679402545"><span class="annot"><span class="annottext">go :: [Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679402545"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; WriterT [(Name, DExp)] q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; DPat -&gt; WriterT [(Name, DExp)] q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-600"></span><span>        </span><span class="annot"><a href="#local-6989586621679402545"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402544"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402544"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402543"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402543"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-601"></span><span>          </span><span id="local-6989586621679402542"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402542"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402544"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-602"></span><span>          </span><span id="local-6989586621679402541"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402541"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679402545"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402543"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-603"></span><span>          </span><span class="annot"><span class="annottext">DPat -&gt; WriterT [(Name, DExp)] q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; DPat -&gt; WriterT [(Name, DExp)] q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402542"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402541"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-604"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigP</span></span><span> </span><span id="local-6989586621679402539"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402539"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402538"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402538"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DType -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DType -&gt; DPat)
-&gt; PatM q DPat -&gt; WriterT [(Name, DExp)] q (DType -&gt; DPat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402539"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q (DType -&gt; DPat)
-&gt; WriterT [(Name, DExp)] q DType -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; WriterT [(Name, DExp)] q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402538"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumP</span></span><span> </span><span id="local-6989586621679402535"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402535"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402534"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402534"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679402533"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402533"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402534"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402533"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; [DPat] -&gt; [DPat]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; [DPat]) -&gt; PatM q DPat -&gt; WriterT [(Name, DExp)] q [DPat]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402535"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViewP</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-610"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; PatM q DPat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;View patterns are not supported in th-desugar. Use pattern guards instead.&quot;</span></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">-- | Convert a 'DPat' to a 'DExp'. Fails on 'DWildP'.</span><span>
</span><span id="line-613"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-type">dPatToDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-614"></span><span id="dPatToDExp"><span class="annot"><span class="annottext">dPatToDExp :: DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var hs-var">dPatToDExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span id="local-6989586621679402531"><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679402531"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679402531"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-615"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679402530"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402530"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402530"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-616"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679402529"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402529"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402528"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402528"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402529"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPat -&gt; DExp) -&gt; [DPat] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402528"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679402527"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402527"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402527"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-618"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679402526"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402526"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402526"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-619"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679402525"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402525"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402524"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402524"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402525"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402524"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-620"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar: wildcard in rhs of as-pattern&quot;</span></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- | Remove all wildcards from a pattern, replacing any wildcard with a fresh</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   variable</span><span>
</span><span id="line-624"></span><span id="local-6989586621679403345"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-type">removeWilds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403345"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403345"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-625"></span><span id="removeWilds"><span class="annot"><span class="annottext">removeWilds :: DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var hs-var">removeWilds</span></a></span></span><span> </span><span id="local-6989586621679402522"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679402522"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402522"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-626"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span id="local-6989586621679402521"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679402521"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402521"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679402520"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679402519"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402519"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; q [DPat] -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q DPat) -&gt; [DPat] -&gt; q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402519"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679402518"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402518"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; q DPat -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402518"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-629"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679402517"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402517"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; q DPat -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402517"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-630"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679402516"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402516"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402515"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402515"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DType -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DType -&gt; DPat) -&gt; q DPat -&gt; q (DType -&gt; DPat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402516"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DPat) -&gt; q DType -&gt; q DPat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402515"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-631"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; q Name -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wild&quot;</span></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- | Desugar @Info@</span><span>
</span><span id="line-634"></span><span id="local-6989586621679403200"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-type">dsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403200"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403200"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span></span><span>
</span><span id="line-635"></span><span id="dsInfo"><span class="annot"><span class="annottext">dsInfo :: Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var hs-var">dsInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassI</span></span><span> </span><span id="local-6989586621679402512"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402512"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679402511"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402511"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679402510"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402510"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402512"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621679402508"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679402508"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402511"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402510"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; Maybe [DDec]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679402508"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassOpI</span></span><span> </span><span id="local-6989586621679402504"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402504"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402503"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402503"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402502"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402502"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402504"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402503"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402502"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span id="local-6989586621679402499"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402499"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679402498"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402498"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402499"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402498"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DDec]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-648"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span id="local-6989586621679402496"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402496"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679402495"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402495"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679402494"><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402494"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402496"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span id="local-6989586621679402493"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679402493"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402495"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679402494"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; Maybe [DDec]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679402493"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimTyConI</span></span><span> </span><span id="local-6989586621679402491"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402491"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402490"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402490"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621679402489"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402489"><span class="hs-identifier hs-var">unlifted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Int -&gt; Bool -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPrimTyConI"><span class="hs-identifier hs-var">DPrimTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402491"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402490"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402489"><span class="hs-identifier hs-var">unlifted</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataConI</span></span><span> </span><span id="local-6989586621679402486"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402486"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402485"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402485"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402484"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402484"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402486"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402485"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402484"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679402483"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402483"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402482"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402482"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Dec
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-658"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402483"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402482"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-659"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679402481"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402481"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-660"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DInfo
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DInfo) -&gt; String -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402481"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">parent</span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-666"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-identifier">impossible</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">name</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarI</span></span><span> </span><span id="local-6989586621679402479"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402479"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402478"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402478"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarI"><span class="hs-identifier hs-var">DTyVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402479"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DInfo) -&gt; q DType -&gt; q DInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402478"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynI</span></span><span> </span><span id="local-6989586621679402475"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402475"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402474"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402474"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynI"><span class="hs-identifier hs-var">DPatSynI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402475"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DInfo) -&gt; q DType -&gt; q DInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402474"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- | Desugar arbitrary @Dec@s</span><span>
</span><span id="line-675"></span><span id="local-6989586621679403324"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-type">dsDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403324"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403324"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-676"></span><span id="dsDecs"><span class="annot"><span class="annottext">dsDecs :: [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var hs-var">dsDecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; q [DDec]) -&gt; [Dec] -&gt; q [DDec]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- | Desugar a single @Dec@, perhaps producing multiple 'DDec's</span><span>
</span><span id="line-679"></span><span id="local-6989586621679403325"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-type">dsDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403325"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403325"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-680"></span><span id="dsDec"><span class="annot"><span class="annottext">dsDec :: Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var hs-var">dsDec</span></a></span></span><span> </span><span id="local-6989586621679402471"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679402471"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402471"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-681"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679402468"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679402468"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402468"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span> </span><span id="local-6989586621679402465"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402465"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402464"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402464"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402463"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402463"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402462"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402462"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402461"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402461"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679402460"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402460"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>  </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402465"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402464"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402463"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402462"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402461"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402460"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-685"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span id="local-6989586621679402456"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402456"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402455"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402455"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402454"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402454"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402453"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402453"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402452"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402452"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679402451"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402451"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-686"></span><span>  </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402456"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402455"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402454"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402453"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402452"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402451"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-690"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-691"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span id="local-6989586621679402448"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402448"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402447"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402447"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402446"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402446"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynD"><span class="hs-identifier hs-var">DTySynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402448"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DType -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q (DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402447"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402446"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span id="local-6989586621679402442"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402442"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402441"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402441"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402440"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402440"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402439"><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679402439"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679402438"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402438"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClassD"><span class="hs-identifier hs-var">DClassD</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q DCxt -&gt; q (Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402442"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q Name -&gt; q ([DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402441"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q ([FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402440"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-697"></span><span>                     </span><span class="annot"><span class="annottext">q ([FunDep] -&gt; [DDec] -&gt; DDec) -&gt; q [FunDep] -&gt; q ([DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FunDep] -&gt; q [FunDep]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679402439"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DDec] -&gt; DDec) -&gt; q [DDec] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402438"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span id="local-6989586621679402434"><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679402434"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679402433"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402433"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402432"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402432"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402431"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402431"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Overlap
-&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInstanceD"><span class="hs-identifier hs-var">DInstanceD</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679402434"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; DType -&gt; [DDec] -&gt; DDec)
-&gt; q DCxt -&gt; q (DType -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402433"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; [DDec] -&gt; DDec) -&gt; q DType -&gt; q ([DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402432"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DDec] -&gt; DDec) -&gt; q [DDec] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402431"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DInstanceD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsDecs</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679402429"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679402429"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402429"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-706"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignD</span></span><span> </span><span id="local-6989586621679402426"><span class="annot"><span class="annottext">Foreign
</span><a href="#local-6989586621679402426"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForeign -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForeignD"><span class="hs-identifier hs-var">DForeignD</span></a></span><span> </span><span class="annot"><span class="annottext">(DForeign -&gt; DDec) -&gt; q DForeign -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Foreign -&gt; q DForeign
forall (q :: * -&gt; *). DsMonad q =&gt; Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="annot"><span class="annottext">Foreign
</span><a href="#local-6989586621679402426"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679402423"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679402423"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402423"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-708"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679402421"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679402421"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402421"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span id="local-6989586621679402418"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679402418"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DOpenTypeFamilyD"><span class="hs-identifier hs-var">DOpenTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTypeFamilyHead -&gt; DDec) -&gt; q DTypeFamilyHead -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; q DTypeFamilyHead
forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679402418"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataFamilyD</span></span><span> </span><span id="local-6989586621679402414"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402414"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402413"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402413"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402412"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402412"><span class="hs-identifier hs-var">m_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataFamilyD"><span class="hs-identifier hs-var">DDataFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; Maybe DType -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q (Maybe DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402413"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; DDec) -&gt; q (Maybe DType) -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402412"><span class="hs-identifier hs-var">m_k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DOpenTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">DataFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDataFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span id="local-6989586621679402409"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402409"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402408"><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679402407"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402407"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679402406"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402406"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402405"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402405"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679402404"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402404"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402407"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-723"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679402402"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402402"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402401"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402401"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402409"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402402"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402401"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402406"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402405"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402404"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q [DDec]) -&gt; String -&gt; q [DDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected data instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402407"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-725"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span id="local-6989586621679402397"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402397"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402396"><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402396"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679402395"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402395"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679402394"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402394"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402393"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402393"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679402392"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402392"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402395"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-727"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679402391"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402391"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402390"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402390"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402397"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402391"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402396"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402390"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402394"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402393"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402392"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-728"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q [DDec]) -&gt; String -&gt; q [DDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected newtype instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402395"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-732"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-737"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynInstD</span></span><span> </span><span id="local-6989586621679402388"><span class="annot"><span class="annottext">TySynEqn
</span><a href="#local-6989586621679402388"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTySynEqn -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynInstD"><span class="hs-identifier hs-var">DTySynInstD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTySynEqn -&gt; DDec) -&gt; q DTySynEqn -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TySynEqn -&gt; q DTySynEqn
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span> </span><span class="annot"><span class="annottext">TySynEqn
</span><a href="#local-6989586621679402388"><span class="hs-identifier hs-var">eqn</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynInstD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span id="local-6989586621679402383"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679402383"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span> </span><span id="local-6989586621679402382"><span class="annot"><span class="annottext">[TySynEqn]
</span><a href="#local-6989586621679402382"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; [DTySynEqn] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClosedTypeFamilyD"><span class="hs-identifier hs-var">DClosedTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTypeFamilyHead -&gt; [DTySynEqn] -&gt; DDec)
-&gt; q DTypeFamilyHead -&gt; q ([DTySynEqn] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; q DTypeFamilyHead
forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679402383"><span class="hs-identifier hs-var">tfHead</span></a></span><span>
</span><span id="line-748"></span><span>                                </span><span class="annot"><span class="annottext">q ([DTySynEqn] -&gt; DDec) -&gt; q [DTySynEqn] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TySynEqn -&gt; q DTySynEqn) -&gt; [TySynEqn] -&gt; q [DTySynEqn]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TySynEqn -&gt; q DTySynEqn
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var">typeFamilyHeadName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679402383"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><a href="#local-6989586621679402382"><span class="hs-identifier hs-var">eqns</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DClosedTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span>
</span><span id="line-752"></span><span>                                </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RoleAnnotD</span></span><span> </span><span id="local-6989586621679402378"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402378"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402377"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679402377"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DDec] -&gt; q [DDec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Role] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRoleAnnotD"><span class="hs-identifier hs-var">DRoleAnnotD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402378"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679402377"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynD</span></span><span> </span><span id="local-6989586621679402374"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402374"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402373"><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679402373"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679402372"><span class="annot"><span class="annottext">PatSynDir
</span><a href="#local-6989586621679402372"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679402371"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402371"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621679402370"><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679402370"><span class="hs-identifier hs-var">dir'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; PatSynDir -&gt; q DPatSynDir
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402374"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><a href="#local-6989586621679402372"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402368"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402368"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402367"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402367"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; q (DPat, [(Name, DExp)])
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402371"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-760"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; q () -&gt; q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402367"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(q () -&gt; q ()) -&gt; q () -&gt; q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; q ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q ()) -&gt; String -&gt; q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern synonym definition cannot contain as-patterns (@).&quot;</span></span><span>
</span><span id="line-762"></span><span>  </span><span class="annot"><span class="annottext">[DDec] -&gt; q [DDec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; PatSynArgs -&gt; DPatSynDir -&gt; DPat -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynD"><span class="hs-identifier hs-var">DPatSynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402374"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679402373"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679402370"><span class="hs-identifier hs-var">dir'</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402368"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-763"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynSigD</span></span><span> </span><span id="local-6989586621679402363"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402363"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402362"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402362"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynSigD"><span class="hs-identifier hs-var">DPatSynSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402363"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402362"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StandaloneDerivD</span></span><span> </span><span id="local-6989586621679402359"><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679402359"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679402358"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402358"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402357"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402357"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-765"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStandaloneDerivD"><span class="hs-identifier hs-var">DStandaloneDerivD</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DDerivStrategy
 -&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
-&gt; q (Maybe DDerivStrategy)
-&gt; q (Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivStrategy -&gt; q DDerivStrategy)
-&gt; Maybe DerivStrategy -&gt; q (Maybe DDerivStrategy)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy -&gt; q DDerivStrategy
forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679402359"><span class="hs-identifier hs-var">mds</span></a></span><span>
</span><span id="line-766"></span><span>                               </span><span class="annot"><span class="annottext">q (Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
-&gt; q (Maybe [DTyVarBndr]) -&gt; q (DCxt -&gt; DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DDec) -&gt; q DCxt -&gt; q (DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402358"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402357"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StandaloneDerivD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DStandaloneDerivD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefaultSigD</span></span><span> </span><span id="local-6989586621679402353"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402353"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402352"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402352"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDefaultSigD"><span class="hs-identifier hs-var">DDefaultSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402353"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402352"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-`let`-bound implicit param binding&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KiSigD</span></span><span> </span><span id="local-6989586621679402348"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402347"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402347"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKiSigD"><span class="hs-identifier hs-var">DKiSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402347"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- | Desugar a 'DataD' or 'NewtypeD'.</span><span>
</span><span id="line-781"></span><span id="local-6989586621679403315"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-type">dsDataDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403315"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-782"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-783"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403315"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-784"></span><span id="dsDataDec"><span class="annot"><span class="annottext">dsDataDec :: NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var hs-var">dsDataDec</span></a></span></span><span> </span><span id="local-6989586621679402343"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679402343"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679402342"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402342"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402341"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402341"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402340"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402340"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402339"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402339"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402338"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402338"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679402337"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402337"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-785"></span><span>  </span><span id="local-6989586621679402336"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402336"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402340"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402335"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402335"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402339"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-787"></span><span>                   </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-788"></span><span>                   </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-789"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-790"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402336"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span id="local-6989586621679402334"><span class="annot"><span class="annottext">h98_return_type :: DType
</span><a href="#local-6989586621679402334"><span class="hs-identifier hs-var hs-var">h98_return_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var">nonFamilyDataReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402341"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402336"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; DCxt
-&gt; Name
-&gt; [DTyVarBndr]
-&gt; Maybe DType
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-var">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679402343"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt
 -&gt; Name
 -&gt; [DTyVarBndr]
 -&gt; Maybe DType
 -&gt; [DCon]
 -&gt; [DDerivClause]
 -&gt; DDec)
-&gt; q DCxt
-&gt; q (Name
      -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402342"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Name
   -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q Name
-&gt; q ([DTyVarBndr]
      -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402341"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-793"></span><span>                       </span><span class="annot"><span class="annottext">q ([DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DTyVarBndr]
-&gt; q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; q [DTyVarBndr]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402336"><span class="hs-identifier hs-var">tvbs'</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe DType) -&gt; q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402339"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-794"></span><span>                       </span><span class="annot"><span class="annottext">q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DCon] -&gt; q ([DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q [DCon]) -&gt; [Con] -&gt; q [DCon]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402335"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402334"><span class="hs-identifier hs-var">h98_return_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402338"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-795"></span><span>                       </span><span class="annot"><span class="annottext">q ([DDerivClause] -&gt; DDec) -&gt; q [DDerivClause] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivClause -&gt; q DDerivClause)
-&gt; [DerivClause] -&gt; q [DDerivClause]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivClause -&gt; q DDerivClause
forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402337"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span class="hs-comment">-- | Desugar a 'DataInstD' or a 'NewtypeInstD'.</span><span>
</span><span id="line-798"></span><span id="local-6989586621679403303"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-type">dsDataInstDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-799"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-800"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-801"></span><span id="dsDataInstDec"><span class="annot"><span class="annottext">dsDataInstDec :: NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var hs-var">dsDataInstDec</span></a></span></span><span> </span><span id="local-6989586621679402329"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679402329"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679402328"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402328"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402327"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402327"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402326"><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402326"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679402325"><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402325"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679402324"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402324"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679402323"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402323"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679402322"><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402322"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-802"></span><span>  </span><span id="local-6989586621679402321"><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679402321"><span class="hs-identifier hs-var">mtvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402326"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-803"></span><span>  </span><span id="local-6989586621679402320"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679402320"><span class="hs-identifier hs-var">tys'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TypeArg -&gt; q DTypeArg) -&gt; [TypeArg] -&gt; q [DTypeArg]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; q DTypeArg
forall (q :: * -&gt; *). DsMonad q =&gt; TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679402325"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402318"><span class="annot"><span class="annottext">lhs' :: DType
</span><a href="#local-6989586621679402318"><span class="hs-identifier hs-var hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402327"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679402320"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span id="local-6989586621679402315"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402315"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-806"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402324"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679402321"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-807"></span><span>          </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-808"></span><span>          </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-809"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-810"></span><span>          </span><span class="hs-comment">-- H98, and there is an explicit `forall` in front. Just reuse the</span><span>
</span><span id="line-811"></span><span>          </span><span class="hs-comment">-- type variable binders from the `forall`.</span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679402314"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402314"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402314"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-813"></span><span>          </span><span class="hs-comment">-- H98, and no explicit `forall`. Compute the bound variables</span><span>
</span><span id="line-814"></span><span>          </span><span class="hs-comment">-- manually.</span><span>
</span><span id="line-815"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var">dataFamInstTvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679402320"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-816"></span><span>      </span><span id="local-6989586621679402312"><span class="annot"><span class="annottext">h98_fam_inst_type :: DType
</span><a href="#local-6989586621679402312"><span class="hs-identifier hs-var hs-var">h98_fam_inst_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var">dataFamInstReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402327"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679402320"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-817"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; DCxt
-&gt; Maybe [DTyVarBndr]
-&gt; DType
-&gt; Maybe DType
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataInstD"><span class="hs-identifier hs-var">DDataInstD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679402329"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt
 -&gt; Maybe [DTyVarBndr]
 -&gt; DType
 -&gt; Maybe DType
 -&gt; [DCon]
 -&gt; [DDerivClause]
 -&gt; DDec)
-&gt; q DCxt
-&gt; q (Maybe [DTyVarBndr]
      -&gt; DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402328"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe [DTyVarBndr]
   -&gt; DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe [DTyVarBndr])
-&gt; q (DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679402321"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span>
</span><span id="line-818"></span><span>                           </span><span class="annot"><span class="annottext">q (DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q DType -&gt; q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402318"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe DType) -&gt; q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679402324"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-819"></span><span>                           </span><span class="annot"><span class="annottext">q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DCon] -&gt; q ([DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q [DCon]) -&gt; [Con] -&gt; q [DCon]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402315"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402312"><span class="hs-identifier hs-var">h98_fam_inst_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679402323"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-820"></span><span>                           </span><span class="annot"><span class="annottext">q ([DDerivClause] -&gt; DDec) -&gt; q [DDerivClause] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivClause -&gt; q DDerivClause)
-&gt; [DerivClause] -&gt; q [DDerivClause]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivClause -&gt; q DDerivClause
forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679402322"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @FamilyResultSig@</span><span>
</span><span id="line-824"></span><span id="local-6989586621679403274"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-type">dsFamilyResultSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403274"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403274"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFamilyResultSig"><span class="hs-identifier hs-type">DFamilyResultSig</span></a></span></span><span>
</span><span id="line-825"></span><span id="dsFamilyResultSig"><span class="annot"><span class="annottext">dsFamilyResultSig :: FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var hs-var">dsFamilyResultSig</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier hs-var">NoSig</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; q DFamilyResultSig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNoSig"><span class="hs-identifier hs-var">DNoSig</span></a></span><span>
</span><span id="line-826"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindSig</span></span><span> </span><span id="local-6989586621679402305"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402305"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindSig"><span class="hs-identifier hs-var">DKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DFamilyResultSig) -&gt; q DType -&gt; q DFamilyResultSig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402305"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-827"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarSig</span></span><span> </span><span id="local-6989586621679402302"><span class="annot"><span class="annottext">TyVarBndr
</span><a href="#local-6989586621679402302"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarSig"><span class="hs-identifier hs-var">DTyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; DFamilyResultSig)
-&gt; q DTyVarBndr -&gt; q DFamilyResultSig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarBndr
</span><a href="#local-6989586621679402302"><span class="hs-identifier hs-var">tvb</span></a></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="hs-comment">-- | Desugar a @TypeFamilyHead@</span><span>
</span><span id="line-830"></span><span id="local-6989586621679403305"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-type">dsTypeFamilyHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403305"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403305"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span></span><span>
</span><span id="line-831"></span><span id="dsTypeFamilyHead"><span class="annot"><span class="annottext">dsTypeFamilyHead :: TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var hs-var">dsTypeFamilyHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679402299"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402299"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402298"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402298"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402297"><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679402297"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679402296"><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679402296"><span class="hs-identifier hs-var">inj</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [DTyVarBndr]
-&gt; DFamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-var">DTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402299"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr]
 -&gt; DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q [DTyVarBndr]
-&gt; q (DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402298"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-833"></span><span>                      </span><span class="annot"><span class="annottext">q (DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q DFamilyResultSig
-&gt; q (Maybe InjectivityAnn -&gt; DTypeFamilyHead)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig -&gt; q DFamilyResultSig
forall (q :: * -&gt; *).
DsMonad q =&gt;
FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679402297"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-834"></span><span>                      </span><span class="annot"><span class="annottext">q (Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q (Maybe InjectivityAnn) -&gt; q DTypeFamilyHead
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn -&gt; q (Maybe InjectivityAnn)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679402296"><span class="hs-identifier hs-var">inj</span></a></span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-type">typeFamilyHeadName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-837"></span><span id="typeFamilyHeadName"><span class="annot"><span class="annottext">typeFamilyHeadName :: TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var hs-var">typeFamilyHeadName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679402294"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402294"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402294"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar bits and pieces into a 'DTypeFamilyHead'</span><span>
</span><span id="line-840"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span>
</span><span id="line-841"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTypeFamilyHead</span><span>
</span><span id="line-842"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-identifier">result_sig</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-844"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">DNoSig</span><span>
</span><span id="line-845"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">k</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DKindSig</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">k</span><span>
</span><span id="line-846"></span><span>  </span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><span id="line-847"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">result_sig</span><span>
</span><span id="line-848"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- | Desugar @Dec@s that can appear in a @let@ expression. See the</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- documentation for 'dsLetDec' for an explanation of what the return type</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- represents.</span><span>
</span><span id="line-854"></span><span id="local-6989586621679403470"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-type">dsLetDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403470"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403470"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-855"></span><span id="dsLetDecs"><span class="annot"><span class="annottext">dsLetDecs :: [Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var hs-var">dsLetDecs</span></a></span></span><span> </span><span id="local-6989586621679402293"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402293"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402292"><span class="annot"><span class="annottext">[[DLetDec]]
</span><a href="#local-6989586621679402292"><span class="hs-identifier hs-var">let_decss</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402291"><span class="annot"><span class="annottext">[DExp -&gt; DExp]
</span><a href="#local-6989586621679402291"><span class="hs-identifier hs-var">ip_binders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; q ([DLetDec], DExp -&gt; DExp))
-&gt; [Dec] -&gt; q ([[DLetDec]], [DExp -&gt; DExp])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><span class="hs-identifier hs-var">mapAndUnzipM</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402293"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679402288"><span class="hs-identifier hs-type">let_decs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-858"></span><span>      </span><span id="local-6989586621679402288"><span class="annot"><span class="annottext">let_decs :: [DLetDec]
</span><a href="#local-6989586621679402288"><span class="hs-identifier hs-var hs-var">let_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[DLetDec]] -&gt; [DLetDec]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[DLetDec]]
</span><a href="#local-6989586621679402292"><span class="hs-identifier hs-var">let_decss</span></a></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>      </span><span class="annot"><a href="#local-6989586621679402287"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-861"></span><span>      </span><span id="local-6989586621679402287"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679402287"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DExp -&gt; DExp) -&gt; (DExp -&gt; DExp) -&gt; DExp -&gt; DExp)
-&gt; (DExp -&gt; DExp) -&gt; [DExp -&gt; DExp] -&gt; DExp -&gt; DExp
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; (DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[DExp -&gt; DExp]
</span><a href="#local-6989586621679402291"><span class="hs-identifier hs-var">ip_binders</span></a></span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402288"><span class="hs-identifier hs-var">let_decs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402287"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">-- | Desugar a single 'Dec' that can appear in a @let@ expression.</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- This produces the following output:</span><span>
</span><span id="line-866"></span><span class="hs-comment">--</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- * One or more 'DLetDec's (a single 'Dec' can produce multiple 'DLetDec's</span><span>
</span><span id="line-868"></span><span class="hs-comment">--   in the event of a value declaration that binds multiple things by way</span><span>
</span><span id="line-869"></span><span class="hs-comment">--   of pattern matching.</span><span>
</span><span id="line-870"></span><span class="hs-comment">--</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- * A function of type @'DExp' -&gt; 'DExp'@, which should be applied to the</span><span>
</span><span id="line-872"></span><span class="hs-comment">--   expression immediately following the 'DLetDec's. This function prepends</span><span>
</span><span id="line-873"></span><span class="hs-comment">--   binding forms for any implicit params that were bound in the argument</span><span>
</span><span id="line-874"></span><span class="hs-comment">--   'Dec'. (If no implicit params are bound, this is simply the 'id'</span><span>
</span><span id="line-875"></span><span class="hs-comment">--   function.)</span><span>
</span><span id="line-876"></span><span class="hs-comment">--</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- For instance, if the argument to 'dsLetDec' is the @?x = 42@ part of this</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- expression:</span><span>
</span><span id="line-879"></span><span class="hs-comment">--</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- let { ?x = 42 } in ?x</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-883"></span><span class="hs-comment">--</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- Then the output is:</span><span>
</span><span id="line-885"></span><span class="hs-comment">--</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- * @let new_x_val = 42@</span><span>
</span><span id="line-887"></span><span class="hs-comment">--</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- * @\\z -&gt; 'bindIP' \@\&quot;x\&quot; new_x_val z@</span><span>
</span><span id="line-889"></span><span class="hs-comment">--</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- This way, the expression</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- @let { new_x_val = 42 } in 'bindIP' \@&quot;x&quot; new_x_val ('ip' \@\&quot;x\&quot;)@ can be</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- formed. The implicit param binders always come after all the other</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- 'DLetDec's to support parallel assignment of implicit params.</span><span>
</span><span id="line-894"></span><span id="local-6989586621679403268"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-type">dsLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403268"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403268"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-895"></span><span id="dsLetDec"><span class="annot"><span class="annottext">dsLetDec :: Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var hs-var">dsLetDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679402285"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402285"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402284"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402284"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-896"></span><span>  </span><span id="local-6989586621679402283"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679402283"><span class="hs-identifier hs-var">clauses'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402285"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402284"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [DClause] -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DFunD"><span class="hs-identifier hs-var">DFunD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402285"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679402283"><span class="hs-identifier hs-var">clauses'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679402280"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402280"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679402279"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402279"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679402278"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402278"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-899"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402277"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402277"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402276"><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402276"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; q (DPat, [(Name, DExp)])
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402280"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-900"></span><span>  </span><span id="local-6989586621679402275"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402275"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402279"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402278"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402274"><span class="hs-identifier hs-var">error_exp</span></a></span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402273"><span class="annot"><span class="annottext">extras :: [DLetDec]
</span><a href="#local-6989586621679402273"><span class="hs-identifier hs-var hs-var">extras</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679402276"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679402277"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402275"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; [DLetDec] -&gt; [DLetDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402273"><span class="hs-identifier hs-var">extras</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-904"></span><span>    </span><span id="local-6989586621679402274"><span class="annot"><span class="annottext">error_exp :: DExp
</span><a href="#local-6989586621679402274"><span class="hs-identifier hs-var hs-var">error_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span>
</span><span id="line-905"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Lit) -&gt; String -&gt; Lit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679402280"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span id="local-6989586621679402272"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402272"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679402271"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402271"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621679402270"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402270"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402271"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-908"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigD"><span class="hs-identifier hs-var">DSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402272"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402270"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span id="local-6989586621679402268"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679402268"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621679402267"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402267"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Fixity -&gt; Name -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInfixD"><span class="hs-identifier hs-var">DInfixD</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679402268"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402267"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span id="local-6989586621679402265"><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-911"></span><span>  </span><span id="local-6989586621679402264"><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679402264"><span class="hs-identifier hs-var">prag'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; q DPragma
forall (q :: * -&gt; *). DsMonad q =&gt; Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">prag</span></a></span><span>
</span><span id="line-912"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPragma -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPragmaD"><span class="hs-identifier hs-var">DPragmaD</span></a></span><span> </span><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679402264"><span class="hs-identifier hs-var">prag'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span id="local-6989586621679402261"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402261"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402260"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402260"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-915"></span><span>  </span><span id="local-6989586621679402259"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402259"><span class="hs-identifier hs-var">new_n_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q Name) -&gt; String -&gt; q Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402261"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_val&quot;</span></span><span>
</span><span id="line-916"></span><span>  </span><span id="local-6989586621679402258"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402258"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402260"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-917"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679402257"><span class="hs-identifier hs-type">let_dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span>
</span><span id="line-918"></span><span>      </span><span id="local-6989586621679402257"><span class="annot"><span class="annottext">let_dec :: DLetDec
</span><a href="#local-6989586621679402257"><span class="hs-identifier hs-var hs-var">let_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402259"><span class="hs-identifier hs-var">new_n_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402258"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span>      </span><span class="annot"><a href="#local-6989586621679402256"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-921"></span><span>      </span><span id="local-6989586621679402256"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679402256"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">bindIP</span><span>        </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span>
</span><span id="line-922"></span><span>                     </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402261"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-923"></span><span>                     </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402259"><span class="hs-identifier hs-var">new_n_name</span></a></span><span>   </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679402257"><span class="hs-identifier hs-var">let_dec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402256"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span id="local-6989586621679402255"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679402255"><span class="hs-identifier hs-var">_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal declaration in let expression.&quot;</span></span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span class="hs-comment">-- | Desugar a single 'Dec' corresponding to something that could appear after</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- the @let@ in a @let@ expression, but occurring at the top level. Because the</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- 'Dec' occurs at the top level, there is nothing that would correspond to the</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- @in ...@ part of the @let@ expression. As a consequence, this function does</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- not return a @'DExp' -&gt; 'DExp'@ function corresonding to implicit param</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- binders (these cannot occur at the top level).</span><span>
</span><span id="line-934"></span><span id="local-6989586621679402254"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-type">dsTopLevelLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402254"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402254"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-935"></span><span id="dsTopLevelLetDec"><span class="annot"><span class="annottext">dsTopLevelLetDec :: Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var hs-var">dsTopLevelLetDec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([DLetDec], DExp -&gt; DExp) -&gt; [DDec])
-&gt; q ([DLetDec], DExp -&gt; DExp) -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DLetDec -&gt; DDec) -&gt; [DLetDec] -&gt; [DDec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-var">DLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">([DLetDec] -&gt; [DDec])
-&gt; (([DLetDec], DExp -&gt; DExp) -&gt; [DLetDec])
-&gt; ([DLetDec], DExp -&gt; DExp)
-&gt; [DDec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; [DLetDec]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(q ([DLetDec], DExp -&gt; DExp) -&gt; q [DDec])
-&gt; (Dec -&gt; q ([DLetDec], DExp -&gt; DExp)) -&gt; Dec -&gt; q [DDec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span>
</span><span id="line-936"></span><span>  </span><span class="hs-comment">-- Note the use of fst above: we're silently throwing away any implicit param</span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-comment">-- binders that dsLetDec returns, since there is invariant that there will be</span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-comment">-- no implicit params in the first place.</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- | Desugar a single @Con@.</span><span>
</span><span id="line-941"></span><span class="hs-comment">--</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- Because we always desugar @Con@s to GADT syntax (see the documentation for</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- 'DCon'), it is not always possible to desugar with just a 'Con' alone.</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- For instance, we must desugar:</span><span>
</span><span id="line-945"></span><span class="hs-comment">--</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-947"></span><span class="hs-comment">-- data Foo a = forall b. MkFoo b</span><span>
</span><span id="line-948"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-949"></span><span class="hs-comment">--</span><span>
</span><span id="line-950"></span><span class="hs-comment">-- To this:</span><span>
</span><span id="line-951"></span><span class="hs-comment">--</span><span>
</span><span id="line-952"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-953"></span><span class="hs-comment">-- data Foo a :: Type where</span><span>
</span><span id="line-954"></span><span class="hs-comment">--   MkFoo :: forall a b. b -&gt; Foo a</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-956"></span><span class="hs-comment">--</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- If our only argument was @forall b. MkFoo b@, it would be somewhat awkward</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- to figure out (1) what the set of universally quantified type variables</span><span>
</span><span id="line-959"></span><span class="hs-comment">-- (@[a]@) was, and (2) what the return type (@Foo a@) was. For this reason,</span><span>
</span><span id="line-960"></span><span class="hs-comment">-- we require passing these as arguments. (If we desugar an actual GADT</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- constructor, these arguments are ignored.)</span><span>
</span><span id="line-962"></span><span id="local-6989586621679403283"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-type">dsCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403283"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-963"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The universally quantified type variables</span><span>
</span><span id="line-964"></span><span>                      </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-965"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>        </span><span class="hs-comment">-- ^ The original data declaration's type</span><span>
</span><span id="line-966"></span><span>                      </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-967"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403283"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-968"></span><span id="dsCon"><span class="annot"><span class="annottext">dsCon :: [DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var hs-var">dsCon</span></a></span></span><span> </span><span id="local-6989586621679402252"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402252"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span></span><span> </span><span id="local-6989586621679402251"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402251"><span class="hs-identifier hs-var">data_type</span></a></span></span><span> </span><span id="local-6989586621679402250"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402250"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-969"></span><span>  </span><span id="local-6989586621679402249"><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679402249"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402250"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-970"></span><span>  </span><span class="annot"><span class="annottext">[DCon] -&gt; q [DCon]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DCon] -&gt; q [DCon]) -&gt; [DCon] -&gt; q [DCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)] -&gt; [DCon])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [DCon]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)] -&gt; [DCon]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679402249"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
 -&gt; [DCon])
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [DCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679402246"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402246"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402245"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402245"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402244"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402244"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402243"><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679402243"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402242"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679402242"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-971"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679402242"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-972"></span><span>      </span><span class="annot"><span class="annottext">Maybe DType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402241"><span class="annot"><span class="annottext">ex_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402241"><span class="hs-identifier hs-var hs-var">ex_dtvbs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402245"><span class="hs-identifier hs-var">dtvbs</span></a></span><span>
</span><span id="line-974"></span><span>            </span><span id="local-6989586621679402240"><span class="annot"><span class="annottext">expl_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402240"><span class="hs-identifier hs-var hs-var">expl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402252"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402241"><span class="hs-identifier hs-var">ex_dtvbs</span></a></span><span>
</span><span id="line-975"></span><span>            </span><span id="local-6989586621679402239"><span class="annot"><span class="annottext">impl_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402239"><span class="hs-identifier hs-var hs-var">impl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; [DTyVarBndr]) -&gt; DCxt -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; Maybe DType) -&gt; [DTyVarBndr] -&gt; DCxt
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; Maybe DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402240"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-976"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402239"><span class="hs-identifier hs-var">impl_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402240"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402244"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402246"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679402243"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402251"><span class="hs-identifier hs-var">data_type</span></a></span><span>
</span><span id="line-977"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679402235"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402235"><span class="hs-identifier hs-var">gadt_type</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-978"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402234"><span class="annot"><span class="annottext">univ_ex_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679402234"><span class="hs-identifier hs-var hs-var">univ_ex_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402245"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-979"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402234"><span class="hs-identifier hs-var">univ_ex_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402244"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402246"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679402243"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402235"><span class="hs-identifier hs-var">gadt_type</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span class="hs-comment">-- Desugar a Con in isolation. The meaning of the returned DTyVarBndrs changes</span><span>
</span><span id="line-982"></span><span class="hs-comment">-- depending on what the returned Maybe DType value is:</span><span>
</span><span id="line-983"></span><span class="hs-comment">--</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- * If returning Just gadt_ty, then we've encountered a GadtC or RecGadtC,</span><span>
</span><span id="line-985"></span><span class="hs-comment">--   so the returned DTyVarBndrs are both the universally and existentially</span><span>
</span><span id="line-986"></span><span class="hs-comment">--   quantified tyvars.</span><span>
</span><span id="line-987"></span><span class="hs-comment">-- * If returning Nothing, we're dealing with a non-GADT constructor, so</span><span>
</span><span id="line-988"></span><span class="hs-comment">--   the returned DTyVarBndrs are the existentials only.</span><span>
</span><span id="line-989"></span><span id="local-6989586621679403254"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-type">dsCon'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403254"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-990"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403254"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConFields"><span class="hs-identifier hs-type">DConFields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-991"></span><span id="dsCon%27"><span class="annot"><span class="annottext">dsCon' :: Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var hs-var">dsCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679402233"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402233"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402232"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402232"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-992"></span><span>  </span><span id="local-6989586621679402231"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679402231"><span class="hs-identifier hs-var">dtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BangType -&gt; q DBangType) -&gt; [BangType] -&gt; q [DBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402232"><span class="hs-identifier hs-var">stys</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402233"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679402231"><span class="hs-identifier hs-var">dtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-994"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679402228"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402228"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402227"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402227"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-995"></span><span>  </span><span id="local-6989586621679402226"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679402226"><span class="hs-identifier hs-var">vdtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; q DVarBangType)
-&gt; [VarBangType] -&gt; q [DVarBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; q DVarBangType
forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402227"><span class="hs-identifier hs-var">vstys</span></a></span><span>
</span><span id="line-996"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402228"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679402226"><span class="hs-identifier hs-var">vdtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-997"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679402223"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402223"><span class="hs-identifier hs-var">sty1</span></a></span></span><span> </span><span id="local-6989586621679402222"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402222"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402221"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402221"><span class="hs-identifier hs-var">sty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-998"></span><span>  </span><span id="local-6989586621679402220"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679402220"><span class="hs-identifier hs-var">dty1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402223"><span class="hs-identifier hs-var">sty1</span></a></span><span>
</span><span id="line-999"></span><span>  </span><span id="local-6989586621679402219"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679402219"><span class="hs-identifier hs-var">dty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679402221"><span class="hs-identifier hs-var">sty2</span></a></span><span>
</span><span id="line-1000"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402222"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679402220"><span class="hs-identifier hs-var">dty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679402219"><span class="hs-identifier hs-var">dty2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span id="local-6989586621679402218"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402218"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402217"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402217"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679402216"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402216"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1002"></span><span>  </span><span id="local-6989586621679402215"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402215"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402218"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1003"></span><span>  </span><span id="local-6989586621679402214"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402214"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402217"><span class="hs-identifier hs-var">cxt</span></a></span><span>
</span><span id="line-1004"></span><span>  </span><span id="local-6989586621679402213"><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679402213"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679402216"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
  -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
    -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
 -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679402213"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
  -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
    -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679402212"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402212"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402211"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402211"><span class="hs-identifier hs-var">dtvbs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402210"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402210"><span class="hs-identifier hs-var">dcxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402209"><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679402209"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402208"><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679402208"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1006"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402212"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402215"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679402211"><span class="hs-identifier hs-var">dtvbs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402214"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; DCxt -&gt; DCxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679402210"><span class="hs-identifier hs-var">dcxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679402209"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679402208"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679402207"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402207"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679402206"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402206"><span class="hs-identifier hs-var">btys</span></a></span></span><span> </span><span id="local-6989586621679402205"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402205"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1009"></span><span>  </span><span id="local-6989586621679402204"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679402204"><span class="hs-identifier hs-var">dbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BangType -&gt; q DBangType) -&gt; [BangType] -&gt; q [DBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679402206"><span class="hs-identifier hs-var">btys</span></a></span><span>
</span><span id="line-1010"></span><span>  </span><span id="local-6989586621679402203"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402203"><span class="hs-identifier hs-var">drty</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402205"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1011"></span><span>  </span><span class="annot"><span class="annottext">[q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [Name]
 -&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [Name]
-&gt; (Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [Name]
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402207"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; (Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402201"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402201"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1012"></span><span>    </span><span id="local-6989586621679402200"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679402200"><span class="hs-identifier hs-var">mbFi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Fixity)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Fixity)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-var">reifyFixityWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402201"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-1013"></span><span>    </span><span class="hs-comment">-- A GADT data constructor is declared infix when these three</span><span>
</span><span id="line-1014"></span><span>    </span><span class="hs-comment">-- properties hold:</span><span>
</span><span id="line-1015"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402198"><span class="annot"><span class="annottext">decInfix :: Bool
</span><a href="#local-6989586621679402198"><span class="hs-identifier hs-var hs-var">decInfix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var">isInfixDataCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402201"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 1. Its name uses operator syntax</span><span>
</span><span id="line-1016"></span><span>                                                </span><span class="hs-comment">--    (e.g., (:*:))</span><span>
</span><span id="line-1017"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[DBangType] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679402204"><span class="hs-identifier hs-var">dbtys</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>            </span><span class="hs-comment">-- 2. It has exactly two fields</span><span>
</span><span id="line-1018"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679402200"><span class="hs-identifier hs-var">mbFi</span></a></span><span>                  </span><span class="hs-comment">-- 3. It has a programmer-specified</span><span>
</span><span id="line-1019"></span><span>                                                </span><span class="hs-comment">--    fixity declaration</span><span>
</span><span id="line-1020"></span><span>    </span><span class="annot"><span class="annottext">(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
-&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402201"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402198"><span class="hs-identifier hs-var">decInfix</span></a></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679402204"><span class="hs-identifier hs-var">dbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402203"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679402195"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402195"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679402194"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402194"><span class="hs-identifier hs-var">vbtys</span></a></span></span><span> </span><span id="local-6989586621679402193"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402193"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1022"></span><span>  </span><span id="local-6989586621679402192"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679402192"><span class="hs-identifier hs-var">dvbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; q DVarBangType)
-&gt; [VarBangType] -&gt; q [DVarBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; q DVarBangType
forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679402194"><span class="hs-identifier hs-var">vbtys</span></a></span><span>
</span><span id="line-1023"></span><span>  </span><span id="local-6989586621679402191"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402191"><span class="hs-identifier hs-var">drty</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402193"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1024"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [Name] -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [Name]
-&gt; (Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [Name] -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402195"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; (Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402190"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402190"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1025"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402190"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679402192"><span class="hs-identifier hs-var">dvbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402191"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1030"></span><span id="local-6989586621679403246"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-type">dsBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403246"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403246"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangType"><span class="hs-identifier hs-type">DBangType</span></a></span></span><span>
</span><span id="line-1031"></span><span id="dsBangType"><span class="annot"><span class="annottext">dsBangType :: BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var hs-var">dsBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402189"><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679402189"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402188"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402188"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679402189"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DBangType) -&gt; q DType -&gt; q DBangType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402188"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1034"></span><span id="local-6989586621679403244"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-type">dsVarBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403244"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarBangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403244"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarBangType"><span class="hs-identifier hs-type">DVarBangType</span></a></span></span><span>
</span><span id="line-1035"></span><span id="dsVarBangType"><span class="annot"><span class="annottext">dsVarBangType :: VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var hs-var">dsVarBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402187"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402187"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402186"><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679402186"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402185"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402185"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402187"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679402186"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DVarBangType) -&gt; q DType -&gt; q DVarBangType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402185"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1038"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">StrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DBangType</span><span>
</span><span id="line-1039"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1042"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">VarStrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DVarBangType</span><span>
</span><span id="line-1043"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- | Desugar a @Foreign@.</span><span>
</span><span id="line-1047"></span><span id="local-6989586621679403308"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-type">dsForeign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403308"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foreign</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403308"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeign"><span class="hs-identifier hs-type">DForeign</span></a></span></span><span>
</span><span id="line-1048"></span><span id="dsForeign"><span class="annot"><span class="annottext">dsForeign :: Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var hs-var">dsForeign</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImportF</span></span><span> </span><span id="local-6989586621679402183"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679402183"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679402182"><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679402182"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621679402181"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402181"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679402180"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402180"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402179"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402179"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; Safety -&gt; String -&gt; Name -&gt; DType -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImportF"><span class="hs-identifier hs-var">DImportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679402183"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679402182"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402181"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402180"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DForeign) -&gt; q DType -&gt; q DForeign
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402179"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1049"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExportF</span></span><span> </span><span id="local-6989586621679402176"><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679402176"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679402175"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402175"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679402174"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402174"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402173"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402173"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; String -&gt; Name -&gt; DType -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExportF"><span class="hs-identifier hs-var">DExportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679402176"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402175"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402174"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DForeign) -&gt; q DType -&gt; q DForeign
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402173"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span class="hs-comment">-- | Desugar a @Pragma@.</span><span>
</span><span id="line-1052"></span><span id="local-6989586621679403258"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-type">dsPragma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403258"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pragma</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403258"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragma"><span class="hs-identifier hs-type">DPragma</span></a></span></span><span>
</span><span id="line-1053"></span><span id="dsPragma"><span class="annot"><span class="annottext">dsPragma :: Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var hs-var">dsPragma</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InlineP</span></span><span> </span><span id="local-6989586621679402170"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402170"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402169"><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679402169"><span class="hs-identifier hs-var">inl</span></a></span></span><span> </span><span id="local-6989586621679402168"><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679402168"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679402167"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402167"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Inline -&gt; RuleMatch -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInlineP"><span class="hs-identifier hs-var">DInlineP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402170"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679402169"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679402168"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402167"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1054"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseP</span></span><span> </span><span id="local-6989586621679402164"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402164"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402163"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402163"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402162"><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679402162"><span class="hs-identifier hs-var">m_inl</span></a></span></span><span> </span><span id="local-6989586621679402161"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402161"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Inline -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseP"><span class="hs-identifier hs-var">DSpecialiseP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402164"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Inline -&gt; Phases -&gt; DPragma)
-&gt; q DType -&gt; q (Maybe Inline -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402163"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1055"></span><span>                                                          </span><span class="annot"><span class="annottext">q (Maybe Inline -&gt; Phases -&gt; DPragma)
-&gt; q (Maybe Inline) -&gt; q (Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Inline -&gt; q (Maybe Inline)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679402162"><span class="hs-identifier hs-var">m_inl</span></a></span><span>
</span><span id="line-1056"></span><span>                                                          </span><span class="annot"><span class="annottext">q (Phases -&gt; DPragma) -&gt; q Phases -&gt; q DPragma
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Phases -&gt; q Phases
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402161"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1057"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseInstP</span></span><span> </span><span id="local-6989586621679402158"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402158"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseInstP"><span class="hs-identifier hs-var">DSpecialiseInstP</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DPragma) -&gt; q DType -&gt; q DPragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402158"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleP</span></span><span> </span><span id="local-6989586621679402155"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402155"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679402154"><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402154"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679402153"><span class="annot"><span class="annottext">[RuleBndr]
</span><a href="#local-6989586621679402153"><span class="hs-identifier hs-var">rbs</span></a></span></span><span> </span><span id="local-6989586621679402152"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402152"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679402151"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402151"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679402150"><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402150"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe [DTyVarBndr]
-&gt; [DRuleBndr]
-&gt; DExp
-&gt; DExp
-&gt; Phases
-&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleP"><span class="hs-identifier hs-var">DRuleP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402155"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [DTyVarBndr]
 -&gt; [DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q (Maybe [DTyVarBndr])
-&gt; q ([DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402154"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-1061"></span><span>                                                      </span><span class="annot"><span class="annottext">q ([DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q [DRuleBndr] -&gt; q (DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleBndr -&gt; q DRuleBndr) -&gt; [RuleBndr] -&gt; q [DRuleBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">RuleBndr -&gt; q DRuleBndr
forall (q :: * -&gt; *). DsMonad q =&gt; RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">[RuleBndr]
</span><a href="#local-6989586621679402153"><span class="hs-identifier hs-var">rbs</span></a></span><span>
</span><span id="line-1062"></span><span>                                                      </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q DExp -&gt; q (DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402152"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1063"></span><span>                                                      </span><span class="annot"><span class="annottext">q (DExp -&gt; Phases -&gt; DPragma) -&gt; q DExp -&gt; q (Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402151"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1064"></span><span>                                                      </span><span class="annot"><span class="annottext">q (Phases -&gt; DPragma) -&gt; q Phases -&gt; q DPragma
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Phases -&gt; q Phases
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679402150"><span class="hs-identifier hs-var">phases</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsPragma</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">rbs</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span> </span><span class="hs-identifier">phases</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DRuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1067"></span><span>                                                      </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsRuleBndr</span><span> </span><span class="hs-identifier">rbs</span><span>
</span><span id="line-1068"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">lhs</span><span>
</span><span id="line-1069"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">rhs</span><span>
</span><span id="line-1070"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">phases</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AnnP</span></span><span> </span><span id="local-6989586621679402146"><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679402146"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679402145"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402145"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnTarget -&gt; DExp -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnnP"><span class="hs-identifier hs-var">DAnnP</span></a></span><span> </span><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679402146"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DPragma) -&gt; q DExp -&gt; q DPragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402145"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineP</span></span><span> </span><span id="local-6989586621679402142"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402142"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402141"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402141"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLineP"><span class="hs-identifier hs-var">DLineP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402142"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402141"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompleteP</span></span><span> </span><span id="local-6989586621679402138"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402138"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679402137"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679402137"><span class="hs-identifier hs-var">mty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Maybe Name -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCompleteP"><span class="hs-identifier hs-var">DCompleteP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402138"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679402137"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1080"></span><span class="hs-comment">-- | Desugar a @RuleBndr@.</span><span>
</span><span id="line-1081"></span><span id="local-6989586621679403227"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-type">dsRuleBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403227"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RuleBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403227"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleBndr"><span class="hs-identifier hs-type">DRuleBndr</span></a></span></span><span>
</span><span id="line-1082"></span><span id="dsRuleBndr"><span class="annot"><span class="annottext">dsRuleBndr :: RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var hs-var">dsRuleBndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleVar</span></span><span> </span><span id="local-6989586621679402134"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402134"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DRuleBndr -&gt; q DRuleBndr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DRuleBndr -&gt; q DRuleBndr) -&gt; DRuleBndr -&gt; q DRuleBndr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleVar"><span class="hs-identifier hs-var">DRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402134"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1083"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypedRuleVar</span></span><span> </span><span id="local-6989586621679402131"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402131"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402130"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402130"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypedRuleVar"><span class="hs-identifier hs-var">DTypedRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402131"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DRuleBndr) -&gt; q DType -&gt; q DRuleBndr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402130"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--</span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- This requires a 'Name' as an argument since 'TySynEqn's did not have</span><span>
</span><span id="line-1089"></span><span class="hs-comment">-- this information prior to GHC 8.8.</span><span>
</span><span id="line-1090"></span><span id="local-6989586621679403298"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-type">dsTySynEqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403298"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403298"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span></span><span>
</span><span id="line-1091"></span><span id="dsTySynEqn"><span class="annot"><span class="annottext">dsTySynEqn :: Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var hs-var">dsTySynEqn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span id="local-6989586621679402127"><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402127"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679402126"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402126"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679402125"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402125"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1092"></span><span>  </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; DType -&gt; DType -&gt; DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-var">DTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [DTyVarBndr] -&gt; DType -&gt; DType -&gt; DTySynEqn)
-&gt; q (Maybe [DTyVarBndr]) -&gt; q (DType -&gt; DType -&gt; DTySynEqn)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679402127"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType -&gt; DTySynEqn)
-&gt; q DType -&gt; q (DType -&gt; DTySynEqn)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402126"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DTySynEqn) -&gt; q DType -&gt; q DTySynEqn
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402125"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1095"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTySynEqn</span><span>
</span><span id="line-1096"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-identifier">lhss</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1097"></span><span>  </span><span class="hs-identifier">lhss'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">lhss</span><span>
</span><span id="line-1098"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">applyDType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">DTANormal</span><span> </span><span class="hs-identifier">lhss'</span><span>
</span><span id="line-1099"></span><span>  </span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- | Desugar clauses to a function definition</span><span>
</span><span id="line-1103"></span><span id="local-6989586621679403262"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-type">dsClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403262"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1104"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>         </span><span class="hs-comment">-- ^ Name of the function</span><span>
</span><span id="line-1105"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Clauses to desugar</span><span>
</span><span id="line-1106"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403262"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1107"></span><span id="dsClauses"><span class="annot"><span class="annottext">dsClauses :: Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var hs-var">dsClauses</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1108"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679402123"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402123"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679402121"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402121"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679402120"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402120"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402119"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402119"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679402118"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402118"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1109"></span><span>  </span><span class="hs-comment">-- this case is necessary to maintain the roundtrip property.</span><span>
</span><span id="line-1110"></span><span>  </span><span id="local-6989586621679402117"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679402117"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402123"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402118"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1111"></span><span>  </span><span id="local-6989586621679402116"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402116"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679402120"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402115"><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402115"><span class="hs-identifier hs-var">where_decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402114"><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402114"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402119"><span class="hs-identifier hs-var">where_decs</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402113"><span class="annot"><span class="annottext">exp_with_wheres :: DExp
</span><a href="#local-6989586621679402113"><span class="hs-identifier hs-var hs-var">exp_with_wheres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679402115"><span class="hs-identifier hs-var">where_decs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679402114"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402116"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679402112"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402112"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402111"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402111"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402121"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402113"><span class="hs-identifier hs-var">exp_with_wheres</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DClause] -&gt; q [DClause]) -&gt; [DClause] -&gt; q [DClause]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402112"><span class="hs-identifier hs-var">pats'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402111"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; [DClause] -&gt; [DClause]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679402117"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1116"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679402109"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402109"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402108"><span class="annot"><span class="annottext">clauses :: [Clause]
</span><a href="#local-6989586621679402108"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679402107"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402107"><span class="hs-identifier hs-var">outer_pats</span></a></span></span><span> </span><span class="annot"><span class="annottext">Body
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1117"></span><span>  </span><span id="local-6989586621679402106"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402106"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; q Name -&gt; q [Name]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402107"><span class="hs-identifier hs-var">outer_pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402105"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679402105"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402106"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>  </span><span id="local-6989586621679402104"><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679402104"><span class="hs-identifier hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; [Name] -&gt; [DPat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679402106"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DClause) -&gt; q DExp -&gt; q DClause
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1120"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402105"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">([DMatch] -&gt; DExp) -&gt; q [DMatch] -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Clause -&gt; [DMatch] -&gt; q [DMatch])
-&gt; [DMatch] -&gt; [Clause] -&gt; q [DMatch]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldrM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
forall (q :: * -&gt; *).
DsMonad q =&gt;
DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679402102"><span class="hs-identifier hs-var">clause_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402105"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402108"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span>  </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679402104"><span class="hs-identifier hs-var">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1123"></span><span>    </span><span id="local-6989586621679403218"><span class="annot"><a href="#local-6989586621679402102"><span class="hs-identifier hs-type">clause_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403218"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403218"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1124"></span><span>    </span><span id="local-6989586621679402102"><span class="annot"><span class="annottext">clause_to_dmatch :: DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679402102"><span class="hs-identifier hs-var hs-var">clause_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679402101"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402101"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679402100"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402100"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679402099"><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402099"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679402098"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402098"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679402097"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402097"><span class="hs-identifier hs-var">failure_matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1125"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402096"><span class="annot"><span class="annottext">failure_exp :: DExp
</span><a href="#local-6989586621679402096"><span class="hs-identifier hs-var hs-var">failure_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-exhaustive patterns in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402109"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>                                    </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402101"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402097"><span class="hs-identifier hs-var">failure_matches</span></a></span><span>
</span><span id="line-1127"></span><span>      </span><span id="local-6989586621679402095"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402095"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679402099"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679402098"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402096"><span class="hs-identifier hs-var">failure_exp</span></a></span><span>
</span><span id="line-1128"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679402094"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402093"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402093"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679402100"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402095"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1129"></span><span>      </span><span id="local-6989586621679402092"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402092"><span class="hs-identifier hs-var">uni_pats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool) -&gt; q All -&gt; q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">(q All -&gt; q Bool) -&gt; q All -&gt; q Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q All) -&gt; [DPat] -&gt; q All
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; q Bool -&gt; q All
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">(q Bool -&gt; q All) -&gt; (DPat -&gt; q Bool) -&gt; DPat -&gt; q All
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">pats'</span></a></span><span>
</span><span id="line-1130"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679402089"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679402093"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-1131"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679402092"><span class="hs-identifier hs-var">uni_pats</span></a></span><span>
</span><span id="line-1132"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1133"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; [DMatch] -&gt; [DMatch]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679402097"><span class="hs-identifier hs-var">failure_matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span class="hs-comment">-- | Desugar a type</span><span>
</span><span id="line-1136"></span><span id="local-6989586621679403463"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-type">dsType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403463"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403463"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span></span><span>
</span><span id="line-1137"></span><span id="dsType"><span class="annot"><span class="annottext">dsType :: Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var hs-var">dsType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679402088"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402088"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402087"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402087"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621679402086"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402086"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1138"></span><span>  </span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var">mkDForallConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType)
-&gt; q [DTyVarBndr] -&gt; q (DCxt -&gt; DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402088"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DType) -&gt; q DCxt -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402087"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402086"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1139"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679402083"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402083"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679402082"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402082"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402083"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402082"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1140"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679402080"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402080"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679402079"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402079"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402080"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402079"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1141"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679402076"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402076"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402076"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1142"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679402074"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402074"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402074"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1143"></span><span>  </span><span class="hs-comment">-- the only difference between ConT and PromotedT is the name lookup. Here, we assume</span><span>
</span><span id="line-1144"></span><span>  </span><span class="hs-comment">-- that the TH quote mechanism figured out the right name. Note that lookupDataName name</span><span>
</span><span id="line-1145"></span><span>  </span><span class="hs-comment">-- does not necessarily work, because `name` has its original module attached, which</span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-comment">-- may not be in scope.</span><span>
</span><span id="line-1147"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679402072"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402072"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402072"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1148"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679402070"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402070"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402070"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span id="local-6989586621679402067"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402067"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402067"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>
</span><span id="line-1151"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1152"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span id="local-6989586621679402062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402062"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402062"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1154"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-1155"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Constraint</span><span>
</span><span id="line-1157"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span id="local-6989586621679402055"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679402055"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679402055"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679402052"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402052"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679402051"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402051"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402050"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402050"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402051"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402052"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402050"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1163"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DType
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1164"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679402047"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402047"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402047"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1165"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span id="local-6989586621679402043"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402043"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679402043"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679402040"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402040"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679402039"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402039"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402040"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402039"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679402036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402036"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402035"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402035"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1173"></span><span>  </span><span id="local-6989586621679402034"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402034"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402035"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1174"></span><span>  </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679402036"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679402034"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span id="local-6989586621679402032"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402032"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679402031"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402031"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DType -&gt; DType)
-&gt; q [DTyVarBndr] -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679402032"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402031"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- | Desugar a @TyVarBndr@</span><span>
</span><span id="line-1181"></span><span id="local-6989586621679403313"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-type">dsTvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403313"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403313"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span></span><span>
</span><span id="line-1182"></span><span id="dsTvb"><span class="annot"><span class="annottext">dsTvb :: TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var hs-var">dsTvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span id="local-6989586621679402027"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402027"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; q DTyVarBndr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; q DTyVarBndr) -&gt; DTyVarBndr -&gt; q DTyVarBndr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402027"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span id="local-6989586621679402024"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402024"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679402023"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402023"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402024"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTyVarBndr) -&gt; q DType -&gt; q DTyVarBndr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402023"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1184"></span><span>
</span><span id="line-1185"></span><span class="hs-comment">-- | Desugar a @Cxt@</span><span>
</span><span id="line-1186"></span><span id="local-6989586621679403311"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-type">dsCxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403311"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403311"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span>
</span><span id="line-1187"></span><span id="dsCxt"><span class="annot"><span class="annottext">dsCxt :: Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var hs-var">dsCxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DCxt) -&gt; Cxt -&gt; q DCxt
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | A backwards-compatible type synonym for the thing representing a single</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- derived class in a @deriving@ clause. (This is a @DerivClause@, @Pred@, or</span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- @Name@ depending on the GHC version.)</span><span>
</span><span id="line-1193"></span><span class="hs-keyword">type</span><span> </span><span id="DerivingClause"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-var">DerivingClause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span>
</span><span id="line-1194"></span><span>
</span><span id="line-1195"></span><span class="hs-comment">-- | Desugar a @DerivingClause@.</span><span>
</span><span id="line-1196"></span><span id="local-6989586621679403282"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-type">dsDerivClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403282"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403282"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span></span><span>
</span><span id="line-1197"></span><span id="dsDerivClause"><span class="annot"><span class="annottext">dsDerivClause :: DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var hs-var">dsDerivClause</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span> </span><span id="local-6989586621679402019"><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679402019"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679402018"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402018"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1198"></span><span>  </span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; DCxt -&gt; DDerivClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-var">DDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DDerivStrategy -&gt; DCxt -&gt; DDerivClause)
-&gt; q (Maybe DDerivStrategy) -&gt; q (DCxt -&gt; DDerivClause)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivStrategy -&gt; q DDerivStrategy)
-&gt; Maybe DerivStrategy -&gt; q (Maybe DDerivStrategy)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy -&gt; q DDerivStrategy
forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679402019"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DDerivClause) -&gt; q DCxt -&gt; q DDerivClause
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679402018"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 711
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pred</span><span>
</span><span id="line-1201"></span><span>
</span><span id="line-1202"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1203"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-identifier">p</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Name</span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1208"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @DerivStrategy@.</span><span>
</span><span id="line-1213"></span><span id="local-6989586621679403287"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-type">dsDerivStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403287"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivStrategy</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403287"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span></span><span>
</span><span id="line-1214"></span><span id="dsDerivStrategy"><span class="annot"><span class="annottext">dsDerivStrategy :: DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var hs-var">dsDerivStrategy</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">StockStrategy</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStockStrategy"><span class="hs-identifier hs-var">DStockStrategy</span></a></span><span>
</span><span id="line-1215"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">AnyclassStrategy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnyclassStrategy"><span class="hs-identifier hs-var">DAnyclassStrategy</span></a></span><span>
</span><span id="line-1216"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">NewtypeStrategy</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNewtypeStrategy"><span class="hs-identifier hs-var">DNewtypeStrategy</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViaStrategy</span></span><span> </span><span id="local-6989586621679402009"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DViaStrategy"><span class="hs-identifier hs-var">DViaStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDerivStrategy) -&gt; q DType -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @PatSynDir@. (Available only with GHC 8.2+)</span><span>
</span><span id="line-1224"></span><span id="local-6989586621679403292"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-type">dsPatSynDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403292"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynDir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403292"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynDir"><span class="hs-identifier hs-type">DPatSynDir</span></a></span></span><span>
</span><span id="line-1225"></span><span id="dsPatSynDir"><span class="annot"><span class="annottext">dsPatSynDir :: Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var hs-var">dsPatSynDir</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">Unidir</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPatSynDir -&gt; q DPatSynDir
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DUnidir"><span class="hs-identifier hs-var">DUnidir</span></a></span><span>
</span><span id="line-1226"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">ImplBidir</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPatSynDir -&gt; q DPatSynDir
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImplBidir"><span class="hs-identifier hs-var">DImplBidir</span></a></span><span>
</span><span id="line-1227"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span id="local-6989586621679402003"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402003"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExplBidir</span></span><span> </span><span id="local-6989586621679402001"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402001"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DClause] -&gt; DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExplBidir"><span class="hs-identifier hs-var">DExplBidir</span></a></span><span> </span><span class="annot"><span class="annottext">([DClause] -&gt; DPatSynDir) -&gt; q [DClause] -&gt; q DPatSynDir
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679402003"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679402001"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- | Desugar a @Pred@, flattening any internal tuples</span><span>
</span><span id="line-1231"></span><span id="local-6989586621679403211"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-type">dsPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403211"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403211"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1234"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">tys</span><span>
</span><span id="line-1235"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span>
</span><span id="line-1236"></span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1237"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">]</span><span>
</span><span id="line-1238"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span id="dsPred"><span class="annot"><span class="annottext">dsPred :: Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var hs-var">dsPred</span></a></span></span><span> </span><span id="local-6989586621679401999"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401999"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679401998"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401998"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Cxt
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-var">splitTuple_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401999"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DCxt) -&gt; Cxt -&gt; q DCxt
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401998"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1243"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679401996"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679401996"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401995"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401995"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679401994"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401994"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Type -&gt; q DCxt
forall (q :: * -&gt; *).
DsMonad q =&gt;
[TyVarBndr] -&gt; Cxt -&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-var">dsForallPred</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679401996"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401995"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401994"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1244"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679401992"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401992"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679401991"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401991"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1245"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679401990"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401990"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401992"><span class="hs-identifier hs-var">t1</span></a></span><span>   </span><span class="hs-comment">-- tuples can't be applied!</span><span>
</span><span id="line-1246"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; (DType -&gt; DType) -&gt; DType -&gt; DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401990"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401991"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1247"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679401989"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401989"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679401988"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401988"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1248"></span><span>  </span><span id="local-6989586621679401987"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401987"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401989"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1249"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401987"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1250"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679401986"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401986"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; (DType -&gt; DType) -&gt; DType -&gt; DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401986"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401988"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1251"></span><span>    </span><span id="local-6989586621679401985"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401985"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401985"><span class="hs-identifier hs-var">other</span></a></span><span>   </span><span class="hs-comment">-- just drop the kind signature on a tuple.</span><span>
</span><span id="line-1252"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679401984"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401984"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401984"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1253"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679401983"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401983"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401983"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1254"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679401982"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679401982"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1255"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted type seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401982"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1256"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1257"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1258"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar in detecting tuple constraints.&quot;</span></span><span>
</span><span id="line-1259"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679401981"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679401981"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1260"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unboxed tuple seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401981"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1261"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arrow seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1262"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1263"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1264"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted tuple seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1265"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted nil seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1266"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Promoted cons seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1267"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;* seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1268"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1269"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The kind `Constraint' seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1270"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679401980"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679401980"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1271"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type literal seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401980"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1272"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679401979"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401979"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679401978"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401978"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679401977"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401977"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401978"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401979"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401977"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1276"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679401976"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401976"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401976"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1277"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679401975"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679401975"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1281"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unboxed sum seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401975"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679401974"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401974"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401973"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401973"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1285"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679401972"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401972"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401974"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1286"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401972"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401973"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679401971"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679401971"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679401970"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401970"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1288"></span><span>  </span><span id="local-6989586621679401969"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401969"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401970"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1289"></span><span>  </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679401971"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401969"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679401968"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679401968"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1293"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Visible dependent quantifier seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401968"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- | Desugar a quantified constraint.</span><span>
</span><span id="line-1297"></span><span id="local-6989586621679403206"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-type">dsForallPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403206"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403206"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span>
</span><span id="line-1298"></span><span id="dsForallPred"><span class="annot"><span class="annottext">dsForallPred :: [TyVarBndr] -&gt; Cxt -&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForallPred"><span class="hs-identifier hs-var hs-var">dsForallPred</span></a></span></span><span> </span><span id="local-6989586621679401967"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679401967"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401966"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401966"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679401965"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401965"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1299"></span><span>  </span><span id="local-6989586621679401964"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401964"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401965"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1300"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401964"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1301"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679401963"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401963"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var">mkDForallConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span>
</span><span id="line-1302"></span><span>                         </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType)
-&gt; q [DTyVarBndr] -&gt; q (DCxt -&gt; DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679401967"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DType) -&gt; q DCxt -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679401966"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401963"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1303"></span><span>    </span><span class="annot"><span class="annottext">DCxt
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot desugar constraint tuples in the body of a quantified constraint&quot;</span></span><span>
</span><span id="line-1304"></span><span>              </span><span class="hs-comment">-- See GHC #15334.</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1307"></span><span class="hs-comment">-- | Like 'reify', but safer and desugared. Uses local declarations where</span><span>
</span><span id="line-1308"></span><span class="hs-comment">-- available.</span><span>
</span><span id="line-1309"></span><span id="local-6989586621679401962"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-type">dsReify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679401962"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679401962"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1310"></span><span id="dsReify"><span class="annot"><span class="annottext">dsReify :: Name -&gt; q (Maybe DInfo)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-var hs-var">dsReify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Info -&gt; q DInfo) -&gt; Maybe Info -&gt; q (Maybe DInfo)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Info -&gt; q DInfo
forall (q :: * -&gt; *). DsMonad q =&gt; Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Info -&gt; q (Maybe DInfo))
-&gt; (Name -&gt; q (Maybe Info)) -&gt; Name -&gt; q (Maybe DInfo)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Info)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a></span><span>
</span><span id="line-1311"></span><span>
</span><span id="line-1312"></span><span class="hs-comment">-- | Like 'reifyType', but safer and desugared. Uses local declarations where</span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- available.</span><span>
</span><span id="line-1314"></span><span id="local-6989586621679401957"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsReifyType"><span class="hs-identifier hs-type">dsReifyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679401957"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679401957"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1315"></span><span id="dsReifyType"><span class="annot"><span class="annottext">dsReifyType :: Name -&gt; q (Maybe DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsReifyType"><span class="hs-identifier hs-var hs-var">dsReifyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; q (Maybe DType))
-&gt; (Name -&gt; q (Maybe Type)) -&gt; Name -&gt; q (Maybe DType)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Type)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Type)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyTypeWithLocals_maybe"><span class="hs-identifier hs-var">reifyTypeWithLocals_maybe</span></a></span><span>
</span><span id="line-1316"></span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- Given a list of `forall`ed type variable binders and a context, construct</span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- a DType using DForallT and DConstrainedT as appropriate. The phrase</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- &quot;as appropriate&quot; is used because DConstrainedT will not be used if the</span><span>
</span><span id="line-1320"></span><span class="hs-comment">-- context is empty, per Note [Desugaring and sweetening ForallT].</span><span>
</span><span id="line-1321"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-type">mkDForallConstrainedT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVisFlag"><span class="hs-identifier hs-type">ForallVisFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1322"></span><span id="mkDForallConstrainedT"><span class="annot"><span class="annottext">mkDForallConstrainedT :: ForallVisFlag -&gt; [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDForallConstrainedT"><span class="hs-identifier hs-var hs-var">mkDForallConstrainedT</span></a></span></span><span> </span><span id="local-6989586621679401954"><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401954"><span class="hs-identifier hs-var">fvf</span></a></span></span><span> </span><span id="local-6989586621679401953"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401953"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401952"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401952"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679401951"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401951"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1323"></span><span>  </span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401954"><span class="hs-identifier hs-var">fvf</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401953"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; DType -&gt; DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401952"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401951"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-var">DConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401952"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401951"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1324"></span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- create a list of expressions in the same order as the fields in the first argument</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- but with the values as given in the second argument</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- if a field is missing from the second argument, use the corresponding expression</span><span>
</span><span id="line-1328"></span><span class="hs-comment">-- from the third argument</span><span>
</span><span id="line-1329"></span><span id="local-6989586621679403451"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-type">reorderFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403451"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldExp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403451"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1330"></span><span id="reorderFields"><span class="annot"><span class="annottext">reorderFields :: Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var hs-var">reorderFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; q DExp)
-&gt; Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span>
</span><span id="line-1331"></span><span>
</span><span id="line-1332"></span><span id="local-6989586621679403335"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-type">reorderFieldsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403335"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldPat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403335"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1333"></span><span id="reorderFieldsPat"><span class="annot"><span class="annottext">reorderFieldsPat :: Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var hs-var">reorderFieldsPat</span></a></span></span><span> </span><span id="local-6989586621679401947"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401947"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679401946"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679401946"><span class="hs-identifier hs-var">field_decs</span></a></span></span><span> </span><span id="local-6989586621679401945"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679401945"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1334"></span><span>  </span><span class="annot"><span class="annottext">(Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; [DPat] -&gt; PatM q [DPat]
forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401947"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679401946"><span class="hs-identifier hs-var">field_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679401945"><span class="hs-identifier hs-var">field_pats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; [DPat]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span id="local-6989586621679403189"><span id="local-6989586621679403190"><span id="local-6989586621679403191"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-type">reorderFields'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679403191"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679403191"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403191"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403189"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1338"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-comment">-- ^ The name of the constructor (used for error reporting)</span><span>
</span><span id="line-1339"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679403190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1340"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403189"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403191"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403189"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-1341"></span><span id="reorderFields%27"><span class="annot"><span class="annottext">reorderFields' :: (a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var hs-var">reorderFields'</span></a></span></span><span> </span><span id="local-6989586621679401944"><span class="annot"><span class="annottext">a -&gt; m da
</span><a href="#local-6989586621679401944"><span class="hs-identifier hs-var">ds_thing</span></a></span></span><span> </span><span id="local-6989586621679401943"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401943"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679401942"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679401942"><span class="hs-identifier hs-var">field_names_types</span></a></span></span><span> </span><span id="local-6989586621679401941"><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679401941"><span class="hs-identifier hs-var">field_things</span></a></span></span><span> </span><span id="local-6989586621679401940"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401940"><span class="hs-identifier hs-var">deflts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1342"></span><span>  </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679401939"><span class="hs-identifier hs-var">check_valid_fields</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m [da] -&gt; m [da]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679401938"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401937"><span class="hs-identifier hs-var">field_names</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401940"><span class="hs-identifier hs-var">deflts</span></a></span><span>
</span><span id="line-1343"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1344"></span><span>    </span><span id="local-6989586621679401937"><span class="annot"><span class="annottext">field_names :: [Name]
</span><a href="#local-6989586621679401937"><span class="hs-identifier hs-var hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Name) -&gt; [VarBangType] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679401936"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401936"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bang
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401936"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679401942"><span class="hs-identifier hs-var">field_names_types</span></a></span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span>    </span><span id="local-6989586621679401939"><span class="annot"><span class="annottext">check_valid_fields :: m ()
</span><a href="#local-6989586621679401939"><span class="hs-identifier hs-var hs-var">check_valid_fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1347"></span><span>      </span><span class="annot"><span class="annottext">[(Name, a)] -&gt; ((Name, a) -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679401941"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, a) -&gt; m ()) -&gt; m ()) -&gt; ((Name, a) -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679401935"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401935"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1348"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401935"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401937"><span class="hs-identifier hs-var">field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1349"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401943"><span class="hs-identifier hs-var">con_name</span></a></span><span>   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; does not have field &#8216;&quot;</span></span><span>
</span><span id="line-1350"></span><span>                                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401935"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216;&quot;</span></span><span>
</span><span id="line-1351"></span><span>
</span><span id="line-1352"></span><span>    </span><span id="local-6989586621679401938"><span class="annot"><span class="annottext">reorder :: [Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679401938"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[da]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[da] -&gt; m [da]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1353"></span><span>    </span><span class="annot"><a href="#local-6989586621679401938"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401934"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401934"><span class="hs-identifier hs-var">field_name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679401933"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401933"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401932"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679401932"><span class="hs-identifier hs-var">deflt</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679401931"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401931"><span class="hs-identifier hs-var">rest_deflt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1354"></span><span>      </span><span id="local-6989586621679401930"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401930"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679401938"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401933"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401931"><span class="hs-identifier hs-var">rest_deflt</span></a></span><span>
</span><span id="line-1355"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Name, a) -&gt; Bool) -&gt; [(Name, a)] -&gt; Maybe (Name, a)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679401928"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401928"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401928"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401934"><span class="hs-identifier hs-var">field_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679401941"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1356"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401927"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">da -&gt; [da] -&gt; [da]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401930"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(da -&gt; [da]) -&gt; m da -&gt; m [da]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m da
</span><a href="#local-6989586621679401944"><span class="hs-identifier hs-var">ds_thing</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401927"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1357"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Name, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[da] -&gt; m [da]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([da] -&gt; m [da]) -&gt; [da] -&gt; m [da]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679401932"><span class="hs-identifier hs-var">deflt</span></a></span><span> </span><span class="annot"><span class="annottext">da -&gt; [da] -&gt; [da]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679401930"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1358"></span><span>    </span><span class="annot"><a href="#local-6989586621679401938"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m [da]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error in th-desugar.&quot;</span></span><span>
</span><span id="line-1359"></span><span>
</span><span id="line-1360"></span><span class="hs-comment">-- | Make a tuple 'DExp' from a list of 'DExp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1361"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-type">mkTupleDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1362"></span><span id="mkTupleDExp"><span class="annot"><span class="annottext">mkTupleDExp :: [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var hs-var">mkTupleDExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679401926"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679401926"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679401926"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1363"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span id="local-6989586621679401925"><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679401925"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DExp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679401925"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679401925"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span class="hs-comment">-- | Make a tuple 'Exp' from a list of 'Exp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1366"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-type">mkTupleExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1367"></span><span id="mkTupleExp"><span class="annot"><span class="annottext">mkTupleExp :: [Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var hs-var">mkTupleExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679401924"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679401924"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679401924"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1368"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span id="local-6989586621679401923"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679401923"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679401923"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679401923"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="hs-comment">-- | Make a tuple 'DPat' from a list of 'DPat's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1371"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-type">mkTupleDPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span>
</span><span id="line-1372"></span><span id="mkTupleDPat"><span class="annot"><span class="annottext">mkTupleDPat :: [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var hs-var">mkTupleDPat</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679401922"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401922"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401922"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1373"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span id="local-6989586621679401921"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679401921"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679401921"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679401921"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- | Make a tuple 'Pat' from a list of 'Pat's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1376"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-type">mkTuplePat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-1377"></span><span id="mkTuplePat"><span class="annot"><span class="annottext">mkTuplePat :: [Pat] -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var hs-var">mkTuplePat</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679401920"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679401920"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679401920"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1378"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var">mkTuplePat</span></a></span><span> </span><span id="local-6989586621679401919"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679401919"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679401919"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679401919"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1379"></span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- | Is this pattern guaranteed to match?</span><span>
</span><span id="line-1381"></span><span id="local-6989586621679403384"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-type">isUniversalPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403384"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403384"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1382"></span><span id="isUniversalPattern"><span class="annot"><span class="annottext">isUniversalPattern :: DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var hs-var">isUniversalPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1383"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1384"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679401918"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401918"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679401917"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679401917"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1385"></span><span>  </span><span id="local-6989586621679401916"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401916"><span class="hs-identifier hs-var">data_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401918"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-1386"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679401914"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679401914"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401913"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679401913"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; q ([TyVarBndr], [Con])
forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401916"><span class="hs-identifier hs-var">data_name</span></a></span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679401913"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1388"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; q [Bool] -&gt; q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">(q [Bool] -&gt; q Bool) -&gt; q [Bool] -&gt; q Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q Bool) -&gt; [DPat] -&gt; q [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679401917"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1389"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1390"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1391"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679401912"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401912"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401912"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1392"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679401911"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401911"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">DType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679401911"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1393"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- | Apply one 'DExp' to a list of arguments</span><span>
</span><span id="line-1396"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-type">applyDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1397"></span><span id="applyDExp"><span class="annot"><span class="annottext">applyDExp :: DExp -&gt; [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-var hs-var">applyDExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- | Apply one 'DType' to a list of arguments</span><span>
</span><span id="line-1400"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-type">applyDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1401"></span><span id="applyDType"><span class="annot"><span class="annottext">applyDType :: DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var hs-var">applyDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg -&gt; DType) -&gt; DType -&gt; [DTypeArg] -&gt; DType
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg -&gt; DType
</span><a href="#local-6989586621679401909"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1402"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1403"></span><span>    </span><span class="annot"><a href="#local-6989586621679401909"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1404"></span><span>    </span><span id="local-6989586621679401909"><span class="annot"><span class="annottext">apply :: DType -&gt; DTypeArg -&gt; DType
</span><a href="#local-6989586621679401909"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679401908"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401908"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679401906"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401906"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401908"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401906"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1405"></span><span>    </span><span class="annot"><a href="#local-6989586621679401909"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span id="local-6989586621679401905"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401905"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679401903"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401903"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-operator hs-var">`DAppKindT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401903"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- | An argument to a type, either a normal type ('DTANormal') or a visible</span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- kind application ('DTyArg').</span><span>
</span><span id="line-1409"></span><span class="hs-comment">--</span><span>
</span><span id="line-1410"></span><span class="hs-comment">-- 'DTypeArg' does not appear directly in the @th-desugar@ AST, but it is</span><span>
</span><span id="line-1411"></span><span class="hs-comment">-- useful when decomposing an application of a 'DType' to its arguments.</span><span>
</span><span id="line-1412"></span><span id="local-6989586621679401901"><span id="local-6989586621679401902"></span></span><span class="hs-keyword">data</span><span> </span><span id="DTypeArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-var">DTypeArg</span></a></span></span><span>
</span><span id="line-1413"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DTANormal"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DTyArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1415"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401896"><span id="local-6989586621679401898"><span class="annot"><span class="annottext">DTypeArg -&gt; DTypeArg -&gt; Bool
(DTypeArg -&gt; DTypeArg -&gt; Bool)
-&gt; (DTypeArg -&gt; DTypeArg -&gt; Bool) -&gt; Eq DTypeArg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
== :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c== :: DTypeArg -&gt; DTypeArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401889"><span id="local-6989586621679401891"><span id="local-6989586621679401893"><span class="annot"><span class="annottext">Int -&gt; DTypeArg -&gt; String -&gt; String
[DTypeArg] -&gt; String -&gt; String
DTypeArg -&gt; String
(Int -&gt; DTypeArg -&gt; String -&gt; String)
-&gt; (DTypeArg -&gt; String)
-&gt; ([DTypeArg] -&gt; String -&gt; String)
-&gt; Show DTypeArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DTypeArg] -&gt; String -&gt; String
$cshowList :: [DTypeArg] -&gt; String -&gt; String
show :: DTypeArg -&gt; String
$cshow :: DTypeArg -&gt; String
showsPrec :: Int -&gt; DTypeArg -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DTypeArg -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cDTyArg"><span id="%24cDTANormal"><span id="%24tDTypeArg"><span id="local-6989586621679401859"><span id="local-6989586621679401861"><span id="local-6989586621679401863"><span id="local-6989586621679401865"><span id="local-6989586621679401867"><span id="local-6989586621679401869"><span id="local-6989586621679401871"><span id="local-6989586621679401873"><span id="local-6989586621679401875"><span id="local-6989586621679401877"><span id="local-6989586621679401879"><span id="local-6989586621679401881"><span id="local-6989586621679401883"><span id="local-6989586621679401885"><span class="annot"><span class="annottext">Typeable DTypeArg
DataType
Constr
Typeable DTypeArg
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg)
-&gt; (DTypeArg -&gt; Constr)
-&gt; (DTypeArg -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; Data DTypeArg
DTypeArg -&gt; DataType
DTypeArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
$cDTyArg :: Constr
$cDTANormal :: Constr
$tDTypeArg :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
dataTypeOf :: DTypeArg -&gt; DataType
$cdataTypeOf :: DTypeArg -&gt; DataType
toConstr :: DTypeArg -&gt; Constr
$ctoConstr :: DTypeArg -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
$cp1Data :: Typeable DTypeArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DTypeArg -&gt; Rep DTypeArg x)
-&gt; (forall x. Rep DTypeArg x -&gt; DTypeArg) -&gt; Generic DTypeArg
forall x. Rep DTypeArg x -&gt; DTypeArg
forall x. DTypeArg -&gt; Rep DTypeArg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DTypeArg x -&gt; DTypeArg
$cfrom :: forall x. DTypeArg -&gt; Rep DTypeArg x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1416"></span><span>
</span><span id="line-1417"></span><span class="hs-comment">-- | Desugar a 'TypeArg'.</span><span>
</span><span id="line-1418"></span><span id="local-6989586621679403279"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-type">dsTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403279"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403279"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span></span><span>
</span><span id="line-1419"></span><span id="dsTypeArg"><span class="annot"><span class="annottext">dsTypeArg :: TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var hs-var">dsTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679401850"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401850"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg) -&gt; q DType -&gt; q DTypeArg
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401850"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679401848"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401848"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span>    </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg) -&gt; q DType -&gt; q DTypeArg
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679401848"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1421"></span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- | Filter the normal type arguments from a list of 'DTypeArg's.</span><span>
</span><span id="line-1423"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-type">filterDTANormals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1424"></span><span id="filterDTANormals"><span class="annot"><span class="annottext">filterDTANormals :: [DTypeArg] -&gt; DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-var hs-var">filterDTANormals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DTypeArg -&gt; Maybe DType) -&gt; [DTypeArg] -&gt; DCxt
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; Maybe DType
</span><a href="#local-6989586621679401846"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span>
</span><span id="line-1425"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1426"></span><span>    </span><span class="annot"><a href="#local-6989586621679401846"><span class="hs-identifier hs-type">getDTANormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1427"></span><span>    </span><span id="local-6989586621679401846"><span class="annot"><span class="annottext">getDTANormal :: DTypeArg -&gt; Maybe DType
</span><a href="#local-6989586621679401846"><span class="hs-identifier hs-var hs-var">getDTANormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679401845"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401845"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401845"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1428"></span><span>    </span><span class="annot"><a href="#local-6989586621679401846"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1429"></span><span>
</span><span id="line-1430"></span><span class="hs-comment">-- | Convert a 'DTyVarBndr' into a 'DType'</span><span>
</span><span id="line-1431"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-type">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1432"></span><span id="dTyVarBndrToDType"><span class="annot"><span class="annottext">dTyVarBndrToDType :: DTyVarBndr -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var hs-var">dTyVarBndrToDType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679401843"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401843"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401843"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1433"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679401842"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401842"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679401841"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401841"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401842"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-operator hs-var">`DSigT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401841"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1434"></span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- | Extract the underlying 'DType' or 'DKind' from a 'DTypeArg'. This forgets</span><span>
</span><span id="line-1436"></span><span class="hs-comment">-- information about whether a type is a normal argument or not, so use with</span><span>
</span><span id="line-1437"></span><span class="hs-comment">-- caution.</span><span>
</span><span id="line-1438"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-type">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1439"></span><span id="probablyWrongUnDTypeArg"><span class="annot"><span class="annottext">probablyWrongUnDTypeArg :: DTypeArg -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var hs-var">probablyWrongUnDTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679401839"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401839"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401839"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1440"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679401838"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401838"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401838"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1441"></span><span>
</span><span id="line-1442"></span><span class="hs-comment">-- | Convert a 'Strict' to a 'Bang' in GHCs 7.x. This is just</span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- the identity operation in GHC 8.x, which has no 'Strict'.</span><span>
</span><span id="line-1444"></span><span class="hs-comment">-- (This is included in GHC 8.x only for good Haddocking.)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bang</span><span>
</span><span id="line-1447"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">IsStrict</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">SourceStrict</span><span>
</span><span id="line-1448"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">NotStrict</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">NoSourceStrictness</span><span>
</span><span id="line-1449"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">Unpacked</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">SourceUnpack</span><span> </span><span class="hs-identifier">SourceStrict</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-type">strictToBang</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span>
</span><span id="line-1452"></span><span id="strictToBang"><span class="annot"><span class="annottext">strictToBang :: Bang -&gt; Bang
</span><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-var hs-var">strictToBang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bang -&gt; Bang
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1455"></span><span class="hs-comment">-- Take a data type name (which does not belong to a data family) and</span><span>
</span><span id="line-1456"></span><span class="hs-comment">-- apply it to its type variable binders to form a DType.</span><span>
</span><span id="line-1457"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-type">nonFamilyDataReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1458"></span><span id="nonFamilyDataReturnType"><span class="annot"><span class="annottext">nonFamilyDataReturnType :: Name -&gt; [DTyVarBndr] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var hs-var">nonFamilyDataReturnType</span></a></span></span><span> </span><span id="local-6989586621679401836"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401836"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1459"></span><span>  </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401836"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DTypeArg] -&gt; DType)
-&gt; ([DTyVarBndr] -&gt; [DTypeArg]) -&gt; [DTyVarBndr] -&gt; DType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; DTypeArg) -&gt; [DTyVarBndr] -&gt; [DTypeArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg)
-&gt; (DTyVarBndr -&gt; DType) -&gt; DTyVarBndr -&gt; DTypeArg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1460"></span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- Take a data family name and apply it to its argument types to form a</span><span>
</span><span id="line-1462"></span><span class="hs-comment">-- data family instance DType.</span><span>
</span><span id="line-1463"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-type">dataFamInstReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1464"></span><span id="dataFamInstReturnType"><span class="annot"><span class="annottext">dataFamInstReturnType :: Name -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var hs-var">dataFamInstReturnType</span></a></span></span><span> </span><span id="local-6989586621679401835"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401835"><span class="hs-identifier hs-var">fam_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401835"><span class="hs-identifier hs-var">fam_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- Data family instance declarations did not come equipped with a list of bound</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- type variables until GHC 8.8 (and even then, it's optional whether the user</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- provides them or not). This means that there are situations where we must</span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- reverse engineer this information ourselves from the list of type</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- arguments. We accomplish this by taking the free variables of the types</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- and performing a reverse topological sort on them to ensure that the</span><span>
</span><span id="line-1472"></span><span class="hs-comment">-- returned list is well scoped.</span><span>
</span><span id="line-1473"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-type">dataFamInstTvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1474"></span><span id="dataFamInstTvbs"><span class="annot"><span class="annottext">dataFamInstTvbs :: [DTypeArg] -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var hs-var">dataFamInstTvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; [DTyVarBndr])
-&gt; ([DTypeArg] -&gt; DCxt) -&gt; [DTypeArg] -&gt; [DTyVarBndr]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DTypeArg -&gt; DType) -&gt; [DTypeArg] -&gt; DCxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span>
</span><span id="line-1475"></span><span>
</span><span id="line-1476"></span><span class="hs-comment">-- | Take a list of 'DType's, find their free variables, and sort them in</span><span>
</span><span id="line-1477"></span><span class="hs-comment">-- reverse topological order to ensure that they are well scoped. In other</span><span>
</span><span id="line-1478"></span><span class="hs-comment">-- words, the free variables are ordered such that:</span><span>
</span><span id="line-1479"></span><span class="hs-comment">--</span><span>
</span><span id="line-1480"></span><span class="hs-comment">-- 1. Whenever an explicit kind signature of the form @(A :: K)@ is</span><span>
</span><span id="line-1481"></span><span class="hs-comment">--    encountered, the free variables of @K@ will always appear to the left of</span><span>
</span><span id="line-1482"></span><span class="hs-comment">--    the free variables of @A@ in the returned result.</span><span>
</span><span id="line-1483"></span><span class="hs-comment">--</span><span>
</span><span id="line-1484"></span><span class="hs-comment">-- 2. The constraint in (1) notwithstanding, free variables will appear in</span><span>
</span><span id="line-1485"></span><span class="hs-comment">--    left-to-right order of their original appearance.</span><span>
</span><span id="line-1486"></span><span class="hs-comment">--</span><span>
</span><span id="line-1487"></span><span class="hs-comment">-- On older GHCs, this takes measures to avoid returning explicitly bound</span><span>
</span><span id="line-1488"></span><span class="hs-comment">-- kind variables, which was not possible before @TypeInType@.</span><span>
</span><span id="line-1489"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-type">toposortTyVarsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1490"></span><span id="toposortTyVarsOf"><span class="annot"><span class="annottext">toposortTyVarsOf :: DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var hs-var">toposortTyVarsOf</span></a></span></span><span> </span><span id="local-6989586621679401834"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401834"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1491"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679401833"><span class="hs-identifier hs-type">freeVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1492"></span><span>      </span><span id="local-6989586621679401833"><span class="annot"><span class="annottext">freeVars :: [Name]
</span><a href="#local-6989586621679401833"><span class="hs-identifier hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name -&gt; [Name]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(OSet Name -&gt; [Name]) -&gt; OSet Name -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; OSet Name) -&gt; DCxt -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401834"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1493"></span><span>
</span><span id="line-1494"></span><span>      </span><span class="annot"><a href="#local-6989586621679401830"><span class="hs-identifier hs-type">varKindSigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1495"></span><span>      </span><span id="local-6989586621679401830"><span class="annot"><span class="annottext">varKindSigs :: Map Name DType
</span><a href="#local-6989586621679401830"><span class="hs-identifier hs-var hs-var">varKindSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Map Name DType) -&gt; DCxt -&gt; Map Name DType
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401834"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1496"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1497"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1498"></span><span>          </span><span id="local-6989586621679401829"><span class="annot"><span class="annottext">go_ty :: DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401828"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401828"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401827"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401827"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679401826"><span class="hs-identifier hs-var">go_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401828"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401827"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1499"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679401825"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401825"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679401824"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401824"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Map Name DType) -&gt; DCxt -&gt; Map Name DType
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401825"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401824"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1500"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679401823"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401823"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679401822"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401822"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401823"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401822"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1501"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679401821"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401821"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401820"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401820"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401821"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401820"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1502"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679401819"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401819"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401818"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401818"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1503"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679401817"><span class="annot"><span class="annottext">kSigs :: Map Name DType
</span><a href="#local-6989586621679401817"><span class="hs-identifier hs-var hs-var">kSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401818"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1504"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401819"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1505"></span><span>                 </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679401816"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401816"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401816"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401818"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401817"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1506"></span><span>                 </span><span class="annot"><span class="annottext">DType
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401819"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401817"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1507"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1508"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1509"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1510"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1511"></span><span>          </span><span class="annot"><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1512"></span><span>
</span><span id="line-1513"></span><span>          </span><span class="annot"><a href="#local-6989586621679401826"><span class="hs-identifier hs-type">go_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1514"></span><span>          </span><span id="local-6989586621679401826"><span class="annot"><span class="annottext">go_tvbs :: [DTyVarBndr] -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679401826"><span class="hs-identifier hs-var hs-var">go_tvbs</span></a></span></span><span> </span><span id="local-6989586621679401814"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401814"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401813"><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401813"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType)
-&gt; Map Name DType -&gt; [DTyVarBndr] -&gt; Map Name DType
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679401812"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401813"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401814"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1515"></span><span>
</span><span id="line-1516"></span><span>          </span><span class="annot"><a href="#local-6989586621679401812"><span class="hs-identifier hs-type">go_tvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1517"></span><span>          </span><span id="local-6989586621679401812"><span class="annot"><span class="annottext">go_tvb :: DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679401812"><span class="hs-identifier hs-var hs-var">go_tvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679401811"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401811"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679401810"><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401810"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401811"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401810"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1518"></span><span>          </span><span class="annot"><a href="#local-6989586621679401812"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679401808"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401808"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679401807"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401807"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401806"><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401806"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401808"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401806"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679401829"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401807"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1519"></span><span>
</span><span id="line-1520"></span><span>      </span><span class="hs-comment">-- | Do a topological sort on a list of tyvars,</span><span>
</span><span id="line-1521"></span><span>      </span><span class="hs-comment">--   so that binders occur before occurrences</span><span>
</span><span id="line-1522"></span><span>      </span><span class="hs-comment">-- E.g. given  [ a::k, k::*, b::k ]</span><span>
</span><span id="line-1523"></span><span>      </span><span class="hs-comment">-- it'll return a well-scoped list [ k::*, a::k, b::k ]</span><span>
</span><span id="line-1524"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1525"></span><span>      </span><span class="hs-comment">-- This is a deterministic sorting operation</span><span>
</span><span id="line-1526"></span><span>      </span><span class="hs-comment">-- (that is, doesn't depend on Uniques).</span><span>
</span><span id="line-1527"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1528"></span><span>      </span><span class="hs-comment">-- It is also meant to be stable: that is, variables should not</span><span>
</span><span id="line-1529"></span><span>      </span><span class="hs-comment">-- be reordered unnecessarily.</span><span>
</span><span id="line-1530"></span><span>      </span><span class="annot"><a href="#local-6989586621679401805"><span class="hs-identifier hs-type">scopedSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1531"></span><span>      </span><span id="local-6989586621679401805"><span class="annot"><span class="annottext">scopedSort :: [Name] -&gt; [Name]
</span><a href="#local-6989586621679401805"><span class="hs-identifier hs-var hs-var">scopedSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679401804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span>      </span><span class="annot"><a href="#local-6989586621679401804"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- already sorted, in reverse order</span><span>
</span><span id="line-1534"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- each set contains all the variables which must be placed</span><span>
</span><span id="line-1535"></span><span>                       </span><span class="hs-comment">-- before the tv corresponding to the set; they are accumulations</span><span>
</span><span id="line-1536"></span><span>                       </span><span class="hs-comment">-- of the fvs in the sorted tvs' kinds</span><span>
</span><span id="line-1537"></span><span>
</span><span id="line-1538"></span><span>                       </span><span class="hs-comment">-- This list is in 1-to-1 correspondence with the sorted tyvars</span><span>
</span><span id="line-1539"></span><span>                       </span><span class="hs-comment">-- INVARIANT:</span><span>
</span><span id="line-1540"></span><span>                       </span><span class="hs-comment">--   all (\tl -&gt; all (`isSubsetOf` head tl) (tail tl)) (tails fv_list)</span><span>
</span><span id="line-1541"></span><span>                       </span><span class="hs-comment">-- That is, each set in the list is a superset of all later sets.</span><span>
</span><span id="line-1542"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- yet to be sorted</span><span>
</span><span id="line-1543"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1544"></span><span>      </span><span id="local-6989586621679401804"><span class="annot"><span class="annottext">go :: [Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679401804"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679401803"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401803"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679401802"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401802"><span class="hs-identifier hs-var">_fv_list</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401803"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1545"></span><span>      </span><span class="annot"><a href="#local-6989586621679401804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679401800"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401800"><span class="hs-identifier hs-var">acc</span></a></span></span><span>  </span><span id="local-6989586621679401799"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401799"><span class="hs-identifier hs-var">fv_list</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401798"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401798"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679401797"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401797"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1546"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679401804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401796"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401795"><span class="hs-identifier hs-var">fv_list'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401797"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1547"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1548"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679401796"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401796"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401795"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401795"><span class="hs-identifier hs-var">fv_list'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679401794"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401798"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401800"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401799"><span class="hs-identifier hs-var">fv_list</span></a></span><span>
</span><span id="line-1549"></span><span>
</span><span id="line-1550"></span><span>      </span><span class="annot"><a href="#local-6989586621679401794"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>       </span><span class="hs-comment">-- var to insert</span><span>
</span><span id="line-1551"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- sorted list, in reverse order</span><span>
</span><span id="line-1552"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of fvs, as above</span><span>
</span><span id="line-1553"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- augmented lists</span><span>
</span><span id="line-1554"></span><span>      </span><span id="local-6989586621679401794"><span class="annot"><span class="annottext">insert :: Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679401794"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679401793"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401793"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401793"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679401792"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401793"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1555"></span><span>      </span><span class="annot"><a href="#local-6989586621679401794"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span id="local-6989586621679401791"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401791"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401790"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401790"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679401789"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401789"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401788"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401788"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679401787"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401787"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401791"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401788"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1557"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401785"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401785"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401784"><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401784"><span class="hs-identifier hs-var">fvss'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679401794"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401791"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401789"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401787"><span class="hs-identifier hs-var">fvss</span></a></span><span>
</span><span id="line-1558"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401790"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401785"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401788"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401782"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401784"><span class="hs-identifier hs-var">fvss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1559"></span><span>
</span><span id="line-1560"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1561"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401791"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401790"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401789"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401788"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401782"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679401788"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679401787"><span class="hs-identifier hs-var">fvss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1563"></span><span>          </span><span id="local-6989586621679401782"><span class="annot"><span class="annottext">fv_tv :: Set Name
</span><a href="#local-6989586621679401782"><span class="hs-identifier hs-var hs-var">fv_tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679401792"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401791"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span>         </span><span class="hs-comment">-- lists not in correspondence</span><span>
</span><span id="line-1566"></span><span>      </span><span class="annot"><a href="#local-6989586621679401794"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Name], [Set Name])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scopedSort&quot;</span></span><span>
</span><span id="line-1567"></span><span>
</span><span id="line-1568"></span><span>      </span><span id="local-6989586621679401792"><span class="annot"><span class="annottext">kindFVSet :: Name -&gt; Set Name
</span><a href="#local-6989586621679401792"><span class="hs-identifier hs-var hs-var">kindFVSet</span></a></span></span><span> </span><span id="local-6989586621679401781"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401781"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1569"></span><span>        </span><span class="annot"><span class="annottext">Set Name -&gt; (DType -&gt; Set Name) -&gt; Maybe DType -&gt; Set Name
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Set Name
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; Set Name
forall a. OSet a -&gt; Set a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#toSet"><span class="hs-identifier hs-var">OS.toSet</span></a></span><span> </span><span class="annot"><span class="annottext">(OSet Name -&gt; Set Name)
-&gt; (DType -&gt; OSet Name) -&gt; DType -&gt; Set Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1570"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Maybe DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401781"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401830"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>      </span><span id="local-6989586621679401777"><span class="annot"><span class="annottext">ascribeWithKind :: Name -&gt; DTyVarBndr
</span><a href="#local-6989586621679401777"><span class="hs-identifier hs-var hs-var">ascribeWithKind</span></a></span></span><span> </span><span id="local-6989586621679401776"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401776"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1572"></span><span>        </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; (DType -&gt; DTyVarBndr) -&gt; Maybe DType -&gt; DTyVarBndr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401776"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401776"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Maybe DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679401830"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span>      </span><span class="hs-comment">-- An annoying wrinkle: GHCs before 8.0 don't support explicitly</span><span>
</span><span id="line-1575"></span><span>      </span><span class="hs-comment">-- quantifying kinds, so something like @forall k (a :: k)@ would be</span><span>
</span><span id="line-1576"></span><span>      </span><span class="hs-comment">-- rejected. To work around this, we filter out any binders whose names</span><span>
</span><span id="line-1577"></span><span>      </span><span class="hs-comment">-- also appear in a kind on old GHCs.</span><span>
</span><span id="line-1578"></span><span>      </span><span id="local-6989586621679401775"><span class="annot"><span class="annottext">isKindBinderOnOldGHCs :: b -&gt; Bool
</span><a href="#local-6989586621679401775"><span class="hs-identifier hs-var hs-var">isKindBinderOnOldGHCs</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">kindVars</span><span class="hs-special">)</span><span>
</span><span id="line-1583"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1584"></span><span>            </span><span class="hs-identifier">kindVars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">fvDType</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">M.elems</span><span> </span><span class="hs-identifier">varKindSigs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1587"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DTyVarBndr) -&gt; [Name] -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="#local-6989586621679401777"><span class="hs-identifier hs-var">ascribeWithKind</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DTyVarBndr]) -&gt; [Name] -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1588"></span><span>     </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Name -&gt; Bool) -&gt; Name -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall b. b -&gt; Bool
</span><a href="#local-6989586621679401775"><span class="hs-identifier hs-var">isKindBinderOnOldGHCs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [Name]) -&gt; [Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1589"></span><span>     </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
</span><a href="#local-6989586621679401805"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679401833"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1590"></span><span>
</span><span id="line-1591"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-type">dtvbName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1592"></span><span id="dtvbName"><span class="annot"><span class="annottext">dtvbName :: DTyVarBndr -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var hs-var">dtvbName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679401771"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401771"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401771"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1593"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var">dtvbName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679401770"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401770"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679401770"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1594"></span><span>
</span><span id="line-1595"></span><span class="hs-comment">-- | Reconstruct an arrow 'DType' from its argument and result types.</span><span>
</span><span id="line-1596"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-type">ravelDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1597"></span><span id="ravelDType"><span class="annot"><span class="annottext">ravelDType :: DFunArgs -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var hs-var">ravelDType</span></a></span></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span>                     </span><span id="local-6989586621679401767"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401767"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401767"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1598"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-type">DFAForalls</span></a></span><span> </span><span id="local-6989586621679401765"><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401765"><span class="hs-identifier hs-var">fvf</span></a></span></span><span> </span><span id="local-6989586621679401764"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401764"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401763"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401763"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401762"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401762"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401765"><span class="hs-identifier hs-var">fvf</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401764"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401763"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401762"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-type">DFACxt</span></a></span><span> </span><span id="local-6989586621679401760"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401760"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679401759"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401759"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>          </span><span id="local-6989586621679401758"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401758"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-var">DConstrainedT</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401760"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401759"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401758"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1600"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-type">DFAAnon</span></a></span><span> </span><span id="local-6989586621679401756"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401756"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401755"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401755"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>           </span><span id="local-6989586621679401754"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401754"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401756"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#ravelDType"><span class="hs-identifier hs-var">ravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401755"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401754"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span class="hs-comment">-- | Decompose a function 'DType' into its arguments (the 'DFunArgs') and its</span><span>
</span><span id="line-1603"></span><span class="hs-comment">-- result type (the 'DType).</span><span>
</span><span id="line-1604"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-type">unravelDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1605"></span><span id="unravelDType"><span class="annot"><span class="annottext">unravelDType :: DType -&gt; (DFunArgs, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var hs-var">unravelDType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679401752"><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401752"><span class="hs-identifier hs-var">fvf</span></a></span></span><span> </span><span id="local-6989586621679401751"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401751"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401750"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401750"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1606"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401749"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401749"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401748"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401748"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; (DFunArgs, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401750"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1607"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForallVisFlag -&gt; [DTyVarBndr] -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-var">DFAForalls</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401752"><span class="hs-identifier hs-var">fvf</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401751"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401749"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401748"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1608"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConstrainedT"><span class="hs-identifier hs-type">DConstrainedT</span></a></span><span> </span><span id="local-6989586621679401747"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401747"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679401746"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401746"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1609"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401745"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401745"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401744"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401744"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; (DFunArgs, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401746"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1610"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-var">DFACxt</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679401747"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401745"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401744"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1611"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span> </span><span id="local-6989586621679401743"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401743"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401742"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401742"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1612"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401741"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401741"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401740"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401740"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; (DFunArgs, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401742"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1613"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DFunArgs -&gt; DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-var">DFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401743"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401741"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401740"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravelDType"><span class="hs-identifier hs-var">unravelDType</span></a></span><span> </span><span id="local-6989586621679401739"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401739"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401739"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>
</span><span id="line-1616"></span><span class="hs-comment">-- | The list of arguments in a function 'DType'.</span><span>
</span><span id="line-1617"></span><span id="local-6989586621679401737"><span id="local-6989586621679401738"></span></span><span class="hs-keyword">data</span><span> </span><span id="DFunArgs"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-var">DFunArgs</span></a></span></span><span>
</span><span id="line-1618"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DFANil"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span></span><span>
</span><span id="line-1619"></span><span>    </span><span class="hs-comment">-- ^ No more arguments.</span><span>
</span><span id="line-1620"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFAForalls"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-var">DFAForalls</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#ForallVisFlag"><span class="hs-identifier hs-type">ForallVisFlag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1621"></span><span>    </span><span class="hs-comment">-- ^ A series of @forall@ed type variables followed by a dot (if</span><span>
</span><span id="line-1622"></span><span>    </span><span class="hs-comment">--   'ForallInvis') or an arrow (if 'ForallVis'). For example,</span><span>
</span><span id="line-1623"></span><span>    </span><span class="hs-comment">--   the type variables @a1 ... an@ in @forall a1 ... an. r@.</span><span>
</span><span id="line-1624"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFACxt"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-var">DFACxt</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1625"></span><span>    </span><span class="hs-comment">-- ^ A series of constraint arguments followed by @=&gt;@. For example,</span><span>
</span><span id="line-1626"></span><span>    </span><span class="hs-comment">--   the @(c1, ..., cn)@ in @(c1, ..., cn) =&gt; r@.</span><span>
</span><span id="line-1627"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-var">DFAAnon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span>
</span><span id="line-1628"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow. For example, the @a@</span><span>
</span><span id="line-1629"></span><span>    </span><span class="hs-comment">--   in @a -&gt; r@.</span><span>
</span><span id="line-1630"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401733"><span id="local-6989586621679401735"><span class="annot"><span class="annottext">DFunArgs -&gt; DFunArgs -&gt; Bool
(DFunArgs -&gt; DFunArgs -&gt; Bool)
-&gt; (DFunArgs -&gt; DFunArgs -&gt; Bool) -&gt; Eq DFunArgs
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DFunArgs -&gt; DFunArgs -&gt; Bool
$c/= :: DFunArgs -&gt; DFunArgs -&gt; Bool
== :: DFunArgs -&gt; DFunArgs -&gt; Bool
$c== :: DFunArgs -&gt; DFunArgs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401727"><span id="local-6989586621679401729"><span id="local-6989586621679401731"><span class="annot"><span class="annottext">Int -&gt; DFunArgs -&gt; String -&gt; String
[DFunArgs] -&gt; String -&gt; String
DFunArgs -&gt; String
(Int -&gt; DFunArgs -&gt; String -&gt; String)
-&gt; (DFunArgs -&gt; String)
-&gt; ([DFunArgs] -&gt; String -&gt; String)
-&gt; Show DFunArgs
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DFunArgs] -&gt; String -&gt; String
$cshowList :: [DFunArgs] -&gt; String -&gt; String
show :: DFunArgs -&gt; String
$cshow :: DFunArgs -&gt; String
showsPrec :: Int -&gt; DFunArgs -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DFunArgs -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cDFAAnon"><span id="%24cDFACxt"><span id="%24cDFAForalls"><span id="%24cDFANil"><span id="%24tDFunArgs"><span id="local-6989586621679401698"><span id="local-6989586621679401700"><span id="local-6989586621679401702"><span id="local-6989586621679401704"><span id="local-6989586621679401706"><span id="local-6989586621679401708"><span id="local-6989586621679401710"><span id="local-6989586621679401712"><span id="local-6989586621679401714"><span id="local-6989586621679401716"><span id="local-6989586621679401718"><span id="local-6989586621679401720"><span id="local-6989586621679401722"><span id="local-6989586621679401724"><span class="annot"><span class="annottext">Typeable DFunArgs
DataType
Constr
Typeable DFunArgs
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs)
-&gt; (DFunArgs -&gt; Constr)
-&gt; (DFunArgs -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs)
-&gt; Data DFunArgs
DFunArgs -&gt; DataType
DFunArgs -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
$cDFAAnon :: Constr
$cDFACxt :: Constr
$cDFAForalls :: Constr
$cDFANil :: Constr
$tDFunArgs :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DFunArgs -&gt; m DFunArgs
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DFunArgs -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DFunArgs -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DFunArgs -&gt; DFunArgs
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DFunArgs)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DFunArgs)
dataTypeOf :: DFunArgs -&gt; DataType
$cdataTypeOf :: DFunArgs -&gt; DataType
toConstr :: DFunArgs -&gt; Constr
$ctoConstr :: DFunArgs -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DFunArgs
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DFunArgs -&gt; c DFunArgs
$cp1Data :: Typeable DFunArgs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DFunArgs -&gt; Rep DFunArgs x)
-&gt; (forall x. Rep DFunArgs x -&gt; DFunArgs) -&gt; Generic DFunArgs
forall x. Rep DFunArgs x -&gt; DFunArgs
forall x. DFunArgs -&gt; Rep DFunArgs x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DFunArgs x -&gt; DFunArgs
$cfrom :: forall x. DFunArgs -&gt; Rep DFunArgs x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span class="hs-comment">-- | A /visible/ function argument type (i.e., one that must be supplied</span><span>
</span><span id="line-1633"></span><span class="hs-comment">-- explicitly in the source code). This is in contrast to /invisible/</span><span>
</span><span id="line-1634"></span><span class="hs-comment">-- arguments (e.g., the @c@ in @c =&gt; r@), which are instantiated without</span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- the need for explicit user input.</span><span>
</span><span id="line-1636"></span><span id="local-6989586621679401689"><span id="local-6989586621679401690"></span></span><span class="hs-keyword">data</span><span> </span><span id="DVisFunArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFunArg"><span class="hs-identifier hs-var">DVisFunArg</span></a></span></span><span>
</span><span id="line-1637"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DVisFADep"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFADep"><span class="hs-identifier hs-var">DVisFADep</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span>
</span><span id="line-1638"></span><span>    </span><span class="hs-comment">-- ^ A visible @forall@ (e.g., @forall a -&gt; a@).</span><span>
</span><span id="line-1639"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DVisFAAnon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFAAnon"><span class="hs-identifier hs-var">DVisFAAnon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1640"></span><span>    </span><span class="hs-comment">-- ^ An anonymous argument followed by an arrow (e.g., @a -&gt; r@).</span><span>
</span><span id="line-1641"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401683"><span id="local-6989586621679401685"><span class="annot"><span class="annottext">DVisFunArg -&gt; DVisFunArg -&gt; Bool
(DVisFunArg -&gt; DVisFunArg -&gt; Bool)
-&gt; (DVisFunArg -&gt; DVisFunArg -&gt; Bool) -&gt; Eq DVisFunArg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
$c/= :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
== :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
$c== :: DVisFunArg -&gt; DVisFunArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401677"><span id="local-6989586621679401679"><span id="local-6989586621679401681"><span class="annot"><span class="annottext">Int -&gt; DVisFunArg -&gt; String -&gt; String
[DVisFunArg] -&gt; String -&gt; String
DVisFunArg -&gt; String
(Int -&gt; DVisFunArg -&gt; String -&gt; String)
-&gt; (DVisFunArg -&gt; String)
-&gt; ([DVisFunArg] -&gt; String -&gt; String)
-&gt; Show DVisFunArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DVisFunArg] -&gt; String -&gt; String
$cshowList :: [DVisFunArg] -&gt; String -&gt; String
show :: DVisFunArg -&gt; String
$cshow :: DVisFunArg -&gt; String
showsPrec :: Int -&gt; DVisFunArg -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DVisFunArg -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cDVisFAAnon"><span id="%24cDVisFADep"><span id="%24tDVisFunArg"><span id="local-6989586621679401648"><span id="local-6989586621679401650"><span id="local-6989586621679401652"><span id="local-6989586621679401654"><span id="local-6989586621679401656"><span id="local-6989586621679401658"><span id="local-6989586621679401660"><span id="local-6989586621679401662"><span id="local-6989586621679401664"><span id="local-6989586621679401666"><span id="local-6989586621679401668"><span id="local-6989586621679401670"><span id="local-6989586621679401672"><span id="local-6989586621679401674"><span class="annot"><span class="annottext">Typeable DVisFunArg
DataType
Constr
Typeable DVisFunArg
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg)
-&gt; (DVisFunArg -&gt; Constr)
-&gt; (DVisFunArg -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c DVisFunArg))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg)
-&gt; Data DVisFunArg
DVisFunArg -&gt; DataType
DVisFunArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
$cDVisFAAnon :: Constr
$cDVisFADep :: Constr
$tDVisFunArg :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DVisFunArg -&gt; m DVisFunArg
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DVisFunArg -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DVisFunArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DVisFunArg -&gt; DVisFunArg
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DVisFunArg)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DVisFunArg)
dataTypeOf :: DVisFunArg -&gt; DataType
$cdataTypeOf :: DVisFunArg -&gt; DataType
toConstr :: DVisFunArg -&gt; Constr
$ctoConstr :: DVisFunArg -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DVisFunArg
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DVisFunArg -&gt; c DVisFunArg
$cp1Data :: Typeable DVisFunArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DVisFunArg -&gt; Rep DVisFunArg x)
-&gt; (forall x. Rep DVisFunArg x -&gt; DVisFunArg) -&gt; Generic DVisFunArg
forall x. Rep DVisFunArg x -&gt; DVisFunArg
forall x. DVisFunArg -&gt; Rep DVisFunArg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DVisFunArg x -&gt; DVisFunArg
$cfrom :: forall x. DVisFunArg -&gt; Rep DVisFunArg x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="hs-comment">-- | Filter the visible function arguments from a list of 'DFunArgs'.</span><span>
</span><span id="line-1644"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-type">filterDVisFunArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFunArgs"><span class="hs-identifier hs-type">DFunArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DVisFunArg"><span class="hs-identifier hs-type">DVisFunArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1645"></span><span id="filterDVisFunArgs"><span class="annot"><span class="annottext">filterDVisFunArgs :: DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var hs-var">filterDVisFunArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="Language.Haskell.TH.Desugar.Core.html#DFANil"><span class="hs-identifier hs-var">DFANil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1646"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAForalls"><span class="hs-identifier hs-type">DFAForalls</span></a></span><span> </span><span id="local-6989586621679401641"><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401641"><span class="hs-identifier hs-var">fvf</span></a></span></span><span> </span><span id="local-6989586621679401640"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401640"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679401639"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401639"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1647"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="#local-6989586621679401641"><span class="hs-identifier hs-var">fvf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1648"></span><span>    </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallVis"><span class="hs-identifier hs-var">ForallVis</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; DVisFunArg) -&gt; [DTyVarBndr] -&gt; [DVisFunArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; DVisFunArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DVisFADep"><span class="hs-identifier hs-var">DVisFADep</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679401640"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DVisFunArg] -&gt; [DVisFunArg] -&gt; [DVisFunArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DVisFunArg]
</span><a href="#local-6989586621679401638"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1649"></span><span>    </span><span class="annot"><span class="annottext">ForallVisFlag
</span><a href="Language.Haskell.TH.Desugar.Util.html#ForallInvis"><span class="hs-identifier hs-var">ForallInvis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DVisFunArg]
</span><a href="#local-6989586621679401638"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1650"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1651"></span><span>    </span><span id="local-6989586621679401638"><span class="annot"><span class="annottext">args' :: [DVisFunArg]
</span><a href="#local-6989586621679401638"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401639"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1652"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFACxt"><span class="hs-identifier hs-type">DFACxt</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401637"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401637"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1653"></span><span>  </span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401637"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1654"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DFAAnon"><span class="hs-identifier hs-type">DFAAnon</span></a></span><span> </span><span id="local-6989586621679401636"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401636"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401635"><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401635"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1655"></span><span>  </span><span class="annot"><span class="annottext">DType -&gt; DVisFunArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DVisFAAnon"><span class="hs-identifier hs-var">DVisFAAnon</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401636"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">DVisFunArg -&gt; [DVisFunArg] -&gt; [DVisFunArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">DFunArgs -&gt; [DVisFunArg]
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDVisFunArgs"><span class="hs-identifier hs-var">filterDVisFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DFunArgs
</span><a href="#local-6989586621679401635"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1656"></span><span>
</span><span id="line-1657"></span><span class="hs-comment">-- | Decompose an applied type into its individual components. For example, this:</span><span>
</span><span id="line-1658"></span><span class="hs-comment">--</span><span>
</span><span id="line-1659"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1660"></span><span class="hs-comment">-- Proxy \@Type Char</span><span>
</span><span id="line-1661"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1662"></span><span class="hs-comment">--</span><span>
</span><span id="line-1663"></span><span class="hs-comment">-- would be unfolded to this:</span><span>
</span><span id="line-1664"></span><span class="hs-comment">--</span><span>
</span><span id="line-1665"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1666"></span><span class="hs-comment">-- ('DConT' ''Proxy, ['DTyArg' ('DConT' ''Type), 'DTANormal' ('DConT' ''Char)])</span><span>
</span><span id="line-1667"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1668"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-type">unfoldDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1669"></span><span id="unfoldDType"><span class="annot"><span class="annottext">unfoldDType :: DType -&gt; (DType, [DTypeArg])
</span><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-var hs-var">unfoldDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1670"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1671"></span><span>    </span><span class="annot"><a href="#local-6989586621679401633"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1672"></span><span>    </span><span id="local-6989586621679401633"><span class="annot"><span class="annottext">go :: [DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679401632"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401632"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">ForallVisFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401631"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401631"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401632"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401631"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1673"></span><span>    </span><span class="annot"><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679401630"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401630"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679401629"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401629"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679401628"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401628"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401628"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">DTypeArg -&gt; [DTypeArg] -&gt; [DTypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401630"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401629"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1674"></span><span>    </span><span class="annot"><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679401627"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401627"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679401626"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401626"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679401625"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401625"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401625"><span class="hs-identifier hs-var">ki</span></a></span><span class="annot"><span class="annottext">DTypeArg -&gt; [DTypeArg] -&gt; [DTypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401627"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401626"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1675"></span><span>    </span><span class="annot"><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679401624"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401624"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679401623"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401623"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">DType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401624"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401623"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1676"></span><span>    </span><span class="annot"><a href="#local-6989586621679401633"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679401622"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401622"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679401621"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401621"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401621"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679401622"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>
</span><span id="line-1678"></span><span class="hs-comment">-- | Extract the kind from a 'TyVarBndr', if one is present.</span><span>
</span><span id="line-1679"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-type">extractTvbKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1680"></span><span id="extractTvbKind"><span class="annot"><span class="annottext">extractTvbKind :: DTyVarBndr -&gt; Maybe DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var hs-var">extractTvbKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1681"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401620"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401620"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679401620"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1682"></span><span>
</span><span id="line-1683"></span><span class="hs-comment">-- | Some functions in this module only use certain arguments on particular</span><span>
</span><span id="line-1684"></span><span class="hs-comment">-- versions of GHC. Other versions of GHC (that don't make use of those</span><span>
</span><span id="line-1685"></span><span class="hs-comment">-- arguments) might need to conjure up those arguments out of thin air at the</span><span>
</span><span id="line-1686"></span><span class="hs-comment">-- functions' call sites, so this function serves as a placeholder to use in</span><span>
</span><span id="line-1687"></span><span class="hs-comment">-- those situations. (In other words, this is a slightly more informative</span><span>
</span><span id="line-1688"></span><span class="hs-comment">-- version of 'undefined'.)</span><span>
</span><span id="line-1689"></span><span id="local-6989586621679403297"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-type">unusedArgument</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679403297"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1690"></span><span id="unusedArgument"><span class="annot"><span class="annottext">unusedArgument :: a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var hs-var">unusedArgument</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unused&quot;</span></span><span>
</span><span id="line-1691"></span><span>
</span><span id="line-1692"></span><span class="hs-comment">{-
Note [Desugaring and sweetening ForallT]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The ForallT constructor from template-haskell is tremendously awkward. Because
ForallT contains both a list of type variable binders and constraint arguments,
ForallT expressions can be ambiguous when one of these lists is empty. For
example, consider this expression with no constraints:

  ForallT [PlainTV a] [] (VarT a)

What should this desugar to in th-desugar, which must maintain a clear
separation between type variable binders and constraints? There are two
possibilities:

1. DForallT DForallInvis [DPlainTV a] (DVarT a)
   (i.e., forall a. a)
2. DForallT DForallInvis [DPlainTV a] (DConstrainedT [] (DVarT a))
   (i.e., forall a. () =&gt; a)

Template Haskell generally drops these empty lists when splicing Template
Haskell expressions, so we would like to do the same in th-desugar to mimic
TH's behavior as closely as possible. However, there are some situations where
dropping empty lists of `forall`ed type variable binders can change the
semantics of a program. For instance, contrast `foo :: forall. a -&gt; a` (which
is an error) with `foo :: a -&gt; a` (which is fine). Therefore, we try to
preserve empty `forall`s to the best of our ability.

Here is an informal specification of how th-desugar should handle different sorts
of ambiguity. First, a specification for desugaring.
Let `tvbs` and `ctxt` be non-empty:

* `ForallT tvbs [] ty` should desugar to `DForallT DForallInvis tvbs ty`.
* `ForallT [] ctxt ty` should desguar to `DForallT DForallInvis [] (DConstrainedT ctxt ty)`.
* `ForallT [] [] ty`   should desugar to `DForallT DForallInvis [] ty`.
* For all other cases, just straightforwardly desugar
  `ForallT tvbs ctxt ty` to `DForallT DForallInvis tvbs (DConstraintedT ctxt ty)`.

For sweetening:

* `DForallT DForallInvis tvbs (DConstrainedT ctxt ty)` should sweeten to `ForallT tvbs ctxt ty`.
* `DForallT DForallInvis []   (DConstrainedT ctxt ty)` should sweeten to `ForallT [] ctxt ty`.
* `DForallT DForallInvis tvbs (DConstrainedT [] ty)`   should sweeten to `ForallT tvbs [] ty`.
* `DForallT DForallInvis []   (DConstrainedT [] ty)`   should sweeten to `ForallT [] [] ty`.
* For all other cases, just straightforwardly sweeten
  `DForallT DForallInvis tvbs ty` to `ForallT tvbs [] ty` and
  `DConstrainedT ctxt ty` to `ForallT [] ctxt ty`.
-}</span><span>
</span><span id="line-1739"></span></pre></body></html>