<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algorithms.Geometry.RayShooting.Naive</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit"><span class="hs-identifier">firstHit</span></a></span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit%27"><span class="hs-identifier">firstHit'</span></a></span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHitSegments"><span class="hs-identifier">firstHitSegments</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#intersectionDistance"><span class="hs-identifier">intersectionDistance</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#labelWithDistances"><span class="hs-identifier">labelWithDistances</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.HalfLine.html"><span class="hs-identifier">Data.Geometry.HalfLine</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.LineSegment.html"><span class="hs-identifier">Data.Geometry.LineSegment</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Polygon.html"><span class="hs-identifier">Data.Geometry.Polygon</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Intersection</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vinyl.CoRec</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vinyl</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- pre: halfline should start in the interior</span><span>
</span><span id="line-30"></span><span id="local-6989586621680050572"><span id="local-6989586621680050573"><span id="local-6989586621680050574"><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit"><span class="hs-identifier hs-type">firstHit</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680050574"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050574"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.HalfLine.html#HalfLine"><span class="hs-identifier hs-type">HalfLine</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050574"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-32"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050573"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050572"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050574"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-33"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050572"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050574"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-34"></span><span id="firstHit"><span class="annot"><span class="annottext">firstHit :: HalfLine 2 r -&gt; Polygon t p r -&gt; LineSegment 2 p r
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit"><span class="hs-identifier hs-var hs-var">firstHit</span></a></span></span><span> </span><span id="local-6989586621680050571"><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050571"><span class="hs-identifier hs-var">ray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r -&gt; Maybe (LineSegment 2 p r) -&gt; LineSegment 2 p r
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
forall a. a
</span><a href="#local-6989586621680050569"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (LineSegment 2 p r) -&gt; LineSegment 2 p r)
-&gt; (Polygon t p r -&gt; Maybe (LineSegment 2 p r))
-&gt; Polygon t p r
-&gt; LineSegment 2 p r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r -&gt; Polygon t p r -&gt; Maybe (LineSegment 2 p r)
forall r (t :: PolygonType) p.
(Fractional r, Ord r) =&gt;
HalfLine 2 r -&gt; Polygon t p r -&gt; Maybe (LineSegment 2 p r)
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit%27"><span class="hs-identifier hs-var">firstHit'</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050571"><span class="hs-identifier hs-var">ray</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>    </span><span id="local-6989586621680050569"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621680050569"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Algorithms.Geometry.RayShooting.Naive: no intersections; ray must have started outside the polygon&quot;</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | Compute the first edge hit by the ray, if it exists</span><span>
</span><span id="line-39"></span><span id="local-6989586621680050675"><span id="local-6989586621680050676"><span id="local-6989586621680050677"><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit%27"><span class="hs-identifier hs-type">firstHit'</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680050677"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050677"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.HalfLine.html#HalfLine"><span class="hs-identifier hs-type">HalfLine</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050677"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-41"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050676"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050675"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050677"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-42"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050675"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050677"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-43"></span><span id="firstHit%27"><span class="annot"><span class="annottext">firstHit' :: HalfLine 2 r -&gt; Polygon t p r -&gt; Maybe (LineSegment 2 p r)
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHit%27"><span class="hs-identifier hs-var hs-var">firstHit'</span></a></span></span><span> </span><span id="local-6989586621680050566"><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050566"><span class="hs-identifier hs-var">ray</span></a></span></span><span> </span><span id="local-6989586621680050565"><span class="annot"><span class="annottext">Polygon t p r
</span><a href="#local-6989586621680050565"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 p r :+ ()) -&gt; LineSegment 2 p r)
-&gt; Maybe (LineSegment 2 p r :+ ()) -&gt; Maybe (LineSegment 2 p r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineSegment 2 p r :+ ())
-&gt; Getting
     (LineSegment 2 p r) (LineSegment 2 p r :+ ()) (LineSegment 2 p r)
-&gt; LineSegment 2 p r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (LineSegment 2 p r) (LineSegment 2 p r :+ ()) (LineSegment 2 p r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (LineSegment 2 p r :+ ()) -&gt; Maybe (LineSegment 2 p r))
-&gt; ([LineSegment 2 p r] -&gt; Maybe (LineSegment 2 p r :+ ()))
-&gt; [LineSegment 2 p r]
-&gt; Maybe (LineSegment 2 p r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
-&gt; [LineSegment 2 p r :+ ()] -&gt; Maybe (LineSegment 2 p r :+ ())
forall r p e.
(Ord r, Fractional r) =&gt;
HalfLine 2 r
-&gt; [LineSegment 2 p r :+ e] -&gt; Maybe (LineSegment 2 p r :+ e)
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHitSegments"><span class="hs-identifier hs-var">firstHitSegments</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050566"><span class="hs-identifier hs-var">ray</span></a></span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ ()] -&gt; Maybe (LineSegment 2 p r :+ ()))
-&gt; ([LineSegment 2 p r] -&gt; [LineSegment 2 p r :+ ()])
-&gt; [LineSegment 2 p r]
-&gt; Maybe (LineSegment 2 p r :+ ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 p r -&gt; LineSegment 2 p r :+ ())
-&gt; [LineSegment 2 p r] -&gt; [LineSegment 2 p r :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r -&gt; LineSegment 2 p r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r] -&gt; Maybe (LineSegment 2 p r))
-&gt; [LineSegment 2 p r] -&gt; Maybe (LineSegment 2 p r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Polygon t p r -&gt; [LineSegment 2 p r]
forall (t :: PolygonType) p r. Polygon t p r -&gt; [LineSegment 2 p r]
</span><a href="Data.Geometry.Polygon.Core.html#listEdges"><span class="hs-identifier hs-var">listEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon t p r
</span><a href="#local-6989586621680050565"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Compute the first segment hit by the ray, if it exists</span><span>
</span><span id="line-47"></span><span id="local-6989586621680050655"><span id="local-6989586621680050656"><span id="local-6989586621680050657"><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHitSegments"><span class="hs-identifier hs-type">firstHitSegments</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680050657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.HalfLine.html#HalfLine"><span class="hs-identifier hs-type">HalfLine</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050657"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-49"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050656"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050657"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680050655"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050656"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050657"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680050655"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-51"></span><span id="firstHitSegments"><span class="annot"><span class="annottext">firstHitSegments :: HalfLine 2 r
-&gt; [LineSegment 2 p r :+ e] -&gt; Maybe (LineSegment 2 p r :+ e)
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#firstHitSegments"><span class="hs-identifier hs-var hs-var">firstHitSegments</span></a></span></span><span> </span><span id="local-6989586621680050560"><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050560"><span class="hs-identifier hs-var">ray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((r :+ (LineSegment 2 p r :+ e)) -&gt; LineSegment 2 p r :+ e)
-&gt; Maybe (r :+ (LineSegment 2 p r :+ e))
-&gt; Maybe (LineSegment 2 p r :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r :+ (LineSegment 2 p r :+ e))
-&gt; Getting
     (LineSegment 2 p r :+ e)
     (r :+ (LineSegment 2 p r :+ e))
     (LineSegment 2 p r :+ e)
-&gt; LineSegment 2 p r :+ e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (LineSegment 2 p r :+ e)
  (r :+ (LineSegment 2 p r :+ e))
  (LineSegment 2 p r :+ e)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (r :+ (LineSegment 2 p r :+ e))
 -&gt; Maybe (LineSegment 2 p r :+ e))
-&gt; ([LineSegment 2 p r :+ e]
    -&gt; Maybe (r :+ (LineSegment 2 p r :+ e)))
-&gt; [LineSegment 2 p r :+ e]
-&gt; Maybe (LineSegment 2 p r :+ e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((r :+ (LineSegment 2 p r :+ e)) -&gt; r)
-&gt; [r :+ (LineSegment 2 p r :+ e)]
-&gt; Maybe (r :+ (LineSegment 2 p r :+ e))
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; Maybe a
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#minimumOn"><span class="hs-identifier hs-var">minimumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r :+ (LineSegment 2 p r :+ e))
-&gt; Getting r (r :+ (LineSegment 2 p r :+ e)) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting r (r :+ (LineSegment 2 p r :+ e)) r
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>                     </span><span class="annot"><span class="annottext">([r :+ (LineSegment 2 p r :+ e)]
 -&gt; Maybe (r :+ (LineSegment 2 p r :+ e)))
-&gt; ([LineSegment 2 p r :+ e] -&gt; [r :+ (LineSegment 2 p r :+ e)])
-&gt; [LineSegment 2 p r :+ e]
-&gt; Maybe (r :+ (LineSegment 2 p r :+ e))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 p r :+ (Maybe r, e))
 -&gt; Maybe (r :+ (LineSegment 2 p r :+ e)))
-&gt; [LineSegment 2 p r :+ (Maybe r, e)]
-&gt; [r :+ (LineSegment 2 p r :+ e)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680050556"><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050556"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680050554"><span class="annot"><span class="annottext">Maybe r
</span><a href="#local-6989586621680050554"><span class="hs-identifier hs-var">md</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680050553"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680050553"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; (LineSegment 2 p r :+ e) -&gt; r :+ (LineSegment 2 p r :+ e)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050556"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r -&gt; e -&gt; LineSegment 2 p r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680050553"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r :+ (LineSegment 2 p r :+ e))
-&gt; Maybe r -&gt; Maybe (r :+ (LineSegment 2 p r :+ e))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe r
</span><a href="#local-6989586621680050554"><span class="hs-identifier hs-var">md</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>                     </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ (Maybe r, e)]
 -&gt; [r :+ (LineSegment 2 p r :+ e)])
-&gt; ([LineSegment 2 p r :+ e]
    -&gt; [LineSegment 2 p r :+ (Maybe r, e)])
-&gt; [LineSegment 2 p r :+ e]
-&gt; [r :+ (LineSegment 2 p r :+ e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; HalfLine 2 r
-&gt; [LineSegment 2 p r :+ e]
-&gt; [LineSegment 2 p r :+ (Maybe r, e)]
forall r p b.
(Ord r, Fractional r) =&gt;
Point 2 r
-&gt; HalfLine 2 r
-&gt; [LineSegment 2 p r :+ b]
-&gt; [LineSegment 2 p r :+ (Maybe r, b)]
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#labelWithDistances"><span class="hs-identifier hs-var">labelWithDistances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050560"><span class="hs-identifier hs-var">ray</span></a></span><span class="annot"><span class="annottext">HalfLine 2 r
-&gt; Getting (Point 2 r) (HalfLine 2 r) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (HalfLine 2 r) (Point 2 r)
forall (d :: Nat) r. Lens' (HalfLine d r) (Point d r)
</span><a href="Data.Geometry.HalfLine.html#startPoint"><span class="hs-identifier hs-var">startPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050560"><span class="hs-identifier hs-var">ray</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621680050638"><span id="local-6989586621680050639"><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#minimumOn"><span class="hs-identifier hs-type">minimumOn</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050639"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680050638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680050639"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680050638"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680050638"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-56"></span><span id="minimumOn"><span class="annot"><span class="annottext">minimumOn :: (a -&gt; b) -&gt; [a] -&gt; Maybe a
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#minimumOn"><span class="hs-identifier hs-var hs-var">minimumOn</span></a></span></span><span> </span><span id="local-6989586621680050550"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680050550"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621680050549"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680050549"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; ([a] -&gt; a) -&gt; [a] -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">List.minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680050550"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Maybe a) -&gt; [a] -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680050549"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Given q, a ray, and a segment s, computes if the</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- segment intersects the initial, rightward ray starting in q, and if</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- so returns the (squared) distance from q to that point together</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- with the segment.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#intersectionDistance"><span class="hs-identifier hs-type">intersectionDistance</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680050582"><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621680050581"><span class="annot"><a href="#local-6989586621680050581"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.HalfLine.html#HalfLine"><span class="hs-identifier hs-type">HalfLine</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050581"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-67"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680050582"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-68"></span><span id="intersectionDistance"><span class="annot"><span class="annottext">intersectionDistance :: Point 2 r -&gt; HalfLine 2 r -&gt; LineSegment 2 p r -&gt; Maybe r
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#intersectionDistance"><span class="hs-identifier hs-var hs-var">intersectionDistance</span></a></span></span><span> </span><span id="local-6989586621680050547"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050547"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680050546"><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050546"><span class="hs-identifier hs-var">ray</span></a></span></span><span> </span><span id="local-6989586621680050545"><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050545"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoRec Identity '[NoIntersection, Point 2 r, LineSegment 2 () r]
-&gt; Handlers
     '[NoIntersection, Point 2 r, LineSegment 2 () r] (Maybe r)
-&gt; Maybe r
forall (ts :: [*]) b. CoRec Identity ts -&gt; Handlers ts b -&gt; b
</span><span class="hs-identifier hs-var">match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment 2 () r
</span><a href="#local-6989586621680050543"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 () r
-&gt; HalfLine 2 r -&gt; Intersection (LineSegment 2 () r) (HalfLine 2 r)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050546"><span class="hs-identifier hs-var">ray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Handlers
   '[NoIntersection, Point 2 r, LineSegment 2 () r] (Maybe r)
 -&gt; Maybe r)
-&gt; Handlers
     '[NoIntersection, Point 2 r, LineSegment 2 () r] (Maybe r)
-&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-69"></span><span>       </span><span class="annot"><span class="annottext">(NoIntersection -&gt; Maybe r) -&gt; Handler (Maybe r) NoIntersection
forall b a. (a -&gt; b) -&gt; Handler b a
</span><span class="hs-identifier hs-var">H</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">NoIntersection
</span><span class="hs-identifier hs-var">NoIntersection</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe r
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">Handler (Maybe r) NoIntersection
-&gt; Rec (Handler (Maybe r)) '[Point 2 r, LineSegment 2 () r]
-&gt; Handlers
     '[NoIntersection, Point 2 r, LineSegment 2 () r] (Maybe r)
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Maybe r) -&gt; Handler (Maybe r) (Point 2 r)
forall b a. (a -&gt; b) -&gt; Handler b a
</span><span class="hs-identifier hs-var">H</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680050538"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050538"><span class="hs-identifier hs-var">p</span></a></span></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Maybe r) -&gt; r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; r
</span><a href="#local-6989586621680050537"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050538"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">Handler (Maybe r) (Point 2 r)
-&gt; Rec (Handler (Maybe r)) '[LineSegment 2 () r]
-&gt; Rec (Handler (Maybe r)) '[Point 2 r, LineSegment 2 () r]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 () r -&gt; Maybe r)
-&gt; Handler (Maybe r) (LineSegment 2 () r)
forall b a. (a -&gt; b) -&gt; Handler b a
</span><span class="hs-identifier hs-var">H</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment%27"><span class="hs-identifier hs-type">LineSegment'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680050535"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050535"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680050534"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050534"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Maybe r) -&gt; r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; r
</span><a href="#local-6989586621680050537"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050535"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`min`</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; r
</span><a href="#local-6989586621680050537"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050534"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">Handler (Maybe r) (LineSegment 2 () r)
-&gt; Rec (Handler (Maybe r)) '[]
-&gt; Rec (Handler (Maybe r)) '[LineSegment 2 () r]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec (Handler (Maybe r)) '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- TODO: there is some slight subtility if the segment is open.</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621680050537"><span class="annot"><span class="annottext">d :: Point 2 r -&gt; r
</span><a href="#local-6989586621680050537"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; r
forall r (d :: Nat).
(Num r, Arity d) =&gt;
Point d r -&gt; Point d r -&gt; r
</span><a href="Data.Geometry.Point.Internal.html#squaredEuclideanDist"><span class="hs-identifier hs-var">squaredEuclideanDist</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050547"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621680050543"><span class="annot"><span class="annottext">seg :: LineSegment 2 () r
</span><a href="#local-6989586621680050543"><span class="hs-identifier hs-var hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p -&gt; ()) -&gt; LineSegment 2 p r -&gt; LineSegment 2 () r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; p -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050545"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Labels the segments with the distance from q to their</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- intersection point with the ray.</span><span>
</span><span id="line-81"></span><span id="local-6989586621680050627"><span id="local-6989586621680050628"><span id="local-6989586621680050629"><span class="annot"><a href="Algorithms.Geometry.RayShooting.Naive.html#labelWithDistances"><span class="hs-identifier hs-type">labelWithDistances</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.HalfLine.html#HalfLine"><span class="hs-identifier hs-type">HalfLine</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050628"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680050627"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680050628"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680050629"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680050627"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-84"></span><span id="labelWithDistances"><span class="annot"><span class="annottext">labelWithDistances :: Point 2 r
-&gt; HalfLine 2 r
-&gt; [LineSegment 2 p r :+ b]
-&gt; [LineSegment 2 p r :+ (Maybe r, b)]
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#labelWithDistances"><span class="hs-identifier hs-var hs-var">labelWithDistances</span></a></span></span><span> </span><span id="local-6989586621680050528"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050528"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680050527"><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050527"><span class="hs-identifier hs-var">ray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 p r :+ b) -&gt; LineSegment 2 p r :+ (Maybe r, b))
-&gt; [LineSegment 2 p r :+ b] -&gt; [LineSegment 2 p r :+ (Maybe r, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680050526"><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050526"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680050525"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680050525"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050526"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
-&gt; (Maybe r, b) -&gt; LineSegment 2 p r :+ (Maybe r, b)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfLine 2 r -&gt; LineSegment 2 p r -&gt; Maybe r
forall r p.
(Ord r, Fractional r) =&gt;
Point 2 r -&gt; HalfLine 2 r -&gt; LineSegment 2 p r -&gt; Maybe r
</span><a href="Algorithms.Geometry.RayShooting.Naive.html#intersectionDistance"><span class="hs-identifier hs-var">intersectionDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680050528"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine 2 r
</span><a href="#local-6989586621680050527"><span class="hs-identifier hs-var">ray</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 p r
</span><a href="#local-6989586621680050526"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680050525"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-89"></span></pre></body></html>