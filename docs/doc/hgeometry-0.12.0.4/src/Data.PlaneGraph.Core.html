<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  Data.PlaneGraph.Core</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Data type for planar graphs embedded in \(\mathbb{R}^2\). For functions that</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- export faces and edges etc, we assume the graph has a (planar) straight line</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- embedding.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.PlaneGraph.Core</span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- $setup</span></span><span>
</span><span id="line-17"></span><span>                             </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier">graph</span></a></span><span>
</span><span id="line-18"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span>
</span><span id="line-19"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier">vData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier">location</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier">vtxDataToExt</span></a></span><span>
</span><span id="line-20"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier">fromSimplePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier">fromConnectedSegments</span></a></span><span>
</span><span id="line-21"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PG.fromAdjacencyLists</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier">numVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier">numEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier">numFaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier">numDarts</span></a></span><span>
</span><span id="line-24"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier">vertices'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier">vertices</span></a></span><span>
</span><span id="line-27"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier">edges'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier">edges</span></a></span><span>
</span><span id="line-28"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier">faces'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces%27"><span class="hs-identifier">internalFaces'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier">faces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier">internalFaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier">faces''</span></a></span><span>
</span><span id="line-29"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier">darts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier">darts</span></a></span><span>
</span><span id="line-30"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier">traverseVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier">traverseDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier">traverseFaces</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier">headOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier">tailOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier">incidentEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier">incomingEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier">outgoingEdges</span></a></span><span>
</span><span id="line-35"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier">neighboursOf</span></a></span><span>
</span><span id="line-36"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier">nextIncidentEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier">prevIncidentEdge</span></a></span><span>
</span><span id="line-37"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdgeFrom"><span class="hs-identifier">nextIncidentEdgeFrom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdgeFrom"><span class="hs-identifier">prevIncidentEdgeFrom</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier">leftFace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier">rightFace</span></a></span><span>
</span><span id="line-41"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier">nextEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier">prevEdge</span></a></span><span>
</span><span id="line-42"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier">boundary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier">boundary'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier">boundaryDart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier">boundaryVertices</span></a></span><span>
</span><span id="line-43"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier">outerFaceId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier">outerFaceDart</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier">vertexDataOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier">locationOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier">endPointsOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier">endPointData</span></a></span><span>
</span><span id="line-48"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier">vertexData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier">faceData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier">dartData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier">rawDartData</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier">edgeSegment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier">edgeSegments</span></a></span><span>
</span><span id="line-51"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faceBoundary"><span class="hs-identifier">faceBoundary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFacePolygon"><span class="hs-identifier">internalFacePolygon</span></a></span><span>
</span><span id="line-52"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFacePolygon"><span class="hs-identifier">outerFacePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFacePolygon%27"><span class="hs-identifier">outerFacePolygon'</span></a></span><span>
</span><span id="line-53"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#facePolygons"><span class="hs-identifier">facePolygons</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#facePolygons%27"><span class="hs-identifier">facePolygons'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFacePolygons"><span class="hs-identifier">internalFacePolygons</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier">withEdgeDistances</span></a></span><span>
</span><span id="line-58"></span><span>                           </span><span class="hs-comment">-- , writePlaneGraph, readPlaneGraph</span><span>
</span><span id="line-59"></span><span>                           </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">holes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">holesOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Box.html"><span class="hs-identifier">Data.Geometry.Box</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Interval.html"><span class="hs-identifier">Data.Geometry.Interval</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Line.html"><span class="hs-identifier">Data.Geometry.Line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#cmpSlope"><span class="hs-identifier">cmpSlope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#supportingLine"><span class="hs-identifier">supportingLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.LineSegment.html"><span class="hs-identifier">Data.Geometry.LineSegment</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Polygon.html"><span class="hs-identifier">Data.Geometry.Polygon</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Properties.html"><span class="hs-identifier">Data.Geometry.Properties</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arc</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Direction</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>                                            </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>                                            </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">planarGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Util</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector.Circular</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CircularVector</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Proxy</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlaneGraph.AdjRep(Gr(Gr),Face(Face),Vtx(Vtx))</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlaneGraph.IO(fromAdjRep)</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlanarGraph.Dart(Dart(..),Arc(..))</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- let dart i s = Dart (Arc i) (read s)</span><span>
</span><span id="line-97"></span><span class="hs-comment">--     small :: Gr (Vtx Int String Int) (Face String)</span><span>
</span><span id="line-98"></span><span class="hs-comment">--     small = Gr [ Vtx 0 (Point2 0 0) [ (2,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-99"></span><span class="hs-comment">--                                     , (1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-100"></span><span class="hs-comment">--                                     , (3,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-101"></span><span class="hs-comment">--                                     ] 0</span><span>
</span><span id="line-102"></span><span class="hs-comment">--                , Vtx 1 (Point2 2 2) [ (0,&quot;1-&gt;0&quot;)</span><span>
</span><span id="line-103"></span><span class="hs-comment">--                                     , (2,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-104"></span><span class="hs-comment">--                                     , (3,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-105"></span><span class="hs-comment">--                                     ] 1</span><span>
</span><span id="line-106"></span><span class="hs-comment">--                , Vtx 2 (Point2 2 0) [ (0,&quot;2-&gt;0&quot;)</span><span>
</span><span id="line-107"></span><span class="hs-comment">--                                     , (1,&quot;2-&gt;1&quot;)</span><span>
</span><span id="line-108"></span><span class="hs-comment">--                                     ] 2</span><span>
</span><span id="line-109"></span><span class="hs-comment">--                , Vtx 3 (Point2 (-1) 4) [ (0,&quot;3-&gt;0&quot;)</span><span>
</span><span id="line-110"></span><span class="hs-comment">--                                        , (1,&quot;3-&gt;1&quot;)</span><span>
</span><span id="line-111"></span><span class="hs-comment">--                                        ] 3</span><span>
</span><span id="line-112"></span><span class="hs-comment">--                ]</span><span>
</span><span id="line-113"></span><span class="hs-comment">--                [ Face (2,1) &quot;OuterFace&quot;</span><span>
</span><span id="line-114"></span><span class="hs-comment">--                , Face (0,1) &quot;A&quot;</span><span>
</span><span id="line-115"></span><span class="hs-comment">--                , Face (1,0) &quot;B&quot;</span><span>
</span><span id="line-116"></span><span class="hs-comment">--                ]</span><span>
</span><span id="line-117"></span><span class="hs-comment">--     smallG = fromAdjRep (Proxy :: Proxy ()) small</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- This represents the following graph. Note that the graph is undirected, the</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- arrows are just to indicate what the Positive direction of the darts is.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- ![myGraph](docs/Data/PlaneGraph/small.png)</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Here is also a slightly larger example graph:</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- ![myGraph](docs/Data/PlaneGraph/planegraph.png)</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.RealNumber.Rational</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;&gt;&gt; data MyWorld</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- let myPlaneGraph :: PlaneGraph MyWorld Int () String (RealNumber 5)</span><span>
</span><span id="line-134"></span><span class="hs-comment">--     myPlaneGraph = fromAdjRep (Proxy @MyWorld) myPlaneGraphAdjrep</span><span>
</span><span id="line-135"></span><span class="hs-comment">--     myPlaneGraphAdjrep :: Gr (Vtx Int () (RealNumber 5)) (Face String)</span><span>
</span><span id="line-136"></span><span class="hs-comment">--     myPlaneGraphAdjrep = Gr [ vtx 0 (Point2 0   0   ) [e 9, e 5, e 1, e 2]</span><span>
</span><span id="line-137"></span><span class="hs-comment">--                             , vtx 1 (Point2 4   4   ) [e 0, e 5, e 12]</span><span>
</span><span id="line-138"></span><span class="hs-comment">--                             , vtx 2 (Point2 3   7   ) [e 0, e 3]</span><span>
</span><span id="line-139"></span><span class="hs-comment">--                             , vtx 3 (Point2 0   5   ) [e 4, e 2]</span><span>
</span><span id="line-140"></span><span class="hs-comment">--                             , vtx 4 (Point2 3   8   ) [e 3, e 13]</span><span>
</span><span id="line-141"></span><span class="hs-comment">--                             , vtx 5 (Point2 8   1   ) [e 0, e 6, e 8, e 1]</span><span>
</span><span id="line-142"></span><span class="hs-comment">--                             , vtx 6 (Point2 6   (-1)) [e 5, e 9]</span><span>
</span><span id="line-143"></span><span class="hs-comment">--                             , vtx 7 (Point2 9   (-1)) [e 8, e 11]</span><span>
</span><span id="line-144"></span><span class="hs-comment">--                             , vtx 8 (Point2 12  1   ) [e 7, e 12, e 5]</span><span>
</span><span id="line-145"></span><span class="hs-comment">--                             , vtx 9 (Point2 8   (-5)) [e 0, e 10, e 6]</span><span>
</span><span id="line-146"></span><span class="hs-comment">--                             , vtx 10 (Point2 12 (-3)) [e 9, e 11]</span><span>
</span><span id="line-147"></span><span class="hs-comment">--                             , vtx 11 (Point2 14 (-1)) [e 10, e 7]</span><span>
</span><span id="line-148"></span><span class="hs-comment">--                             , vtx 12 (Point2 10 4   ) [e 1, e 8, e 13, e 14]</span><span>
</span><span id="line-149"></span><span class="hs-comment">--                             , vtx 13 (Point2 9  6   ) [e 4, e 14, e 12]</span><span>
</span><span id="line-150"></span><span class="hs-comment">--                             , vtx 14 (Point2 8  5   ) [e 13, e 12]</span><span>
</span><span id="line-151"></span><span class="hs-comment">--                             ]</span><span>
</span><span id="line-152"></span><span class="hs-comment">--                             [ Face (0,9) &quot;OuterFace&quot;</span><span>
</span><span id="line-153"></span><span class="hs-comment">--                             , Face (0,5) &quot;A&quot;</span><span>
</span><span id="line-154"></span><span class="hs-comment">--                             , Face (0,1) &quot;B&quot;</span><span>
</span><span id="line-155"></span><span class="hs-comment">--                             , Face (0,2) &quot;C&quot;</span><span>
</span><span id="line-156"></span><span class="hs-comment">--                             , Face (14,13) &quot;D&quot;</span><span>
</span><span id="line-157"></span><span class="hs-comment">--                             , Face (1,12) &quot;E&quot;</span><span>
</span><span id="line-158"></span><span class="hs-comment">--                             , Face (5,8) &quot;F&quot;</span><span>
</span><span id="line-159"></span><span class="hs-comment">--                             ]</span><span>
</span><span id="line-160"></span><span class="hs-comment">--       where</span><span>
</span><span id="line-161"></span><span class="hs-comment">--         e i = (i,())</span><span>
</span><span id="line-162"></span><span class="hs-comment">--         vtx i p es = Vtx i p es i</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- * Vertex Data</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Note that the functor instance is in v</span><span>
</span><span id="line-169"></span><span id="local-6989586621680100370"><span id="local-6989586621680100371"></span></span><span class="hs-keyword">data</span><span> </span><span id="VertexData"><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span></span><span> </span><span id="local-6989586621680101451"><span class="annot"><a href="#local-6989586621680101451"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621680101450"><span class="annot"><a href="#local-6989586621680101450"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VertexData"><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_location"><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r
</span><a href="Data.PlaneGraph.Core.html#_location"><span class="hs-identifier hs-var hs-var">_location</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680101451"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_vData"><span class="annot"><span class="annottext">VertexData r v -&gt; v
</span><a href="Data.PlaneGraph.Core.html#_vData"><span class="hs-identifier hs-var hs-var">_vData</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621680101450"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-171"></span><span>                                 </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680100362"><span id="local-6989586621680100364"><span id="local-6989586621680100366"><span class="annot"><span class="annottext">Int -&gt; VertexData r v -&gt; ShowS
[VertexData r v] -&gt; ShowS
VertexData r v -&gt; String
(Int -&gt; VertexData r v -&gt; ShowS)
-&gt; (VertexData r v -&gt; String)
-&gt; ([VertexData r v] -&gt; ShowS)
-&gt; Show (VertexData r v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r v. (Show r, Show v) =&gt; Int -&gt; VertexData r v -&gt; ShowS
forall r v. (Show r, Show v) =&gt; [VertexData r v] -&gt; ShowS
forall r v. (Show r, Show v) =&gt; VertexData r v -&gt; String
showList :: [VertexData r v] -&gt; ShowS
$cshowList :: forall r v. (Show r, Show v) =&gt; [VertexData r v] -&gt; ShowS
show :: VertexData r v -&gt; String
$cshow :: forall r v. (Show r, Show v) =&gt; VertexData r v -&gt; String
showsPrec :: Int -&gt; VertexData r v -&gt; ShowS
$cshowsPrec :: forall r v. (Show r, Show v) =&gt; Int -&gt; VertexData r v -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680100357"><span id="local-6989586621680100359"><span class="annot"><span class="annottext">VertexData r v -&gt; VertexData r v -&gt; Bool
(VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; Eq (VertexData r v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
/= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c/= :: forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
== :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c== :: forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680100341"><span id="local-6989586621680100343"><span id="local-6989586621680100345"><span id="local-6989586621680100347"><span id="local-6989586621680100349"><span id="local-6989586621680100351"><span id="local-6989586621680100353"><span class="annot"><span class="annottext">Eq (VertexData r v)
Eq (VertexData r v) =&gt;
(VertexData r v -&gt; VertexData r v -&gt; Ordering)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; Ord (VertexData r v)
VertexData r v -&gt; VertexData r v -&gt; Bool
VertexData r v -&gt; VertexData r v -&gt; Ordering
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall r v. (Ord r, Ord v) =&gt; Eq (VertexData r v)
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Ordering
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
min :: VertexData r v -&gt; VertexData r v -&gt; VertexData r v
$cmin :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
max :: VertexData r v -&gt; VertexData r v -&gt; VertexData r v
$cmax :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
&gt;= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&gt;= :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&gt; :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&gt; :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&lt;= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&lt;= :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&lt; :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&lt; :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
compare :: VertexData r v -&gt; VertexData r v -&gt; Ordering
$ccompare :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Ordering
$cp1Ord :: forall r v. (Ord r, Ord v) =&gt; Eq (VertexData r v)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x. VertexData r v -&gt; Rep (VertexData r v) x)
-&gt; (forall x. Rep (VertexData r v) x -&gt; VertexData r v)
-&gt; Generic (VertexData r v)
forall x. Rep (VertexData r v) x -&gt; VertexData r v
forall x. VertexData r v -&gt; Rep (VertexData r v) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall r v x. Rep (VertexData r v) x -&gt; VertexData r v
forall r v x. VertexData r v -&gt; Rep (VertexData r v) x
$cto :: forall r v x. Rep (VertexData r v) x -&gt; VertexData r v
$cfrom :: forall r v x. VertexData r v -&gt; Rep (VertexData r v) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span>
</span><span id="line-172"></span><span>                                            </span><span class="hs-special">,</span><span id="local-6989586621680100333"><span id="local-6989586621680100335"><span class="annot"><span class="annottext">a -&gt; VertexData r b -&gt; VertexData r a
(a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
(forall a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b)
-&gt; (forall a b. a -&gt; VertexData r b -&gt; VertexData r a)
-&gt; Functor (VertexData r)
forall a b. a -&gt; VertexData r b -&gt; VertexData r a
forall a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
forall r a b. a -&gt; VertexData r b -&gt; VertexData r a
forall r a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; VertexData r b -&gt; VertexData r a
$c&lt;$ :: forall r a b. a -&gt; VertexData r b -&gt; VertexData r a
fmap :: (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
$cfmap :: forall r a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680100298"><span id="local-6989586621680100300"><span id="local-6989586621680100302"><span id="local-6989586621680100304"><span id="local-6989586621680100306"><span id="local-6989586621680100308"><span id="local-6989586621680100310"><span id="local-6989586621680100312"><span id="local-6989586621680100314"><span id="local-6989586621680100316"><span id="local-6989586621680100318"><span id="local-6989586621680100320"><span id="local-6989586621680100322"><span id="local-6989586621680100324"><span id="local-6989586621680100326"><span id="local-6989586621680100328"><span id="local-6989586621680100330"><span class="annot"><span class="annottext">VertexData r a -&gt; Bool
(a -&gt; m) -&gt; VertexData r a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
(forall m. Monoid m =&gt; VertexData r m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a)
-&gt; (forall a. VertexData r a -&gt; [a])
-&gt; (forall a. VertexData r a -&gt; Bool)
-&gt; (forall a. VertexData r a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Ord a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Num a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Num a =&gt; VertexData r a -&gt; a)
-&gt; Foldable (VertexData r)
forall a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
forall a. Num a =&gt; VertexData r a -&gt; a
forall a. Ord a =&gt; VertexData r a -&gt; a
forall m. Monoid m =&gt; VertexData r m -&gt; m
forall a. VertexData r a -&gt; Bool
forall a. VertexData r a -&gt; Int
forall a. VertexData r a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
forall r a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
forall r a. Num a =&gt; VertexData r a -&gt; a
forall r a. Ord a =&gt; VertexData r a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
forall r m. Monoid m =&gt; VertexData r m -&gt; m
forall r a. VertexData r a -&gt; Bool
forall r a. VertexData r a -&gt; Int
forall r a. VertexData r a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: VertexData r a -&gt; a
$cproduct :: forall r a. Num a =&gt; VertexData r a -&gt; a
sum :: VertexData r a -&gt; a
$csum :: forall r a. Num a =&gt; VertexData r a -&gt; a
minimum :: VertexData r a -&gt; a
$cminimum :: forall r a. Ord a =&gt; VertexData r a -&gt; a
maximum :: VertexData r a -&gt; a
$cmaximum :: forall r a. Ord a =&gt; VertexData r a -&gt; a
elem :: a -&gt; VertexData r a -&gt; Bool
$celem :: forall r a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
length :: VertexData r a -&gt; Int
$clength :: forall r a. VertexData r a -&gt; Int
null :: VertexData r a -&gt; Bool
$cnull :: forall r a. VertexData r a -&gt; Bool
toList :: VertexData r a -&gt; [a]
$ctoList :: forall r a. VertexData r a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
$cfoldl1 :: forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
$cfoldr1 :: forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldl' :: forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldl :: forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldr' :: forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldr :: forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldMap' :: (a -&gt; m) -&gt; VertexData r a -&gt; m
$cfoldMap' :: forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
foldMap :: (a -&gt; m) -&gt; VertexData r a -&gt; m
$cfoldMap :: forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
fold :: VertexData r m -&gt; m
$cfold :: forall r m. Monoid m =&gt; VertexData r m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680100287"><span id="local-6989586621680100289"><span id="local-6989586621680100291"><span id="local-6989586621680100293"><span class="annot"><span class="annottext">Functor (VertexData r)
Foldable (VertexData r)
(Functor (VertexData r), Foldable (VertexData r)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    VertexData r (f a) -&gt; f (VertexData r a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    VertexData r (m a) -&gt; m (VertexData r a))
-&gt; Traversable (VertexData r)
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
forall r. Functor (VertexData r)
forall r. Foldable (VertexData r)
forall r (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
forall r (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
forall r (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
forall r (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
sequence :: VertexData r (m a) -&gt; m (VertexData r a)
$csequence :: forall r (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
mapM :: (a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
$cmapM :: forall r (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
sequenceA :: VertexData r (f a) -&gt; f (VertexData r a)
$csequenceA :: forall r (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
traverse :: (a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
$ctraverse :: forall r (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
$cp2Traversable :: forall r. Foldable (VertexData r)
$cp1Traversable :: forall r. Functor (VertexData r)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span id="location"><span id="vData"><span id="local-6989586621680101053"><span id="local-6989586621680101355"><span id="local-6989586621680101450"><span id="local-6989586621680101451"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">VertexData</span></span></span></span></span></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Convert to an Ext</span><span>
</span><span id="line-176"></span><span id="local-6989586621680101434"><span id="local-6989586621680101435"><span class="annot"><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-type">vtxDataToExt</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101435"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101434"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680101435"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680101434"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-177"></span><span id="vtxDataToExt"><span class="annot"><span class="annottext">vtxDataToExt :: VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var hs-var">vtxDataToExt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621680100285"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621680100285"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680100284"><span class="annot"><span class="annottext">v :: v
</span><a href="#local-6989586621680100284"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100285"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; Point 2 r :+ v
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680100284"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680100278"><span id="local-6989586621680100280"><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621680100276"><span class="annot"><span class="annottext">bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; VertexData a c -&gt; VertexData b d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></span></span><span> </span><span id="local-6989586621680100274"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621680100274"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680100273"><span class="annot"><span class="annottext">g :: c -&gt; d
</span><a href="#local-6989586621680100273"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621680100272"><span class="annot"><span class="annottext">p :: Point 2 a
</span><a href="#local-6989586621680100272"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680100271"><span class="annot"><span class="annottext">v :: c
</span><a href="#local-6989586621680100271"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 b -&gt; d -&gt; VertexData b d
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Point 2 a -&gt; Point 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680100274"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 a
</span><a href="#local-6989586621680100272"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621680100273"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680100271"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621680100269"><span id="local-6989586621680100270"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680100266"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680100270"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680100269"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100270"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100269"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621680100264"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (VertexData r v)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; VertexData r v)
-&gt; Parser (Point 2 r :+ v) -&gt; Parser (VertexData r v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680100262"><span class="annot"><span class="annottext">l :: Point 2 r
</span><a href="#local-6989586621680100262"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680100261"><span class="annot"><span class="annottext">d :: v
</span><a href="#local-6989586621680100261"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; VertexData r v
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100262"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680100261"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser (Point 2 r :+ v) -&gt; Parser (VertexData r v))
-&gt; (Value -&gt; Parser (Point 2 r :+ v))
-&gt; Value
-&gt; Parser (VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Point 2 r :+ v)
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span></span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span id="local-6989586621680100258"><span id="local-6989586621680100259"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680100252"><span id="local-6989586621680100254"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680100259"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680100258"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100259"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100258"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621680100250"><span class="annot"><span class="annottext">toJSON :: VertexData r v -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span>     </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; Value)
-&gt; (VertexData r v -&gt; Point 2 r :+ v) -&gt; VertexData r v -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621680100248"><span class="annot"><span class="annottext">toEncoding :: VertexData r v -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; Encoding)
-&gt; (VertexData r v -&gt; Point 2 r :+ v) -&gt; VertexData r v -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span></span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- * The PlaneGraph type</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Embedded, *connected*, planar graph</span><span>
</span><span id="line-193"></span><span id="local-6989586621680100245"><span id="local-6989586621680100246"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PlaneGraph"><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span></span><span> </span><span id="local-6989586621680101376"><span class="annot"><a href="#local-6989586621680101376"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680101375"><span class="annot"><a href="#local-6989586621680101375"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680101374"><span class="annot"><a href="#local-6989586621680101374"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680101373"><span class="annot"><a href="#local-6989586621680101373"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680101372"><span class="annot"><a href="#local-6989586621680101372"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span id="PlaneGraph"><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_graph"><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlanarGraph</span></span><span> </span><span class="annot"><a href="#local-6989586621680101376"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Primal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101372"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101375"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680101374"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101373"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680100238"><span id="local-6989586621680100240"><span id="local-6989586621680100242"><span class="annot"><span class="annottext">Int -&gt; PlaneGraph s v e f r -&gt; ShowS
[PlaneGraph s v e f r] -&gt; ShowS
PlaneGraph s v e f r -&gt; String
(Int -&gt; PlaneGraph s v e f r -&gt; ShowS)
-&gt; (PlaneGraph s v e f r -&gt; String)
-&gt; ([PlaneGraph s v e f r] -&gt; ShowS)
-&gt; Show (PlaneGraph s v e f r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlaneGraph s v e f r -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlaneGraph s v e f r] -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlaneGraph s v e f r -&gt; String
showList :: [PlaneGraph s v e f r] -&gt; ShowS
$cshowList :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlaneGraph s v e f r] -&gt; ShowS
show :: PlaneGraph s v e f r -&gt; String
$cshow :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlaneGraph s v e f r -&gt; String
showsPrec :: Int -&gt; PlaneGraph s v e f r -&gt; ShowS
$cshowsPrec :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlaneGraph s v e f r -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680100234"><span id="local-6989586621680100236"><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool)
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool)
-&gt; Eq (PlaneGraph s v e f r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
/= :: PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
$c/= :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
== :: PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
$c== :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x. PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x)
-&gt; (forall x. Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r)
-&gt; Generic (PlaneGraph s v e f r)
forall x. Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
forall x. PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall k (s :: k) v e f r x.
Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r x.
PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
$cto :: forall k (s :: k) v e f r x.
Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
$cfrom :: forall k (s :: k) v e f r x.
PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="graph"><span id="local-6989586621680101367"><span id="local-6989586621680101368"><span id="local-6989586621680101369"><span id="local-6989586621680101370"><span id="local-6989586621680101371"><span id="local-6989586621680101372"><span id="local-6989586621680101373"><span id="local-6989586621680101374"><span id="local-6989586621680101375"><span id="local-6989586621680101376"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PlaneGraph</span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="Data.Geometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span id="local-6989586621680100231"><span class="annot"><a href="#local-6989586621680100231"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680100230"><span class="annot"><a href="#local-6989586621680100230"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680100229"><span class="annot"><a href="#local-6989586621680100229"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680100228"><span class="annot"><a href="#local-6989586621680100228"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680100227"><span class="annot"><a href="#local-6989586621680100227"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680100227"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-199"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="Data.Geometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span id="local-6989586621680100226"><span class="annot"><a href="#local-6989586621680100226"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680100225"><span class="annot"><a href="#local-6989586621680100225"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680100224"><span class="annot"><a href="#local-6989586621680100224"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680100223"><span class="annot"><a href="#local-6989586621680100223"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680100222"><span class="annot"><a href="#local-6989586621680100222"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621680100218"><span id="local-6989586621680100219"><span id="local-6989586621680100220"><span id="local-6989586621680100221"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680100215"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100221"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100220"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100219"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100218"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621680100214"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; PlaneGraph s v e f a -&gt; PlaneGraph s v e f b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621680100213"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621680100213"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680100212"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f a
</span><a href="#local-6989586621680100212"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f a
</span><a href="#local-6989586621680100212"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f a
-&gt; (PlaneGraph s v e f a -&gt; PlaneGraph s v e f b)
-&gt; PlaneGraph s v e f b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData a v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData a v) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
 -&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; PlanarGraph s 'Primal (VertexData a v) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; PlaneGraph s v e f a
-&gt; Identity (PlaneGraph s v e f b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; PlanarGraph s 'Primal (VertexData a v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span class="annot"><span class="annottext">((Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
 -&gt; PlanarGraph s 'Primal (VertexData a v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; PlanarGraph s 'Primal (VertexData a v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexData a v -&gt; Identity (VertexData b v))
-&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((VertexData a v -&gt; Identity (VertexData b v))
 -&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; VertexData a v -&gt; Identity (VertexData b v))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; Vector (VertexData a v)
-&gt; Identity (Vector (VertexData b v))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 a -&gt; Identity (Point 2 b))
-&gt; VertexData a v -&gt; Identity (VertexData b v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">((Point 2 a -&gt; Identity (Point 2 b))
 -&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b))
-&gt; (Point 2 a -&gt; Point 2 b)
-&gt; PlaneGraph s v e f a
-&gt; PlaneGraph s v e f b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Point 2 a -&gt; Point 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680100213"><span class="hs-identifier hs-var">f</span></a></span></span></span></span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621680100203"><span id="local-6989586621680100204"><span id="local-6989586621680100205"><span id="local-6989586621680100206"><span id="local-6989586621680100207"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#IsBoxable"><span class="hs-identifier hs-type">IsBoxable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100207"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100206"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100205"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100204"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100203"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621680100200"><span class="annot"><span class="annottext">boundingBox :: PlaneGraph s v e f r
-&gt; Box
     (Dimension (PlaneGraph s v e f r))
     ()
     (NumType (PlaneGraph s v e f r))
</span><a href="Data.Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var hs-var hs-var hs-var">boundingBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Box 2 () r
forall g (c :: * -&gt; *).
(IsBoxable g, Foldable c, Ord (NumType g), Arity (Dimension g)) =&gt;
c g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Data.Geometry.Box.Internal.html#boundingBoxList%27"><span class="hs-identifier hs-var">boundingBoxList'</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Box 2 () r)
-&gt; (PlaneGraph s v e f r -&gt; [Point 2 r])
-&gt; PlaneGraph s v e f r
-&gt; Box 2 () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point 2 r) -&gt; [Point 2 r])
-&gt; (PlaneGraph s v e f r -&gt; Vector (Point 2 r))
-&gt; PlaneGraph s v e f r
-&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v) -&gt; Point 2 r)
-&gt; Vector (VertexId' s, VertexData r v) -&gt; Vector (Point 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VertexId' s, VertexData r v)
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; (VertexId' s, VertexData r v)
-&gt; Const (Point 2 r) (VertexId' s, VertexData r v)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
 -&gt; (VertexId' s, VertexData r v)
 -&gt; Const (Point 2 r) (VertexId' s, VertexData r v))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s, VertexData r v) -&gt; Vector (Point 2 r))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span></span></span></span></span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- * Constructing a Plane Graph</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Construct a plane graph from a simple polygon. It is assumed that the</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- polygon is given in counterclockwise order.</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- the interior of the polygon will have faceId 0</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- pre: the input polygon is given in counterclockwise order</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- running time: \(O(n)\).</span><span>
</span><span id="line-218"></span><span id="local-6989586621680100190"><span id="local-6989586621680100191"><span id="local-6989586621680100192"><span id="local-6989586621680100193"><span id="local-6989586621680100194"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier hs-type">fromSimplePolygon</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680100194"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100193"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-219"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100192"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100191"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-220"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680100190"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data inside</span><span>
</span><span id="line-221"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680100190"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data outside the polygon</span><span>
</span><span id="line-222"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100193"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100192"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680100190"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100191"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-223"></span><span id="fromSimplePolygon"><span class="annot"><span class="annottext">fromSimplePolygon :: proxy s -&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlaneGraph s p () f r
</span><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier hs-var hs-var">fromSimplePolygon</span></a></span></span><span> </span><span id="local-6989586621680100189"><span class="annot"><span class="annottext">p :: proxy s
</span><a href="#local-6989586621680100189"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680100188"><span class="annot"><span class="annottext">poly :: SimplePolygon p r
</span><a href="#local-6989586621680100188"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span id="local-6989586621680100187"><span class="annot"><span class="annottext">iD :: f
</span><a href="#local-6989586621680100187"><span class="hs-identifier hs-var">iD</span></a></span></span><span> </span><span id="local-6989586621680100186"><span class="annot"><span class="annottext">oD :: f
</span><a href="#local-6989586621680100186"><span class="hs-identifier hs-var">oD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () f
-&gt; PlaneGraph s p () f r
forall k (s :: k) v e f r.
PlanarGraph s 'Primal (VertexData r v) e f -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () f
</span><a href="#local-6989586621680100185"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621680100184"><span class="annot"><span class="annottext">vs :: CircularVector (Point 2 r :+ p)
</span><a href="#local-6989586621680100184"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
</span><a href="#local-6989586621680100188"><span class="hs-identifier hs-var">poly</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon p r
-&gt; Getting
     (CircularVector (Point 2 r :+ p))
     (SimplePolygon p r)
     (CircularVector (Point 2 r :+ p))
-&gt; CircularVector (Point 2 r :+ p)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (CircularVector (Point 2 r :+ p))
  (SimplePolygon p r)
  (CircularVector (Point 2 r :+ p))
forall (t :: PolygonType) p r.
Getter (Polygon t p r) (CircularVector (Point 2 r :+ p))
</span><a href="Data.Geometry.Polygon.Core.html#outerBoundaryVector"><span class="hs-identifier hs-var">outerBoundaryVector</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621680100182"><span class="annot"><span class="annottext">g :: PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="#local-6989586621680100182"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy s
-&gt; CircularVector (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall k (proxy :: k -&gt; *) (s :: k) r p.
proxy s
-&gt; CircularVector (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-var">fromVertices</span></a></span><span> </span><span class="annot"><span class="annottext">proxy s
</span><a href="#local-6989586621680100189"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">CircularVector (Point 2 r :+ p)
</span><a href="#local-6989586621680100184"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621680100180"><span class="annot"><span class="annottext">fData' :: Vector f
</span><a href="#local-6989586621680100180"><span class="hs-identifier hs-var hs-var">fData'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f] -&gt; Vector f
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680100187"><span class="hs-identifier hs-var">iD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680100186"><span class="hs-identifier hs-var">oD</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621680100185"><span class="annot"><span class="annottext">g' :: PlanarGraph s 'Primal (VertexData r p) () f
</span><a href="#local-6989586621680100185"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="#local-6989586621680100182"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; (PlanarGraph s 'Primal (VertexData r p) () ()
    -&gt; PlanarGraph s 'Primal (VertexData r p) () f)
-&gt; PlanarGraph s 'Primal (VertexData r p) () f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector f))
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () f)
forall k (s :: k) (w :: World) v e f f'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e f')
  (Vector f)
  (Vector f')
</span><span class="hs-identifier hs-var">PG.faceData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector f))
 -&gt; PlanarGraph s 'Primal (VertexData r p) () ()
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () f))
-&gt; Vector f
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; PlanarGraph s 'Primal (VertexData r p) () f
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector f
</span><a href="#local-6989586621680100180"><span class="hs-identifier hs-var">fData'</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Constructs a planar from the given vertices</span><span>
</span><span id="line-231"></span><span id="local-6989586621680101300"><span id="local-6989586621680101301"><span id="local-6989586621680101302"><span id="local-6989586621680101303"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-type">fromVertices</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680101303"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101302"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-232"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CircularVector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680101301"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680101300"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlanarGraph</span></span><span> </span><span class="annot"><a href="#local-6989586621680101302"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Primal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101301"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101300"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-234"></span><span id="fromVertices"><span class="annot"><span class="annottext">fromVertices :: proxy s
-&gt; CircularVector (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-var hs-var">fromVertices</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621680100176"><span class="annot"><span class="annottext">vs :: CircularVector (Point 2 r :+ p)
</span><a href="#local-6989586621680100176"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () () ()
</span><a href="#local-6989586621680100175"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () () ()
-&gt; (PlanarGraph s 'Primal () () ()
    -&gt; PlanarGraph s 'Primal (VertexData r p) () ())
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector (VertexData r p)))
-&gt; PlanarGraph s 'Primal () () ()
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () ())
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector (VertexData r p)))
 -&gt; PlanarGraph s 'Primal () () ()
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () ()))
-&gt; Vector (VertexData r p)
-&gt; PlanarGraph s 'Primal () () ()
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r p)
</span><a href="#local-6989586621680100174"><span class="hs-identifier hs-var">vData'</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621680100173"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680100173"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CircularVector (Point 2 r :+ p) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">CircularVector (Point 2 r :+ p)
</span><a href="#local-6989586621680100176"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621680100175"><span class="annot"><span class="annottext">g :: PlanarGraph s 'Primal () () ()
</span><a href="#local-6989586621680100175"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Dart s, ())]] -&gt; PlanarGraph s 'Primal () () ()
forall k (s :: k) e.
[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
</span><span class="hs-identifier hs-var">planarGraph</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100169"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>               </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Arc s) -&gt; Int -&gt; Arc s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100169"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100173"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680100169"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100169"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100173"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621680100174"><span class="annot"><span class="annottext">vData' :: Vector (VertexData r p)
</span><a href="#local-6989586621680100174"><span class="hs-identifier hs-var hs-var">vData'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VertexData r p] -&gt; Vector (VertexData r p)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([VertexData r p] -&gt; Vector (VertexData r p))
-&gt; (CircularVector (Point 2 r :+ p) -&gt; [VertexData r p])
-&gt; CircularVector (Point 2 r :+ p)
-&gt; Vector (VertexData r p)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ p) -&gt; VertexData r p)
-&gt; [Point 2 r :+ p] -&gt; [VertexData r p]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680100164"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621680100164"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680100163"><span class="annot"><span class="annottext">e :: p
</span><a href="#local-6989586621680100163"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; p -&gt; VertexData r p
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100164"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680100163"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [VertexData r p])
-&gt; (CircularVector (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; CircularVector (Point 2 r :+ p)
-&gt; [VertexData r p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CircularVector (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(CircularVector (Point 2 r :+ p) -&gt; Vector (VertexData r p))
-&gt; CircularVector (Point 2 r :+ p) -&gt; Vector (VertexData r p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CircularVector (Point 2 r :+ p)
</span><a href="#local-6989586621680100176"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Constructs a connected plane graph</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- pre: The segments form a single connected component</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- running time: \(O(n\log n)\)</span><span>
</span><span id="line-248"></span><span id="local-6989586621680100157"><span id="local-6989586621680100158"><span id="local-6989586621680100159"><span id="local-6989586621680100160"><span id="local-6989586621680100161"><span id="local-6989586621680100162"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier hs-type">fromConnectedSegments</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621680100162"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680100161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680100160"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100159"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-250"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680100162"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680100158"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100161"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100157"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100159"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty.NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621680100158"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680100157"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680100161"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-252"></span><span id="fromConnectedSegments"><span class="annot"><span class="annottext">fromConnectedSegments :: proxy s
-&gt; f (LineSegment 2 p r :+ e) -&gt; PlaneGraph s (NonEmpty p) e () r
</span><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier hs-var hs-var">fromConnectedSegments</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621680100156"><span class="annot"><span class="annottext">ss :: f (LineSegment 2 p r :+ e)
</span><a href="#local-6989586621680100156"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
-&gt; PlaneGraph s (NonEmpty p) e () r
forall k (s :: k) v e f r.
PlanarGraph s 'Primal (VertexData r v) e f -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
 -&gt; PlaneGraph s (NonEmpty p) e () r)
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
-&gt; PlaneGraph s (NonEmpty p) e () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
forall k (s :: k) e.
[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
</span><span class="hs-identifier hs-var">planarGraph</span></span><span> </span><span class="annot"><span class="annottext">[[(Dart s, e)]]
</span><a href="#local-6989586621680100155"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () e ()
-&gt; (PlanarGraph s 'Primal () e ()
    -&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ())
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector (VertexData r (NonEmpty p))))
-&gt; PlanarGraph s 'Primal () e ()
-&gt; Identity
     (PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ())
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector (VertexData r (NonEmpty p))))
 -&gt; PlanarGraph s 'Primal () e ()
 -&gt; Identity
      (PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()))
-&gt; Vector (VertexData r (NonEmpty p))
-&gt; PlanarGraph s 'Primal () e ()
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r (NonEmpty p))
</span><a href="#local-6989586621680100154"><span class="hs-identifier hs-var">vxData</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621680100153"><span class="annot"><span class="annottext">pts :: Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
</span><a href="#local-6989586621680100153"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
 -&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
 -&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
 -&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]))
-&gt; (f (LineSegment 2 p r :+ e)
    -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 p r :+ (Arc s :+ e))
 -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 p r :+ (Arc s :+ e))
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall k s (s :: k) b.
(HasStart s, HasEnd s, StartExtra s ~ EndExtra s,
 EndCore s ~ StartCore s) =&gt;
(s :+ (Arc s :+ b))
-&gt; [(StartCore s,
     SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)])]
</span><a href="#local-6989586621680100150"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ (Arc s :+ e)]
 -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; (f (LineSegment 2 p r :+ e)
    -&gt; [LineSegment 2 p r :+ (Arc s :+ e)])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; (LineSegment 2 p r :+ e) -&gt; LineSegment 2 p r :+ (Arc s :+ e))
-&gt; [Int]
-&gt; [LineSegment 2 p r :+ e]
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (LineSegment 2 p r :+ e) -&gt; LineSegment 2 p r :+ (Arc s :+ e)
forall k core extra (s :: k).
Int -&gt; (core :+ extra) -&gt; core :+ (Arc s :+ extra)
</span><a href="#local-6989586621680100148"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ e] -&gt; [LineSegment 2 p r :+ (Arc s :+ e)])
-&gt; (f (LineSegment 2 p r :+ e) -&gt; [LineSegment 2 p r :+ e])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (LineSegment 2 p r :+ e) -&gt; [LineSegment 2 p r :+ e]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(f (LineSegment 2 p r :+ e)
 -&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]))
-&gt; f (LineSegment 2 p r :+ e)
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (LineSegment 2 p r :+ e)
</span><a href="#local-6989586621680100156"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621680100150"><span class="annot"><span class="annottext">f :: (s :+ (Arc s :+ b))
-&gt; [(StartCore s,
     SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)])]
</span><a href="#local-6989586621680100150"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680100147"><span class="annot"><span class="annottext">s :: s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680100146"><span class="annot"><span class="annottext">e :: Arc s :+ b
</span><a href="#local-6989586621680100146"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span>
</span><span id="line-256"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty (EndExtra s)
-&gt; [StartCore s :+ (Dart s, b)]
-&gt; SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)]
forall a b. a -&gt; b -&gt; SP a b
</span><span class="hs-identifier hs-var">SP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndExtra s -&gt; NonEmpty (EndExtra s)
forall a. a -&gt; NonEmpty a
</span><a href="#local-6989586621680100142"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="annot"><span class="annottext">(EndExtra s -&gt; NonEmpty (EndExtra s))
-&gt; EndExtra s -&gt; NonEmpty (EndExtra s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (EndExtra s) s (EndExtra s) -&gt; EndExtra s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (EndExtra s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (EndExtra s) s)
-&gt; ((EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; Getting (EndExtra s) s (EndExtra s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (EndExtra s) (StartCore s :+ EndExtra s)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">StartCore s -&gt; (Dart s, b) -&gt; StartCore s :+ (Dart s, b)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
forall k (s :: k) b. Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621680100139"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span> </span><span class="annot"><span class="annottext">Arc s :+ b
</span><a href="#local-6989586621680100146"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span>
</span><span id="line-258"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty (EndExtra s)
-&gt; [StartCore s :+ (Dart s, b)]
-&gt; SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)]
forall a b. a -&gt; b -&gt; SP a b
</span><span class="hs-identifier hs-var">SP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndExtra s -&gt; NonEmpty (EndExtra s)
forall a. a -&gt; NonEmpty a
</span><a href="#local-6989586621680100142"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="annot"><span class="annottext">(EndExtra s -&gt; NonEmpty (EndExtra s))
-&gt; EndExtra s -&gt; NonEmpty (EndExtra s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (EndExtra s) s (EndExtra s) -&gt; EndExtra s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (EndExtra s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (EndExtra s) s)
-&gt; ((EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; Getting (EndExtra s) s (EndExtra s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (EndExtra s) (StartCore s :+ EndExtra s)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680100147"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StartCore s -&gt; (Dart s, b) -&gt; StartCore s :+ (Dart s, b)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
forall k (s :: k) b. Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621680100139"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span> </span><span class="annot"><span class="annottext">Arc s :+ b
</span><a href="#local-6989586621680100146"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621680100148"><span class="annot"><span class="annottext">g :: Int -&gt; (core :+ extra) -&gt; core :+ (Arc s :+ extra)
</span><a href="#local-6989586621680100148"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680100138"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621680100138"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680100137"><span class="annot"><span class="annottext">s :: core
</span><a href="#local-6989586621680100137"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680100136"><span class="annot"><span class="annottext">e :: extra
</span><a href="#local-6989586621680100136"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">core
</span><a href="#local-6989586621680100137"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">core -&gt; (Arc s :+ extra) -&gt; core :+ (Arc s :+ extra)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680100138"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Arc s -&gt; extra -&gt; Arc s :+ extra
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">extra
</span><a href="#local-6989586621680100136"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621680100139"><span class="annot"><span class="annottext">h :: Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621680100139"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680100135"><span class="annot"><span class="annottext">d :: Direction
</span><a href="#local-6989586621680100135"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680100134"><span class="annot"><span class="annottext">a :: Arc s
</span><a href="#local-6989586621680100134"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621680100133"><span class="annot"><span class="annottext">e :: b
</span><a href="#local-6989586621680100133"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621680100134"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621680100135"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680100133"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621680100142"><span class="annot"><span class="annottext">sing :: a -&gt; NonEmpty a
</span><a href="#local-6989586621680100142"><span class="hs-identifier hs-var hs-var">sing</span></a></span></span><span> </span><span id="local-6989586621680100132"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621680100132"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680100132"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; NonEmpty a
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621680100130"><span class="annot"><span class="annottext">vts :: [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621680100130"><span class="hs-identifier hs-var hs-var">vts</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
 -&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)]))
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680100129"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621680100129"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680100128"><span class="annot"><span class="annottext">sp :: SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
</span><a href="#local-6989586621680100128"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100129"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">((Point 2 r :+ (Dart s, e)) -&gt; (Dart s, e))
-&gt; [Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ (Dart s, e))
-&gt; Getting (Dart s, e) (Point 2 r :+ (Dart s, e)) (Dart s, e)
-&gt; (Dart s, e)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Dart s, e) (Point 2 r :+ (Dart s, e)) (Dart s, e)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)])
-&gt; ([Point 2 r :+ (Dart s, e)] -&gt; [Point 2 r :+ (Dart s, e)])
-&gt; [Point 2 r :+ (Dart s, e)]
-&gt; [(Dart s, e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ ())
-&gt; [Point 2 r :+ (Dart s, e)] -&gt; [Point 2 r :+ (Dart s, e)]
forall r q p.
(Ord r, Num r) =&gt;
(Point 2 r :+ q) -&gt; [Point 2 r :+ p] -&gt; [Point 2 r :+ p]
</span><a href="Data.Geometry.Point.Orientation.Degenerate.html#sortAround%27"><span class="hs-identifier hs-var">sortAround'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100129"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)])
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [(Dart s, e)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
</span><a href="#local-6989586621680100128"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>           </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
 -&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])])
-&gt; (Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
    -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">(Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
 -&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])])
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
</span><a href="#local-6989586621680100153"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-comment">-- vertex Data</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621680100154"><span class="annot"><span class="annottext">vxData :: Vector (VertexData r (NonEmpty p))
</span><a href="#local-6989586621680100154"><span class="hs-identifier hs-var hs-var">vxData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VertexData r (NonEmpty p)] -&gt; Vector (VertexData r (NonEmpty p))
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([VertexData r (NonEmpty p)] -&gt; Vector (VertexData r (NonEmpty p)))
-&gt; ([(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
    -&gt; [VertexData r (NonEmpty p)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; Vector (VertexData r (NonEmpty p))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [(Dart s, e)])
 -&gt; VertexData r (NonEmpty p))
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; [VertexData r (NonEmpty p)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680100123"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621680100123"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680100122"><span class="annot"><span class="annottext">sp :: SP (NonEmpty p) [(Dart s, e)]
</span><a href="#local-6989586621680100122"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; NonEmpty p -&gt; VertexData r (NonEmpty p)
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100123"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SP (NonEmpty p) [(Dart s, e)]
</span><a href="#local-6989586621680100122"><span class="hs-identifier hs-var">sp</span></a></span><span class="annot"><span class="annottext">SP (NonEmpty p) [(Dart s, e)]
-&gt; Getting
     (NonEmpty p) (SP (NonEmpty p) [(Dart s, e)]) (NonEmpty p)
-&gt; NonEmpty p
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (NonEmpty p) (SP (NonEmpty p) [(Dart s, e)]) (NonEmpty p)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
 -&gt; Vector (VertexData r (NonEmpty p)))
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; Vector (VertexData r (NonEmpty p))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621680100130"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- The darts</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621680100155"><span class="annot"><span class="annottext">dts :: [[(Dart s, e)]]
</span><a href="#local-6989586621680100155"><span class="hs-identifier hs-var hs-var">dts</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [(Dart s, e)]) -&gt; [(Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])] -&gt; [[(Dart s, e)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r, SP (NonEmpty p) [(Dart s, e)])
-&gt; Getting
     [(Dart s, e)]
     (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
     [(Dart s, e)]
-&gt; [(Dart s, e)]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(SP (NonEmpty p) [(Dart s, e)]
 -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
-&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
-&gt; Const [(Dart s, e)] (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((SP (NonEmpty p) [(Dart s, e)]
  -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
 -&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
 -&gt; Const [(Dart s, e)] (Point 2 r, SP (NonEmpty p) [(Dart s, e)]))
-&gt; (([(Dart s, e)] -&gt; Const [(Dart s, e)] [(Dart s, e)])
    -&gt; SP (NonEmpty p) [(Dart s, e)]
    -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
-&gt; Getting
     [(Dart s, e)]
     (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
     [(Dart s, e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([(Dart s, e)] -&gt; Const [(Dart s, e)] [(Dart s, e)])
-&gt; SP (NonEmpty p) [(Dart s, e)]
-&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)])
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621680100130"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- * Basic Graph information</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Get the number of vertices</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- &gt;&gt;&gt; numVertices smallG</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- 4</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- &gt;&gt;&gt; numVertices myPlaneGraph</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- 15</span><span>
</span><span id="line-282"></span><span id="local-6989586621680100116"><span id="local-6989586621680100117"><span id="local-6989586621680100118"><span id="local-6989586621680100119"><span id="local-6989586621680100120"><span class="annot"><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier hs-type">numVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100118"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100117"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100116"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-283"></span><span id="numVertices"><span class="annot"><span class="annottext">numVertices :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier hs-var hs-var">numVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numVertices</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Get the number of Darts</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- &gt;&gt;&gt; numDarts smallG</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- 10</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span id="local-6989586621680100110"><span id="local-6989586621680100111"><span id="local-6989586621680100112"><span id="local-6989586621680100113"><span id="local-6989586621680100114"><span class="annot"><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier hs-type">numDarts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100114"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100113"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100112"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100111"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100110"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-291"></span><span id="numDarts"><span class="annot"><span class="annottext">numDarts :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier hs-var hs-var">numDarts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numDarts</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Get the number of Edges</span><span>
</span><span id="line-294"></span><span class="hs-comment">--</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- &gt;&gt;&gt; numEdges smallG</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- 5</span><span>
</span><span id="line-297"></span><span id="local-6989586621680100104"><span id="local-6989586621680100105"><span id="local-6989586621680100106"><span id="local-6989586621680100107"><span id="local-6989586621680100108"><span class="annot"><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier hs-type">numEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100108"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100107"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100106"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100105"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100104"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-298"></span><span id="numEdges"><span class="annot"><span class="annottext">numEdges :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier hs-var hs-var">numEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numEdges</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Get the number of faces</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- &gt;&gt;&gt; numFaces smallG</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- 3</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- &gt;&gt;&gt; numFaces myPlaneGraph</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- 7</span><span>
</span><span id="line-306"></span><span id="local-6989586621680100098"><span id="local-6989586621680100099"><span id="local-6989586621680100100"><span id="local-6989586621680100101"><span id="local-6989586621680100102"><span class="annot"><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier hs-type">numFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100102"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100101"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100100"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100099"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100098"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-307"></span><span id="numFaces"><span class="annot"><span class="annottext">numFaces :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier hs-var hs-var">numFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numFaces</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Enumerate all vertices</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; vertices' smallG</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- [VertexId 0,VertexId 1,VertexId 2,VertexId 3]</span><span>
</span><span id="line-313"></span><span id="local-6989586621680100092"><span id="local-6989586621680100093"><span id="local-6989586621680100094"><span id="local-6989586621680100095"><span id="local-6989586621680100096"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier hs-type">vertices'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100096"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100095"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100094"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100093"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100092"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100096"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-314"></span><span id="vertices%27"><span class="annot"><span class="annottext">vertices' :: PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier hs-var hs-var">vertices'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.vertices'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- | Enumerate all vertices, together with their vertex data</span><span>
</span><span id="line-317"></span><span class="hs-comment">--</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ vertices smallG</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- (VertexId 0,VertexData {_location = Point2 0 0, _vData = 0})</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- (VertexId 1,VertexData {_location = Point2 2 2, _vData = 1})</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- (VertexId 2,VertexData {_location = Point2 2 0, _vData = 2})</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- (VertexId 3,VertexData {_location = Point2 (-1) 4, _vData = 3})</span><span>
</span><span id="line-323"></span><span id="local-6989586621680101320"><span id="local-6989586621680101321"><span id="local-6989586621680101322"><span id="local-6989586621680101323"><span id="local-6989586621680101324"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101324"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101323"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101322"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101321"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101320"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680101324"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101320"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101323"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-324"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (VertexId s w, v)
</span><span class="hs-identifier hs-var">PG.vertices</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s, VertexData r v))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Enumerate all darts</span><span>
</span><span id="line-327"></span><span id="local-6989586621680100085"><span id="local-6989586621680100086"><span id="local-6989586621680100087"><span id="local-6989586621680100088"><span id="local-6989586621680100089"><span class="annot"><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier hs-type">darts'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100089"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100088"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100087"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100086"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100085"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100089"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-328"></span><span id="darts%27"><span class="annot"><span class="annottext">darts' :: PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier hs-var hs-var">darts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.darts'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | Get all darts together with their data</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span id="local-6989586621680100079"><span id="local-6989586621680100080"><span id="local-6989586621680100081"><span id="local-6989586621680100082"><span id="local-6989586621680100083"><span class="annot"><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier hs-type">darts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100083"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100082"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100081"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100080"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100079"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100083"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100081"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-334"></span><span id="darts"><span class="annot"><span class="annottext">darts :: PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier hs-var hs-var">darts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s, e)
</span><span class="hs-identifier hs-var">PG.darts</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Enumerate all edges. We report only the Positive darts</span><span>
</span><span id="line-338"></span><span id="local-6989586621680100073"><span id="local-6989586621680100074"><span id="local-6989586621680100075"><span id="local-6989586621680100076"><span id="local-6989586621680100077"><span class="annot"><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier hs-type">edges'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100077"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100076"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100075"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100073"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100077"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-339"></span><span id="edges%27"><span class="annot"><span class="annottext">edges' :: PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier hs-var hs-var">edges'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.edges'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Lens to access the raw dart data, use at your own risk</span><span>
</span><span id="line-342"></span><span id="local-6989586621680100066"><span id="local-6989586621680100067"><span id="local-6989586621680100068"><span id="local-6989586621680100069"><span id="local-6989586621680100070"><span id="local-6989586621680100071"><span class="annot"><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-type">rawDartData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100071"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100070"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100069"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100068"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100067"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100071"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100070"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100066"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100068"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100067"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100069"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100066"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-344"></span><span id="rawDartData"><span class="annot"><span class="annottext">rawDartData :: (Vector e -&gt; f (Vector e'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var hs-var">rawDartData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r))
-&gt; ((Vector e -&gt; f (Vector e'))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; (Vector e -&gt; f (Vector e'))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e' f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector e -&gt; f (Vector e'))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector e)
  (Vector e')
</span><span class="hs-identifier hs-var">PG.rawDartData</span></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | lens to access the Dart Data</span><span>
</span><span id="line-347"></span><span id="local-6989586621680100059"><span id="local-6989586621680100060"><span id="local-6989586621680100061"><span id="local-6989586621680100062"><span id="local-6989586621680100063"><span id="local-6989586621680100064"><span class="annot"><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier hs-type">dartData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100064"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100063"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100062"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100061"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100060"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100064"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100063"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100059"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100061"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100060"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100064"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100062"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100064"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100059"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-349"></span><span id="dartData"><span class="annot"><span class="annottext">dartData :: (Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier hs-var hs-var">dartData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r))
-&gt; ((Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; (Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e' f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector (Dart s, e))
  (Vector (Dart s, e'))
</span><span class="hs-identifier hs-var">PG.dartData</span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Lens to access face data</span><span>
</span><span id="line-352"></span><span id="local-6989586621680100052"><span id="local-6989586621680100053"><span id="local-6989586621680100054"><span id="local-6989586621680100055"><span id="local-6989586621680100056"><span id="local-6989586621680100057"><span class="annot"><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-type">faceData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100057"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100055"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100054"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100053"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100057"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100055"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100052"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100053"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100054"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100052"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-354"></span><span id="faceData"><span class="annot"><span class="annottext">faceData :: (Vector f -&gt; f (Vector f'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r)
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var hs-var">faceData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r))
-&gt; ((Vector f -&gt; f (Vector f'))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
-&gt; (Vector f -&gt; f (Vector f'))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f' r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector f -&gt; f (Vector f'))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e f')
forall k (s :: k) (w :: World) v e f f'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e f')
  (Vector f)
  (Vector f')
</span><span class="hs-identifier hs-var">PG.faceData</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span id="local-6989586621680100729"><span id="local-6989586621680100730"><span id="local-6989586621680100731"><span id="local-6989586621680100732"><span id="local-6989586621680100733"><span id="local-6989586621680100734"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-type">vertexData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100734"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100733"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100732"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100731"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100734"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100729"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100732"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100731"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100733"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621680100729"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-358"></span><span id="vertexData"><span class="annot"><span class="annottext">vertexData :: (Vector v -&gt; f (Vector v'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v' e f r)
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var hs-var">vertexData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; Vector v)
-&gt; (PlaneGraph s v e f r -&gt; Vector v' -&gt; PlaneGraph s v' e f r)
-&gt; Lens
     (PlaneGraph s v e f r)
     (PlaneGraph s v' e f r)
     (Vector v)
     (Vector v')
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector v
forall k (s :: k) v e f r. PlaneGraph s v e f r -&gt; Vector v
</span><a href="#local-6989586621680100050"><span class="hs-identifier hs-var">get''</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector v' -&gt; PlaneGraph s v' e f r
forall k (s :: k) v e f r v.
PlaneGraph s v e f r -&gt; Vector v -&gt; PlaneGraph s v e f r
</span><a href="#local-6989586621680100049"><span class="hs-identifier hs-var">set''</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621680100050"><span class="annot"><span class="annottext">get'' :: PlaneGraph s v e f r -&gt; Vector v
</span><a href="#local-6989586621680100050"><span class="hs-identifier hs-var hs-var">get''</span></a></span></span><span> </span><span id="local-6989586621680100048"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621680100048"><span class="hs-identifier hs-var">pg</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680100047"><span class="annot"><span class="annottext">v :: Vector (VertexData r v)
</span><a href="#local-6989586621680100047"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100048"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (Vector (VertexData r v))
     (PlaneGraph s v e f r)
     (Vector (VertexData r v))
-&gt; Vector (VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Vector (VertexData r v))
      (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r
-&gt; Const (Vector (VertexData r v)) (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Const
       (Vector (VertexData r v))
       (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r
 -&gt; Const (Vector (VertexData r v)) (PlaneGraph s v e f r))
-&gt; ((Vector (VertexData r v)
     -&gt; Const (Vector (VertexData r v)) (Vector (VertexData r v)))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Const
         (Vector (VertexData r v))
         (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; Getting
     (Vector (VertexData r v))
     (PlaneGraph s v e f r)
     (Vector (VertexData r v))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData r v)
 -&gt; Const (Vector (VertexData r v)) (Vector (VertexData r v)))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Const
     (Vector (VertexData r v))
     (PlanarGraph s 'Primal (VertexData r v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r v -&gt; Getting v (VertexData r v) v -&gt; v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting v (VertexData r v) v
forall r v v. Lens (VertexData r v) (VertexData r v) v v
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; v) -&gt; Vector (VertexData r v) -&gt; Vector v
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r v)
</span><a href="#local-6989586621680100047"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621680100049"><span class="annot"><span class="annottext">set'' :: PlaneGraph s v e f r -&gt; Vector v -&gt; PlaneGraph s v e f r
</span><a href="#local-6989586621680100049"><span class="hs-identifier hs-var hs-var">set''</span></a></span></span><span> </span><span id="local-6989586621680100046"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621680100046"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span id="local-6989586621680100045"><span class="annot"><span class="annottext">v' :: Vector v
</span><a href="#local-6989586621680100045"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100046"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r))
-&gt; ((Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
-&gt; PlaneGraph s v e f r
-&gt; Identity (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
 -&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r))
-&gt; (Vector (VertexData r v) -&gt; Vector (VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; Vector v -&gt; Vector (VertexData r v) -&gt; Vector (VertexData r v)
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; VertexData r v -&gt; VertexData r v
forall v r v. v -&gt; VertexData r v -&gt; VertexData r v
</span><a href="#local-6989586621680100043"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v
</span><a href="#local-6989586621680100045"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621680100043"><span class="annot"><span class="annottext">f :: v -&gt; VertexData r v -&gt; VertexData r v
</span><a href="#local-6989586621680100043"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680100042"><span class="annot"><span class="annottext">x :: v
</span><a href="#local-6989586621680100042"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621680100041"><span class="annot"><span class="annottext">l :: Point 2 r
</span><a href="#local-6989586621680100041"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; VertexData r v
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680100041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680100042"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Enumerate all edges with their edge data. We report only the Positive</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- darts.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edges smallG</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- (Dart (Arc 0) +1,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- (Dart (Arc 1) +1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- (Dart (Arc 2) +1,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- (Dart (Arc 4) +1,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- (Dart (Arc 3) +1,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-373"></span><span id="local-6989586621680100592"><span id="local-6989586621680100593"><span id="local-6989586621680100594"><span id="local-6989586621680100595"><span id="local-6989586621680100596"><span class="annot"><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100595"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100594"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100593"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100592"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100596"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100594"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-374"></span><span id="edges"><span class="annot"><span class="annottext">edges :: PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s, e)
</span><span class="hs-identifier hs-var">PG.edges</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Enumerate all faces in the plane graph</span><span>
</span><span id="line-377"></span><span id="local-6989586621680101008"><span id="local-6989586621680101009"><span id="local-6989586621680101010"><span id="local-6989586621680101011"><span id="local-6989586621680101012"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-type">faces'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101012"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101011"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101010"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101009"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101008"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680101012"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-378"></span><span id="faces%27"><span class="annot"><span class="annottext">faces' :: PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-var hs-var">faces'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (FaceId s w)
</span><span class="hs-identifier hs-var">PG.faces'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | face Ids of all internal faces in the plane graph</span><span>
</span><span id="line-382"></span><span class="hs-comment">--</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-384"></span><span id="local-6989586621680100034"><span id="local-6989586621680100035"><span id="local-6989586621680100036"><span id="local-6989586621680100037"><span id="local-6989586621680100038"><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces%27"><span class="hs-identifier hs-type">internalFaces'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100038"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680100038"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100037"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100036"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100035"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100034"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100038"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100037"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-385"></span><span id="internalFaces%27"><span class="annot"><span class="annottext">internalFaces' :: PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#internalFaces%27"><span class="hs-identifier hs-var hs-var">internalFaces'</span></a></span></span><span> </span><span id="local-6989586621680100033"><span class="annot"><span class="annottext">g :: PlaneGraph s v e f r
</span><a href="#local-6989586621680100033"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680100032"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680100032"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; FaceId' s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100033"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; Bool) -&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680100032"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Vector (FaceId' s))
-&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (FaceId' s)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-var">faces'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100033"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | All faces with their face data.</span><span>
</span><span id="line-388"></span><span class="hs-comment">--</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ faces smallG</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- (FaceId 0,&quot;OuterFace&quot;)</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- (FaceId 1,&quot;A&quot;)</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- (FaceId 2,&quot;B&quot;)</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ faces myPlaneGraph</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- (FaceId 0,&quot;OuterFace&quot;)</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- (FaceId 1,&quot;A&quot;)</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- (FaceId 2,&quot;B&quot;)</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- (FaceId 3,&quot;C&quot;)</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- (FaceId 4,&quot;E&quot;)</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- (FaceId 5,&quot;F&quot;)</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- (FaceId 6,&quot;D&quot;)</span><span>
</span><span id="line-401"></span><span id="local-6989586621680100980"><span id="local-6989586621680100981"><span id="local-6989586621680100982"><span id="local-6989586621680100983"><span id="local-6989586621680100984"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-type">faces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100984"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100983"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100982"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100981"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100980"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100984"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100981"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-402"></span><span id="faces"><span class="annot"><span class="annottext">faces :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-var hs-var">faces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s, f)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (FaceId s w, f)
</span><span class="hs-identifier hs-var">PG.faces</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (FaceId' s, f))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | Reports the outerface and all internal faces separately.</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-406"></span><span id="local-6989586621680100966"><span id="local-6989586621680100967"><span id="local-6989586621680100968"><span id="local-6989586621680100969"><span id="local-6989586621680100970"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-type">faces''</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100970"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680100970"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100969"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100968"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100967"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100966"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100970"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100969"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100966"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100969"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100966"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-408"></span><span id="faces%27%27"><span class="annot"><span class="annottext">faces'' :: PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
</span><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-var hs-var">faces''</span></a></span></span><span> </span><span id="local-6989586621680100028"><span class="annot"><span class="annottext">g :: PlaneGraph s v e f r
</span><a href="#local-6989586621680100028"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680100027"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680100027"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; FaceId' s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100028"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-409"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680100027"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100028"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680100027"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((FaceId' s, f) -&gt; Bool)
-&gt; Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680100025"><span class="annot"><span class="annottext">j :: FaceId' s
</span><a href="#local-6989586621680100025"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680100027"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680100025"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f))
-&gt; Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-var">faces</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680100028"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Reports all internal faces.</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-413"></span><span id="local-6989586621680100020"><span id="local-6989586621680100021"><span id="local-6989586621680100022"><span id="local-6989586621680100023"><span id="local-6989586621680100024"><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier hs-type">internalFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100024"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680100024"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100023"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100022"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100021"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100020"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100024"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100023"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680100020"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-415"></span><span id="internalFaces"><span class="annot"><span class="annottext">internalFaces :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier hs-var hs-var">internalFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FaceId' s, f), Vector (FaceId' s, f)) -&gt; Vector (FaceId' s, f)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(((FaceId' s, f), Vector (FaceId' s, f)) -&gt; Vector (FaceId' s, f))
-&gt; (PlaneGraph s v e f r
    -&gt; ((FaceId' s, f), Vector (FaceId' s, f)))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
</span><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-var">faces''</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | The tail of a dart, i.e. the vertex this dart is leaving from</span><span>
</span><span id="line-418"></span><span class="hs-comment">--</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-420"></span><span class="hs-comment">--</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- &gt;&gt;&gt; tailOf (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- VertexId 0</span><span>
</span><span id="line-423"></span><span id="local-6989586621680100015"><span id="local-6989586621680100016"><span id="local-6989586621680100017"><span id="local-6989586621680100018"><span id="local-6989586621680100019"><span class="annot"><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-type">tailOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100019"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100019"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100018"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100017"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100016"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100015"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100019"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-424"></span><span id="tailOf"><span class="annot"><span class="annottext">tailOf :: Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-var hs-var">tailOf</span></a></span></span><span> </span><span id="local-6989586621680100014"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680100014"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; VertexId s w
</span><span class="hs-identifier hs-var">PG.tailOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680100014"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; VertexId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- | The vertex this dart is heading in to</span><span>
</span><span id="line-427"></span><span class="hs-comment">--</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- &gt;&gt;&gt; headOf (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- VertexId 2</span><span>
</span><span id="line-432"></span><span id="local-6989586621680100008"><span id="local-6989586621680100009"><span id="local-6989586621680100010"><span id="local-6989586621680100011"><span id="local-6989586621680100012"><span class="annot"><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-type">headOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100012"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100012"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100011"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100010"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100009"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100008"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100012"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-433"></span><span id="headOf"><span class="annot"><span class="annottext">headOf :: Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-var hs-var">headOf</span></a></span></span><span> </span><span id="local-6989586621680100007"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680100007"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; VertexId s w
</span><span class="hs-identifier hs-var">PG.headOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680100007"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; VertexId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | endPoints d g = (tailOf d g, headOf d g)</span><span>
</span><span id="line-436"></span><span class="hs-comment">--</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-438"></span><span class="hs-comment">--</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- &gt;&gt;&gt; endPoints (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- (VertexId 0,VertexId 2)</span><span>
</span><span id="line-441"></span><span id="local-6989586621680100001"><span id="local-6989586621680100002"><span id="local-6989586621680100003"><span id="local-6989586621680100004"><span id="local-6989586621680100005"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier hs-type">endPoints</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100005"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100005"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100004"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100003"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100002"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100001"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-442"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100005"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100005"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-443"></span><span id="endPoints"><span class="annot"><span class="annottext">endPoints :: Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexId' s, VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier hs-var hs-var">endPoints</span></a></span></span><span> </span><span id="local-6989586621680100000"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680100000"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; (VertexId' s, VertexId' s)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; (VertexId s w, VertexId s w)
</span><span class="hs-identifier hs-var">PG.endPoints</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680100000"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; (VertexId' s, VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; (VertexId' s, VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | All edges incident to vertex v, in counterclockwise order around v.</span><span>
</span><span id="line-446"></span><span class="hs-comment">--</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- &gt;&gt;&gt; incidentEdges (VertexId 1) smallG</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- [Dart (Arc 1) -1,Dart (Arc 4) +1,Dart (Arc 3) +1]</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ incidentEdges (VertexId 5) myPlaneGraph</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- Dart (Arc 1) -1</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- Dart (Arc 7) +1</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- Dart (Arc 10) +1</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Dart (Arc 4) -1</span><span>
</span><span id="line-456"></span><span id="local-6989586621680100604"><span id="local-6989586621680100605"><span id="local-6989586621680100606"><span id="local-6989586621680100607"><span id="local-6989586621680100608"><span class="annot"><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-type">incidentEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100608"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100608"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100607"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100606"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100605"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100604"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100608"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-457"></span><span id="incidentEdges"><span class="annot"><span class="annottext">incidentEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-var hs-var">incidentEdges</span></a></span></span><span> </span><span id="local-6989586621680099998"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099998"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.incidentEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099998"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | All edges incident to vertex v in incoming direction</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- (i.e. pointing into v) in counterclockwise order around v.</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-464"></span><span class="hs-comment">--</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- &gt;&gt;&gt; incomingEdges (VertexId 1) smallG</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- [Dart (Arc 1) +1,Dart (Arc 4) -1,Dart (Arc 3) -1]</span><span>
</span><span id="line-467"></span><span id="local-6989586621680099992"><span id="local-6989586621680099993"><span id="local-6989586621680099994"><span id="local-6989586621680099995"><span id="local-6989586621680099996"><span class="annot"><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier hs-type">incomingEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099996"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099996"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099995"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099994"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099993"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099992"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099996"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-468"></span><span id="incomingEdges"><span class="annot"><span class="annottext">incomingEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier hs-var hs-var">incomingEdges</span></a></span></span><span> </span><span id="local-6989586621680099991"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099991"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.incomingEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099991"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- | All edges incident to vertex v in incoming direction</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- (i.e. pointing into v) in counterclockwise order around v.</span><span>
</span><span id="line-474"></span><span class="hs-comment">--</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-476"></span><span class="hs-comment">--</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- &gt;&gt;&gt; outgoingEdges (VertexId 1) smallG</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- [Dart (Arc 1) -1,Dart (Arc 4) +1,Dart (Arc 3) +1]</span><span>
</span><span id="line-479"></span><span id="local-6989586621680099985"><span id="local-6989586621680099986"><span id="local-6989586621680099987"><span id="local-6989586621680099988"><span id="local-6989586621680099989"><span class="annot"><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier hs-type">outgoingEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099989"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099989"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099988"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099987"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099986"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099985"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099989"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-480"></span><span id="outgoingEdges"><span class="annot"><span class="annottext">outgoingEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier hs-var hs-var">outgoingEdges</span></a></span></span><span> </span><span id="local-6989586621680099984"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099984"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.outgoingEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099984"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Gets the neighbours of a particular vertex, in counterclockwise order</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- around the vertex.</span><span>
</span><span id="line-484"></span><span class="hs-comment">--</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size</span><span>
</span><span id="line-486"></span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- &gt;&gt;&gt; neighboursOf (VertexId 1) smallG</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- [VertexId 0,VertexId 2,VertexId 3]</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- &gt;&gt;&gt; neighboursOf (VertexId 5) myPlaneGraph</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- [VertexId 0,VertexId 6,VertexId 8,VertexId 1]</span><span>
</span><span id="line-491"></span><span id="local-6989586621680099978"><span id="local-6989586621680099979"><span id="local-6989586621680099980"><span id="local-6989586621680099981"><span id="local-6989586621680099982"><span class="annot"><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier hs-type">neighboursOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099982"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099982"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099981"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099980"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099979"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099978"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-492"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099982"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-493"></span><span id="neighboursOf"><span class="annot"><span class="annottext">neighboursOf :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier hs-var hs-var">neighboursOf</span></a></span></span><span> </span><span id="local-6989586621680099977"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099977"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.neighboursOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099977"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the next dart in the</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-497"></span><span class="hs-comment">--</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-499"></span><span class="hs-comment">--</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- Dart (Arc 4) +1</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdge (dart 1 &quot;+1&quot;) myPlaneGraph</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- Dart (Arc 7) +1</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdge (dart 17 &quot;-1&quot;) myPlaneGraph</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- Dart (Arc 15) -1</span><span>
</span><span id="line-506"></span><span id="local-6989586621680099971"><span id="local-6989586621680099972"><span id="local-6989586621680099973"><span id="local-6989586621680099974"><span id="local-6989586621680099975"><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier hs-type">nextIncidentEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099975"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099975"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099974"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099973"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099972"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099971"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099975"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-507"></span><span id="nextIncidentEdge"><span class="annot"><span class="annottext">nextIncidentEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier hs-var hs-var">nextIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621680099970"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099970"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.nextIncidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099970"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the previous dart in the</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- Dart (Arc 3) +1</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdge (dart 1 &quot;+1&quot;) myPlaneGraph</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- Dart (Arc 4) -1</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdge (dart 7 &quot;-1&quot;) myPlaneGraph</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- Dart (Arc 1) -1</span><span>
</span><span id="line-520"></span><span id="local-6989586621680099964"><span id="local-6989586621680099965"><span id="local-6989586621680099966"><span id="local-6989586621680099967"><span id="local-6989586621680099968"><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier hs-type">prevIncidentEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099968"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099968"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099967"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099966"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099965"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099964"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099968"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-521"></span><span id="prevIncidentEdge"><span class="annot"><span class="annottext">prevIncidentEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier hs-var hs-var">prevIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621680099963"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099963"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.prevIncidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099963"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-- | Given a dart d that points away from some vertex v, report the</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- next dart in the cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-529"></span><span class="hs-comment">--</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdgeFrom (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- Dart (Arc 2) +1</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdgeFrom (dart 1 &quot;+1&quot;) myPlaneGraph</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- Dart (Arc 2) +1</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdgeFrom (dart 4 &quot;+1&quot;) myPlaneGraph</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- Dart (Arc 15) +1</span><span>
</span><span id="line-536"></span><span id="local-6989586621680099957"><span id="local-6989586621680099958"><span id="local-6989586621680099959"><span id="local-6989586621680099960"><span id="local-6989586621680099961"><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdgeFrom"><span class="hs-identifier hs-type">nextIncidentEdgeFrom</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099961"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099961"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099960"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099959"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099958"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099957"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099961"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-537"></span><span id="nextIncidentEdgeFrom"><span class="annot"><span class="annottext">nextIncidentEdgeFrom :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextIncidentEdgeFrom"><span class="hs-identifier hs-var hs-var">nextIncidentEdgeFrom</span></a></span></span><span> </span><span id="local-6989586621680099956"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099956"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.nextIncidentEdgeFrom</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099956"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | Given a dart d that points into away from vertex v, report the previous dart in the</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- cyclic (counterclockwise) order around v.</span><span>
</span><span id="line-541"></span><span class="hs-comment">--</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdgeFrom (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- Dart (Arc 0) +1</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdgeFrom (dart 4 &quot;+1&quot;) myPlaneGraph</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- Dart (Arc 2) -1</span><span>
</span><span id="line-548"></span><span id="local-6989586621680099950"><span id="local-6989586621680099951"><span id="local-6989586621680099952"><span id="local-6989586621680099953"><span id="local-6989586621680099954"><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdgeFrom"><span class="hs-identifier hs-type">prevIncidentEdgeFrom</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099954"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099954"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099953"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099952"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099951"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099950"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099954"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-549"></span><span id="prevIncidentEdgeFrom"><span class="annot"><span class="annottext">prevIncidentEdgeFrom :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevIncidentEdgeFrom"><span class="hs-identifier hs-var hs-var">prevIncidentEdgeFrom</span></a></span></span><span> </span><span id="local-6989586621680099949"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099949"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.prevIncidentEdgeFrom</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099949"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- | The face to the left of the dart</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-555"></span><span class="hs-comment">--</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 1 &quot;-1&quot;) smallG</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- FaceId 1</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 2 &quot;+1&quot;) smallG</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- FaceId 0</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 2 &quot;-1&quot;) smallG</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-564"></span><span id="local-6989586621680100645"><span id="local-6989586621680100646"><span id="local-6989586621680100647"><span id="local-6989586621680100648"><span id="local-6989586621680100649"><span class="annot"><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-type">leftFace</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100649"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100649"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100648"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100647"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100646"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100645"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100649"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-565"></span><span id="leftFace"><span class="annot"><span class="annottext">leftFace :: Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var hs-var">leftFace</span></a></span></span><span> </span><span id="local-6989586621680099947"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099947"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; FaceId s w
</span><span class="hs-identifier hs-var">PG.leftFace</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099947"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | The face to the right of the dart</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-570"></span><span class="hs-comment">--</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- FaceId 1</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 1 &quot;-1&quot;) smallG</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 2 &quot;+1&quot;) smallG</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 2 &quot;-1&quot;) smallG</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- FaceId 0</span><span>
</span><span id="line-579"></span><span id="local-6989586621680099941"><span id="local-6989586621680099942"><span id="local-6989586621680099943"><span id="local-6989586621680099944"><span id="local-6989586621680099945"><span class="annot"><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier hs-type">rightFace</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099945"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099945"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099944"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099943"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099942"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099941"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099945"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-580"></span><span id="rightFace"><span class="annot"><span class="annottext">rightFace :: Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier hs-var hs-var">rightFace</span></a></span></span><span> </span><span id="local-6989586621680099940"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099940"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; FaceId s w
</span><span class="hs-identifier hs-var">PG.rightFace</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099940"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-comment">-- | Get the next edge along the face</span><span>
</span><span id="line-584"></span><span class="hs-comment">--</span><span>
</span><span id="line-585"></span><span class="hs-comment">--</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-587"></span><span class="hs-comment">--</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- &gt;&gt;&gt; nextEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- Dart (Arc 4) +1</span><span>
</span><span id="line-590"></span><span id="local-6989586621680099934"><span id="local-6989586621680099935"><span id="local-6989586621680099936"><span id="local-6989586621680099937"><span id="local-6989586621680099938"><span class="annot"><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier hs-type">nextEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099938"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099938"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099937"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099936"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099935"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099934"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099938"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-591"></span><span id="nextEdge"><span class="annot"><span class="annottext">nextEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier hs-var hs-var">nextEdge</span></a></span></span><span> </span><span id="local-6989586621680099933"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099933"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.nextEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099933"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-comment">-- | Get the previous edge along the face</span><span>
</span><span id="line-594"></span><span class="hs-comment">--</span><span>
</span><span id="line-595"></span><span class="hs-comment">--</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- &gt;&gt;&gt; prevEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- Dart (Arc 0) -1</span><span>
</span><span id="line-600"></span><span id="local-6989586621680099927"><span id="local-6989586621680099928"><span id="local-6989586621680099929"><span id="local-6989586621680099930"><span id="local-6989586621680099931"><span class="annot"><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier hs-type">prevEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099930"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099929"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099928"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099927"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099931"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-601"></span><span id="prevEdge"><span class="annot"><span class="annottext">prevEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier hs-var hs-var">prevEdge</span></a></span></span><span> </span><span id="local-6989586621680099926"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099926"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.prevEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099926"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-comment">-- | The darts bounding this face. The darts are reported in order</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- along the face. This means that for internal faces the darts are</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- reported in *clockwise* order along the boundary, whereas for the</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- outer face the darts are reported in counter clockwise order.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-610"></span><span class="hs-comment">--</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- &gt;&gt;&gt; boundary (FaceId $ VertexId 2) smallG -- around face B</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- [Dart (Arc 2) +1,Dart (Arc 3) -1,Dart (Arc 1) -1]</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- &gt;&gt;&gt; boundary (FaceId $ VertexId 0) smallG -- around outer face</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- [Dart (Arc 0) +1,Dart (Arc 4) -1,Dart (Arc 3) +1,Dart (Arc 2) -1]</span><span>
</span><span id="line-615"></span><span class="hs-comment">--</span><span>
</span><span id="line-616"></span><span id="local-6989586621680099920"><span id="local-6989586621680099921"><span id="local-6989586621680099922"><span id="local-6989586621680099923"><span id="local-6989586621680099924"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier hs-type">boundary</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099923"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099922"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099921"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099920"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099924"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-617"></span><span id="boundary"><span class="annot"><span class="annottext">boundary :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier hs-var hs-var">boundary</span></a></span></span><span> </span><span id="local-6989586621680099919"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621680099919"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.boundary</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099919"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-comment">-- | Given a dart d, generates the darts bounding the face that is to</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- the right of the given dart. The darts are reported in order along</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- the face. This means that for internal faces the darts are reported</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- in *clockwise* order along the boundary, whereas for the outer face</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- the darts are reported in counter clockwise order.</span><span>
</span><span id="line-624"></span><span class="hs-comment">--</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the number of darts reported</span><span>
</span><span id="line-626"></span><span class="hs-comment">--</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- &gt;&gt;&gt; boundary' (dart 2 &quot;+1&quot;) smallG -- around face B</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- [Dart (Arc 2) +1,Dart (Arc 3) -1,Dart (Arc 1) -1]</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- &gt;&gt;&gt; boundary' (dart 0 &quot;+1&quot;) smallG -- around outer face</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- [Dart (Arc 0) +1,Dart (Arc 4) -1,Dart (Arc 3) +1,Dart (Arc 2) -1]</span><span>
</span><span id="line-631"></span><span class="hs-comment">--</span><span>
</span><span id="line-632"></span><span id="local-6989586621680099913"><span id="local-6989586621680099914"><span id="local-6989586621680099915"><span id="local-6989586621680099916"><span id="local-6989586621680099917"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier hs-type">boundary'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099916"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099915"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099914"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099913"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099917"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-633"></span><span id="boundary%27"><span class="annot"><span class="annottext">boundary' :: Dart s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier hs-var hs-var">boundary'</span></a></span></span><span> </span><span id="local-6989586621680099912"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099912"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.boundary'</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099912"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- | Gets a dart bounding this face. I.e. a dart d such that the face lies to</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- the right of the dart.</span><span>
</span><span id="line-637"></span><span id="local-6989586621680099906"><span id="local-6989586621680099907"><span id="local-6989586621680099908"><span id="local-6989586621680099909"><span id="local-6989586621680099910"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-type">boundaryDart</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099909"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099908"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099907"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099910"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-638"></span><span id="boundaryDart"><span class="annot"><span class="annottext">boundaryDart :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-var hs-var">boundaryDart</span></a></span></span><span> </span><span id="local-6989586621680099905"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621680099905"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.boundaryDart</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | The vertices bounding this face, for internal faces in clockwise order, for</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- the outer face in counter clockwise order.</span><span>
</span><span id="line-642"></span><span class="hs-comment">--</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-644"></span><span class="hs-comment">--</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- &gt;&gt;&gt; boundaryVertices (FaceId $ VertexId 2) smallG -- around B</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- [VertexId 0,VertexId 3,VertexId 1]</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- &gt;&gt;&gt; boundaryVertices (FaceId $ VertexId 0) smallG -- around outerface</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- [VertexId 0,VertexId 2,VertexId 1,VertexId 3]</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ boundaryVertices (FaceId $ VertexId 0) myPlaneGraph</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- VertexId 0</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- VertexId 9</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- VertexId 10</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- VertexId 11</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- VertexId 7</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- VertexId 8</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- VertexId 12</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- VertexId 13</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- VertexId 4</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- VertexId 3</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- VertexId 2</span><span>
</span><span id="line-661"></span><span id="local-6989586621680100562"><span id="local-6989586621680100563"><span id="local-6989586621680100564"><span id="local-6989586621680100565"><span id="local-6989586621680100566"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-type">boundaryVertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100565"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100564"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100563"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100562"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-662"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100566"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-663"></span><span id="boundaryVertices"><span class="annot"><span class="annottext">boundaryVertices :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-var hs-var">boundaryVertices</span></a></span></span><span> </span><span id="local-6989586621680099903"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621680099903"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.boundaryVertices</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099903"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- * Access data</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="hs-comment">-- | Lens to access the vertex data</span><span>
</span><span id="line-671"></span><span class="hs-comment">--</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- Note that using the setting part of this lens may be very</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- expensive!!  (O(n))</span><span>
</span><span id="line-674"></span><span id="local-6989586621680100772"><span id="local-6989586621680100773"><span id="local-6989586621680100774"><span id="local-6989586621680100775"><span id="local-6989586621680100776"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-type">vertexDataOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100776"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100776"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100775"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100774"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100773"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100772"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100772"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100775"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-675"></span><span id="vertexDataOf"><span class="annot"><span class="annottext">vertexDataOf :: VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var hs-var">vertexDataOf</span></a></span></span><span> </span><span id="local-6989586621680099901"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099901"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((VertexData r v -&gt; f (VertexData r v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (VertexData r v -&gt; f (VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">PG.dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099901"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | Get the location of a vertex in the plane graph</span><span>
</span><span id="line-678"></span><span class="hs-comment">--</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- Note that the setting part of this lens may be very expensive!</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- Moreover, use with care (as this may destroy planarity etc.)</span><span>
</span><span id="line-681"></span><span id="local-6989586621680099896"><span id="local-6989586621680099897"><span id="local-6989586621680099898"><span id="local-6989586621680099899"><span id="local-6989586621680099900"><span class="annot"><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier hs-type">locationOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099900"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099900"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099899"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099898"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099897"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099896"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680099896"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-682"></span><span id="locationOf"><span class="annot"><span class="annottext">locationOf :: VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier hs-var hs-var">locationOf</span></a></span></span><span> </span><span id="local-6989586621680099895"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099895"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099895"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((Point 2 r -&gt; f (Point 2 r))
    -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (Point 2 r -&gt; f (Point 2 r))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; f (Point 2 r))
-&gt; VertexData r v -&gt; f (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span id="local-6989586621680099890"><span id="local-6989586621680099891"><span id="local-6989586621680099892"><span id="local-6989586621680099893"><span id="local-6989586621680099894"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099894"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099893"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099892"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099890"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099894"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099894"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099893"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099892"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099890"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099894"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680099893"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-687"></span><span>  </span><span id="local-6989586621680099887"><span class="annot"><span class="annottext">dataOf :: VertexId' s
-&gt; Lens'
     (PlaneGraph s v e f r)
     (DataOf (PlaneGraph s v e f r) (VertexId' s))
</span><a href="#local-6989586621680099887"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680099886"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099886"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((v -&gt; f v)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (v -&gt; f v)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099886"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; ((v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (v -&gt; f v)
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v)
forall r v v. Lens (VertexData r v) (VertexData r v) v v
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span></span></span></span></span></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span id="local-6989586621680099881"><span id="local-6989586621680099882"><span id="local-6989586621680099883"><span id="local-6989586621680099884"><span id="local-6989586621680099885"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099885"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099884"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099882"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099881"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099885"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099885"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099884"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099882"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099881"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099885"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680099883"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-691"></span><span>  </span><span id="local-6989586621680099879"><span class="annot"><span class="annottext">dataOf :: Dart s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (Dart s))
</span><a href="#local-6989586621680099879"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680099878"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099878"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((e -&gt; f e)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (e -&gt; f e)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099878"><span class="hs-identifier hs-var">d</span></a></span></span></span></span></span></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span id="local-6989586621680099873"><span id="local-6989586621680099874"><span id="local-6989586621680099875"><span id="local-6989586621680099876"><span id="local-6989586621680099877"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099876"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099875"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099874"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099873"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099877"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099876"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099875"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099874"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099873"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099877"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680099874"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-695"></span><span>  </span><span id="local-6989586621680099871"><span class="annot"><span class="annottext">dataOf :: FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
</span><a href="#local-6989586621680099871"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621680099870"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621680099870"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((f -&gt; f f)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (f -&gt; f f)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099870"><span class="hs-identifier hs-var">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span>
</span><span id="line-698"></span><span class="hs-comment">-- | Traverse the vertices</span><span>
</span><span id="line-699"></span><span class="hs-comment">--</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- (^.vertexData) &lt;$&gt; traverseVertices (\i x -&gt; Just (i,x)) smallG</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- Just [(VertexId 0,0),(VertexId 1,1),(VertexId 2,2),(VertexId 3,3)]</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseVertices (\i x -&gt; print (i,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- (VertexId 0,0)</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- (VertexId 1,1)</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- (VertexId 2,2)</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- (VertexId 3,3)</span><span>
</span><span id="line-707"></span><span id="local-6989586621680099863"><span id="local-6989586621680099864"><span id="local-6989586621680099865"><span id="local-6989586621680099866"><span id="local-6989586621680099867"><span id="local-6989586621680099868"><span id="local-6989586621680099869"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier hs-type">traverseVertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680099869"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-708"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099868"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099867"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099869"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099866"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099868"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099867"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099865"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099864"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099863"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-710"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099869"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099868"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099866"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099865"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099864"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099863"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-711"></span><span id="traverseVertices"><span class="annot"><span class="annottext">traverseVertices :: (VertexId' s -&gt; v -&gt; m v')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r)
</span><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier hs-var hs-var">traverseVertices</span></a></span></span><span> </span><span id="local-6989586621680099862"><span class="annot"><span class="annottext">f :: VertexId' s -&gt; v -&gt; m v'
</span><a href="#local-6989586621680099862"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Indexed Int v (m v')
 -&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r))
-&gt; (Int -&gt; v -&gt; m v')
-&gt; PlaneGraph s v e f r
-&gt; m (PlaneGraph s v' e f r)
forall i a (f :: * -&gt; *) b s t.
(Indexed i a (f b) -&gt; s -&gt; f t) -&gt; (i -&gt; a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">itraverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Vector v -&gt; m (Vector v'))
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">vertexData</span></a></span><span class="annot"><span class="annottext">((Vector v -&gt; m (Vector v'))
 -&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r))
-&gt; (Indexed Int v (m v') -&gt; Vector v -&gt; m (Vector v'))
-&gt; Indexed Int v (m v')
-&gt; PlaneGraph s v e f r
-&gt; m (PlaneGraph s v' e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Indexed Int v (m v') -&gt; Vector v -&gt; m (Vector v')
forall i (t :: * -&gt; *) a b.
TraversableWithIndex i t =&gt;
IndexedTraversal i (t a) (t b) a b
</span><span class="hs-identifier hs-var">itraversed</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; m v'
</span><a href="#local-6989586621680099862"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; v -&gt; m v')
-&gt; (Int -&gt; VertexId' s) -&gt; Int -&gt; v -&gt; m v'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">-- | Traverses the darts</span><span>
</span><span id="line-714"></span><span class="hs-comment">--</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseDarts (\d x -&gt; print (d,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- (Dart (Arc 0) +1,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- (Dart (Arc 0) -1,&quot;2-&gt;0&quot;)</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- (Dart (Arc 1) +1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- (Dart (Arc 1) -1,&quot;1-&gt;0&quot;)</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- (Dart (Arc 2) +1,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- (Dart (Arc 2) -1,&quot;3-&gt;0&quot;)</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- (Dart (Arc 3) +1,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- (Dart (Arc 3) -1,&quot;3-&gt;1&quot;)</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- (Dart (Arc 4) +1,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- (Dart (Arc 4) -1,&quot;2-&gt;1&quot;)</span><span>
</span><span id="line-726"></span><span id="local-6989586621680099852"><span id="local-6989586621680099853"><span id="local-6989586621680099854"><span id="local-6989586621680099855"><span id="local-6989586621680099856"><span id="local-6989586621680099857"><span id="local-6989586621680099858"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier hs-type">traverseDarts</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680099858"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-727"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099857"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099856"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099858"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099855"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099857"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099854"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099856"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099853"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099852"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-729"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099858"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099857"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099854"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099855"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099853"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099852"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-730"></span><span id="traverseDarts"><span class="annot"><span class="annottext">traverseDarts :: (Dart s -&gt; e -&gt; m e')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier hs-var hs-var">traverseDarts</span></a></span></span><span> </span><span id="local-6989586621680099851"><span class="annot"><span class="annottext">f :: Dart s -&gt; e -&gt; m e'
</span><a href="#local-6989586621680099851"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e' f)
-&gt; LensLike
     m
     (PlaneGraph s v e f r)
     (PlaneGraph s v e' f r)
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (PlanarGraph s 'Primal (VertexData r v) e' f)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s -&gt; e -&gt; m e')
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; m (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (m :: * -&gt; *) (s :: k) e e' (w :: World) v f.
Applicative m =&gt;
(Dart s -&gt; e -&gt; m e')
-&gt; PlanarGraph s w v e f -&gt; m (PlanarGraph s w v e' f)
</span><span class="hs-identifier hs-var">PG.traverseDarts</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; m e'
</span><a href="#local-6989586621680099851"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- | Traverses the faces</span><span>
</span><span id="line-734"></span><span class="hs-comment">--</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseFaces (\i x -&gt; print (i,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- (FaceId 0,&quot;OuterFace&quot;)</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- (FaceId 1,&quot;A&quot;)</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- (FaceId 2,&quot;B&quot;)</span><span>
</span><span id="line-739"></span><span id="local-6989586621680099842"><span id="local-6989586621680099843"><span id="local-6989586621680099844"><span id="local-6989586621680099845"><span id="local-6989586621680099846"><span id="local-6989586621680099847"><span id="local-6989586621680099848"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier hs-type">traverseFaces</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621680099848"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-740"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099847"><span class="hs-identifier hs-type">s</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099846"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099848"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099845"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099847"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099844"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099843"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099846"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099842"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-742"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099848"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099847"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099844"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099843"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099845"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099842"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-743"></span><span id="traverseFaces"><span class="annot"><span class="annottext">traverseFaces :: (FaceId' s -&gt; f -&gt; m f')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v e f' r)
</span><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier hs-var hs-var">traverseFaces</span></a></span></span><span> </span><span id="local-6989586621680099841"><span class="annot"><span class="annottext">f :: FaceId' s -&gt; f -&gt; m f'
</span><a href="#local-6989586621680099841"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f')
-&gt; LensLike
     m
     (PlaneGraph s v e f r)
     (PlaneGraph s v e f' r)
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (PlanarGraph s 'Primal (VertexData r v) e f')
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f')
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FaceId' s -&gt; f -&gt; m f')
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; m (PlanarGraph s 'Primal (VertexData r v) e f')
forall k (m :: * -&gt; *) (s :: k) (w :: World) f f' v e.
Applicative m =&gt;
(FaceId s w -&gt; f -&gt; m f')
-&gt; PlanarGraph s w v e f -&gt; m (PlanarGraph s w v e f')
</span><span class="hs-identifier hs-var">PG.traverseFaces</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; m f'
</span><a href="#local-6989586621680099841"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-comment">-- | Getter for the data at the endpoints of a dart</span><span>
</span><span id="line-747"></span><span class="hs-comment">--</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-749"></span><span id="local-6989586621680100586"><span id="local-6989586621680100587"><span id="local-6989586621680100588"><span id="local-6989586621680100589"><span id="local-6989586621680100590"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-type">endPointsOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100590"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100590"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100589"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100588"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100587"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100586"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100586"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100589"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100586"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100589"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-751"></span><span id="endPointsOf"><span class="annot"><span class="annottext">endPointsOf :: Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var hs-var">endPointsOf</span></a></span></span><span> </span><span id="local-6989586621680099839"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099839"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; (((VertexData r v, VertexData r v)
     -&gt; f (VertexData r v, VertexData r v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; ((VertexData r v, VertexData r v)
    -&gt; f (VertexData r v, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (VertexData r v, VertexData r v)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; Getter (PlanarGraph s w v e f) (v, v)
</span><span class="hs-identifier hs-var">PG.endPointDataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099839"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span class="hs-comment">-- | Data corresponding to the endpoints of the dart</span><span>
</span><span id="line-754"></span><span class="hs-comment">--</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-756"></span><span id="local-6989586621680100450"><span id="local-6989586621680100451"><span id="local-6989586621680100452"><span id="local-6989586621680100453"><span id="local-6989586621680100454"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-type">endPointData</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100454"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100454"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100453"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100452"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100451"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100450"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-757"></span><span>               </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100450"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100453"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100450"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100453"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-758"></span><span id="endPointData"><span class="annot"><span class="annottext">endPointData :: Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-var hs-var">endPointData</span></a></span></span><span> </span><span id="local-6989586621680099837"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099837"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; (VertexData r v, VertexData r v)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; (v, v)
</span><span class="hs-identifier hs-var">PG.endPointData</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099837"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; (VertexData r v, VertexData r v))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; (VertexData r v, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span class="hs-comment">-- | gets the id of the outer face</span><span>
</span><span id="line-763"></span><span class="hs-comment">--</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-765"></span><span class="hs-comment">--</span><span>
</span><span id="line-766"></span><span id="local-6989586621680101015"><span id="local-6989586621680101016"><span id="local-6989586621680101017"><span id="local-6989586621680101018"><span id="local-6989586621680101019"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-type">outerFaceId</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680101019"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680101019"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101018"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101017"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101016"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101015"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680101019"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680101018"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-767"></span><span id="outerFaceId"><span class="annot"><span class="annottext">outerFaceId :: PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var hs-var">outerFaceId</span></a></span></span><span> </span><span id="local-6989586621680099835"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099835"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Dart s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-var">outerFaceDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099835"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099835"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="hs-comment">-- | gets a dart incident to the outer face (in particular, that has the</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- outerface on its left)</span><span>
</span><span id="line-772"></span><span class="hs-comment">--</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-774"></span><span class="hs-comment">--</span><span>
</span><span id="line-775"></span><span id="local-6989586621680100639"><span id="local-6989586621680100640"><span id="local-6989586621680100641"><span id="local-6989586621680100642"><span id="local-6989586621680100643"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-type">outerFaceDart</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100643"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680100643"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100641"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100640"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100639"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100643"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100642"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-776"></span><span id="outerFaceDart"><span class="annot"><span class="annottext">outerFaceDart :: PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-var hs-var">outerFaceDart</span></a></span></span><span> </span><span id="local-6989586621680099834"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099834"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099833"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-777"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680099832"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621680099832"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v)
 -&gt; (VertexId' s, VertexData r v) -&gt; Ordering)
-&gt; Vector (VertexId' s, VertexData r v)
-&gt; (VertexId' s, VertexData r v)
forall a. (a -&gt; a -&gt; Ordering) -&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v) -&gt; Point 2 r)
-&gt; (VertexId' s, VertexData r v)
-&gt; (VertexId' s, VertexData r v)
-&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VertexId' s, VertexData r v)
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; (VertexId' s, VertexData r v)
-&gt; Const (Point 2 r) (VertexId' s, VertexData r v)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
 -&gt; (VertexId' s, VertexData r v)
 -&gt; Const (Point 2 r) (VertexId' s, VertexData r v))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s, VertexData r v)
 -&gt; (VertexId' s, VertexData r v))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; (VertexId' s, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r -&gt; (VertexId' s, VertexData r v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099834"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-779"></span><span>           </span><span class="hs-comment">-- compare lexicographically; i.e. if same x-coord prefer the one with the</span><span>
</span><span id="line-780"></span><span>           </span><span class="hs-comment">-- smallest y-coord</span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621680099833"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099833"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Dart s :+ Line 2 r) -&gt; (Dart s :+ Line 2 r) -&gt; Ordering)
-&gt; Vector (Dart s :+ Line 2 r) -&gt; Dart s :+ Line 2 r
forall a. (a -&gt; a -&gt; Ordering) -&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Line 2 r -&gt; Line 2 r -&gt; Ordering
forall r. (Num r, Ord r) =&gt; Line 2 r -&gt; Line 2 r -&gt; Ordering
</span><a href="Data.Geometry.Line.Internal.html#cmpSlope"><span class="hs-identifier hs-var">cmpSlope</span></a></span><span> </span><span class="annot"><span class="annottext">(Line 2 r -&gt; Line 2 r -&gt; Ordering)
-&gt; ((Dart s :+ Line 2 r) -&gt; Line 2 r)
-&gt; (Dart s :+ Line 2 r)
-&gt; (Dart s :+ Line 2 r)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s :+ Line 2 r)
-&gt; Getting (Line 2 r) (Dart s :+ Line 2 r) (Line 2 r) -&gt; Line 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Line 2 r) (Dart s :+ Line 2 r) (Line 2 r)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>           </span><span class="annot"><span class="annottext">(Vector (Dart s :+ Line 2 r) -&gt; Dart s :+ Line 2 r)
-&gt; (Vector (Dart s) -&gt; Vector (Dart s :+ Line 2 r))
-&gt; Vector (Dart s)
-&gt; Dart s :+ Line 2 r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s :+ Line 2 r)
-&gt; Vector (Dart s) -&gt; Vector (Dart s :+ Line 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680099829"><span class="annot"><span class="annottext">d' :: Dart s
</span><a href="#local-6989586621680099829"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099829"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Line 2 r -&gt; Dart s :+ Line 2 r
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-var">edgeSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099829"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099834"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 v r :+ e)
-&gt; Getting (Line 2 r) (LineSegment 2 v r :+ e) (Line 2 r)
-&gt; Line 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
-&gt; (LineSegment 2 v r :+ e)
-&gt; Const (Line 2 r) (LineSegment 2 v r :+ e)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="annot"><span class="annottext">((LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
 -&gt; (LineSegment 2 v r :+ e)
 -&gt; Const (Line 2 r) (LineSegment 2 v r :+ e))
-&gt; ((Line 2 r -&gt; Const (Line 2 r) (Line 2 r))
    -&gt; LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
-&gt; Getting (Line 2 r) (LineSegment 2 v r :+ e) (Line 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(LineSegment 2 v r -&gt; Line 2 r)
-&gt; (Line 2 r -&gt; Const (Line 2 r) (Line 2 r))
-&gt; LineSegment 2 v r
-&gt; Const (Line 2 r) (LineSegment 2 v r)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; Line 2 r
forall t.
HasSupportingLine t =&gt;
t -&gt; Line (Dimension t) (NumType t)
</span><a href="Data.Geometry.Line.Internal.html#supportingLine"><span class="hs-identifier hs-var">supportingLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>           </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Dart s :+ Line 2 r)
-&gt; Vector (Dart s) -&gt; Dart s :+ Line 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099832"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099834"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-comment">-- based on the approach sketched at https://cstheory.stackexchange.com/questions/27586/finding-outer-face-in-plane-graph-embedded-planar-graph</span><span>
</span><span id="line-785"></span><span>    </span><span class="hs-comment">-- basically: find the leftmost vertex, find the incident edge with the largest slope</span><span>
</span><span id="line-786"></span><span>    </span><span class="hs-comment">-- and take the face left of that edge. This is the outerface.</span><span>
</span><span id="line-787"></span><span>    </span><span class="hs-comment">-- note that this requires that the edges are straight line segments</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- * Reporting Geometries</span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- | Reports all edges as line segments</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edgeSegments smallG</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- (Dart (Arc 0) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 2 0 :+ 2) :+ &quot;0-&gt;2&quot;)</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- (Dart (Arc 1) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 2 2 :+ 1) :+ &quot;0-&gt;1&quot;)</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- (Dart (Arc 2) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 (-1) 4 :+ 3) :+ &quot;0-&gt;3&quot;)</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- (Dart (Arc 4) +1,ClosedLineSegment (Point2 2 2 :+ 1) (Point2 2 0 :+ 2) :+ &quot;1-&gt;2&quot;)</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- (Dart (Arc 3) +1,ClosedLineSegment (Point2 2 2 :+ 1) (Point2 (-1) 4 :+ 3) :+ &quot;1-&gt;3&quot;)</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edgeSegments myPlaneGraph</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- (Dart (Arc 0) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 8 (-5) :+ 9) :+ ())</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- (Dart (Arc 1) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 8 1 :+ 5) :+ ())</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- (Dart (Arc 2) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 4 4 :+ 1) :+ ())</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- (Dart (Arc 3) +1,ClosedLineSegment (Point2 0 0 :+ 0) (Point2 3 7 :+ 2) :+ ())</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- (Dart (Arc 4) +1,ClosedLineSegment (Point2 4 4 :+ 1) (Point2 8 1 :+ 5) :+ ())</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- (Dart (Arc 15) +1,ClosedLineSegment (Point2 4 4 :+ 1) (Point2 10 4 :+ 12) :+ ())</span><span>
</span><span id="line-808"></span><span class="hs-comment">-- (Dart (Arc 5) +1,ClosedLineSegment (Point2 3 7 :+ 2) (Point2 0 5 :+ 3) :+ ())</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- (Dart (Arc 6) +1,ClosedLineSegment (Point2 0 5 :+ 3) (Point2 3 8 :+ 4) :+ ())</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- (Dart (Arc 18) +1,ClosedLineSegment (Point2 3 8 :+ 4) (Point2 9 6 :+ 13) :+ ())</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- (Dart (Arc 7) +1,ClosedLineSegment (Point2 8 1 :+ 5) (Point2 6 (-1) :+ 6) :+ ())</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- (Dart (Arc 10) +1,ClosedLineSegment (Point2 8 1 :+ 5) (Point2 12 1 :+ 8) :+ ())</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- (Dart (Arc 12) +1,ClosedLineSegment (Point2 6 (-1) :+ 6) (Point2 8 (-5) :+ 9) :+ ())</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- (Dart (Arc 8) +1,ClosedLineSegment (Point2 9 (-1) :+ 7) (Point2 12 1 :+ 8) :+ ())</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- (Dart (Arc 14) +1,ClosedLineSegment (Point2 9 (-1) :+ 7) (Point2 14 (-1) :+ 11) :+ ())</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- (Dart (Arc 9) +1,ClosedLineSegment (Point2 12 1 :+ 8) (Point2 10 4 :+ 12) :+ ())</span><span>
</span><span id="line-817"></span><span class="hs-comment">-- (Dart (Arc 11) +1,ClosedLineSegment (Point2 8 (-5) :+ 9) (Point2 12 (-3) :+ 10) :+ ())</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- (Dart (Arc 13) +1,ClosedLineSegment (Point2 12 (-3) :+ 10) (Point2 14 (-1) :+ 11) :+ ())</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- (Dart (Arc 16) +1,ClosedLineSegment (Point2 10 4 :+ 12) (Point2 9 6 :+ 13) :+ ())</span><span>
</span><span id="line-820"></span><span class="hs-comment">-- (Dart (Arc 17) +1,ClosedLineSegment (Point2 10 4 :+ 12) (Point2 8 5 :+ 14) :+ ())</span><span>
</span><span id="line-821"></span><span class="hs-comment">-- (Dart (Arc 19) +1,ClosedLineSegment (Point2 9 6 :+ 13) (Point2 8 5 :+ 14) :+ ())</span><span>
</span><span id="line-822"></span><span id="local-6989586621680099823"><span id="local-6989586621680099824"><span id="local-6989586621680099825"><span id="local-6989586621680099826"><span id="local-6989586621680099827"><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier hs-type">edgeSegments</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099827"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099826"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099825"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099824"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099823"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680099827"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680099826"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099823"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099825"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-823"></span><span id="edgeSegments"><span class="annot"><span class="annottext">edgeSegments :: PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
</span><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier hs-var hs-var">edgeSegments</span></a></span></span><span> </span><span id="local-6989586621680099822"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099822"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e))
-&gt; Vector (Dart s, e) -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e)
</span><a href="#local-6989586621680099821"><span class="hs-identifier hs-var">withSegment</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; Vector (Dart s, LineSegment 2 v r :+ e))
-&gt; (PlaneGraph s v e f r -&gt; Vector (Dart s, e))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (Dart s, e)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e))
-&gt; PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099822"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-824"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-825"></span><span>    </span><span id="local-6989586621680099821"><span class="annot"><span class="annottext">withSegment :: (Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e)
</span><a href="#local-6989586621680099821"><span class="hs-identifier hs-var hs-var">withSegment</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680099820"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099820"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680099819"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621680099819"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680099818"><span class="annot"><span class="annottext">p :: Point 2 r :+ v
</span><a href="#local-6989586621680099818"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680099817"><span class="annot"><span class="annottext">q :: Point 2 r :+ v
</span><a href="#local-6989586621680099817"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span>
</span><span id="line-826"></span><span>                                  </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v)
 -&gt; (Point 2 r :+ v, Point 2 r :+ v))
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099822"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (VertexData r v, VertexData r v)
     (PlaneGraph s v e f r)
     (VertexData r v, VertexData r v)
-&gt; (VertexData r v, VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099820"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-827"></span><span>                            </span><span id="local-6989586621680099816"><span class="annot"><span class="annottext">seg :: LineSegment 2 v r
</span><a href="#local-6989586621680099816"><span class="hs-identifier hs-var hs-var">seg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; (Point 2 r :+ v) -&gt; LineSegment 2 v r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680099818"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680099817"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-828"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099820"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r
</span><a href="#local-6989586621680099816"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; e -&gt; LineSegment 2 v r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680099819"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span class="hs-comment">-- | Given a dart and the graph constructs the line segment representing the</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- dart. The segment \(\overline{uv})\) is has \(u\) as its tail and \(v\) as</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- its head.</span><span>
</span><span id="line-833"></span><span class="hs-comment">--</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- \(O(1)\)</span><span>
</span><span id="line-835"></span><span id="local-6989586621680100619"><span id="local-6989586621680100620"><span id="local-6989586621680100621"><span id="local-6989586621680100622"><span id="local-6989586621680100623"><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-type">edgeSegment</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621680100623"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100623"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100622"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100621"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100620"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100619"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680100622"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100619"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100621"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span></span><span>
</span><span id="line-836"></span><span id="edgeSegment"><span class="annot"><span class="annottext">edgeSegment :: Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-var hs-var">edgeSegment</span></a></span></span><span> </span><span id="local-6989586621680099814"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099814"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680099813"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099813"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r
</span><a href="#local-6989586621680099812"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; e -&gt; LineSegment 2 v r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099813"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting e (PlaneGraph s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099814"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-838"></span><span>    </span><span id="local-6989586621680099812"><span class="annot"><span class="annottext">seg :: LineSegment 2 v r
</span><a href="#local-6989586621680099812"><span class="hs-identifier hs-var hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680099811"><span class="annot"><span class="annottext">p :: Point 2 r :+ v
</span><a href="#local-6989586621680099811"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680099810"><span class="annot"><span class="annottext">q :: Point 2 r :+ v
</span><a href="#local-6989586621680099810"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v)
 -&gt; (Point 2 r :+ v, Point 2 r :+ v))
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099813"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (VertexData r v, VertexData r v)
     (PlaneGraph s v e f r)
     (VertexData r v, VertexData r v)
-&gt; (VertexData r v, VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099814"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-839"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; (Point 2 r :+ v) -&gt; LineSegment 2 v r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680099811"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621680099810"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- | The boundary of the face as a simple polygon. For internal faces</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- the polygon that is reported has its vertices stored in CCW order</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- (as expected).</span><span>
</span><span id="line-845"></span><span class="hs-comment">--</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- pre: FaceId refers to an internal face.</span><span>
</span><span id="line-847"></span><span class="hs-comment">--</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- For the other face this prodcuces a polygon in CW order (this may</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- lead to unexpected results.)</span><span>
</span><span id="line-850"></span><span class="hs-comment">--</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- runningtime: \(O(k)\), where \(k\) is the size of the face.</span><span>
</span><span id="line-852"></span><span id="local-6989586621680100550"><span id="local-6989586621680100551"><span id="local-6989586621680100552"><span id="local-6989586621680100553"><span id="local-6989586621680100554"><span class="annot"><a href="Data.PlaneGraph.Core.html#faceBoundary"><span class="hs-identifier hs-type">faceBoundary</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100552"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100551"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100550"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100550"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100551"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-853"></span><span id="faceBoundary"><span class="annot"><span class="annottext">faceBoundary :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#faceBoundary"><span class="hs-identifier hs-var hs-var">faceBoundary</span></a></span></span><span> </span><span id="local-6989586621680099809"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680099809"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680099808"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099808"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r
</span><a href="#local-6989586621680099807"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r -&gt; f -&gt; SimplePolygon v r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099808"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099809"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-855"></span><span>    </span><span id="local-6989586621680099807"><span class="annot"><span class="annottext">pg :: SimplePolygon v r
</span><a href="#local-6989586621680099807"><span class="hs-identifier hs-var hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Point 2 r :+ v) -&gt; SimplePolygon v r
forall r p. Vector (Point 2 r :+ p) -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Point 2 r :+ v) -&gt; SimplePolygon v r)
-&gt; (PlaneGraph s v e f r -&gt; Vector (Point 2 r :+ v))
-&gt; PlaneGraph s v e f r
-&gt; SimplePolygon v r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point 2 r :+ v) -&gt; Vector (Point 2 r :+ v)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point 2 r :+ v) -&gt; Vector (Point 2 r :+ v))
-&gt; (PlaneGraph s v e f r -&gt; Vector (Point 2 r :+ v))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Point 2 r :+ v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; Point 2 r :+ v)
-&gt; Vector (VertexId' s) -&gt; Vector (Point 2 r :+ v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680099804"><span class="annot"><span class="annottext">j :: VertexId' s
</span><a href="#local-6989586621680099804"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099808"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting (Point 2 r :+ v) (PlaneGraph s v e f r) (Point 2 r :+ v)
-&gt; Point 2 r :+ v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r
-&gt; Const (Point 2 r :+ v) (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Const
       (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r
 -&gt; Const (Point 2 r :+ v) (PlaneGraph s v e f r))
-&gt; (((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Const
         (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; Getting (Point 2 r :+ v) (PlaneGraph s v e f r) (Point 2 r :+ v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621680099804"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r :+ v) (VertexData r v))
 -&gt; PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
    -&gt; VertexData r v -&gt; Const (Point 2 r :+ v) (VertexData r v))
-&gt; ((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Const
     (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; ((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
-&gt; VertexData r v
-&gt; Const (Point 2 r :+ v) (VertexData r v)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>       </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; Vector (Point 2 r :+ v))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Point 2 r :+ v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-var">boundaryVertices</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099809"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; SimplePolygon v r)
-&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099808"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-comment">-- polygons are stored in CCW order, the boundaryVertices of</span><span>
</span><span id="line-858"></span><span>    </span><span class="hs-comment">-- internal faces are reported in CW order we reverse them.</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span class="hs-comment">-- | The boundary of the face as a simple polygon. For internal faces</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- the polygon that is reported has its vertices stored in CCW order</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- (as expected).</span><span>
</span><span id="line-865"></span><span class="hs-comment">--</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- pre: FaceId refers to an internal face.</span><span>
</span><span id="line-867"></span><span class="hs-comment">--</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- For the other face this prodcuces a polygon in CW order (this may</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- lead to unexpected results.)</span><span>
</span><span id="line-870"></span><span class="hs-comment">--</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- runningtime: \(O(k)\), where \(k\) is the size of the face.</span><span>
</span><span id="line-872"></span><span id="local-6989586621680099799"><span id="local-6989586621680099800"><span id="local-6989586621680099801"><span id="local-6989586621680099802"><span id="local-6989586621680099803"><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFacePolygon"><span class="hs-identifier hs-type">internalFacePolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099803"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099803"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099802"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099801"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099799"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099802"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099799"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099800"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-873"></span><span id="internalFacePolygon"><span class="annot"><span class="annottext">internalFacePolygon :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#internalFacePolygon"><span class="hs-identifier hs-var hs-var">internalFacePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#faceBoundary"><span class="hs-identifier hs-var">faceBoundary</span></a></span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- | Given the outerFaceId and the graph, construct a sufficiently</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- large rectangular multipolygon ith a hole containing the boundary</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- of the outer face.</span><span>
</span><span id="line-878"></span><span id="local-6989586621680100489"><span id="local-6989586621680100490"><span id="local-6989586621680100491"><span id="local-6989586621680100492"><span id="local-6989586621680100493"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFacePolygon"><span class="hs-identifier hs-type">outerFacePolygon</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680100493"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680100493"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100492"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100492"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100491"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100490"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100493"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-type">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680100491"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680100493"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100489"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-880"></span><span id="outerFacePolygon"><span class="annot"><span class="annottext">outerFacePolygon :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
</span><a href="Data.PlaneGraph.Core.html#outerFacePolygon"><span class="hs-identifier hs-var hs-var">outerFacePolygon</span></a></span></span><span> </span><span id="local-6989586621680099798"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680099798"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680099797"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099797"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-881"></span><span>    </span><span class="annot"><span class="annottext">FaceId' s
-&gt; SimplePolygon () r
-&gt; PlaneGraph s v e f r
-&gt; MultiPolygon (Either () v) r :+ f
forall k (s :: k) v' r v e f.
FaceId' s
-&gt; SimplePolygon v' r
-&gt; PlaneGraph s v e f r
-&gt; MultiPolygon (Either v' v) r :+ f
</span><a href="Data.PlaneGraph.Core.html#outerFacePolygon%27"><span class="hs-identifier hs-var">outerFacePolygon'</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099798"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon () r
</span><a href="#local-6989586621680099796"><span class="hs-identifier hs-var">outer</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099797"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">(MultiPolygon (Either () v) r :+ f)
-&gt; ((MultiPolygon (Either () v) r :+ f)
    -&gt; MultiPolygon (Maybe v) r :+ f)
-&gt; MultiPolygon (Maybe v) r :+ f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(MultiPolygon (Either () v) r
 -&gt; Identity (MultiPolygon (Maybe v) r))
-&gt; (MultiPolygon (Either () v) r :+ f)
-&gt; Identity (MultiPolygon (Maybe v) r :+ f)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span> </span><span class="annot"><span class="annottext">((MultiPolygon (Either () v) r
  -&gt; Identity (MultiPolygon (Maybe v) r))
 -&gt; (MultiPolygon (Either () v) r :+ f)
 -&gt; Identity (MultiPolygon (Maybe v) r :+ f))
-&gt; (MultiPolygon (Either () v) r -&gt; MultiPolygon (Maybe v) r)
-&gt; (MultiPolygon (Either () v) r :+ f)
-&gt; MultiPolygon (Maybe v) r :+ f
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Either () v -&gt; Maybe v)
-&gt; MultiPolygon (Either () v) r -&gt; MultiPolygon (Maybe v) r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() -&gt; Maybe v) -&gt; (v -&gt; Maybe v) -&gt; Either () v -&gt; Maybe v
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe v -&gt; () -&gt; Maybe v
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe v
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v -&gt; Maybe v
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-883"></span><span>    </span><span id="local-6989586621680099796"><span class="annot"><span class="annottext">outer :: SimplePolygon () r
</span><a href="#local-6989586621680099796"><span class="hs-identifier hs-var hs-var">outer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; SimplePolygon () r
forall p. Rectangle p r -&gt; SimplePolygon p r
</span><a href="#local-6989586621680099793"><span class="hs-identifier hs-var">rectToPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; SimplePolygon () r)
-&gt; (PlaneGraph s v e f r -&gt; Rectangle () r)
-&gt; PlaneGraph s v e f r
-&gt; SimplePolygon () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Rectangle () r -&gt; Rectangle () r
forall r (d :: Nat) p.
(Num r, Arity d) =&gt;
r -&gt; Box d p r -&gt; Box d p r
</span><a href="Data.Geometry.Box.Internal.html#grow"><span class="hs-identifier hs-var">grow</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; Rectangle () r)
-&gt; (PlaneGraph s v e f r -&gt; Rectangle () r)
-&gt; PlaneGraph s v e f r
-&gt; Rectangle () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Rectangle () r
forall g.
(IsBoxable g, Ord (NumType g)) =&gt;
g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Data.Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var">boundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; SimplePolygon () r)
-&gt; PlaneGraph s v e f r -&gt; SimplePolygon () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099797"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-884"></span><span>    </span><span id="local-6989586621680099793"><span class="annot"><span class="annottext">rectToPolygon :: Rectangle p r -&gt; SimplePolygon p r
</span><a href="#local-6989586621680099793"><span class="hs-identifier hs-var hs-var">rectToPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ p] -&gt; SimplePolygon p r
forall r p. [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#unsafeFromPoints"><span class="hs-identifier hs-var">unsafeFromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; SimplePolygon p r)
-&gt; (Rectangle p r -&gt; [Point 2 r :+ p])
-&gt; Rectangle p r
-&gt; SimplePolygon p r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ p] -&gt; [Point 2 r :+ p]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [Point 2 r :+ p])
-&gt; (Rectangle p r -&gt; [Point 2 r :+ p])
-&gt; Rectangle p r
-&gt; [Point 2 r :+ p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Corners (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Corners (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; (Rectangle p r -&gt; Corners (Point 2 r :+ p))
-&gt; Rectangle p r
-&gt; [Point 2 r :+ p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rectangle p r -&gt; Corners (Point 2 r :+ p)
forall r p. Num r =&gt; Rectangle p r -&gt; Corners (Point 2 r :+ p)
</span><a href="Data.Geometry.Box.Corners.html#corners"><span class="hs-identifier hs-var">corners</span></a></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-comment">-- | Given the outerface id, and a sufficiently large outer boundary,</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- draw the outerface as a polygon with a hole.</span><span>
</span><span id="line-888"></span><span id="local-6989586621680100536"><span id="local-6989586621680100537"><span id="local-6989586621680100538"><span id="local-6989586621680100539"><span id="local-6989586621680100540"><span id="local-6989586621680100541"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFacePolygon%27"><span class="hs-identifier hs-type">outerFacePolygon'</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100541"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100540"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100539"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-889"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100541"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100538"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100536"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100539"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-type">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621680100540"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100538"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680100539"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100536"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-890"></span><span id="outerFacePolygon%27"><span class="annot"><span class="annottext">outerFacePolygon' :: FaceId' s
-&gt; SimplePolygon v' r
-&gt; PlaneGraph s v e f r
-&gt; MultiPolygon (Either v' v) r :+ f
</span><a href="Data.PlaneGraph.Core.html#outerFacePolygon%27"><span class="hs-identifier hs-var hs-var">outerFacePolygon'</span></a></span></span><span> </span><span id="local-6989586621680099788"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680099788"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680099787"><span class="annot"><span class="annottext">outer :: SimplePolygon v' r
</span><a href="#local-6989586621680099787"><span class="hs-identifier hs-var">outer</span></a></span></span><span> </span><span id="local-6989586621680099786"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099786"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Either v' v) r
-&gt; [SimplePolygon (Either v' v) r] -&gt; MultiPolygon (Either v' v) r
forall p r.
SimplePolygon p r -&gt; [SimplePolygon p r] -&gt; MultiPolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-var">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v' -&gt; Either v' v)
-&gt; SimplePolygon v' r -&gt; SimplePolygon (Either v' v) r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">v' -&gt; Either v' v
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon v' r
</span><a href="#local-6989586621680099787"><span class="hs-identifier hs-var">outer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SimplePolygon (Either v' v) r
</span><a href="#local-6989586621680099784"><span class="hs-identifier hs-var">hole</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">MultiPolygon (Either v' v) r
-&gt; f -&gt; MultiPolygon (Either v' v) r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099786"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099788"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-891"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-892"></span><span>    </span><span id="local-6989586621680099784"><span class="annot"><span class="annottext">hole :: SimplePolygon (Either v' v) r
</span><a href="#local-6989586621680099784"><span class="hs-identifier hs-var hs-var">hole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Either v' v) r -&gt; SimplePolygon (Either v' v) r
forall (t :: PolygonType) p r. Polygon t p r -&gt; Polygon t p r
</span><a href="Data.Geometry.Polygon.Core.html#reverseOuterBoundary"><span class="hs-identifier hs-var">reverseOuterBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon (Either v' v) r -&gt; SimplePolygon (Either v' v) r)
-&gt; ((SimplePolygon v r :+ f) -&gt; SimplePolygon (Either v' v) r)
-&gt; (SimplePolygon v r :+ f)
-&gt; SimplePolygon (Either v' v) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; Either v' v)
-&gt; SimplePolygon v r -&gt; SimplePolygon (Either v' v) r
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Either v' v
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon v r -&gt; SimplePolygon (Either v' v) r)
-&gt; ((SimplePolygon v r :+ f) -&gt; SimplePolygon v r)
-&gt; (SimplePolygon v r :+ f)
-&gt; SimplePolygon (Either v' v) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (SimplePolygon v r) (SimplePolygon v r :+ f) (SimplePolygon v r)
-&gt; (SimplePolygon v r :+ f) -&gt; SimplePolygon v r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (SimplePolygon v r) (SimplePolygon v r :+ f) (SimplePolygon v r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span> </span><span class="annot"><span class="annottext">((SimplePolygon v r :+ f) -&gt; SimplePolygon (Either v' v) r)
-&gt; (SimplePolygon v r :+ f) -&gt; SimplePolygon (Either v' v) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#faceBoundary"><span class="hs-identifier hs-var">faceBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099788"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099786"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-893"></span><span>    </span><span class="hs-comment">-- if we call faceBoundary on the outerface we get a polygon in</span><span>
</span><span id="line-894"></span><span>    </span><span class="hs-comment">-- the wrong orientation. So reverse it.</span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span class="hs-comment">-- | Given the outerFace Id, construct polygons for all faces. We</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- construct a polygon with a hole for the outer face.</span><span>
</span><span id="line-900"></span><span class="hs-comment">--</span><span>
</span><span id="line-901"></span><span id="local-6989586621680099777"><span id="local-6989586621680099778"><span id="local-6989586621680099779"><span id="local-6989586621680099780"><span id="local-6989586621680099781"><span class="annot"><a href="Data.PlaneGraph.Core.html#facePolygons"><span class="hs-identifier hs-type">facePolygons</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680099781"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680099781"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099780"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099780"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099779"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099778"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099777"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099781"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-902"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099780"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#MultiPolygon"><span class="hs-identifier hs-type">MultiPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680099779"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680099781"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099777"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099780"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099779"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099781"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099777"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>                     </span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-905"></span><span id="facePolygons"><span class="annot"><span class="annottext">facePolygons :: FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; ((FaceId' s, MultiPolygon (Maybe v) r :+ f),
    Vector (FaceId' s, SimplePolygon v r :+ f))
</span><a href="Data.PlaneGraph.Core.html#facePolygons"><span class="hs-identifier hs-var hs-var">facePolygons</span></a></span></span><span> </span><span id="local-6989586621680099776"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680099776"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680099775"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099775"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099776"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
forall k r (s :: k) v e f.
(Num r, Ord r) =&gt;
FaceId' s -&gt; PlaneGraph s v e f r -&gt; MultiPolygon (Maybe v) r :+ f
</span><a href="Data.PlaneGraph.Core.html#outerFacePolygon"><span class="hs-identifier hs-var">outerFacePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099776"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099775"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall k (s :: k) v e f r.
FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
</span><a href="Data.PlaneGraph.Core.html#facePolygons%27"><span class="hs-identifier hs-var">facePolygons'</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099776"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099775"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span class="hs-comment">-- | Given the outerFace Id, lists all internal faces of the plane</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- graph with their boundaries.</span><span>
</span><span id="line-909"></span><span id="local-6989586621680100483"><span id="local-6989586621680100484"><span id="local-6989586621680100485"><span id="local-6989586621680100486"><span id="local-6989586621680100487"><span class="annot"><a href="Data.PlaneGraph.Core.html#facePolygons%27"><span class="hs-identifier hs-type">facePolygons'</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100487"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100487"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100486"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100485"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100484"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100483"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-910"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680100487"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100486"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680100483"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680100484"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-911"></span><span id="facePolygons%27"><span class="annot"><span class="annottext">facePolygons' :: FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
</span><a href="Data.PlaneGraph.Core.html#facePolygons%27"><span class="hs-identifier hs-var hs-var">facePolygons'</span></a></span></span><span> </span><span id="local-6989586621680099774"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621680099774"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680099773"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099773"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; (FaceId' s, SimplePolygon v r :+ f))
-&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680099772"><span class="annot"><span class="annottext">j :: FaceId' s
</span><a href="#local-6989586621680099772"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099772"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#internalFacePolygon"><span class="hs-identifier hs-var">internalFacePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099772"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099773"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Vector (FaceId' s, SimplePolygon v r :+ f))
-&gt; (PlaneGraph s v e f r -&gt; Vector (FaceId' s))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; Bool) -&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621680099774"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Vector (FaceId' s))
-&gt; (PlaneGraph s v e f r -&gt; Vector (FaceId' s))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (FaceId' s)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-var">faces'</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r
 -&gt; Vector (FaceId' s, SimplePolygon v r :+ f))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099773"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span class="hs-comment">-- | lists all internal faces of the plane graph with their</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- boundaries.</span><span>
</span><span id="line-916"></span><span id="local-6989586621680099767"><span id="local-6989586621680099768"><span id="local-6989586621680099769"><span id="local-6989586621680099770"><span id="local-6989586621680099771"><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFacePolygons"><span class="hs-identifier hs-type">internalFacePolygons</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680099771"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680099771"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099770"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099769"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099768"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099767"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099771"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621680099770"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099769"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099771"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099767"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-918"></span><span id="internalFacePolygons"><span class="annot"><span class="annottext">internalFacePolygons :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
</span><a href="Data.PlaneGraph.Core.html#internalFacePolygons"><span class="hs-identifier hs-var hs-var">internalFacePolygons</span></a></span></span><span> </span><span id="local-6989586621680099766"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621680099766"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall k (s :: k) v e f r.
FaceId' s
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
</span><a href="Data.PlaneGraph.Core.html#facePolygons%27"><span class="hs-identifier hs-var">facePolygons'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; FaceId' s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099766"><span class="hs-identifier hs-var">pg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621680099766"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-921"></span><span>
</span><span id="line-922"></span><span class="hs-comment">-- | Labels the edges of a plane graph with their distances, as specified by</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- the distance function.</span><span>
</span><span id="line-924"></span><span id="local-6989586621680099760"><span id="local-6989586621680099761"><span id="local-6989586621680099762"><span id="local-6989586621680099763"><span id="local-6989586621680099764"><span id="local-6989586621680099765"><span class="annot"><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier hs-type">withEdgeDistances</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680099765"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680099765"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680099764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099763"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099762"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099761"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099760"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099765"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099763"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099762"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680099764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680099761"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680099760"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680099765"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-926"></span><span id="withEdgeDistances"><span class="annot"><span class="annottext">withEdgeDistances :: (Point 2 r -&gt; Point 2 r -&gt; a)
-&gt; PlaneGraph s p e f r -&gt; PlaneGraph s p (a :+ e) f r
</span><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier hs-var hs-var">withEdgeDistances</span></a></span></span><span> </span><span id="local-6989586621680099759"><span class="annot"><span class="annottext">f :: Point 2 r -&gt; Point 2 r -&gt; a
</span><a href="#local-6989586621680099759"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680099758"><span class="annot"><span class="annottext">g :: PlaneGraph s p e f r
</span><a href="#local-6989586621680099758"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s p e f r
</span><a href="#local-6989586621680099758"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s p e f r
-&gt; (PlaneGraph s p e f r -&gt; PlaneGraph s p (a :+ e) f r)
-&gt; PlaneGraph s p (a :+ e) f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r p) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
-&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r p) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
 -&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r))
-&gt; ((Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
    -&gt; PlanarGraph s 'Primal (VertexData r p) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
-&gt; (Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
-&gt; PlaneGraph s p e f r
-&gt; Identity (PlaneGraph s p (a :+ e) f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
-&gt; PlanarGraph s 'Primal (VertexData r p) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector (Dart s, e))
  (Vector (Dart s, e'))
</span><span class="hs-identifier hs-var">PG.dartData</span></span><span> </span><span class="annot"><span class="annottext">((Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
 -&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r))
-&gt; (Vector (Dart s, e) -&gt; Vector (Dart s, a :+ e))
-&gt; PlaneGraph s p e f r
-&gt; PlaneGraph s p (a :+ e) f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">((Dart s, e) -&gt; (Dart s, a :+ e))
-&gt; Vector (Dart s, e) -&gt; Vector (Dart s, a :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680099757"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099757"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680099756"><span class="annot"><span class="annottext">x :: e
</span><a href="#local-6989586621680099756"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099757"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dart s -&gt; a
</span><a href="#local-6989586621680099755"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099757"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; e -&gt; a :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680099756"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-928"></span><span>    </span><span id="local-6989586621680099755"><span class="annot"><span class="annottext">len :: Dart s -&gt; a
</span><a href="#local-6989586621680099755"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span id="local-6989586621680099754"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621680099754"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 r -&gt; a) -&gt; (Point 2 r, Point 2 r) -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; a
</span><a href="#local-6989586621680099759"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; a)
-&gt; ((VertexData r p, VertexData r p) -&gt; (Point 2 r, Point 2 r))
-&gt; (VertexData r p, VertexData r p)
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r p, VertexData r p)
  (Point 2 r, Point 2 r)
  (VertexData r p)
  (Point 2 r)
-&gt; (VertexData r p -&gt; Point 2 r)
-&gt; (VertexData r p, VertexData r p)
-&gt; (Point 2 r, Point 2 r)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r p, VertexData r p)
  (Point 2 r, Point 2 r)
  (VertexData r p)
  (Point 2 r)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r p
-&gt; Getting (Point 2 r) (VertexData r p) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (VertexData r p) (Point 2 r)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((VertexData r p, VertexData r p) -&gt; a)
-&gt; (VertexData r p, VertexData r p) -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s p e f r -&gt; (VertexData r p, VertexData r p)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-var">endPointData</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621680099754"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s p e f r
</span><a href="#local-6989586621680099758"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-933"></span></pre></body></html>