<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE
    BangPatterns
  , CPP
  , RankNTypes
  , MagicHash
  , UnboxedTuples
  , MultiParamTypeClasses
  , FlexibleInstances
  , FlexibleContexts
  , UnliftedFFITypes
  , RoleAnnotations
 #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Module      :  Data.Array.Base</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Portability :  non-portable (MPTCs, uses Control.Monad.ST)</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Basis for IArray and MArray.  Not intended for external consumption;</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- use IArray or MArray instead.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- = WARNING</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- This module is considered __internal__.</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- The Package Versioning Policy __does not apply__.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- The contents of this module may change __in any way whatsoever__</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- and __without any warning__ between minor versions of this package.</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- Authors importing this module are expected to track development</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- closely.</span><span>
</span><span id="line-39"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.Array.Base.html"><span class="hs-identifier">Data.Array.Base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Control.Monad.ST.Lazy.html/Control.Monad.ST.Lazy.html"><span class="hs-identifier">Control.Monad.ST.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">strictToLazyST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Control.Monad.ST.Lazy.html/Control.Monad.ST.Lazy.html"><span class="hs-identifier">Control.Monad.ST.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ST</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Ix.html/Data.Ix.html"><span class="hs-identifier">Data.Ix</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Ix</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">range</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">index</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">inRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rangeSize</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Foreign.C.Types.html/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Foreign.StablePtr.html/Foreign.StablePtr.html"><span class="hs-identifier">Foreign.StablePtr</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Char.html/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Arr.html/GHC.Arr.html"><span class="hs-identifier">GHC.Arr</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">STArray</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Arr.html/GHC.Arr.html"><span class="hs-identifier">GHC.Arr</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Arr</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Arr.html/GHC.Arr.html"><span class="hs-identifier">GHC.Arr</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ArrST</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Ix.html/GHC.Ix.html"><span class="hs-identifier">GHC.Ix</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unsafeIndex</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.ST.html/GHC.ST.html"><span class="hs-identifier">GHC.ST</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Base.html/GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">divInt#</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Exts.html/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Ptr.html/GHC.Ptr.html"><span class="hs-identifier">GHC.Ptr</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">nullPtr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nullFunPtr</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Show.html/GHC.Show.html"><span class="hs-identifier">GHC.Show</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">appPrec</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Stable.html/GHC.Stable.html"><span class="hs-identifier">GHC.Stable</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StablePtr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Read.html/GHC.Read.html"><span class="hs-identifier">GHC.Read</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">expectP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Read</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Int.html/GHC.Int.html"><span class="hs-identifier">GHC.Int</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int8</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier">Int16</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier">Int32</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.Word.html/GHC.Word.html"><span class="hs-identifier">GHC.Word</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.IO.html/GHC.IO.html"><span class="hs-identifier">GHC.IO</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">stToIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//GHC.IOArray.html/GHC.IOArray.html"><span class="hs-identifier">GHC.IOArray</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IOArray</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>                          </span><span class="annot"><span class="hs-identifier">newIOArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeReadIOArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeWriteIOArray</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Text.Read.Lex.html/Text.Read.Lex.html"><span class="hs-identifier">Text.Read.Lex</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Lexeme</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ident</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Text.ParserCombinators.ReadPrec.html/Text.ParserCombinators.ReadPrec.html"><span class="hs-identifier">Text.ParserCombinators.ReadPrec</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">prec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReadPrec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">step</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">

#include &quot;MachDeps.h&quot;
</span><span>
</span><span id="line-71"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Class of immutable arrays</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">{- | Class of immutable array types.

An array type has the form @(a i e)@ where @a@ is the array type
constructor (kind @* -&gt; * -&gt; *@), @i@ is the index type (a member of
the class 'Ix'), and @e@ is the element type.  The @IArray@ class is
parameterised over both @a@ and @e@, so that instances specialised to
certain element types can be defined.
-}</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">class</span><span> </span><span id="IArray"><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-var">IArray</span></a></span></span><span> </span><span id="local-6989586621679058845"><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679058846"><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- | Extracts the bounds of an immutable array</span><span>
</span><span id="line-84"></span><span>    </span><span id="bounds"><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-type">bounds</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058979"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-85"></span><span>    </span><span id="numElements"><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-type">numElements</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058981"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058981"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058981"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-86"></span><span>    </span><span id="unsafeArray"><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-type">unsafeArray</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058934"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-87"></span><span>    </span><span id="unsafeAt"><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-type">unsafeAt</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058980"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058980"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058980"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span id="unsafeReplace"><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-type">unsafeReplace</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058844"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058844"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058844"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058844"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-89"></span><span>    </span><span id="unsafeAccum"><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-type">unsafeAccum</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058870"><span id="local-6989586621679058871"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058870"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058871"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058870"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058871"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058870"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-90"></span><span>    </span><span id="unsafeAccumArray"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-type">unsafeAccumArray</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058880"><span id="local-6989586621679058881"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058880"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058881"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058880"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058880"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058881"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058880"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058846"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679059844"><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var">unsafeReplace</span></a></span><span> </span><span id="local-6989586621679059846"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679059847"><span class="annot"><span class="annottext">[(Int, e)]
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (a i e)) -&gt; a i e
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e -&gt; [(Int, e)] -&gt; ST s (STArray s i e)
forall (a :: * -&gt; * -&gt; *) e i s.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(Int, e)] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeReplaceST"><span class="hs-identifier hs-var">unsafeReplaceST</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e)]
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">ST s (STArray s i e)
-&gt; (STArray s i e -&gt; ST s (a i e)) -&gt; ST s (a i e)
forall a b. ST s a -&gt; (a -&gt; ST s b) -&gt; ST s b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; ST s (a i e)
forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-var">unsafeFreeze</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679059858"><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var">unsafeAccum</span></a></span><span> </span><span id="local-6989586621679059860"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059861"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679059862"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (a i e)) -&gt; a i e
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
forall (a :: * -&gt; * -&gt; *) e i e' s.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeAccumST"><span class="hs-identifier hs-var">unsafeAccumST</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">ST s (STArray s i e)
-&gt; (STArray s i e -&gt; ST s (a i e)) -&gt; ST s (a i e)
forall a b. ST s a -&gt; (a -&gt; ST s b) -&gt; ST s b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; ST s (a i e)
forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-var">unsafeFreeze</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679059870"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var">unsafeAccumArray</span></a></span><span> </span><span id="local-6989586621679059872"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059873"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679059874"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679059875"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (a i e)) -&gt; a i e
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e)
-&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
forall i e e' s.
Ix i =&gt;
(e -&gt; e' -&gt; e)
-&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayST"><span class="hs-identifier hs-var">unsafeAccumArrayST</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">ST s (STArray s i e)
-&gt; (STArray s i e -&gt; ST s (a i e)) -&gt; ST s (a i e)
forall a b. ST s a -&gt; (a -&gt; ST s b) -&gt; ST s b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; ST s (a i e)
forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-var">unsafeFreeze</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-pragma hs-type">safeRangeSize</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-97"></span><span id="local-6989586621679058889"><span class="annot"><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-type">safeRangeSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058889"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058889"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058889"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-98"></span><span id="safeRangeSize"><span class="annot"><span class="annottext">safeRangeSize :: forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var hs-var">safeRangeSize</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059894"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059895"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059899"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><span class="hs-identifier hs-var">rangeSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Negative range size&quot;</span></span><span>
</span><span id="line-100"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-pragma hs-type">safeIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-103"></span><span id="local-6989586621679058896"><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-type">safeIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058896"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058896"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058896"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058896"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-104"></span><span id="safeIndex"><span class="annot"><span class="annottext">safeIndex :: forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var hs-var">safeIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059913"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059914"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059915"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059916"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059920"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; i -&gt; Int
forall a. Ix a =&gt; (a, a) -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">index</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-105"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-107"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Error in array index; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-108"></span><span>                                     </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; not in range [0..&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplaceST"><span class="hs-pragma hs-type">unsafeReplaceST</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-111"></span><span id="local-6989586621679058858"><span id="local-6989586621679058859"><span id="local-6989586621679058860"><span id="local-6989586621679058861"><span class="annot"><a href="Data.Array.Base.html#unsafeReplaceST"><span class="hs-identifier hs-type">unsafeReplaceST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058859"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058860"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058860"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058859"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058859"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058861"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679058861"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058860"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058859"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-112"></span><span id="unsafeReplaceST"><span class="annot"><span class="annottext">unsafeReplaceST :: forall (a :: * -&gt; * -&gt; *) e i s.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(Int, e)] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeReplaceST"><span class="hs-identifier hs-var hs-var">unsafeReplaceST</span></a></span></span><span> </span><span id="local-6989586621679059937"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059937"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679059938"><span class="annot"><span class="annottext">[(Int, e)]
</span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679059939"><span class="annot"><a href="#local-6989586621679059939"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; ST s (STArray s i e)
forall i (a :: * -&gt; * -&gt; *) e (b :: * -&gt; * -&gt; *) (m :: * -&gt; *).
(Ix i, IArray a e, MArray b e m) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#thaw"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059937"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059939"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059943"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059944"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059943"><span class="annot"><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059944"><span class="annot"><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679059939"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumST"><span class="hs-pragma hs-type">unsafeAccumST</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-118"></span><span id="local-6989586621679058875"><span id="local-6989586621679058876"><span id="local-6989586621679058877"><span id="local-6989586621679058878"><span id="local-6989586621679058879"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumST"><span class="hs-identifier hs-type">unsafeAccumST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058876"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058877"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058876"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058878"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058876"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058877"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058876"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058878"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058879"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679058879"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058877"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058876"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-119"></span><span id="unsafeAccumST"><span class="annot"><span class="annottext">unsafeAccumST :: forall (a :: * -&gt; * -&gt; *) e i e' s.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeAccumST"><span class="hs-identifier hs-var hs-var">unsafeAccumST</span></a></span></span><span> </span><span id="local-6989586621679059960"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059961"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059961"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679059962"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059962"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679059963"><span class="annot"><a href="#local-6989586621679059963"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; ST s (STArray s i e)
forall i (a :: * -&gt; * -&gt; *) e (b :: * -&gt; * -&gt; *) (m :: * -&gt; *).
(Ix i, IArray a e, MArray b e m) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#thaw"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679059961"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679059964"><span class="annot"><a href="#local-6989586621679059964"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059963"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059966"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-122"></span><span>                  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059963"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059966"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059960"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059964"><span class="hs-identifier hs-type">old</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059967"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059966"><span class="annot"><a href="#local-6989586621679059966"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059967"><span class="annot"><a href="#local-6989586621679059967"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679059962"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679059963"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArrayST"><span class="hs-pragma hs-type">unsafeAccumArrayST</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-127"></span><span id="local-6989586621679058885"><span id="local-6989586621679058886"><span id="local-6989586621679058887"><span id="local-6989586621679058888"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArrayST"><span class="hs-identifier hs-type">unsafeAccumArrayST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058885"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058886"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058887"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058886"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058886"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058885"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058885"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058887"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058888"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679058888"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058885"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058886"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-128"></span><span id="unsafeAccumArrayST"><span class="annot"><span class="annottext">unsafeAccumArrayST :: forall i e e' s.
Ix i =&gt;
(e -&gt; e' -&gt; e)
-&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayST"><span class="hs-identifier hs-var hs-var">unsafeAccumArrayST</span></a></span></span><span> </span><span id="local-6989586621679059981"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679059981"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059982"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059983"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059984"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059984"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059985"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679059986"><span class="annot"><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; ST s (STArray s i e)
forall i. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STArray s i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059984"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679059988"><span class="annot"><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059986"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059989"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-131"></span><span>                  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059986"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059989"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059981"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059988"><span class="hs-identifier hs-type">old</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059990"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059989"><span class="annot"><a href="#local-6989586621679059989"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059990"><span class="annot"><a href="#local-6989586621679059990"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679059985"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679059986"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#array"><span class="hs-pragma hs-type">array</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">{-| Constructs an immutable array from a pair of bounds and a list of
initial associations.

The bounds are specified as a pair of the lowest and highest bounds in
the array respectively.  For example, a one-origin vector of length 10
has bounds (1,10), and a one-origin 10 by 10 matrix has bounds
((1,1),(10,10)).

An association is a pair of the form @(i,x)@, which defines the value of
the array at index @i@ to be @x@.  The array is undefined if any index
in the list is out of bounds.  If any two associations in the list have
the same index, the value at that index is implementation-dependent.
(In GHC, the last value specified for that index is used.
Other implementations will also do this for unboxed arrays, but Haskell
98 requires that for 'Array' the value at such indices is bottom.)

Because the indices must be checked for these errors, 'array' is
strict in the bounds argument and in the indices of the association
list.  Whether @array@ is strict or non-strict in the elements depends
on the array type: 'Data.Array.Array' is a non-strict array type, but
all of the 'Data.Array.Unboxed.UArray' arrays are strict.  Thus in a
non-strict array, recurrences such as the following are possible:

&gt; a = array (1,100) ((1,1) : [(i, i * a!(i-1)) | i \&lt;- [2..100]])

Not every index within the bounds of the array need appear in the
association list, but the values associated with indices that do not
appear will be undefined.

If, in any dimension, the lower bound is greater than the upper bound,
then the array is legal, but empty. Indexing an empty array always
gives an array-bounds error, but 'bounds' still yields the bounds with
which the array was constructed.
-}</span></span><span>
</span><span id="line-172"></span><span id="local-6989586621679058928"><span id="local-6989586621679058929"><span id="local-6989586621679058930"><span class="annot"><a href="Data.Array.Base.html#array"><span class="hs-identifier hs-type">array</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058929"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>        </span><span class="annot"><span class="hs-comment">-- ^ bounds of the array: (lowest,highest)</span></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679058929"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ list of associations</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058930"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058929"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-176"></span><span id="array"><span class="annot"><span class="annottext">array :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(i, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#array"><span class="hs-identifier hs-var hs-var">array</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059999"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060000"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060001"><span class="annot"><span class="annottext">[(i, e)]
</span><a href="#local-6989586621679060001"><span class="hs-identifier hs-var">ies</span></a></span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060005"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, e)] -&gt; a i e
forall i. Ix i =&gt; (i, i) -&gt; [(Int, e)] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var">unsafeArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060006"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060007"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(i, e)]
</span><a href="#local-6989586621679060001"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- Since unsafeFreeze is not guaranteed to be only a cast, we will</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- use unsafeArray and zip instead of a specialized loop to implement</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- listArray, unlike Array.listArray, even though it generates some</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- unnecessary heap allocation. Will use the loop only when we have</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- fast unsafeFreeze, namely for Array and UArray (well, they cover</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- almost all cases).</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Constructs an immutable array from a list of initial elements.</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- The list gives the elements of the array in ascending order</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- beginning with the lowest index.</span><span>
</span><span id="line-193"></span><span id="local-6989586621679058935"><span id="local-6989586621679058936"><span id="local-6989586621679058937"><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-identifier hs-type">listArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058935"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058936"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058936"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058935"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058936"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-194"></span><span id="listArray"><span class="annot"><span class="annottext">listArray :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="Data.Array.Base.html#listArray"><span class="hs-identifier hs-var hs-var">listArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060020"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060021"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060022"><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679060022"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060026"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, e)] -&gt; a i e
forall i. Ix i =&gt; (i, i) -&gt; [(Int, e)] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var">unsafeArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [e] -&gt; [(Int, e)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679060022"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#genArray"><span class="hs-pragma hs-type">genArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">-- | Constructs an immutable array using a generator function.</span></span><span>
</span><span id="line-200"></span><span id="local-6989586621679058944"><span id="local-6989586621679058945"><span id="local-6989586621679058946"><span class="annot"><a href="Data.Array.Base.html#genArray"><span class="hs-identifier hs-type">genArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058945"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058945"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058945"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-201"></span><span id="genArray"><span class="annot"><span class="annottext">genArray :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; (i -&gt; e) -&gt; a i e
</span><a href="Data.Array.Base.html#genArray"><span class="hs-identifier hs-var hs-var">genArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060033"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060034"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060035"><span class="annot"><span class="annottext">i -&gt; e
</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [e] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="Data.Array.Base.html#listArray"><span class="hs-identifier hs-var">listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([e] -&gt; a i e) -&gt; [e] -&gt; a i e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i -&gt; e) -&gt; [i] -&gt; [e]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; e
</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([i] -&gt; [e]) -&gt; [i] -&gt; [e]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [i]
forall a. Ix a =&gt; (a, a) -&gt; [a]
</span><span class="hs-identifier hs-var">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#listArrayST"><span class="hs-pragma hs-type">listArrayST</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>   </span><span class="hs-comment">-- See Note [Inlining and fusion]</span><span>
</span><span id="line-204"></span><span id="local-6989586621679058956"><span id="local-6989586621679058957"><span id="local-6989586621679058958"><span class="annot"><a href="Data.Array.Base.html#listArrayST"><span class="hs-identifier hs-type">listArrayST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058956"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058956"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058956"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058958"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679058958"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058956"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-205"></span><span id="listArrayST"><span class="annot"><span class="annottext">listArrayST :: forall i e s. Ix i =&gt; (i, i) -&gt; [e] -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#listArrayST"><span class="hs-identifier hs-var hs-var">listArrayST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [e] -&gt; ST s (STArray s i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newListArray"><span class="hs-identifier hs-var">newListArray</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-208"></span><span class="annot"><span class="hs-pragma">&quot;listArray/Array&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span> </span><span class="hs-pragma">=</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-pragma">\</span><span id="local-6989586621679060041"><span class="annot"><a href="#local-6989586621679060041"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060042"><span class="annot"><a href="#local-6989586621679060042"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listArrayST"><span class="hs-pragma hs-type">listArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060041"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060042"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">ArrST.unsafeFreezeSTArray</span></span><span class="hs-pragma">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>   </span><span class="hs-comment">-- See Note [Inlining and fusion]</span><span>
</span><span id="line-213"></span><span id="local-6989586621679058966"><span id="local-6989586621679058968"><span id="local-6989586621679058969"><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-identifier hs-type">listUArrayST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058966"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679058968"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058966"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058969"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058969"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058969"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058968"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058966"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058966"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058969"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058968"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-215"></span><span id="listUArrayST"><span class="annot"><span class="annottext">listUArrayST :: forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [e] -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#listUArrayST"><span class="hs-identifier hs-var hs-var">listUArrayST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [e] -&gt; ST s (STUArray s i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newListArray"><span class="hs-identifier hs-var">newListArray</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- I don't know how to write a single rule for listUArrayST, because</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- the type looks like constrained over 's', which runST doesn't</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- like. In fact all MArray (STUArray s) instances are polymorphic</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- wrt. 's', but runST can't know that.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- More precisely, we'd like to write this:</span><span>
</span><span id="line-223"></span><span class="hs-comment">--   listUArray :: (forall s. MArray (STUArray s) e (ST s), Ix i)</span><span>
</span><span id="line-224"></span><span class="hs-comment">--              =&gt; (i,i) -&gt; [e] -&gt; UArray i e</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   listUArray lu = runST (listUArrayST lu es &gt;&gt;= unsafeFreezeSTUArray)</span><span>
</span><span id="line-226"></span><span class="hs-comment">--   {-# RULES listArray = listUArray</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- Then we could call listUArray at any type 'e' that had a suitable</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- MArray instance.  But sadly we can't, because we don't have quantified</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- constraints.  Hence the mass of rules below.</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- I would like also to write a rule for listUArrayST (or listArray or</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- whatever) applied to unpackCString#. Unfortunately unpackCString#</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- calls seem to be floated out, then floated back into the middle</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- of listUArrayST, so I was not able to do this.</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-keyword">type</span><span> </span><span id="ListUArray"><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-identifier hs-var">ListUArray</span></a></span></span><span> </span><span id="local-6989586621679060050"><span class="annot"><a href="#local-6989586621679060050"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679060051"><span class="annot"><a href="#local-6989586621679060051"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679060051"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060051"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679060051"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679060050"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060051"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060050"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-239"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Bool&quot;</span></span><span>      </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-240"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060052"><span class="annot"><a href="#local-6989586621679060052"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060053"><span class="annot"><a href="#local-6989586621679060053"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060052"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060053"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Char&quot;</span></span><span>      </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-242"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060055"><span class="annot"><a href="#local-6989586621679060055"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060056"><span class="annot"><a href="#local-6989586621679060056"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060055"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060056"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Char</span></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Int&quot;</span></span><span>       </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-244"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060057"><span class="annot"><a href="#local-6989586621679060057"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060058"><span class="annot"><a href="#local-6989586621679060058"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060057"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060058"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Word&quot;</span></span><span>      </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-246"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060059"><span class="annot"><a href="#local-6989586621679060059"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060060"><span class="annot"><a href="#local-6989586621679060060"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060059"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060060"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span>
</span><span id="line-247"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Ptr&quot;</span></span><span>       </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-248"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span id="local-6989586621679060061"><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060062"><span class="annot"><a href="#local-6989586621679060062"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060063"><span class="annot"><a href="#local-6989586621679060063"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060062"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060063"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679060061"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">)</span></span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/FunPtr&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-250"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span id="local-6989586621679060064"><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060065"><span class="annot"><a href="#local-6989586621679060065"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060066"><span class="annot"><a href="#local-6989586621679060066"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060065"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060066"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">FunPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679060064"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">)</span></span><span>
</span><span id="line-251"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Float&quot;</span></span><span>     </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-252"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060067"><span class="annot"><a href="#local-6989586621679060067"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060068"><span class="annot"><a href="#local-6989586621679060068"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060067"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060068"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Float</span></span><span>
</span><span id="line-253"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Double&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-254"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060069"><span class="annot"><a href="#local-6989586621679060069"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060070"><span class="annot"><a href="#local-6989586621679060070"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060069"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060070"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/StablePtr&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-256"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span id="local-6989586621679060071"><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060072"><span class="annot"><a href="#local-6989586621679060072"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060073"><span class="annot"><a href="#local-6989586621679060073"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060072"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060073"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">StablePtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679060071"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">)</span></span><span>
</span><span id="line-257"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Int8&quot;</span></span><span>      </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-258"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060074"><span class="annot"><a href="#local-6989586621679060074"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060075"><span class="annot"><a href="#local-6989586621679060075"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060074"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060075"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int8</span></span><span>
</span><span id="line-259"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Int16&quot;</span></span><span>     </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-260"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060076"><span class="annot"><a href="#local-6989586621679060076"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060077"><span class="annot"><a href="#local-6989586621679060077"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060076"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060077"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int16</span></span><span>
</span><span id="line-261"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Int32&quot;</span></span><span>     </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-262"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060078"><span class="annot"><a href="#local-6989586621679060078"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060079"><span class="annot"><a href="#local-6989586621679060079"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060078"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060079"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int32</span></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Int64&quot;</span></span><span>     </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-264"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060080"><span class="annot"><a href="#local-6989586621679060080"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060081"><span class="annot"><a href="#local-6989586621679060081"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060080"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060081"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int64</span></span><span>
</span><span id="line-265"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Word8&quot;</span></span><span>     </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-266"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060082"><span class="annot"><a href="#local-6989586621679060082"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060083"><span class="annot"><a href="#local-6989586621679060083"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060082"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060083"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word8</span></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Word16&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-268"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060084"><span class="annot"><a href="#local-6989586621679060084"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060085"><span class="annot"><a href="#local-6989586621679060085"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060084"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060085"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word16</span></span><span>
</span><span id="line-269"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Word32&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-270"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060086"><span class="annot"><a href="#local-6989586621679060086"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060087"><span class="annot"><a href="#local-6989586621679060087"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060086"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060087"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word32</span></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-pragma">&quot;listArray/UArray/Word64&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-pragma hs-type">listArray</span></a></span><span>
</span><span id="line-272"></span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060088"><span class="annot"><a href="#local-6989586621679060088"><span class="hs-pragma hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060089"><span class="annot"><a href="#local-6989586621679060089"><span class="hs-pragma hs-var">es</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">runST</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#listUArrayST"><span class="hs-pragma hs-type">listUArrayST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060088"><span class="hs-pragma hs-type">lu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060089"><span class="hs-pragma hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ListUArray"><span class="hs-pragma hs-type">ListUArray</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word64</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Returns the element of an immutable array at the specified index,</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- or throws an exception if the index is out of bounds.</span><span>
</span><span id="line-278"></span><span id="local-6989586621679058973"><span id="local-6989586621679058974"><span id="local-6989586621679058975"><span class="annot"><a href="Data.Array.Base.html#%21"><span class="hs-operator hs-type">(!)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-279"></span><span id="%21"><span class="annot"><span class="annottext">! :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; i -&gt; e
</span><a href="Data.Array.Base.html#%21"><span class="hs-operator hs-var hs-var">(!)</span></a></span></span><span> </span><span id="local-6989586621679060100"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060101"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060101"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679060102"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060102"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060103"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060103"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; Int -&gt; e
forall i. Ix i =&gt; a i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; e) -&gt; Int -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060102"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060103"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e -&gt; Int
forall i. Ix i =&gt; a i e -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var">numElements</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060101"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!?</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Returns 'Just' the element of an immutable array at the specified index,</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- or 'Nothing' if the index is out of bounds.</span><span>
</span><span id="line-285"></span><span id="local-6989586621679058982"><span id="local-6989586621679058983"><span id="local-6989586621679058984"><span class="annot"><a href="Data.Array.Base.html#%21%3F"><span class="hs-operator hs-type">(!?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058982"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058984"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058982"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058984"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058984"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-286"></span><span id="%21%3F"><span class="annot"><span class="annottext">!? :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; i -&gt; Maybe e
</span><a href="Data.Array.Base.html#%21%3F"><span class="hs-operator hs-var hs-var">(!?)</span></a></span></span><span> </span><span id="local-6989586621679060113"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060114"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060119"><span class="annot"><span class="annottext">b :: (i, i)
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-287"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; i -&gt; Bool
forall a. Ix a =&gt; (a, a) -&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">inRange</span></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-288"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">e -&gt; Maybe e
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Maybe e) -&gt; e -&gt; Maybe e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a i e -&gt; Int -&gt; e
forall i. Ix i =&gt; a i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; e) -&gt; Int -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; i -&gt; Int
forall a. Ix a =&gt; (a, a) -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-289"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe e
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#indices"><span class="hs-pragma hs-type">indices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- | Returns a list of all the valid indices in an array.</span></span><span>
</span><span id="line-293"></span><span id="local-6989586621679058989"><span id="local-6989586621679058990"><span id="local-6989586621679058991"><span class="annot"><a href="Data.Array.Base.html#indices"><span class="hs-identifier hs-type">indices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058990"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058991"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058991"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058990"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058991"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-294"></span><span id="indices"><span class="annot"><span class="annottext">indices :: forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; [i]
</span><a href="Data.Array.Base.html#indices"><span class="hs-identifier hs-var hs-var">indices</span></a></span></span><span> </span><span id="local-6989586621679060126"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060126"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060126"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060127"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060127"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060128"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060128"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [i]
forall a. Ix a =&gt; (a, a) -&gt; [a]
</span><span class="hs-identifier hs-var">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060127"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060128"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#elems"><span class="hs-pragma hs-type">elems</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Returns a list of all the elements of an array, in the same order</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- as their indices.</span><span>
</span><span id="line-299"></span><span id="local-6989586621679058995"><span id="local-6989586621679058996"><span id="local-6989586621679058997"><span class="annot"><a href="Data.Array.Base.html#elems"><span class="hs-identifier hs-type">elems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058997"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058997"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-300"></span><span id="elems"><span class="annot"><span class="annottext">elems :: forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; [e]
</span><a href="Data.Array.Base.html#elems"><span class="hs-identifier hs-var hs-var">elems</span></a></span></span><span> </span><span id="local-6989586621679060140"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a i e -&gt; Int -&gt; e
forall i. Ix i =&gt; a i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060141"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679060141"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060141"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; Int
forall i. Ix i =&gt; a i e -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var">numElements</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#assocs"><span class="hs-pragma hs-type">assocs</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">-- | Returns the contents of an array as a list of associations.</span></span><span>
</span><span id="line-304"></span><span id="local-6989586621679059001"><span id="local-6989586621679059002"><span id="local-6989586621679059003"><span class="annot"><a href="Data.Array.Base.html#assocs"><span class="hs-identifier hs-type">assocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059003"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059003"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059003"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-305"></span><span id="assocs"><span class="annot"><span class="annottext">assocs :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(i, e)]
</span><a href="Data.Array.Base.html#assocs"><span class="hs-identifier hs-var hs-var">assocs</span></a></span></span><span> </span><span id="local-6989586621679060150"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679060151"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060151"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060152"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060152"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">a i e -&gt; i -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; i -&gt; e
</span><a href="Data.Array.Base.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679060153"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [i]
forall a. Ix a =&gt; (a, a) -&gt; [a]
</span><span class="hs-identifier hs-var">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060151"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060152"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#accumArray"><span class="hs-pragma hs-type">accumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">{-|
Constructs an immutable array from a list of associations.  Unlike
'array', the same index is allowed to occur multiple times in the list
of associations; an /accumulating function/ is used to combine the
values of elements with the same index.

For example, given a list of values of some index type, hist produces
a histogram of the number of occurrences of each index within a
specified range:

&gt; hist :: (Ix a, Num b) =&gt; (a,a) -&gt; [a] -&gt; Array a b
&gt; hist bnds is = accumArray (+) 0 bnds [(i, 1) | i\&lt;-is, inRange bnds i]
-}</span></span><span>
</span><span id="line-323"></span><span id="local-6989586621679059007"><span id="local-6989586621679059008"><span id="local-6989586621679059009"><span id="local-6989586621679059010"><span class="annot"><a href="Data.Array.Base.html#accumArray"><span class="hs-identifier hs-type">accumArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059010"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ An accumulating function</span></span><span>
</span><span id="line-325"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">e</span></a></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ A default element</span></span><span>
</span><span id="line-326"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>              </span><span class="annot"><span class="hs-comment">-- ^ The bounds of the array</span></span><span>
</span><span id="line-327"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059010"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>          </span><span class="annot"><span class="hs-comment">-- ^ List of associations</span></span><span>
</span><span id="line-328"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Returns: the array</span></span><span>
</span><span id="line-329"></span><span id="accumArray"><span class="annot"><span class="annottext">accumArray :: forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(i, e')] -&gt; a i e
</span><a href="Data.Array.Base.html#accumArray"><span class="hs-identifier hs-var hs-var">accumArray</span></a></span></span><span> </span><span id="local-6989586621679060162"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060163"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060163"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060164"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060164"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060165"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060165"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060166"><span class="annot"><span class="annottext">[(i, e')]
</span><a href="#local-6989586621679060166"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060170"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679060170"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060164"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060165"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; a i e
forall i e'.
Ix i =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var">unsafeAccumArray</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060162"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060163"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060164"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060165"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060164"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060165"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060170"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060171"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621679060172"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060171"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060171"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060172"><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621679060172"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(i, e')]
</span><a href="#local-6989586621679060166"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">//</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-335"></span><span class="annot"><span class="hs-comment">{-|
Takes an array and a list of pairs and returns an array identical to
the left argument except that it has been updated by the associations
in the right argument.  For example, if m is a 1-origin, n by n matrix,
then @m\/\/[((i,i), 0) | i \&lt;- [1..n]]@ is the same matrix, except with
the diagonal zeroed.

As with the 'array' function, if any two associations in the list have
the same index, the value at that index is implementation-dependent.
(In GHC, the last value specified for that index is used.
Other implementations will also do this for unboxed arrays, but Haskell
98 requires that for 'Array' the value at such indices is bottom.)

For most array types, this operation is O(/n/) where /n/ is the size
of the array.  However, the diffarray package provides an array type
for which this operation has complexity linear in the number of updates.
-}</span></span><span>
</span><span id="line-352"></span><span id="local-6989586621679059015"><span id="local-6989586621679059016"><span id="local-6989586621679059017"><span class="annot"><a href="Data.Array.Base.html#%2F%2F"><span class="hs-operator hs-type">(//)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span>
</span><span id="line-353"></span><span id="local-6989586621679060183"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060183"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="%2F%2F"><span class="annot"><span class="annottext">// :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(i, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#%2F%2F"><span class="hs-operator hs-var hs-var">//</span></a></span></span><span> </span><span id="local-6989586621679060184"><span class="annot"><span class="annottext">[(i, e)]
</span><a href="#local-6989586621679060184"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060183"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679060185"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060185"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060186"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060186"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; [(Int, e)] -&gt; a i e
forall i. Ix i =&gt; a i e -&gt; [(Int, e)] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(Int, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var">unsafeReplace</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060183"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060185"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060186"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e -&gt; Int
forall i. Ix i =&gt; a i e -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var">numElements</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060183"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060187"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060188"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(i, e)]
</span><a href="#local-6989586621679060184"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#accum"><span class="hs-pragma hs-type">accum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-358"></span><span class="annot"><span class="hs-comment">{-|
@accum f@ takes an array and an association list and accumulates pairs
from the list into the array with the accumulating function @f@. Thus
'accumArray' can be defined using 'accum':

&gt; accumArray f z b = accum f (array b [(i, z) | i \&lt;- range b])
-}</span></span><span>
</span><span id="line-365"></span><span id="local-6989586621679059021"><span id="local-6989586621679059022"><span id="local-6989586621679059023"><span id="local-6989586621679059024"><span class="annot"><a href="Data.Array.Base.html#accum"><span class="hs-identifier hs-type">accum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-366"></span><span id="accum"><span class="annot"><span class="annottext">accum :: forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(i, e')] -&gt; a i e
</span><a href="Data.Array.Base.html#accum"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679060199"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060200"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060201"><span class="annot"><span class="annottext">[(i, e')]
</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679060202"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060203"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060203"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060208"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679060208"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; Int
forall i. Ix i =&gt; a i e -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var">numElements</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-368"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; a i e
forall i e'.
Ix i =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var">unsafeAccum</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060203"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060208"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060209"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060210"><span class="annot"><span class="annottext">e'
</span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(i, e')]
</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#amap"><span class="hs-pragma hs-type">amap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Returns a new array derived from the original array by applying a</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- function to each of the elements.</span><span>
</span><span id="line-373"></span><span id="local-6989586621679059029"><span id="local-6989586621679059030"><span id="local-6989586621679059031"><span id="local-6989586621679059032"><span class="annot"><a href="Data.Array.Base.html#amap"><span class="hs-identifier hs-type">amap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059032"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059032"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059032"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-374"></span><span id="amap"><span class="annot"><span class="annottext">amap :: forall (a :: * -&gt; * -&gt; *) e' e i.
(IArray a e', IArray a e, Ix i) =&gt;
(e' -&gt; e) -&gt; a i e' -&gt; a i e
</span><a href="Data.Array.Base.html#amap"><span class="hs-identifier hs-var hs-var">amap</span></a></span></span><span> </span><span id="local-6989586621679060227"><span class="annot"><span class="annottext">e' -&gt; e
</span><a href="#local-6989586621679060227"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060228"><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679060228"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e' -&gt; (i, i)
forall i. Ix i =&gt; a i e' -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679060228"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679060229"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060229"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060230"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060230"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060235"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679060235"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e' -&gt; Int
forall i. Ix i =&gt; a i e' -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var">numElements</span></a></span><span> </span><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679060228"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-376"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, e)] -&gt; a i e
forall i. Ix i =&gt; (i, i) -&gt; [(Int, e)] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var">unsafeArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060229"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060230"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060236"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e' -&gt; e
</span><a href="#local-6989586621679060227"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e' -&gt; Int -&gt; e'
forall i. Ix i =&gt; a i e' -&gt; Int -&gt; e'
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679060228"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060236"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                                  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679060236"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060236"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060235"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#ixmap"><span class="hs-pragma hs-type">ixmap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Returns a new array derived from the original array by applying a</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- function to each of the indices.</span><span>
</span><span id="line-382"></span><span id="local-6989586621679059037"><span id="local-6989586621679059038"><span id="local-6989586621679059039"><span id="local-6989586621679059040"><span class="annot"><a href="Data.Array.Base.html#ixmap"><span class="hs-identifier hs-type">ixmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059038"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059040"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059040"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059040"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059038"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059038"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-383"></span><span id="ixmap"><span class="annot"><span class="annottext">ixmap :: forall (a :: * -&gt; * -&gt; *) e i j.
(IArray a e, Ix i, Ix j) =&gt;
(i, i) -&gt; (i -&gt; j) -&gt; a j e -&gt; a i e
</span><a href="Data.Array.Base.html#ixmap"><span class="hs-identifier hs-var hs-var">ixmap</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060246"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060247"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060248"><span class="annot"><span class="annottext">i -&gt; j
</span><a href="#local-6989586621679060248"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060249"><span class="annot"><span class="annottext">a j e
</span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">(i, i) -&gt; [(i, e)] -&gt; a i e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(i, e)] -&gt; a i e
</span><a href="Data.Array.Base.html#array"><span class="hs-identifier hs-var">array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a j e
</span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">a j e -&gt; j -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; i -&gt; e
</span><a href="Data.Array.Base.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; j
</span><a href="#local-6989586621679060248"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679060250"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [i]
forall a. Ix a =&gt; (a, a) -&gt; [a]
</span><span class="hs-identifier hs-var">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- Normal polymorphic arrays</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059047"><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arr.Array</span></span><span> </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679060261"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; Array i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array i e -&gt; (i, i)
forall i e. Array i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">Arr.bounds</span></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679060264"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; Array i e -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array i e -&gt; Int
forall i e. Array i e -&gt; Int
</span><span class="hs-identifier hs-var">Arr.numElements</span></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679060268"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, e)] -&gt; Array i e
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, e)] -&gt; Array i e
forall i e. Ix i =&gt; (i, i) -&gt; [(Int, e)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Arr.unsafeArray</span></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679060271"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; Array i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array i e -&gt; Int -&gt; e
forall i e. Array i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">Arr.unsafeAt</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-399"></span><span>    </span><span id="local-6989586621679060274"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; Array i e -&gt; [(Int, e)] -&gt; Array i e
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array i e -&gt; [(Int, e)] -&gt; Array i e
forall i e. Array i e -&gt; [(Int, e)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Arr.unsafeReplace</span></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679060277"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(e -&gt; e' -&gt; e) -&gt; Array i e -&gt; [(Int, e')] -&gt; Array i e
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e) -&gt; Array i e -&gt; [(Int, e')] -&gt; Array i e
forall e a i. (e -&gt; a -&gt; e) -&gt; Array i e -&gt; [(Int, a)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Arr.unsafeAccum</span></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679060281"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; Array i e
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; Array i e
forall i e a.
Ix i =&gt;
(e -&gt; a -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, a)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Arr.unsafeAccumArray</span></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- Flat unboxed arrays</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | Arrays with unboxed elements.  Instances of 'IArray' are provided</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- for 'UArray' with certain element types ('Int', 'Float', 'Char',</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- etc.; see the 'UArray' class for a full list).</span><span>
</span><span id="line-411"></span><span class="hs-comment">--</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- A 'UArray' will generally be more efficient (in terms of both time</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- and space) than the equivalent 'Data.Array.Array' with the same</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- element type.  However, 'UArray' is strict in its elements - so</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- don\'t use 'UArray' if you require the non-strictness that</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- 'Data.Array.Array' provides.</span><span>
</span><span id="line-417"></span><span class="hs-comment">--</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- Because the @IArray@ interface provides operations overloaded on</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- the type of the array, it should be possible to just change the</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- array type being used by a program from say @Array@ to @UArray@ to</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- get the benefits of unboxed arrays (don\'t forget to import</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- &quot;Data.Array.Unboxed&quot; instead of &quot;Data.Array&quot;).</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span class="hs-keyword">data</span><span> </span><span id="UArray"><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-var">UArray</span></a></span></span><span> </span><span id="local-6989586621679059090"><span class="annot"><a href="#local-6989586621679059090"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679059091"><span class="annot"><a href="#local-6989586621679059091"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UArray"><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-var">UArray</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679059090"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679059090"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- There are class-based invariants on both parameters. See also #9220.</span><span>
</span><span id="line-426"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-pragma hs-type">unsafeArrayUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-429"></span><span id="local-6989586621679059073"><span id="local-6989586621679059074"><span id="local-6989586621679059075"><span class="annot"><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-type">unsafeArrayUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059073"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059074"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059073"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059075"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059075"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059075"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059074"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059074"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059073"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059075"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059074"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-431"></span><span id="unsafeArrayUArray"><span class="annot"><span class="annottext">unsafeArrayUArray :: forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var hs-var">unsafeArrayUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060297"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060297"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060298"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060298"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060299"><span class="annot"><span class="annottext">[(Int, e)]
</span><a href="#local-6989586621679060299"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span id="local-6989586621679060300"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060300"><span class="hs-identifier hs-var">default_elem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621679060301"><span class="annot"><a href="#local-6989586621679060301"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; ST s (STUArray s i e)
forall i. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STUArray s i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060297"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060298"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060300"><span class="hs-identifier hs-var">default_elem</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060301"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060302"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060303"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060302"><span class="annot"><a href="#local-6989586621679060302"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060303"><span class="annot"><a href="#local-6989586621679060303"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679060299"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060301"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-437"></span><span id="local-6989586621679059080"><span id="local-6989586621679059081"><span id="local-6989586621679059082"><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059080"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059081"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059082"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059080"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059081"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059082"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-438"></span><span id="unsafeFreezeSTUArray"><span class="annot"><span class="annottext">unsafeFreezeSTUArray :: forall s i e. STUArray s i e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-var hs-var">unsafeFreezeSTUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679060305"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060305"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060306"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060306"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679060307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060307"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060308"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679060308"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (UArray i e) -&gt; ST s (UArray i e)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (UArray i e) -&gt; ST s (UArray i e))
-&gt; STRep s (UArray i e) -&gt; ST s (UArray i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679060310"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679060310"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; State# s -&gt; (# State# s, ByteArray# #)
forall d.
MutableByteArray# d -&gt; State# d -&gt; (# State# d, ByteArray# #)
</span><span class="hs-identifier hs-var">unsafeFreezeByteArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679060308"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679060310"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679060311"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679060311"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060312"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060312"><span class="hs-identifier hs-var">arr#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679060311"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; ByteArray# -&gt; UArray i e
forall i e. i -&gt; i -&gt; Int -&gt; ByteArray# -&gt; UArray i e
</span><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-var">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060305"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060306"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060307"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060312"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-pragma hs-type">unsafeReplaceUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-443"></span><span id="local-6989586621679059092"><span id="local-6989586621679059093"><span id="local-6989586621679059094"><span class="annot"><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-type">unsafeReplaceUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059092"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059093"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059092"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059094"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059094"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059093"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059093"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059092"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059094"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059093"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-445"></span><span id="unsafeReplaceUArray"><span class="annot"><span class="annottext">unsafeReplaceUArray :: forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var hs-var">unsafeReplaceUArray</span></a></span></span><span> </span><span id="local-6989586621679060323"><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060323"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060324"><span class="annot"><span class="annottext">[(Int, e)]
</span><a href="#local-6989586621679060324"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679060325"><span class="annot"><a href="#local-6989586621679060325"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UArray i e -&gt; ST s (STUArray s i e)
forall i e s. UArray i e -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#thawSTUArray"><span class="hs-identifier hs-var">thawSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060323"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060325"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060327"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060328"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060327"><span class="annot"><a href="#local-6989586621679060327"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060328"><span class="annot"><a href="#local-6989586621679060328"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679060324"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060325"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-pragma hs-type">unsafeAccumUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-451"></span><span id="local-6989586621679059101"><span id="local-6989586621679059102"><span id="local-6989586621679059103"><span id="local-6989586621679059104"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-type">unsafeAccumUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059101"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059102"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059101"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059103"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059102"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059104"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059102"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059103"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059102"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059104"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059101"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059103"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059102"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-453"></span><span id="unsafeAccumUArray"><span class="annot"><span class="annottext">unsafeAccumUArray :: forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var hs-var">unsafeAccumUArray</span></a></span></span><span> </span><span id="local-6989586621679060342"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060342"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060343"><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060343"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060344"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060344"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679060345"><span class="annot"><a href="#local-6989586621679060345"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UArray i e -&gt; ST s (STUArray s i e)
forall i e s. UArray i e -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#thawSTUArray"><span class="hs-identifier hs-var">thawSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060343"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679060346"><span class="annot"><a href="#local-6989586621679060346"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060345"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060347"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-456"></span><span>                  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060345"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060347"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060342"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060346"><span class="hs-identifier hs-type">old</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060348"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060347"><span class="annot"><a href="#local-6989586621679060347"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060348"><span class="annot"><a href="#local-6989586621679060348"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679060344"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060345"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-pragma hs-type">unsafeAccumArrayUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-461"></span><span id="local-6989586621679059109"><span id="local-6989586621679059110"><span id="local-6989586621679059111"><span id="local-6989586621679059112"><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-type">unsafeAccumArrayUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059111"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059111"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059111"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059111"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-463"></span><span id="unsafeAccumArrayUArray"><span class="annot"><span class="annottext">unsafeAccumArrayUArray :: forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var hs-var">unsafeAccumArrayUArray</span></a></span></span><span> </span><span id="local-6989586621679060364"><span class="annot"><span class="annottext">e -&gt; e' -&gt; e
</span><a href="#local-6989586621679060364"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060365"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060365"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060366"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060366"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679060367"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060367"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060368"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060368"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679060369"><span class="annot"><a href="#local-6989586621679060369"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; ST s (STUArray s i e)
forall i. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STUArray s i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060366"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060367"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679060365"><span class="hs-identifier hs-var">initialValue</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679060370"><span class="annot"><a href="#local-6989586621679060370"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060369"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060371"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-466"></span><span>                  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060369"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060371"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060364"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060370"><span class="hs-identifier hs-type">old</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060372"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060371"><span class="annot"><a href="#local-6989586621679060371"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060372"><span class="annot"><a href="#local-6989586621679060372"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679060368"><span class="hs-identifier hs-type">ies</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-identifier hs-type">unsafeFreezeSTUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060369"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#eqUArray"><span class="hs-pragma hs-type">eqUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-471"></span><span id="local-6989586621679059117"><span id="local-6989586621679059118"><span class="annot"><a href="Data.Array.Base.html#eqUArray"><span class="hs-identifier hs-type">eqUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059117"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059118"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679059117"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059118"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059117"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059118"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059117"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-472"></span><span id="eqUArray"><span class="annot"><span class="annottext">eqUArray :: forall e i.
(IArray UArray e, Ix i, Eq e) =&gt;
UArray i e -&gt; UArray i e -&gt; Bool
</span><a href="Data.Array.Base.html#eqUArray"><span class="hs-identifier hs-var hs-var">eqUArray</span></a></span></span><span> </span><span id="local-6989586621679060396"><span class="annot"><span class="annottext">arr1 :: UArray i e
</span><a href="#local-6989586621679060396"><span class="hs-identifier hs-var">arr1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060397"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060397"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679060398"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060398"><span class="hs-identifier hs-var">u1</span></a></span></span><span> </span><span id="local-6989586621679060399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060399"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060400"><span class="annot"><span class="annottext">arr2 :: UArray i e
</span><a href="#local-6989586621679060400"><span class="hs-identifier hs-var">arr2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060401"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060401"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679060402"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060402"><span class="hs-identifier hs-var">u2</span></a></span></span><span> </span><span id="local-6989586621679060403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060403"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060399"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060403"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060397"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060401"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060398"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060402"><span class="hs-identifier hs-var">u2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UArray i e -&gt; Int -&gt; e
forall i. Ix i =&gt; UArray i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060396"><span class="hs-identifier hs-var">arr1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060405"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UArray i e -&gt; Int -&gt; e
forall i. Ix i =&gt; UArray i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060400"><span class="hs-identifier hs-var">arr2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060405"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679060405"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060405"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060399"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#cmpUArray"><span class="hs-pragma hs-type">cmpUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span><span id="local-6989586621679059123"><span id="local-6989586621679059124"><span class="annot"><a href="Data.Array.Base.html#cmpUArray"><span class="hs-identifier hs-type">cmpUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059124"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059124"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059124"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span></span><span>
</span><span id="line-479"></span><span id="cmpUArray"><span class="annot"><span class="annottext">cmpUArray :: forall e i.
(IArray UArray e, Ix i, Ord e) =&gt;
UArray i e -&gt; UArray i e -&gt; Ordering
</span><a href="Data.Array.Base.html#cmpUArray"><span class="hs-identifier hs-var hs-var">cmpUArray</span></a></span></span><span> </span><span id="local-6989586621679060419"><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060419"><span class="hs-identifier hs-var">arr1</span></a></span></span><span> </span><span id="local-6989586621679060420"><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060420"><span class="hs-identifier hs-var">arr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(i, e)] -&gt; [(i, e)] -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i e -&gt; [(i, e)]
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(i, e)]
</span><a href="Data.Array.Base.html#assocs"><span class="hs-identifier hs-var">assocs</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060419"><span class="hs-identifier hs-var">arr1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i e -&gt; [(i, e)]
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(i, e)]
</span><a href="Data.Array.Base.html#assocs"><span class="hs-identifier hs-var">assocs</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i e
</span><a href="#local-6989586621679060420"><span class="hs-identifier hs-var">arr2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#cmpIntUArray"><span class="hs-pragma hs-type">cmpIntUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-482"></span><span id="local-6989586621679059130"><span class="annot"><a href="Data.Array.Base.html#cmpIntUArray"><span class="hs-identifier hs-type">cmpIntUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059130"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679059130"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679059130"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679059130"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span><span>
</span><span id="line-483"></span><span id="cmpIntUArray"><span class="annot"><span class="annottext">cmpIntUArray :: forall e.
(IArray UArray e, Ord e) =&gt;
UArray Int e -&gt; UArray Int e -&gt; Ordering
</span><a href="Data.Array.Base.html#cmpIntUArray"><span class="hs-identifier hs-var hs-var">cmpIntUArray</span></a></span></span><span> </span><span id="local-6989586621679060440"><span class="annot"><span class="annottext">arr1 :: UArray Int e
</span><a href="#local-6989586621679060440"><span class="hs-identifier hs-var">arr1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060441"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060441"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679060442"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060442"><span class="hs-identifier hs-var">u1</span></a></span></span><span> </span><span id="local-6989586621679060443"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060443"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679060444"><span class="annot"><span class="annottext">arr2 :: UArray Int e
</span><a href="#local-6989586621679060444"><span class="hs-identifier hs-var">arr2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060445"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060445"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679060446"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060446"><span class="hs-identifier hs-var">u2</span></a></span></span><span> </span><span id="local-6989586621679060447"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060447"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060443"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060447"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060447"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060441"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060445"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-487"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Ordering -&gt; Ordering) -&gt; Ordering -&gt; [Int] -&gt; Ordering
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ordering -&gt; Ordering
</span><a href="#local-6989586621679060449"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060442"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060446"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060443"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`min`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060447"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621679060451"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060451"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060451"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679060449"><span class="annot"><span class="annottext">cmp :: Int -&gt; Ordering -&gt; Ordering
</span><a href="#local-6989586621679060449"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621679060459"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060459"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679060460"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060460"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">e -&gt; e -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray Int e -&gt; Int -&gt; e
forall i. Ix i =&gt; UArray i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int e
</span><a href="#local-6989586621679060440"><span class="hs-identifier hs-var">arr1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060459"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray Int e -&gt; Int -&gt; e
forall i. Ix i =&gt; UArray i e -&gt; Int -&gt; e
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var">unsafeAt</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int e
</span><a href="#local-6989586621679060444"><span class="hs-identifier hs-var">arr2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060459"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060460"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span id="local-6989586621679060461"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060461"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679060461"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;cmpUArray/Int&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#cmpUArray"><span class="hs-pragma hs-type">cmpUArray</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#cmpIntUArray"><span class="hs-pragma hs-type">cmpIntUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- Showing and Reading IArrays</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-pragma">{-# SPECIALISE</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#showsIArray"><span class="hs-pragma hs-type">showsIArray</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679060463"><span id="local-6989586621679060464"><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-pragma hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-pragma hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060463"><span class="hs-pragma hs-type">e</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679060464"><span class="hs-pragma hs-type">i</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679060464"><span class="hs-pragma hs-type">i</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679060463"><span class="hs-pragma hs-type">e</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=&gt;</span><span>
</span><span id="line-501"></span><span>                   </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-pragma hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060464"><span class="hs-pragma hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060463"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">ShowS</span></span></span></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621679059135"><span id="local-6989586621679059136"><span id="local-6989586621679059137"><span class="annot"><a href="Data.Array.Base.html#showsIArray"><span class="hs-identifier hs-type">showsIArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059135"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059137"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059137"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059135"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059137"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShowS</span></span></span></span></span><span>
</span><span id="line-505"></span><span id="showsIArray"><span class="annot"><span class="annottext">showsIArray :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i, Show i, Show e) =&gt;
Int -&gt; a i e -&gt; [Char] -&gt; [Char]
</span><a href="Data.Array.Base.html#showsIArray"><span class="hs-identifier hs-var hs-var">showsIArray</span></a></span></span><span> </span><span id="local-6989586621679060480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060480"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679060481"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060480"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier hs-var">appPrec</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char])
-&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;array &quot;</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><span class="annottext">(i, i) -&gt; [Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="annottext">[(i, e)] -&gt; [Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a i e -&gt; [(i, e)]
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(i, e)]
</span><a href="Data.Array.Base.html#assocs"><span class="hs-identifier hs-var">assocs</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-pragma">{-# SPECIALISE</span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#readIArray"><span class="hs-pragma hs-type">readIArray</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679060489"><span id="local-6989586621679060490"><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-pragma hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-pragma hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060489"><span class="hs-pragma hs-type">e</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679060490"><span class="hs-pragma hs-type">i</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679060490"><span class="hs-pragma hs-type">i</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679060489"><span class="hs-pragma hs-type">e</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=&gt;</span><span>
</span><span id="line-514"></span><span>                   </span><span class="annot"><span class="hs-pragma hs-type">ReadPrec</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-pragma hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060490"><span class="hs-pragma hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060489"><span class="hs-pragma hs-type">e</span></a></span><span class="hs-pragma">)</span></span></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="local-6989586621679059148"><span id="local-6989586621679059149"><span id="local-6989586621679059150"><span class="annot"><a href="Data.Array.Base.html#readIArray"><span class="hs-identifier hs-type">readIArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059149"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059150"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679059150"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679059149"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadPrec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059150"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059149"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-518"></span><span id="readIArray"><span class="annot"><span class="annottext">readIArray :: forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i, Read i, Read e) =&gt;
ReadPrec (a i e)
</span><a href="Data.Array.Base.html#readIArray"><span class="hs-identifier hs-var hs-var">readIArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadPrec (a i e) -&gt; ReadPrec (a i e)
forall a. ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(ReadPrec (a i e) -&gt; ReadPrec (a i e))
-&gt; ReadPrec (a i e) -&gt; ReadPrec (a i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadPrec (a i e) -&gt; ReadPrec (a i e)
forall a. Int -&gt; ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">prec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier hs-var">appPrec</span></span><span> </span><span class="annot"><span class="annottext">(ReadPrec (a i e) -&gt; ReadPrec (a i e))
-&gt; ReadPrec (a i e) -&gt; ReadPrec (a i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-519"></span><span>               </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Lexeme -&gt; ReadPrec ()
</span><span class="hs-identifier hs-var">expectP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Lexeme
</span><span class="hs-identifier hs-var">Ident</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;array&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>                  </span><span id="local-6989586621679060507"><span class="annot"><a href="#local-6989586621679060507"><span class="hs-identifier hs-var">theBounds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadPrec (i, i) -&gt; ReadPrec (i, i)
forall a. ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">step</span></span><span> </span><span class="annot"><span class="annottext">ReadPrec (i, i)
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span>
</span><span id="line-521"></span><span>                  </span><span id="local-6989586621679060509"><span class="annot"><a href="#local-6989586621679060509"><span class="hs-identifier hs-var">vals</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">step</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">readPrec</span></span><span>
</span><span id="line-522"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#array"><span class="hs-identifier hs-type">array</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060507"><span class="hs-identifier hs-type">theBounds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060509"><span class="hs-identifier hs-type">vals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- Flat unboxed arrays: instances</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621679060519"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Bool -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060520"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060520"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060521"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060521"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060520"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060521"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621679060523"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Bool -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060524"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060524"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060524"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679060526"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Bool)] -&gt; UArray i Bool
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060527"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060527"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060528"><span class="annot"><span class="annottext">[(Int, Bool)]
</span><a href="#local-6989586621679060528"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Bool)) -&gt; UArray i Bool
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Bool)] -&gt; Bool -&gt; ST s (UArray i Bool)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060527"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Bool)]
</span><a href="#local-6989586621679060528"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621679060533"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Bool -&gt; Int -&gt; Bool
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060534"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060534"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060535"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060535"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span>
</span><span id="line-536"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060534"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_INDEX"><span class="hs-identifier hs-var">bOOL_INDEX</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060535"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-var">bOOL_BIT</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060535"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>        </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`neWord#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-540"></span><span>    </span><span id="local-6989586621679060540"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; UArray i Bool -&gt; [(Int, Bool)] -&gt; UArray i Bool
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060541"><span class="annot"><span class="annottext">UArray i Bool
</span><a href="#local-6989586621679060541"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060542"><span class="annot"><span class="annottext">[(Int, Bool)]
</span><a href="#local-6989586621679060542"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Bool)) -&gt; UArray i Bool
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Bool -&gt; [(Int, Bool)] -&gt; ST s (UArray i Bool)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Bool
</span><a href="#local-6989586621679060541"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Bool)]
</span><a href="#local-6989586621679060542"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-542"></span><span>    </span><span id="local-6989586621679060546"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Bool -&gt; e' -&gt; Bool)
-&gt; UArray i Bool -&gt; [(Int, e')] -&gt; UArray i Bool
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060547"><span class="annot"><span class="annottext">Bool -&gt; e' -&gt; Bool
</span><a href="#local-6989586621679060547"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060548"><span class="annot"><span class="annottext">UArray i Bool
</span><a href="#local-6989586621679060548"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060549"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060549"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Bool)) -&gt; UArray i Bool
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; e' -&gt; Bool)
-&gt; UArray i Bool -&gt; [(Int, e')] -&gt; ST s (UArray i Bool)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; e' -&gt; Bool
</span><a href="#local-6989586621679060547"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Bool
</span><a href="#local-6989586621679060548"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060549"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-544"></span><span>    </span><span id="local-6989586621679060553"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Bool -&gt; e' -&gt; Bool)
-&gt; Bool -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Bool
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060554"><span class="annot"><span class="annottext">Bool -&gt; e' -&gt; Bool
</span><a href="#local-6989586621679060554"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060555"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060555"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060556"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060556"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060557"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060557"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Bool)) -&gt; UArray i Bool
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; e' -&gt; Bool)
-&gt; Bool -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Bool)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; e' -&gt; Bool
</span><a href="#local-6989586621679060554"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060555"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060556"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060557"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621679060569"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Char -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060570"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060570"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060571"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060570"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679060573"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Char -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060574"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060574"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679060576"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Char)] -&gt; UArray i Char
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060577"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060577"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060578"><span class="annot"><span class="annottext">[(Int, Char)]
</span><a href="#local-6989586621679060578"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Char)) -&gt; UArray i Char
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Char)] -&gt; Char -&gt; ST s (UArray i Char)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060577"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Char)]
</span><a href="#local-6989586621679060578"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\0'</span></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621679060583"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Char -&gt; Int -&gt; Char
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060584"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060584"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060585"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060585"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char# -&gt; Char
</span><span class="hs-identifier hs-var">C#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Char#
</span><span class="hs-identifier hs-var">indexWideCharArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060584"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060585"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679060587"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; UArray i Char -&gt; [(Int, Char)] -&gt; UArray i Char
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060588"><span class="annot"><span class="annottext">UArray i Char
</span><a href="#local-6989586621679060588"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060589"><span class="annot"><span class="annottext">[(Int, Char)]
</span><a href="#local-6989586621679060589"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Char)) -&gt; UArray i Char
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Char -&gt; [(Int, Char)] -&gt; ST s (UArray i Char)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Char
</span><a href="#local-6989586621679060588"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Char)]
</span><a href="#local-6989586621679060589"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679060593"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Char -&gt; e' -&gt; Char)
-&gt; UArray i Char -&gt; [(Int, e')] -&gt; UArray i Char
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060594"><span class="annot"><span class="annottext">Char -&gt; e' -&gt; Char
</span><a href="#local-6989586621679060594"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060595"><span class="annot"><span class="annottext">UArray i Char
</span><a href="#local-6989586621679060595"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060596"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060596"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Char)) -&gt; UArray i Char
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; e' -&gt; Char)
-&gt; UArray i Char -&gt; [(Int, e')] -&gt; ST s (UArray i Char)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; e' -&gt; Char
</span><a href="#local-6989586621679060594"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Char
</span><a href="#local-6989586621679060595"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060596"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621679060600"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Char -&gt; e' -&gt; Char)
-&gt; Char -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Char
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060601"><span class="annot"><span class="annottext">Char -&gt; e' -&gt; Char
</span><a href="#local-6989586621679060601"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060602"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679060602"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060603"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060603"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060604"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060604"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Char)) -&gt; UArray i Char
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; e' -&gt; Char)
-&gt; Char -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Char)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; e' -&gt; Char
</span><a href="#local-6989586621679060601"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679060602"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060603"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060604"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679060616"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Int -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060617"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060617"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060618"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060618"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060617"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060618"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621679060620"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Int -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060621"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060621"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-568"></span><span>    </span><span id="local-6989586621679060623"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Int)] -&gt; UArray i Int
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060624"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060624"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060625"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679060625"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int)) -&gt; UArray i Int
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int)] -&gt; Int -&gt; ST s (UArray i Int)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060624"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679060625"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621679060631"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Int -&gt; Int -&gt; Int
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060632"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060632"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060633"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060633"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int#
</span><span class="hs-identifier hs-var">indexIntArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060632"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060633"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679060635"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; UArray i Int -&gt; [(Int, Int)] -&gt; UArray i Int
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060636"><span class="annot"><span class="annottext">UArray i Int
</span><a href="#local-6989586621679060636"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060637"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679060637"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int)) -&gt; UArray i Int
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Int -&gt; [(Int, Int)] -&gt; ST s (UArray i Int)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int
</span><a href="#local-6989586621679060636"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679060637"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621679060641"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Int -&gt; e' -&gt; Int) -&gt; UArray i Int -&gt; [(Int, e')] -&gt; UArray i Int
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060642"><span class="annot"><span class="annottext">Int -&gt; e' -&gt; Int
</span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060643"><span class="annot"><span class="annottext">UArray i Int
</span><a href="#local-6989586621679060643"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060644"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060644"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int)) -&gt; UArray i Int
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; e' -&gt; Int)
-&gt; UArray i Int -&gt; [(Int, e')] -&gt; ST s (UArray i Int)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e' -&gt; Int
</span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int
</span><a href="#local-6989586621679060643"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060644"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621679060648"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Int -&gt; e' -&gt; Int) -&gt; Int -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060649"><span class="annot"><span class="annottext">Int -&gt; e' -&gt; Int
</span><a href="#local-6989586621679060649"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060650"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060650"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060651"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060651"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060652"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060652"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int)) -&gt; UArray i Int
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; e' -&gt; Int)
-&gt; Int -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Int)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e' -&gt; Int
</span><a href="#local-6989586621679060649"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060650"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060651"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060652"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621679060664"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Word -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060665"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060665"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060666"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060665"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679060668"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Word -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060669"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060669"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621679060671"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Word)] -&gt; UArray i Word
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060672"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060673"><span class="annot"><span class="annottext">[(Int, Word)]
</span><a href="#local-6989586621679060673"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word)) -&gt; UArray i Word
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Word)] -&gt; Word -&gt; ST s (UArray i Word)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word)]
</span><a href="#local-6989586621679060673"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621679060680"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Word -&gt; Int -&gt; Word
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060681"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060681"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060682"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060682"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word
</span><span class="hs-identifier hs-var">W#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060681"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060682"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679060684"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; UArray i Word -&gt; [(Int, Word)] -&gt; UArray i Word
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060685"><span class="annot"><span class="annottext">UArray i Word
</span><a href="#local-6989586621679060685"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060686"><span class="annot"><span class="annottext">[(Int, Word)]
</span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word)) -&gt; UArray i Word
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Word -&gt; [(Int, Word)] -&gt; ST s (UArray i Word)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word
</span><a href="#local-6989586621679060685"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word)]
</span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621679060690"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Word -&gt; e' -&gt; Word)
-&gt; UArray i Word -&gt; [(Int, e')] -&gt; UArray i Word
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060691"><span class="annot"><span class="annottext">Word -&gt; e' -&gt; Word
</span><a href="#local-6989586621679060691"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060692"><span class="annot"><span class="annottext">UArray i Word
</span><a href="#local-6989586621679060692"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060693"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060693"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word)) -&gt; UArray i Word
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word -&gt; e' -&gt; Word)
-&gt; UArray i Word -&gt; [(Int, e')] -&gt; ST s (UArray i Word)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; e' -&gt; Word
</span><a href="#local-6989586621679060691"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word
</span><a href="#local-6989586621679060692"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060693"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-592"></span><span>    </span><span id="local-6989586621679060697"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Word -&gt; e' -&gt; Word)
-&gt; Word -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Word
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060698"><span class="annot"><span class="annottext">Word -&gt; e' -&gt; Word
</span><a href="#local-6989586621679060698"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060699"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679060699"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060700"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060700"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060701"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060701"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word)) -&gt; UArray i Word
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word -&gt; e' -&gt; Word)
-&gt; Word -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Word)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; e' -&gt; Word
</span><a href="#local-6989586621679060698"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679060699"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060700"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060701"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059219"><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059219"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621679060713"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i (Ptr a) -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060714"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060714"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060715"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060715"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060714"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060715"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621679060717"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i (Ptr a) -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060718"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060718"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060718"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-600"></span><span>    </span><span id="local-6989586621679060720"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Ptr a)] -&gt; UArray i (Ptr a)
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060721"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060721"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060722"><span class="annot"><span class="annottext">[(Int, Ptr a)]
</span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (Ptr a))) -&gt; UArray i (Ptr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Ptr a)] -&gt; Ptr a -&gt; ST s (UArray i (Ptr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060721"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Ptr a)]
</span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621679060727"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i (Ptr a) -&gt; Int -&gt; Ptr a
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060728"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060728"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060729"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060729"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Ptr a
forall a. Addr# -&gt; Ptr a
</span><span class="hs-identifier hs-var">Ptr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Addr#
</span><span class="hs-identifier hs-var">indexAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060728"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060729"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621679060732"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i (Ptr a) -&gt; [(Int, Ptr a)] -&gt; UArray i (Ptr a)
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060733"><span class="annot"><span class="annottext">UArray i (Ptr a)
</span><a href="#local-6989586621679060733"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060734"><span class="annot"><span class="annottext">[(Int, Ptr a)]
</span><a href="#local-6989586621679060734"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (Ptr a))) -&gt; UArray i (Ptr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i (Ptr a) -&gt; [(Int, Ptr a)] -&gt; ST s (UArray i (Ptr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (Ptr a)
</span><a href="#local-6989586621679060733"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Ptr a)]
</span><a href="#local-6989586621679060734"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-606"></span><span>    </span><span id="local-6989586621679060738"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Ptr a -&gt; e' -&gt; Ptr a)
-&gt; UArray i (Ptr a) -&gt; [(Int, e')] -&gt; UArray i (Ptr a)
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060739"><span class="annot"><span class="annottext">Ptr a -&gt; e' -&gt; Ptr a
</span><a href="#local-6989586621679060739"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060740"><span class="annot"><span class="annottext">UArray i (Ptr a)
</span><a href="#local-6989586621679060740"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060741"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060741"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (Ptr a))) -&gt; UArray i (Ptr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr a -&gt; e' -&gt; Ptr a)
-&gt; UArray i (Ptr a) -&gt; [(Int, e')] -&gt; ST s (UArray i (Ptr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a -&gt; e' -&gt; Ptr a
</span><a href="#local-6989586621679060739"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (Ptr a)
</span><a href="#local-6989586621679060740"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060741"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621679060745"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Ptr a -&gt; e' -&gt; Ptr a)
-&gt; Ptr a -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i (Ptr a)
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060746"><span class="annot"><span class="annottext">Ptr a -&gt; e' -&gt; Ptr a
</span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060747"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679060747"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060748"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060748"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060749"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060749"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (Ptr a))) -&gt; UArray i (Ptr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr a -&gt; e' -&gt; Ptr a)
-&gt; Ptr a -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i (Ptr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a -&gt; e' -&gt; Ptr a
</span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679060747"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060748"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060749"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059238"><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679060761"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i (FunPtr a) -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060762"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060763"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-614"></span><span>    </span><span id="local-6989586621679060765"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i (FunPtr a) -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060766"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060766"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060766"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621679060768"><span class="annot"><span class="annottext">unsafeArray :: forall i.
Ix i =&gt;
(i, i) -&gt; [(Int, FunPtr a)] -&gt; UArray i (FunPtr a)
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060769"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060769"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060770"><span class="annot"><span class="annottext">[(Int, FunPtr a)]
</span><a href="#local-6989586621679060770"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (FunPtr a))) -&gt; UArray i (FunPtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i)
-&gt; [(Int, FunPtr a)] -&gt; FunPtr a -&gt; ST s (UArray i (FunPtr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060769"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, FunPtr a)]
</span><a href="#local-6989586621679060770"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">FunPtr a
forall a. FunPtr a
</span><span class="hs-identifier hs-var">nullFunPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-618"></span><span>    </span><span id="local-6989586621679060775"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i (FunPtr a) -&gt; Int -&gt; FunPtr a
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060776"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060777"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; FunPtr a
forall a. Addr# -&gt; FunPtr a
</span><span class="hs-identifier hs-var">FunPtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Addr#
</span><span class="hs-identifier hs-var">indexAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-620"></span><span>    </span><span id="local-6989586621679060780"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i (FunPtr a) -&gt; [(Int, FunPtr a)] -&gt; UArray i (FunPtr a)
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060781"><span class="annot"><span class="annottext">UArray i (FunPtr a)
</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060782"><span class="annot"><span class="annottext">[(Int, FunPtr a)]
</span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (FunPtr a))) -&gt; UArray i (FunPtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i (FunPtr a)
-&gt; [(Int, FunPtr a)] -&gt; ST s (UArray i (FunPtr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (FunPtr a)
</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, FunPtr a)]
</span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621679060786"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(FunPtr a -&gt; e' -&gt; FunPtr a)
-&gt; UArray i (FunPtr a) -&gt; [(Int, e')] -&gt; UArray i (FunPtr a)
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060787"><span class="annot"><span class="annottext">FunPtr a -&gt; e' -&gt; FunPtr a
</span><a href="#local-6989586621679060787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060788"><span class="annot"><span class="annottext">UArray i (FunPtr a)
</span><a href="#local-6989586621679060788"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060789"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060789"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (FunPtr a))) -&gt; UArray i (FunPtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunPtr a -&gt; e' -&gt; FunPtr a)
-&gt; UArray i (FunPtr a) -&gt; [(Int, e')] -&gt; ST s (UArray i (FunPtr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">FunPtr a -&gt; e' -&gt; FunPtr a
</span><a href="#local-6989586621679060787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (FunPtr a)
</span><a href="#local-6989586621679060788"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060789"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679060793"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(FunPtr a -&gt; e' -&gt; FunPtr a)
-&gt; FunPtr a -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i (FunPtr a)
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060794"><span class="annot"><span class="annottext">FunPtr a -&gt; e' -&gt; FunPtr a
</span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060795"><span class="annot"><span class="annottext">FunPtr a
</span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060796"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060797"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (FunPtr a))) -&gt; UArray i (FunPtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunPtr a -&gt; e' -&gt; FunPtr a)
-&gt; FunPtr a -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i (FunPtr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">FunPtr a -&gt; e' -&gt; FunPtr a
</span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FunPtr a
</span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621679060809"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Float -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060810"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060810"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060811"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060811"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060810"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060811"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621679060813"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Float -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-632"></span><span>    </span><span id="local-6989586621679060816"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Float)] -&gt; UArray i Float
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060817"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060818"><span class="annot"><span class="annottext">[(Int, Float)]
</span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Float)) -&gt; UArray i Float
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Float)] -&gt; Float -&gt; ST s (UArray i Float)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Float)]
</span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621679060825"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Float -&gt; Int -&gt; Float
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060826"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060826"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060827"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060827"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float# -&gt; Float
</span><span class="hs-identifier hs-var">F#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Float#
</span><span class="hs-identifier hs-var">indexFloatArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060826"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060827"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679060829"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Float -&gt; [(Int, Float)] -&gt; UArray i Float
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060830"><span class="annot"><span class="annottext">UArray i Float
</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060831"><span class="annot"><span class="annottext">[(Int, Float)]
</span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Float)) -&gt; UArray i Float
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Float -&gt; [(Int, Float)] -&gt; ST s (UArray i Float)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Float
</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Float)]
</span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679060835"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Float -&gt; e' -&gt; Float)
-&gt; UArray i Float -&gt; [(Int, e')] -&gt; UArray i Float
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060836"><span class="annot"><span class="annottext">Float -&gt; e' -&gt; Float
</span><a href="#local-6989586621679060836"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060837"><span class="annot"><span class="annottext">UArray i Float
</span><a href="#local-6989586621679060837"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060838"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060838"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Float)) -&gt; UArray i Float
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Float -&gt; e' -&gt; Float)
-&gt; UArray i Float -&gt; [(Int, e')] -&gt; ST s (UArray i Float)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; e' -&gt; Float
</span><a href="#local-6989586621679060836"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Float
</span><a href="#local-6989586621679060837"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060838"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679060842"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Float -&gt; e' -&gt; Float)
-&gt; Float -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Float
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060843"><span class="annot"><span class="annottext">Float -&gt; e' -&gt; Float
</span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060844"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060845"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060846"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Float)) -&gt; UArray i Float
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Float -&gt; e' -&gt; Float)
-&gt; Float -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Float)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; e' -&gt; Float
</span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-644"></span><span>    </span><span id="local-6989586621679060858"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Double -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060859"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060859"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060860"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060859"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621679060862"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Double -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060863"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060863"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060863"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-648"></span><span>    </span><span id="local-6989586621679060865"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Double)] -&gt; UArray i Double
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060866"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060867"><span class="annot"><span class="annottext">[(Int, Double)]
</span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Double)) -&gt; UArray i Double
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Double)] -&gt; Double -&gt; ST s (UArray i Double)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Double)]
</span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679060874"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Double -&gt; Int -&gt; Double
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060875"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060876"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060876"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><span class="hs-identifier hs-var">D#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Double#
</span><span class="hs-identifier hs-var">indexDoubleArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060876"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621679060878"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Double -&gt; [(Int, Double)] -&gt; UArray i Double
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060879"><span class="annot"><span class="annottext">UArray i Double
</span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060880"><span class="annot"><span class="annottext">[(Int, Double)]
</span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Double)) -&gt; UArray i Double
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Double -&gt; [(Int, Double)] -&gt; ST s (UArray i Double)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Double
</span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Double)]
</span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621679060884"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Double -&gt; e' -&gt; Double)
-&gt; UArray i Double -&gt; [(Int, e')] -&gt; UArray i Double
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060885"><span class="annot"><span class="annottext">Double -&gt; e' -&gt; Double
</span><a href="#local-6989586621679060885"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060886"><span class="annot"><span class="annottext">UArray i Double
</span><a href="#local-6989586621679060886"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060887"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060887"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Double)) -&gt; UArray i Double
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; e' -&gt; Double)
-&gt; UArray i Double -&gt; [(Int, e')] -&gt; ST s (UArray i Double)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; e' -&gt; Double
</span><a href="#local-6989586621679060885"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Double
</span><a href="#local-6989586621679060886"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060887"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679060891"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Double -&gt; e' -&gt; Double)
-&gt; Double -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Double
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060892"><span class="annot"><span class="annottext">Double -&gt; e' -&gt; Double
</span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060893"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060894"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060895"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Double)) -&gt; UArray i Double
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; e' -&gt; Double)
-&gt; Double -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Double)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; e' -&gt; Double
</span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059285"><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StablePtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621679060907"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i (StablePtr a) -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060908"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060908"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060909"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060909"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060908"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060909"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-662"></span><span>    </span><span id="local-6989586621679060911"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i (StablePtr a) -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060912"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679060914"><span class="annot"><span class="annottext">unsafeArray :: forall i.
Ix i =&gt;
(i, i) -&gt; [(Int, StablePtr a)] -&gt; UArray i (StablePtr a)
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060915"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060915"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060916"><span class="annot"><span class="annottext">[(Int, StablePtr a)]
</span><a href="#local-6989586621679060916"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (StablePtr a))) -&gt; UArray i (StablePtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i)
-&gt; [(Int, StablePtr a)]
-&gt; StablePtr a
-&gt; ST s (UArray i (StablePtr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060915"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, StablePtr a)]
</span><a href="#local-6989586621679060916"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">StablePtr a
forall a. StablePtr a
</span><a href="Data.Array.Base.html#nullStablePtr"><span class="hs-identifier hs-var">nullStablePtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-666"></span><span>    </span><span id="local-6989586621679060922"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i (StablePtr a) -&gt; Int -&gt; StablePtr a
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060923"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060924"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060924"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StablePtr# a -&gt; StablePtr a
forall a. StablePtr# a -&gt; StablePtr a
</span><span class="hs-identifier hs-var">StablePtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; StablePtr# a
forall a. ByteArray# -&gt; Int# -&gt; StablePtr# a
</span><span class="hs-identifier hs-var">indexStablePtrArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060924"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679060927"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i (StablePtr a)
-&gt; [(Int, StablePtr a)] -&gt; UArray i (StablePtr a)
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060928"><span class="annot"><span class="annottext">UArray i (StablePtr a)
</span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060929"><span class="annot"><span class="annottext">[(Int, StablePtr a)]
</span><a href="#local-6989586621679060929"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (StablePtr a))) -&gt; UArray i (StablePtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i (StablePtr a)
-&gt; [(Int, StablePtr a)] -&gt; ST s (UArray i (StablePtr a))
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (StablePtr a)
</span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, StablePtr a)]
</span><a href="#local-6989586621679060929"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679060933"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(StablePtr a -&gt; e' -&gt; StablePtr a)
-&gt; UArray i (StablePtr a) -&gt; [(Int, e')] -&gt; UArray i (StablePtr a)
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060934"><span class="annot"><span class="annottext">StablePtr a -&gt; e' -&gt; StablePtr a
</span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060935"><span class="annot"><span class="annottext">UArray i (StablePtr a)
</span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060936"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (StablePtr a))) -&gt; UArray i (StablePtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StablePtr a -&gt; e' -&gt; StablePtr a)
-&gt; UArray i (StablePtr a)
-&gt; [(Int, e')]
-&gt; ST s (UArray i (StablePtr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">StablePtr a -&gt; e' -&gt; StablePtr a
</span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i (StablePtr a)
</span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679060940"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(StablePtr a -&gt; e' -&gt; StablePtr a)
-&gt; StablePtr a -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i (StablePtr a)
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060941"><span class="annot"><span class="annottext">StablePtr a -&gt; e' -&gt; StablePtr a
</span><a href="#local-6989586621679060941"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060942"><span class="annot"><span class="annottext">StablePtr a
</span><a href="#local-6989586621679060942"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060943"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060943"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060944"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060944"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i (StablePtr a))) -&gt; UArray i (StablePtr a)
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StablePtr a -&gt; e' -&gt; StablePtr a)
-&gt; StablePtr a
-&gt; (i, i)
-&gt; [(Int, e')]
-&gt; ST s (UArray i (StablePtr a))
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">StablePtr a -&gt; e' -&gt; StablePtr a
</span><a href="#local-6989586621679060941"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">StablePtr a
</span><a href="#local-6989586621679060942"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060943"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060944"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="hs-comment">-- bogus StablePtr value for initialising a UArray of StablePtr.</span><span>
</span><span id="line-675"></span><span id="local-6989586621679059292"><span class="annot"><a href="Data.Array.Base.html#nullStablePtr"><span class="hs-identifier hs-type">nullStablePtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StablePtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059292"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-676"></span><span id="nullStablePtr"><span class="annot"><span class="annottext">nullStablePtr :: forall a. StablePtr a
</span><a href="Data.Array.Base.html#nullStablePtr"><span class="hs-identifier hs-var hs-var">nullStablePtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StablePtr# a -&gt; StablePtr a
forall a. StablePtr# a -&gt; StablePtr a
</span><span class="hs-identifier hs-var">StablePtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; StablePtr# a
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce#</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><span class="hs-identifier hs-var">nullAddr#</span></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621679060956"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Int8 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679060957"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060957"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679060958"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060958"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060957"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679060958"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679060960"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Int8 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060961"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060961"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060961"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621679060963"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Int8)] -&gt; UArray i Int8
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679060964"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060964"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060965"><span class="annot"><span class="annottext">[(Int, Int8)]
</span><a href="#local-6989586621679060965"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int8)) -&gt; UArray i Int8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int8)] -&gt; Int8 -&gt; ST s (UArray i Int8)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060964"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int8)]
</span><a href="#local-6989586621679060965"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Int8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-686"></span><span>    </span><span id="local-6989586621679060972"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Int8 -&gt; Int -&gt; Int8
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060973"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679060974"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int8# -&gt; Int8
</span><span class="hs-identifier hs-var">I8#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int8#
</span><span class="hs-identifier hs-var">indexInt8Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621679060977"><span class="annot"><span class="annottext">unsafeReplace :: forall i. Ix i =&gt; UArray i Int8 -&gt; [(Int, Int8)] -&gt; UArray i Int8
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679060978"><span class="annot"><span class="annottext">UArray i Int8
</span><a href="#local-6989586621679060978"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060979"><span class="annot"><span class="annottext">[(Int, Int8)]
</span><a href="#local-6989586621679060979"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int8)) -&gt; UArray i Int8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Int8 -&gt; [(Int, Int8)] -&gt; ST s (UArray i Int8)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int8
</span><a href="#local-6989586621679060978"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int8)]
</span><a href="#local-6989586621679060979"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679060983"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Int8 -&gt; e' -&gt; Int8)
-&gt; UArray i Int8 -&gt; [(Int, e')] -&gt; UArray i Int8
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679060984"><span class="annot"><span class="annottext">Int8 -&gt; e' -&gt; Int8
</span><a href="#local-6989586621679060984"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060985"><span class="annot"><span class="annottext">UArray i Int8
</span><a href="#local-6989586621679060985"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679060986"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060986"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int8)) -&gt; UArray i Int8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int8 -&gt; e' -&gt; Int8)
-&gt; UArray i Int8 -&gt; [(Int, e')] -&gt; ST s (UArray i Int8)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; e' -&gt; Int8
</span><a href="#local-6989586621679060984"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int8
</span><a href="#local-6989586621679060985"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060986"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-692"></span><span>    </span><span id="local-6989586621679060990"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Int8 -&gt; e' -&gt; Int8)
-&gt; Int8 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int8
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679060991"><span class="annot"><span class="annottext">Int8 -&gt; e' -&gt; Int8
</span><a href="#local-6989586621679060991"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679060992"><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679060992"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679060993"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060993"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679060994"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060994"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int8)) -&gt; UArray i Int8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int8 -&gt; e' -&gt; Int8)
-&gt; Int8 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Int8)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; e' -&gt; Int8
</span><a href="#local-6989586621679060991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679060992"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679060993"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679060994"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621679061006"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Int16 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061007"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061007"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061008"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061008"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061007"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061008"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621679061010"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Int16 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061011"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-700"></span><span>    </span><span id="local-6989586621679061013"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Int16)] -&gt; UArray i Int16
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061014"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061014"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061015"><span class="annot"><span class="annottext">[(Int, Int16)]
</span><a href="#local-6989586621679061015"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int16)) -&gt; UArray i Int16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int16)] -&gt; Int16 -&gt; ST s (UArray i Int16)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061014"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int16)]
</span><a href="#local-6989586621679061015"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-702"></span><span>    </span><span id="local-6989586621679061022"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Int16 -&gt; Int -&gt; Int16
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061023"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061023"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061024"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061024"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16# -&gt; Int16
</span><span class="hs-identifier hs-var">I16#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int16#
</span><span class="hs-identifier hs-var">indexInt16Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061023"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061024"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621679061027"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Int16 -&gt; [(Int, Int16)] -&gt; UArray i Int16
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061028"><span class="annot"><span class="annottext">UArray i Int16
</span><a href="#local-6989586621679061028"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061029"><span class="annot"><span class="annottext">[(Int, Int16)]
</span><a href="#local-6989586621679061029"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int16)) -&gt; UArray i Int16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Int16 -&gt; [(Int, Int16)] -&gt; ST s (UArray i Int16)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int16
</span><a href="#local-6989586621679061028"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int16)]
</span><a href="#local-6989586621679061029"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679061033"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Int16 -&gt; e' -&gt; Int16)
-&gt; UArray i Int16 -&gt; [(Int, e')] -&gt; UArray i Int16
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061034"><span class="annot"><span class="annottext">Int16 -&gt; e' -&gt; Int16
</span><a href="#local-6989586621679061034"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061035"><span class="annot"><span class="annottext">UArray i Int16
</span><a href="#local-6989586621679061035"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061036"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061036"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int16)) -&gt; UArray i Int16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int16 -&gt; e' -&gt; Int16)
-&gt; UArray i Int16 -&gt; [(Int, e')] -&gt; ST s (UArray i Int16)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; e' -&gt; Int16
</span><a href="#local-6989586621679061034"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int16
</span><a href="#local-6989586621679061035"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061036"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679061040"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Int16 -&gt; e' -&gt; Int16)
-&gt; Int16 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int16
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061041"><span class="annot"><span class="annottext">Int16 -&gt; e' -&gt; Int16
</span><a href="#local-6989586621679061041"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061042"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679061042"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061043"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061043"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061044"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061044"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int16)) -&gt; UArray i Int16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int16 -&gt; e' -&gt; Int16)
-&gt; Int16 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Int16)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; e' -&gt; Int16
</span><a href="#local-6989586621679061041"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679061042"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061043"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061044"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621679061056"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Int32 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061057"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061057"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061058"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061058"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061057"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061058"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-714"></span><span>    </span><span id="local-6989586621679061060"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Int32 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061061"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061061"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679061063"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Int32)] -&gt; UArray i Int32
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061064"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061065"><span class="annot"><span class="annottext">[(Int, Int32)]
</span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int32)) -&gt; UArray i Int32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int32)] -&gt; Int32 -&gt; ST s (UArray i Int32)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int32)]
</span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-718"></span><span>    </span><span id="local-6989586621679061072"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Int32 -&gt; Int -&gt; Int32
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061073"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061073"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061074"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061074"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32# -&gt; Int32
</span><span class="hs-identifier hs-var">I32#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int32#
</span><span class="hs-identifier hs-var">indexInt32Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061073"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061074"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-720"></span><span>    </span><span id="local-6989586621679061077"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Int32 -&gt; [(Int, Int32)] -&gt; UArray i Int32
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061078"><span class="annot"><span class="annottext">UArray i Int32
</span><a href="#local-6989586621679061078"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061079"><span class="annot"><span class="annottext">[(Int, Int32)]
</span><a href="#local-6989586621679061079"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int32)) -&gt; UArray i Int32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Int32 -&gt; [(Int, Int32)] -&gt; ST s (UArray i Int32)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int32
</span><a href="#local-6989586621679061078"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int32)]
</span><a href="#local-6989586621679061079"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-722"></span><span>    </span><span id="local-6989586621679061083"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Int32 -&gt; e' -&gt; Int32)
-&gt; UArray i Int32 -&gt; [(Int, e')] -&gt; UArray i Int32
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061084"><span class="annot"><span class="annottext">Int32 -&gt; e' -&gt; Int32
</span><a href="#local-6989586621679061084"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061085"><span class="annot"><span class="annottext">UArray i Int32
</span><a href="#local-6989586621679061085"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061086"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061086"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int32)) -&gt; UArray i Int32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int32 -&gt; e' -&gt; Int32)
-&gt; UArray i Int32 -&gt; [(Int, e')] -&gt; ST s (UArray i Int32)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; e' -&gt; Int32
</span><a href="#local-6989586621679061084"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int32
</span><a href="#local-6989586621679061085"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061086"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-724"></span><span>    </span><span id="local-6989586621679061090"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Int32 -&gt; e' -&gt; Int32)
-&gt; Int32 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int32
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061091"><span class="annot"><span class="annottext">Int32 -&gt; e' -&gt; Int32
</span><a href="#local-6989586621679061091"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061092"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679061092"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061093"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061093"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061094"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061094"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int32)) -&gt; UArray i Int32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int32 -&gt; e' -&gt; Int32)
-&gt; Int32 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Int32)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; e' -&gt; Int32
</span><a href="#local-6989586621679061091"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679061092"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061093"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061094"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-727"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679061106"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Int64 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061107"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061107"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061108"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061108"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061107"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061108"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-730"></span><span>    </span><span id="local-6989586621679061110"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Int64 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061111"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061111"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-732"></span><span>    </span><span id="local-6989586621679061113"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Int64)] -&gt; UArray i Int64
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061114"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061114"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061115"><span class="annot"><span class="annottext">[(Int, Int64)]
</span><a href="#local-6989586621679061115"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int64)) -&gt; UArray i Int64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int64)] -&gt; Int64 -&gt; ST s (UArray i Int64)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061114"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int64)]
</span><a href="#local-6989586621679061115"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621679061122"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Int64 -&gt; Int -&gt; Int64
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061123"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061123"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061124"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061124"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64# -&gt; Int64
</span><span class="hs-identifier hs-var">I64#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int64#
</span><span class="hs-identifier hs-var">indexInt64Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061123"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061124"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-736"></span><span>    </span><span id="local-6989586621679061127"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Int64 -&gt; [(Int, Int64)] -&gt; UArray i Int64
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061128"><span class="annot"><span class="annottext">UArray i Int64
</span><a href="#local-6989586621679061128"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061129"><span class="annot"><span class="annottext">[(Int, Int64)]
</span><a href="#local-6989586621679061129"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int64)) -&gt; UArray i Int64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Int64 -&gt; [(Int, Int64)] -&gt; ST s (UArray i Int64)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int64
</span><a href="#local-6989586621679061128"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int64)]
</span><a href="#local-6989586621679061129"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-738"></span><span>    </span><span id="local-6989586621679061133"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Int64 -&gt; e' -&gt; Int64)
-&gt; UArray i Int64 -&gt; [(Int, e')] -&gt; UArray i Int64
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061134"><span class="annot"><span class="annottext">Int64 -&gt; e' -&gt; Int64
</span><a href="#local-6989586621679061134"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061135"><span class="annot"><span class="annottext">UArray i Int64
</span><a href="#local-6989586621679061135"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061136"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061136"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int64)) -&gt; UArray i Int64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int64 -&gt; e' -&gt; Int64)
-&gt; UArray i Int64 -&gt; [(Int, e')] -&gt; ST s (UArray i Int64)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; e' -&gt; Int64
</span><a href="#local-6989586621679061134"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Int64
</span><a href="#local-6989586621679061135"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061136"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-740"></span><span>    </span><span id="local-6989586621679061140"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Int64 -&gt; e' -&gt; Int64)
-&gt; Int64 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int64
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061141"><span class="annot"><span class="annottext">Int64 -&gt; e' -&gt; Int64
</span><a href="#local-6989586621679061141"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061142"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679061142"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061143"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061143"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061144"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061144"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Int64)) -&gt; UArray i Int64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int64 -&gt; e' -&gt; Int64)
-&gt; Int64 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Int64)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; e' -&gt; Int64
</span><a href="#local-6989586621679061141"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679061142"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061143"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061144"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-743"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-744"></span><span>    </span><span id="local-6989586621679061156"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Word8 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061157"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061157"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061158"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061158"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061157"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061158"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-746"></span><span>    </span><span id="local-6989586621679061160"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Word8 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061161"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061161"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061161"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-747"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-748"></span><span>    </span><span id="local-6989586621679061163"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Word8)] -&gt; UArray i Word8
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061164"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061164"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061165"><span class="annot"><span class="annottext">[(Int, Word8)]
</span><a href="#local-6989586621679061165"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word8)) -&gt; UArray i Word8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Word8)] -&gt; Word8 -&gt; ST s (UArray i Word8)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061164"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word8)]
</span><a href="#local-6989586621679061165"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-750"></span><span>    </span><span id="local-6989586621679061172"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Word8 -&gt; Int -&gt; Word8
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061173"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061173"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061174"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061174"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word8
</span><span class="hs-identifier hs-var">W8#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><span class="hs-identifier hs-var">indexWord8Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061173"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061174"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-752"></span><span>    </span><span id="local-6989586621679061177"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Word8 -&gt; [(Int, Word8)] -&gt; UArray i Word8
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061178"><span class="annot"><span class="annottext">UArray i Word8
</span><a href="#local-6989586621679061178"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061179"><span class="annot"><span class="annottext">[(Int, Word8)]
</span><a href="#local-6989586621679061179"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word8)) -&gt; UArray i Word8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Word8 -&gt; [(Int, Word8)] -&gt; ST s (UArray i Word8)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word8
</span><a href="#local-6989586621679061178"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word8)]
</span><a href="#local-6989586621679061179"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-754"></span><span>    </span><span id="local-6989586621679061183"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Word8 -&gt; e' -&gt; Word8)
-&gt; UArray i Word8 -&gt; [(Int, e')] -&gt; UArray i Word8
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061184"><span class="annot"><span class="annottext">Word8 -&gt; e' -&gt; Word8
</span><a href="#local-6989586621679061184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061185"><span class="annot"><span class="annottext">UArray i Word8
</span><a href="#local-6989586621679061185"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061186"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061186"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word8)) -&gt; UArray i Word8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; e' -&gt; Word8)
-&gt; UArray i Word8 -&gt; [(Int, e')] -&gt; ST s (UArray i Word8)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; e' -&gt; Word8
</span><a href="#local-6989586621679061184"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word8
</span><a href="#local-6989586621679061185"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061186"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-756"></span><span>    </span><span id="local-6989586621679061190"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Word8 -&gt; e' -&gt; Word8)
-&gt; Word8 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Word8
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061191"><span class="annot"><span class="annottext">Word8 -&gt; e' -&gt; Word8
</span><a href="#local-6989586621679061191"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061192"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679061192"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061193"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061193"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061194"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061194"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word8)) -&gt; UArray i Word8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; e' -&gt; Word8)
-&gt; Word8 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Word8)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; e' -&gt; Word8
</span><a href="#local-6989586621679061191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679061192"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061193"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061194"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-759"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-760"></span><span>    </span><span id="local-6989586621679061206"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Word16 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061207"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061207"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061208"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061208"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061207"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061208"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-762"></span><span>    </span><span id="local-6989586621679061210"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Word16 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061211"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061211"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-763"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621679061213"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Word16)] -&gt; UArray i Word16
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061214"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061214"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061215"><span class="annot"><span class="annottext">[(Int, Word16)]
</span><a href="#local-6989586621679061215"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word16)) -&gt; UArray i Word16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Word16)] -&gt; Word16 -&gt; ST s (UArray i Word16)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061214"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word16)]
</span><a href="#local-6989586621679061215"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-766"></span><span>    </span><span id="local-6989586621679061222"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Word16 -&gt; Int -&gt; Word16
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061223"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061223"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061224"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061224"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16# -&gt; Word16
</span><span class="hs-identifier hs-var">W16#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word16#
</span><span class="hs-identifier hs-var">indexWord16Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061223"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061224"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-768"></span><span>    </span><span id="local-6989586621679061227"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Word16 -&gt; [(Int, Word16)] -&gt; UArray i Word16
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061228"><span class="annot"><span class="annottext">UArray i Word16
</span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061229"><span class="annot"><span class="annottext">[(Int, Word16)]
</span><a href="#local-6989586621679061229"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word16)) -&gt; UArray i Word16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Word16 -&gt; [(Int, Word16)] -&gt; ST s (UArray i Word16)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word16
</span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word16)]
</span><a href="#local-6989586621679061229"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-770"></span><span>    </span><span id="local-6989586621679061233"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Word16 -&gt; e' -&gt; Word16)
-&gt; UArray i Word16 -&gt; [(Int, e')] -&gt; UArray i Word16
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061234"><span class="annot"><span class="annottext">Word16 -&gt; e' -&gt; Word16
</span><a href="#local-6989586621679061234"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061235"><span class="annot"><span class="annottext">UArray i Word16
</span><a href="#local-6989586621679061235"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061236"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061236"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word16)) -&gt; UArray i Word16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word16 -&gt; e' -&gt; Word16)
-&gt; UArray i Word16 -&gt; [(Int, e')] -&gt; ST s (UArray i Word16)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; e' -&gt; Word16
</span><a href="#local-6989586621679061234"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word16
</span><a href="#local-6989586621679061235"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061236"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-772"></span><span>    </span><span id="local-6989586621679061240"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Word16 -&gt; e' -&gt; Word16)
-&gt; Word16 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Word16
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061241"><span class="annot"><span class="annottext">Word16 -&gt; e' -&gt; Word16
</span><a href="#local-6989586621679061241"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061242"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679061242"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061243"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061243"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061244"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061244"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word16)) -&gt; UArray i Word16
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word16 -&gt; e' -&gt; Word16)
-&gt; Word16 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Word16)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; e' -&gt; Word16
</span><a href="#local-6989586621679061241"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679061242"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061243"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061244"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-775"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621679061256"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Word32 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061257"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061257"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061258"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061258"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061257"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061258"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621679061260"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Word32 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061261"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061261"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061261"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-779"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-780"></span><span>    </span><span id="local-6989586621679061263"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Word32)] -&gt; UArray i Word32
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061264"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061264"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061265"><span class="annot"><span class="annottext">[(Int, Word32)]
</span><a href="#local-6989586621679061265"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word32)) -&gt; UArray i Word32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Word32)] -&gt; Word32 -&gt; ST s (UArray i Word32)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061264"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word32)]
</span><a href="#local-6989586621679061265"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-782"></span><span>    </span><span id="local-6989586621679061272"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Word32 -&gt; Int -&gt; Word32
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061273"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061274"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32# -&gt; Word32
</span><span class="hs-identifier hs-var">W32#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word32#
</span><span class="hs-identifier hs-var">indexWord32Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-784"></span><span>    </span><span id="local-6989586621679061277"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Word32 -&gt; [(Int, Word32)] -&gt; UArray i Word32
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061278"><span class="annot"><span class="annottext">UArray i Word32
</span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061279"><span class="annot"><span class="annottext">[(Int, Word32)]
</span><a href="#local-6989586621679061279"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word32)) -&gt; UArray i Word32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Word32 -&gt; [(Int, Word32)] -&gt; ST s (UArray i Word32)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word32
</span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word32)]
</span><a href="#local-6989586621679061279"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-786"></span><span>    </span><span id="local-6989586621679061283"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Word32 -&gt; e' -&gt; Word32)
-&gt; UArray i Word32 -&gt; [(Int, e')] -&gt; UArray i Word32
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061284"><span class="annot"><span class="annottext">Word32 -&gt; e' -&gt; Word32
</span><a href="#local-6989586621679061284"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061285"><span class="annot"><span class="annottext">UArray i Word32
</span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061286"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word32)) -&gt; UArray i Word32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32 -&gt; e' -&gt; Word32)
-&gt; UArray i Word32 -&gt; [(Int, e')] -&gt; ST s (UArray i Word32)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; e' -&gt; Word32
</span><a href="#local-6989586621679061284"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word32
</span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-788"></span><span>    </span><span id="local-6989586621679061290"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Word32 -&gt; e' -&gt; Word32)
-&gt; Word32 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Word32
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061291"><span class="annot"><span class="annottext">Word32 -&gt; e' -&gt; Word32
</span><a href="#local-6989586621679061291"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061292"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679061292"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061293"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061293"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061294"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061294"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word32)) -&gt; UArray i Word32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32 -&gt; e' -&gt; Word32)
-&gt; Word32 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Word32)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; e' -&gt; Word32
</span><a href="#local-6989586621679061291"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679061292"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061293"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061294"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bounds"><span class="hs-pragma hs-type">bounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-792"></span><span>    </span><span id="local-6989586621679061306"><span class="annot"><span class="annottext">bounds :: forall i. Ix i =&gt; UArray i Word64 -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679061307"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061307"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061308"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061308"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061307"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061308"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#numElements"><span class="hs-pragma hs-type">numElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-794"></span><span>    </span><span id="local-6989586621679061310"><span class="annot"><span class="annottext">numElements :: forall i. Ix i =&gt; UArray i Word64 -&gt; Int
</span><a href="Data.Array.Base.html#numElements"><span class="hs-identifier hs-var hs-var hs-var">numElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061311"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061311"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061311"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-795"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeArray"><span class="hs-pragma hs-type">unsafeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-796"></span><span>    </span><span id="local-6989586621679061313"><span class="annot"><span class="annottext">unsafeArray :: forall i. Ix i =&gt; (i, i) -&gt; [(Int, Word64)] -&gt; UArray i Word64
</span><a href="Data.Array.Base.html#unsafeArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeArray</span></a></span></span><span> </span><span id="local-6989586621679061314"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061314"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061315"><span class="annot"><span class="annottext">[(Int, Word64)]
</span><a href="#local-6989586621679061315"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word64)) -&gt; UArray i Word64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Word64)] -&gt; Word64 -&gt; ST s (UArray i Word64)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeArrayUArray"><span class="hs-identifier hs-var">unsafeArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061314"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word64)]
</span><a href="#local-6989586621679061315"><span class="hs-identifier hs-var">ies</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-pragma hs-type">unsafeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-798"></span><span>    </span><span id="local-6989586621679061322"><span class="annot"><span class="annottext">unsafeAt :: forall i. Ix i =&gt; UArray i Word64 -&gt; Int -&gt; Word64
</span><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-var hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061323"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061323"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061324"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061324"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64# -&gt; Word64
</span><span class="hs-identifier hs-var">W64#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word64#
</span><span class="hs-identifier hs-var">indexWord64Array#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679061323"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061324"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-pragma hs-type">unsafeReplace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621679061327"><span class="annot"><span class="annottext">unsafeReplace :: forall i.
Ix i =&gt;
UArray i Word64 -&gt; [(Int, Word64)] -&gt; UArray i Word64
</span><a href="Data.Array.Base.html#unsafeReplace"><span class="hs-identifier hs-var hs-var hs-var">unsafeReplace</span></a></span></span><span> </span><span id="local-6989586621679061328"><span class="annot"><span class="annottext">UArray i Word64
</span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061329"><span class="annot"><span class="annottext">[(Int, Word64)]
</span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word64)) -&gt; UArray i Word64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i Word64 -&gt; [(Int, Word64)] -&gt; ST s (UArray i Word64)
forall s e i.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
UArray i e -&gt; [(Int, e)] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeReplaceUArray"><span class="hs-identifier hs-var">unsafeReplaceUArray</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word64
</span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Word64)]
</span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-pragma hs-type">unsafeAccum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-802"></span><span>    </span><span id="local-6989586621679061333"><span class="annot"><span class="annottext">unsafeAccum :: forall i e'.
Ix i =&gt;
(Word64 -&gt; e' -&gt; Word64)
-&gt; UArray i Word64 -&gt; [(Int, e')] -&gt; UArray i Word64
</span><a href="Data.Array.Base.html#unsafeAccum"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccum</span></a></span></span><span> </span><span id="local-6989586621679061334"><span class="annot"><span class="annottext">Word64 -&gt; e' -&gt; Word64
</span><a href="#local-6989586621679061334"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061335"><span class="annot"><span class="annottext">UArray i Word64
</span><a href="#local-6989586621679061335"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061336"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061336"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word64)) -&gt; UArray i Word64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64 -&gt; e' -&gt; Word64)
-&gt; UArray i Word64 -&gt; [(Int, e')] -&gt; ST s (UArray i Word64)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; UArray i e -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumUArray"><span class="hs-identifier hs-var">unsafeAccumUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; e' -&gt; Word64
</span><a href="#local-6989586621679061334"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i Word64
</span><a href="#local-6989586621679061335"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061336"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-pragma hs-type">unsafeAccumArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-804"></span><span>    </span><span id="local-6989586621679061340"><span class="annot"><span class="annottext">unsafeAccumArray :: forall i e'.
Ix i =&gt;
(Word64 -&gt; e' -&gt; Word64)
-&gt; Word64 -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Word64
</span><a href="Data.Array.Base.html#unsafeAccumArray"><span class="hs-identifier hs-var hs-var hs-var">unsafeAccumArray</span></a></span></span><span> </span><span id="local-6989586621679061341"><span class="annot"><span class="annottext">Word64 -&gt; e' -&gt; Word64
</span><a href="#local-6989586621679061341"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061342"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679061342"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679061343"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679061344"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061344"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (UArray i Word64)) -&gt; UArray i Word64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64 -&gt; e' -&gt; Word64)
-&gt; Word64 -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i Word64)
forall s e i e'.
(MArray (STUArray s) e (ST s), Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#unsafeAccumArrayUArray"><span class="hs-identifier hs-var">unsafeAccumArrayUArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; e' -&gt; Word64
</span><a href="#local-6989586621679061341"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679061342"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679061344"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059422"><span id="local-6989586621679059423"><span id="local-6989586621679061352"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059422"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679059423"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059423"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059422"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059423"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-807"></span><span>    </span><span id="local-6989586621679061359"><span class="annot"><span class="annottext">== :: UArray ix e -&gt; UArray ix e -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray ix e -&gt; UArray ix e -&gt; Bool
forall e i.
(IArray UArray e, Ix i, Eq e) =&gt;
UArray i e -&gt; UArray i e -&gt; Bool
</span><a href="Data.Array.Base.html#eqUArray"><span class="hs-identifier hs-var">eqUArray</span></a></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059426"><span id="local-6989586621679059427"><span id="local-6989586621679061368"><span id="local-6989586621679061372"><span id="local-6989586621679061375"><span id="local-6989586621679061378"><span id="local-6989586621679061381"><span id="local-6989586621679061384"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059426"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679059427"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059427"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059426"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059427"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-810"></span><span>    </span><span id="local-6989586621679061390"><span class="annot"><span class="annottext">compare :: UArray ix e -&gt; UArray ix e -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray ix e -&gt; UArray ix e -&gt; Ordering
forall e i.
(IArray UArray e, Ix i, Ord e) =&gt;
UArray i e -&gt; UArray i e -&gt; Ordering
</span><a href="Data.Array.Base.html#cmpUArray"><span class="hs-identifier hs-var">cmpUArray</span></a></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059430"><span id="local-6989586621679059431"><span id="local-6989586621679061397"><span id="local-6989586621679061401"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059430"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059430"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059431"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059431"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059430"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059431"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-813"></span><span>    </span><span id="local-6989586621679061408"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; UArray ix e -&gt; [Char] -&gt; [Char]
</span><a href="#local-6989586621679061408"><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; UArray ix e -&gt; [Char] -&gt; [Char]
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i, Show i, Show e) =&gt;
Int -&gt; a i e -&gt; [Char] -&gt; [Char]
</span><a href="Data.Array.Base.html#showsIArray"><span class="hs-identifier hs-var">showsIArray</span></a></span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059435"><span id="local-6989586621679059436"><span id="local-6989586621679061415"><span id="local-6989586621679061419"><span id="local-6989586621679061423"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059435"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679059435"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679059436"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059436"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059435"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059436"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-816"></span><span>    </span><span id="local-6989586621679061430"><span class="annot"><span class="annottext">readPrec :: ReadPrec (UArray ix e)
</span><span class="hs-identifier hs-var hs-var hs-var">readPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadPrec (UArray ix e)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i, Read i, Read e) =&gt;
ReadPrec (a i e)
</span><a href="Data.Array.Base.html#readIArray"><span class="hs-identifier hs-var">readIArray</span></a></span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- Mutable arrays</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#arrEleBottom"><span class="hs-pragma hs-type">arrEleBottom</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-822"></span><span id="local-6989586621679059437"><span class="annot"><a href="Data.Array.Base.html#arrEleBottom"><span class="hs-identifier hs-type">arrEleBottom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679059437"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-823"></span><span id="arrEleBottom"><span class="annot"><span class="annottext">arrEleBottom :: forall a. a
</span><a href="Data.Array.Base.html#arrEleBottom"><span class="hs-identifier hs-var hs-var">arrEleBottom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MArray: undefined array element&quot;</span></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="annot"><span class="hs-comment">{-| Class of mutable array types.

An array type has the form @(a i e)@ where @a@ is the array type
constructor (kind @* -&gt; * -&gt; *@), @i@ is the index type (a member of
the class 'Ix'), and @e@ is the element type.

The @MArray@ class is parameterised over both @a@ and @e@ (so that
instances specialised to certain element types can be defined, in the
same way as for 'IArray'), and also over the type of the monad, @m@,
in which the mutable array will be manipulated.
-}</span></span><span>
</span><span id="line-836"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MArray"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-var">MArray</span></a></span></span><span> </span><span id="local-6989586621679058913"><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679058914"><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679058915"><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-comment">-- | Returns the bounds of the array (lowest,highest).</span><span>
</span><span id="line-838"></span><span>    </span><span id="getBounds"><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-type">getBounds</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059443"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-comment">-- | Returns the number of elements in the array.</span><span>
</span><span id="line-840"></span><span>    </span><span id="getNumElements"><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059446"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059446"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059446"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-comment">-- | Builds a new array, with every element initialised to the supplied</span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-comment">-- value. The first and second element of the tuple specifies the lowest</span><span>
</span><span id="line-844"></span><span>    </span><span class="hs-comment">-- and highest index, respectively.</span><span>
</span><span id="line-845"></span><span>    </span><span id="newArray"><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-type">newArray</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058927"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>    </span><span class="hs-comment">-- | Builds a new array, with every element initialised to an</span><span>
</span><span id="line-848"></span><span>    </span><span class="hs-comment">-- undefined value. In a monadic context in which operations must</span><span>
</span><span id="line-849"></span><span>    </span><span class="hs-comment">-- be deterministic (e.g. the ST monad), the array elements are</span><span>
</span><span id="line-850"></span><span>    </span><span class="hs-comment">-- initialised to a fixed but undefined value, such as zero.</span><span>
</span><span id="line-851"></span><span>    </span><span class="hs-comment">-- The first and second element of the tuple specifies the lowest</span><span>
</span><span id="line-852"></span><span>    </span><span class="hs-comment">-- and highest index, respectively.</span><span>
</span><span id="line-853"></span><span>    </span><span id="newArray_"><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-type">newArray_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059447"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059447"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059447"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059447"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059447"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>    </span><span class="hs-comment">-- | Builds a new array, with every element initialised to an undefined</span><span>
</span><span id="line-856"></span><span>    </span><span class="hs-comment">-- value. The first and second element of the tuple specifies the lowest</span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-comment">-- and highest index, respectively.</span><span>
</span><span id="line-858"></span><span>    </span><span id="unsafeNewArray_"><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-type">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059440"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059440"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059440"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059440"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059440"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>    </span><span id="unsafeRead"><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058922"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058922"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058922"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-861"></span><span>    </span><span id="unsafeWrite"><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679058912"><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058912"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058912"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058914"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-pragma hs-type">newArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-864"></span><span>        </span><span class="hs-comment">-- The INLINE is crucial, because until we know at least which monad</span><span>
</span><span id="line-865"></span><span>        </span><span class="hs-comment">-- we are in, the code below allocates like crazy.  So inline it,</span><span>
</span><span id="line-866"></span><span>        </span><span class="hs-comment">-- in the hope that the context will know the monad.</span><span>
</span><span id="line-867"></span><span>    </span><span id="local-6989586621679061439"><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061457"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061457"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061458"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061458"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061459"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061459"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-868"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061463"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679061463"><span class="hs-identifier hs-var hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061457"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061458"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>        </span><span id="local-6989586621679061464"><span class="annot"><a href="#local-6989586621679061464"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var">unsafeNewArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061457"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061458"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061464"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061465"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061459"><span class="hs-identifier hs-type">initialValue</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061465"><span class="annot"><a href="#local-6989586621679061465"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679061463"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-871"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679061464"><span class="hs-identifier hs-type">marr</span></a></span></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-874"></span><span>    </span><span id="local-6989586621679061466"><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var">unsafeNewArray_</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061470"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061470"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061471"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061471"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; e -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061470"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061471"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
forall a. a
</span><a href="Data.Array.Base.html#arrEleBottom"><span class="hs-identifier hs-var">arrEleBottom</span></a></span></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-877"></span><span>    </span><span id="local-6989586621679061472"><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061476"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061476"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061477"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061477"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; e -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061476"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061477"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
forall a. a
</span><a href="Data.Array.Base.html#arrEleBottom"><span class="hs-identifier hs-var">arrEleBottom</span></a></span></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span>    </span><span class="hs-comment">-- newArray takes an initialiser which all elements of</span><span>
</span><span id="line-880"></span><span>    </span><span class="hs-comment">-- the newly created array are initialised to.  unsafeNewArray_ takes</span><span>
</span><span id="line-881"></span><span>    </span><span class="hs-comment">-- no initialiser, it is assumed that the array is initialised with</span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-comment">-- &quot;undefined&quot; values.</span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-comment">-- why not omit unsafeNewArray_?  Because in the unboxed array</span><span>
</span><span id="line-885"></span><span>    </span><span class="hs-comment">-- case we would like to omit the initialisation altogether if</span><span>
</span><span id="line-886"></span><span>    </span><span class="hs-comment">-- possible.  We can't do this for boxed arrays, because the</span><span>
</span><span id="line-887"></span><span>    </span><span class="hs-comment">-- elements must all have valid values at all times in case of</span><span>
</span><span id="line-888"></span><span>    </span><span class="hs-comment">-- garbage collection.</span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span>    </span><span class="hs-comment">-- why not omit newArray?  Because in the boxed case, we can omit the</span><span>
</span><span id="line-891"></span><span>    </span><span class="hs-comment">-- default initialisation with undefined values if we *do* know the</span><span>
</span><span id="line-892"></span><span>    </span><span class="hs-comment">-- initial value and it is constant for all elements.</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-pragma hs-type">newArray</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059450"><span id="local-6989586621679061485"><span id="local-6989586621679061491"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679059450"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-898"></span><span>    </span><span id="local-6989586621679061501"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; IOArray i e -&gt; IO (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span id="local-6989586621679061503"><span class="annot"><span class="annottext">STArray RealWorld i e
</span><a href="#local-6989586621679061503"><span class="hs-identifier hs-var">marr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld (i, i) -&gt; IO (i, i)
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="annot"><span class="annottext">(ST RealWorld (i, i) -&gt; IO (i, i))
-&gt; ST RealWorld (i, i) -&gt; IO (i, i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld i e -&gt; ST RealWorld (i, i)
forall i. Ix i =&gt; STArray RealWorld i e -&gt; ST RealWorld (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld i e
</span><a href="#local-6989586621679061503"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-899"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-900"></span><span>    </span><span id="local-6989586621679061507"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; IOArray i e -&gt; IO Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span id="local-6989586621679061508"><span class="annot"><span class="annottext">STArray RealWorld i e
</span><a href="#local-6989586621679061508"><span class="hs-identifier hs-var">marr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld Int -&gt; IO Int
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="annot"><span class="annottext">(ST RealWorld Int -&gt; IO Int) -&gt; ST RealWorld Int -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld i e -&gt; ST RealWorld Int
forall i. Ix i =&gt; STArray RealWorld i e -&gt; ST RealWorld Int
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var">getNumElements</span></a></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld i e
</span><a href="#local-6989586621679061508"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-901"></span><span>    </span><span id="local-6989586621679061511"><span class="annot"><span class="annottext">newArray :: forall i. Ix i =&gt; (i, i) -&gt; e -&gt; IO (IOArray i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var hs-var hs-var">newArray</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; IO (IOArray i e)
forall i e. Ix i =&gt; (i, i) -&gt; e -&gt; IO (IOArray i e)
</span><span class="hs-identifier hs-var">newIOArray</span></span><span>
</span><span id="line-902"></span><span>    </span><span id="local-6989586621679061513"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; IOArray i e -&gt; Int -&gt; IO e
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOArray i e -&gt; Int -&gt; IO e
forall i e. IOArray i e -&gt; Int -&gt; IO e
</span><span class="hs-identifier hs-var">unsafeReadIOArray</span></span><span>
</span><span id="line-903"></span><span>    </span><span id="local-6989586621679061515"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; IOArray i e -&gt; Int -&gt; e -&gt; IO ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOArray i e -&gt; Int -&gt; e -&gt; IO ()
forall i e. IOArray i e -&gt; Int -&gt; e -&gt; IO ()
</span><span class="hs-identifier hs-var">unsafeWriteIOArray</span></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newListArray"><span class="hs-pragma hs-type">newListArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>   </span><span class="hs-comment">-- See Note [Inlining and fusion]</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- | Constructs a mutable array from a list of initial elements.</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- The list gives the elements of the array in ascending order</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- beginning with the lowest index. The first and second element</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- of the tuple specifies the lowest and highest index, respectively.</span><span>
</span><span id="line-910"></span><span id="local-6989586621679058962"><span id="local-6989586621679058963"><span id="local-6989586621679058964"><span id="local-6989586621679058965"><span class="annot"><a href="Data.Array.Base.html#newListArray"><span class="hs-identifier hs-type">newListArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058965"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058965"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679058965"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058965"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-911"></span><span id="newListArray"><span class="annot"><span class="annottext">newListArray :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newListArray"><span class="hs-identifier hs-var hs-var">newListArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061530"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061530"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061531"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061531"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061532"><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679061532"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-912"></span><span>    </span><span id="local-6989586621679061533"><span class="annot"><a href="#local-6989586621679061533"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061530"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061531"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061537"><span class="annot"><a href="#local-6989586621679061537"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061530"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061531"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>        </span><span id="local-6989586621679061558"><span class="annot"><a href="#local-6989586621679061558"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061559"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061559"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061560"><span class="annot"><span class="annottext">Int -&gt; m ()
</span><a href="#local-6989586621679061560"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679061561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061561"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-915"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061561"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061537"><span class="hs-identifier hs-var">n</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; Int -&gt; e -&gt; m ()
forall i. Ix i =&gt; a i e -&gt; Int -&gt; e -&gt; m ()
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; Int -&gt; e -&gt; m ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var">unsafeWrite</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061533"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061561"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061559"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m ()
</span><a href="#local-6989586621679061560"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061561"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><a href="#local-6989586621679061558"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679061563"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061563"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061532"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-918"></span><span>    </span><span class="hs-comment">-- The bang above is important for GHC for unbox the Int.</span><span>
</span><span id="line-919"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679061533"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newGenArray"><span class="hs-pragma hs-type">newGenArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-922"></span><span class="hs-comment">-- | Constructs a mutable array using a generator function.</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- It invokes the generator function in ascending order of the indices.</span><span>
</span><span id="line-924"></span><span id="local-6989586621679059471"><span id="local-6989586621679059472"><span id="local-6989586621679059473"><span id="local-6989586621679059474"><span class="annot"><a href="Data.Array.Base.html#newGenArray"><span class="hs-identifier hs-type">newGenArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059472"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059473"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059474"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059474"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059474"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059474"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059473"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059472"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059473"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059474"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059472"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-925"></span><span id="newGenArray"><span class="annot"><span class="annottext">newGenArray :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; (i -&gt; m e) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newGenArray"><span class="hs-identifier hs-var hs-var">newGenArray</span></a></span></span><span> </span><span id="local-6989586621679061581"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061581"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621679061582"><span class="annot"><span class="annottext">i -&gt; m e
</span><a href="#local-6989586621679061582"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-926"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061586"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679061586"><span class="hs-identifier hs-var hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061581"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-927"></span><span>    </span><span id="local-6989586621679061587"><span class="annot"><a href="#local-6989586621679061587"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var">unsafeNewArray_</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061581"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-928"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061603"><span class="annot"><a href="#local-6989586621679061603"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679061604"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061604"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679061605"><span class="annot"><span class="annottext">Int -&gt; m ()
</span><a href="#local-6989586621679061605"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679061606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061606"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-929"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061606"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061586"><span class="hs-identifier hs-var">n</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>                </span><span id="local-6989586621679061607"><span class="annot"><a href="#local-6989586621679061607"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">i -&gt; m e
</span><a href="#local-6989586621679061582"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061604"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-932"></span><span>                </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061587"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061606"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061607"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-933"></span><span>                </span><span class="annot"><a href="#local-6989586621679061605"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061606"><span class="hs-identifier hs-type">i</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><a href="#local-6989586621679061603"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679061608"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061608"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">range</span></span><span> </span><span class="annot"><a href="#local-6989586621679061581"><span class="hs-identifier hs-type">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-935"></span><span>    </span><span class="hs-comment">-- The bang above is important for GHC for unbox the Int.</span><span>
</span><span id="line-936"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679061587"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#readArray"><span class="hs-pragma hs-type">readArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-939"></span><span class="annot"><span class="hs-comment">-- | Read an element from a mutable array</span></span><span>
</span><span id="line-940"></span><span id="local-6989586621679059479"><span id="local-6989586621679059480"><span id="local-6989586621679059481"><span id="local-6989586621679059482"><span class="annot"><a href="Data.Array.Base.html#readArray"><span class="hs-identifier hs-type">readArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059480"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059481"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059482"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059482"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059480"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059482"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059481"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059480"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-941"></span><span id="readArray"><span class="annot"><span class="annottext">readArray :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="Data.Array.Base.html#readArray"><span class="hs-identifier hs-var hs-var">readArray</span></a></span></span><span> </span><span id="local-6989586621679061622"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061622"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span id="local-6989586621679061623"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061623"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061624"><span class="annot"><a href="#local-6989586621679061624"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061625"><span class="annot"><a href="#local-6989586621679061625"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061622"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-943"></span><span>  </span><span id="local-6989586621679061626"><span class="annot"><a href="#local-6989586621679061626"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061622"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-944"></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061622"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-type">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061624"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061625"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061626"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061623"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#writeArray"><span class="hs-pragma hs-type">writeArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-947"></span><span class="annot"><span class="hs-comment">-- | Write an element in a mutable array</span></span><span>
</span><span id="line-948"></span><span id="local-6989586621679059487"><span id="local-6989586621679059488"><span id="local-6989586621679059489"><span id="local-6989586621679059490"><span class="annot"><a href="Data.Array.Base.html#writeArray"><span class="hs-identifier hs-type">writeArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059488"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059489"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059490"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059490"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059488"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059490"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059488"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059489"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-949"></span><span id="writeArray"><span class="annot"><span class="annottext">writeArray :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="Data.Array.Base.html#writeArray"><span class="hs-identifier hs-var hs-var">writeArray</span></a></span></span><span> </span><span id="local-6989586621679061640"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061640"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span id="local-6989586621679061641"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061641"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679061642"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061642"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-950"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061643"><span class="annot"><a href="#local-6989586621679061643"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061644"><span class="annot"><a href="#local-6989586621679061644"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061640"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621679061645"><span class="annot"><a href="#local-6989586621679061645"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061640"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061640"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-type">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061643"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061644"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061645"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061641"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061642"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#modifyArray"><span class="hs-pragma hs-type">modifyArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- | Modify an element in a mutable array</span><span>
</span><span id="line-956"></span><span class="hs-comment">--</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- @since 0.5.6.0</span><span>
</span><span id="line-958"></span><span id="local-6989586621679059495"><span id="local-6989586621679059496"><span id="local-6989586621679059497"><span id="local-6989586621679059498"><span class="annot"><a href="Data.Array.Base.html#modifyArray"><span class="hs-identifier hs-type">modifyArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059496"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059497"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059498"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059498"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059496"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059498"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059496"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059496"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-959"></span><span id="modifyArray"><span class="annot"><span class="annottext">modifyArray :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; (e -&gt; e) -&gt; m ()
</span><a href="Data.Array.Base.html#modifyArray"><span class="hs-identifier hs-var hs-var">modifyArray</span></a></span></span><span> </span><span id="local-6989586621679061663"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061663"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span id="local-6989586621679061664"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061664"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679061665"><span class="annot"><span class="annottext">e -&gt; e
</span><a href="#local-6989586621679061665"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061666"><span class="annot"><a href="#local-6989586621679061666"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061667"><span class="annot"><a href="#local-6989586621679061667"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061663"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621679061668"><span class="annot"><a href="#local-6989586621679061668"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061663"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061672"><span class="annot"><a href="#local-6989586621679061672"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061666"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061667"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061668"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061664"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-963"></span><span>  </span><span id="local-6989586621679061673"><span class="annot"><a href="#local-6989586621679061673"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061663"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061672"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-964"></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061663"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061672"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061665"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061673"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-965"></span><span>
</span><span id="line-966"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#modifyArray%27"><span class="hs-pragma hs-type">modifyArray'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- | Modify an element in a mutable array. Strict in the written element.</span><span>
</span><span id="line-968"></span><span class="hs-comment">--</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- @since 0.5.6.0</span><span>
</span><span id="line-970"></span><span id="local-6989586621679061675"><span id="local-6989586621679061676"><span id="local-6989586621679061677"><span id="local-6989586621679061678"><span class="annot"><a href="Data.Array.Base.html#modifyArray%27"><span class="hs-identifier hs-type">modifyArray'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061676"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679061678"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061678"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061676"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061678"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061676"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061676"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061677"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-971"></span><span id="modifyArray%27"><span class="annot"><span class="annottext">modifyArray' :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; (e -&gt; e) -&gt; m ()
</span><a href="Data.Array.Base.html#modifyArray%27"><span class="hs-identifier hs-var hs-var">modifyArray'</span></a></span></span><span> </span><span id="local-6989586621679061695"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061695"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span id="local-6989586621679061696"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061696"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679061697"><span class="annot"><span class="annottext">e -&gt; e
</span><a href="#local-6989586621679061697"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061698"><span class="annot"><a href="#local-6989586621679061698"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061699"><span class="annot"><a href="#local-6989586621679061699"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061695"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-973"></span><span>  </span><span id="local-6989586621679061700"><span class="annot"><a href="#local-6989586621679061700"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061695"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679061704"><span class="annot"><a href="#local-6989586621679061704"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; i -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; i -&gt; Int
</span><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-var">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061698"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061699"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061700"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061696"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-975"></span><span>  </span><span id="local-6989586621679061705"><span class="annot"><a href="#local-6989586621679061705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061695"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061704"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679061706"><span class="annot"><a href="#local-6989586621679061706"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; e
</span><a href="#local-6989586621679061697"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061705"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-977"></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061695"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061704"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061706"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getElems"><span class="hs-pragma hs-type">getElems</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-980"></span><span class="annot"><span class="hs-comment">-- | Return a list of all the elements of a mutable array</span></span><span>
</span><span id="line-981"></span><span id="local-6989586621679059507"><span id="local-6989586621679059508"><span id="local-6989586621679059509"><span id="local-6989586621679059510"><span class="annot"><a href="Data.Array.Base.html#getElems"><span class="hs-identifier hs-type">getElems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059508"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059509"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059510"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059510"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059508"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059509"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059508"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-982"></span><span id="getElems"><span class="annot"><span class="annottext">getElems :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m [e]
</span><a href="Data.Array.Base.html#getElems"><span class="hs-identifier hs-var hs-var">getElems</span></a></span></span><span> </span><span id="local-6989586621679061726"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061726"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061727"><span class="annot"><a href="#local-6989586621679061727"><span class="hs-identifier hs-var">_l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061728"><span class="annot"><a href="#local-6989586621679061728"><span class="hs-identifier hs-var">_u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061726"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-984"></span><span>  </span><span id="local-6989586621679061729"><span class="annot"><a href="#local-6989586621679061729"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061726"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-985"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">sequence</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061726"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061731"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061731"><span class="annot"><a href="#local-6989586621679061731"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679061729"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getAssocs"><span class="hs-pragma hs-type">getAssocs</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- | Return a list of all the associations of a mutable array, in</span><span>
</span><span id="line-989"></span><span class="hs-comment">-- index order.</span><span>
</span><span id="line-990"></span><span id="local-6989586621679059518"><span id="local-6989586621679059519"><span id="local-6989586621679059520"><span id="local-6989586621679059521"><span class="annot"><a href="Data.Array.Base.html#getAssocs"><span class="hs-identifier hs-type">getAssocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059518"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059519"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059520"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059521"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059518"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059521"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059519"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059520"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059521"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059519"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-991"></span><span id="getAssocs"><span class="annot"><span class="annottext">getAssocs :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m [(i, e)]
</span><a href="Data.Array.Base.html#getAssocs"><span class="hs-identifier hs-var hs-var">getAssocs</span></a></span></span><span> </span><span id="local-6989586621679061750"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061750"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-992"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061751"><span class="annot"><a href="#local-6989586621679061751"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061752"><span class="annot"><a href="#local-6989586621679061752"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679061750"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span id="local-6989586621679061753"><span class="annot"><a href="#local-6989586621679061753"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061750"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-994"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">sequence</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679061754"><span class="annot"><a href="#local-6989586621679061754"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061750"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-type">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061751"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061752"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061753"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061755"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061755"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061754"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061755"><span class="annot"><a href="#local-6989586621679061755"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061751"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061752"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-996"></span><span>
</span><span id="line-997"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#mapArray"><span class="hs-pragma hs-type">mapArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- | Constructs a new array derived from the original array by applying a</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- function to each of the elements.</span><span>
</span><span id="line-1000"></span><span id="local-6989586621679059526"><span id="local-6989586621679059527"><span id="local-6989586621679059528"><span id="local-6989586621679059529"><span id="local-6989586621679059530"><span class="annot"><a href="Data.Array.Base.html#mapArray"><span class="hs-identifier hs-type">mapArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059527"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059528"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059529"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059528"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059530"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059527"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059529"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059530"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059527"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059528"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059530"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059529"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1001"></span><span id="mapArray"><span class="annot"><span class="annottext">mapArray :: forall (a :: * -&gt; * -&gt; *) e' (m :: * -&gt; *) e i.
(MArray a e' m, MArray a e m, Ix i) =&gt;
(e' -&gt; e) -&gt; a i e' -&gt; m (a i e)
</span><a href="Data.Array.Base.html#mapArray"><span class="hs-identifier hs-var hs-var">mapArray</span></a></span></span><span> </span><span id="local-6989586621679061783"><span class="annot"><span class="annottext">e' -&gt; e
</span><a href="#local-6989586621679061783"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061784"><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679061784"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1002"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679061785"><span class="annot"><a href="#local-6989586621679061785"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061786"><span class="annot"><a href="#local-6989586621679061786"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e' -&gt; m (i, i)
forall i. Ix i =&gt; a i e' -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e'
</span><a href="#local-6989586621679061784"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-1003"></span><span>  </span><span id="local-6989586621679061787"><span class="annot"><a href="#local-6989586621679061787"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061784"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-1004"></span><span>  </span><span id="local-6989586621679061788"><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-var">marr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-type">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061785"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061786"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679061789"><span class="annot"><a href="#local-6989586621679061789"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061784"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061790"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1006"></span><span>                </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-type">marr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061790"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061789"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061790"><span class="annot"><a href="#local-6989586621679061790"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679061787"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1008"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-type">marr'</span></a></span><span>
</span><span id="line-1009"></span><span>
</span><span id="line-1010"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#mapIndices"><span class="hs-pragma hs-type">mapIndices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- | Constructs a new array derived from the original array by applying a</span><span>
</span><span id="line-1012"></span><span class="hs-comment">-- function to each of the indices.</span><span>
</span><span id="line-1013"></span><span id="local-6989586621679059536"><span id="local-6989586621679059537"><span id="local-6989586621679059538"><span id="local-6989586621679059539"><span id="local-6989586621679059540"><span class="annot"><a href="Data.Array.Base.html#mapIndices"><span class="hs-identifier hs-type">mapIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059536"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059538"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059539"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059540"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059539"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059539"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059539"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059540"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059536"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059540"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059538"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059536"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059539"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059537"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1014"></span><span id="mapIndices"><span class="annot"><span class="annottext">mapIndices :: forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i j.
(MArray a e m, Ix i, Ix j) =&gt;
(i, i) -&gt; (i -&gt; j) -&gt; a j e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#mapIndices"><span class="hs-identifier hs-var hs-var">mapIndices</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061813"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061813"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061814"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061814"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061815"><span class="annot"><span class="annottext">i -&gt; j
</span><a href="#local-6989586621679061815"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061816"><span class="annot"><span class="annottext">a j e
</span><a href="#local-6989586621679061816"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1015"></span><span>    </span><span id="local-6989586621679061817"><span class="annot"><a href="#local-6989586621679061817"><span class="hs-identifier hs-var">marr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; m (a i e)
forall i. Ix i =&gt; (i, i) -&gt; m (a i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061813"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061814"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>    </span><span id="local-6989586621679061818"><span class="annot"><a href="#local-6989586621679061818"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061817"><span class="hs-identifier hs-type">marr'</span></a></span><span>
</span><span id="line-1017"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679061819"><span class="annot"><a href="#local-6989586621679061819"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#readArray"><span class="hs-identifier hs-type">readArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061816"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">i'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>                  </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061817"><span class="hs-identifier hs-type">marr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#safeIndex"><span class="hs-identifier hs-type">safeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061813"><span class="hs-identifier hs-type">l'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">u'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061818"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">i'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679061819"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1019"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061820"><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061813"><span class="hs-identifier hs-type">l'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">u'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1020"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679061817"><span class="hs-identifier hs-type">marr'</span></a></span><span>
</span><span id="line-1021"></span><span>
</span><span id="line-1022"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- Polymorphic non-strict mutable arrays (ST monad)</span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058856"><span id="local-6989586621679058857"><span id="local-6989586621679061827"><span id="local-6989586621679061832"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679058856"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679058857"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679058856"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1026"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1027"></span><span>    </span><span id="local-6989586621679061840"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STArray s i e -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span id="local-6989586621679061841"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061841"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((i, i) -&gt; ST s (i, i)) -&gt; (i, i) -&gt; ST s (i, i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; (i, i)
forall s i e. STArray s i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">ArrST.boundsSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061841"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-1028"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1029"></span><span>    </span><span id="local-6989586621679061846"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STArray s i e -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span id="local-6989586621679061847"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061847"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; Int
forall s i e. STArray s i e -&gt; Int
</span><span class="hs-identifier hs-var">ArrST.numElementsSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061847"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-1030"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-pragma hs-type">newArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1031"></span><span>    </span><span id="local-6989586621679061851"><span class="annot"><span class="annottext">newArray :: forall i. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var hs-var hs-var">newArray</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; ST s (STArray s i e)
forall i e s. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STArray s i e)
</span><span class="hs-identifier hs-var">ArrST.newSTArray</span></span><span>
</span><span id="line-1032"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1033"></span><span>    </span><span id="local-6989586621679061854"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STArray s i e -&gt; Int -&gt; ST s e
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; Int -&gt; ST s e
forall s i e. STArray s i e -&gt; Int -&gt; ST s e
</span><span class="hs-identifier hs-var">ArrST.unsafeReadSTArray</span></span><span>
</span><span id="line-1034"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1035"></span><span>    </span><span id="local-6989586621679061857"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
forall s i e. STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
</span><span class="hs-identifier hs-var">ArrST.unsafeWriteSTArray</span></span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059579"><span id="local-6989586621679059580"><span id="local-6989586621679061866"><span id="local-6989586621679061872"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679059579"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059580"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lazy.ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059579"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1038"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1039"></span><span>    </span><span id="local-6989586621679061880"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STArray s i e -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span id="local-6989586621679061881"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061881"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s (i, i) -&gt; ST s (i, i)
forall s a. ST s a -&gt; ST s a
</span><span class="hs-identifier hs-var">strictToLazyST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((i, i) -&gt; ST s (i, i)) -&gt; (i, i) -&gt; ST s (i, i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; (i, i)
forall s i e. STArray s i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">ArrST.boundsSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061881"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1041"></span><span>    </span><span id="local-6989586621679061884"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STArray s i e -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span id="local-6989586621679061885"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061885"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s Int -&gt; ST s Int
forall s a. ST s a -&gt; ST s a
</span><span class="hs-identifier hs-var">strictToLazyST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e -&gt; Int
forall s i e. STArray s i e -&gt; Int
</span><span class="hs-identifier hs-var">ArrST.numElementsSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061885"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-pragma hs-type">newArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1043"></span><span>    </span><span id="local-6989586621679061888"><span class="annot"><span class="annottext">newArray :: forall i. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STArray s i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var hs-var hs-var">newArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061889"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061889"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061890"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061890"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061891"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">e</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s (STArray s i e) -&gt; ST s (STArray s i e)
forall s a. ST s a -&gt; ST s a
</span><span class="hs-identifier hs-var">strictToLazyST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i, i) -&gt; e -&gt; ST s (STArray s i e)
forall i e s. Ix i =&gt; (i, i) -&gt; e -&gt; ST s (STArray s i e)
</span><span class="hs-identifier hs-var">ArrST.newSTArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061889"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061890"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1045"></span><span>    </span><span id="local-6989586621679061893"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STArray s i e -&gt; Int -&gt; ST s e
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span id="local-6989586621679061894"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061894"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061895"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061895"><span class="hs-identifier hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s e -&gt; ST s e
forall s a. ST s a -&gt; ST s a
</span><span class="hs-identifier hs-var">strictToLazyST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STArray s i e -&gt; Int -&gt; ST s e
forall s i e. STArray s i e -&gt; Int -&gt; ST s e
</span><span class="hs-identifier hs-var">ArrST.unsafeReadSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061894"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061895"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1047"></span><span>    </span><span id="local-6989586621679061897"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span id="local-6989586621679061898"><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061898"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679061899"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061899"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679061900"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061900"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; ST s ()
forall s a. ST s a -&gt; ST s a
</span><span class="hs-identifier hs-var">strictToLazyST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
forall s i e. STArray s i e -&gt; Int -&gt; e -&gt; ST s ()
</span><span class="hs-identifier hs-var">ArrST.unsafeWriteSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray s i e
</span><a href="#local-6989586621679061898"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061899"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679061900"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- Flat unboxed mutable arrays (ST monad)</span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span class="hs-comment">-- | A mutable array with unboxed elements, that can be manipulated in</span><span>
</span><span id="line-1053"></span><span class="hs-comment">-- the 'ST' monad.  The type arguments are as follows:</span><span>
</span><span id="line-1054"></span><span class="hs-comment">--</span><span>
</span><span id="line-1055"></span><span class="hs-comment">--  * @s@: the state variable argument for the 'ST' type</span><span>
</span><span id="line-1056"></span><span class="hs-comment">--</span><span>
</span><span id="line-1057"></span><span class="hs-comment">--  * @i@: the index type of the array (should be an instance of @Ix@)</span><span>
</span><span id="line-1058"></span><span class="hs-comment">--</span><span>
</span><span id="line-1059"></span><span class="hs-comment">--  * @e@: the element type of the array.  Only certain element types</span><span>
</span><span id="line-1060"></span><span class="hs-comment">--    are supported.</span><span>
</span><span id="line-1061"></span><span class="hs-comment">--</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- An 'STUArray' will generally be more efficient (in terms of both time</span><span>
</span><span id="line-1063"></span><span class="hs-comment">-- and space) than the equivalent boxed version ('STArray') with the same</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- element type.  However, 'STUArray' is strict in its elements - so</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- don\'t use 'STUArray' if you require the non-strictness that</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- 'STArray' provides.</span><span>
</span><span id="line-1067"></span><span class="hs-keyword">data</span><span> </span><span id="STUArray"><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span></span><span> </span><span id="local-6989586621679059602"><span class="annot"><a href="#local-6989586621679059602"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679059601"><span class="annot"><a href="#local-6989586621679059601"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679059603"><span class="annot"><a href="#local-6989586621679059603"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="STUArray"><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679059601"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679059601"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MutableByteArray#</span></span><span> </span><span class="annot"><a href="#local-6989586621679059602"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- The &quot;ST&quot; parameter must be nominal for the safety of the ST trick.</span><span>
</span><span id="line-1069"></span><span class="hs-comment">-- The other parameters have class constraints. See also #9220.</span><span>
</span><span id="line-1070"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span>
</span><span id="line-1071"></span><span>
</span><span id="line-1072"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059591"><span id="local-6989586621679059592"><span id="local-6989586621679059593"><span id="local-6989586621679061903"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059591"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059592"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059593"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1073"></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061906"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061906"><span class="hs-identifier hs-var">arr1#</span></a></span></span><span> </span><span id="local-6989586621679061907"><span class="annot"><span class="annottext">== :: STUArray s i e -&gt; STUArray s i e -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061908"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061908"><span class="hs-identifier hs-var">arr2#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1074"></span><span>        </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; MutableByteArray# s -&gt; Int#
forall s. MutableByteArray# s -&gt; MutableByteArray# s -&gt; Int#
</span><span class="hs-identifier hs-var">sameMutableByteArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061906"><span class="hs-identifier hs-var">arr1#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061908"><span class="hs-identifier hs-var">arr2#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1075"></span><span>
</span><span id="line-1076"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-pragma hs-type">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1077"></span><span id="local-6989586621679059595"><span id="local-6989586621679059596"><span id="local-6989586621679059597"><span class="annot"><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-type">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679059595"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1078"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059595"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059595"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059595"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1079"></span><span id="unsafeNewArraySTUArray_"><span class="annot"><span class="annottext">unsafeNewArraySTUArray_ :: forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var hs-var">unsafeNewArraySTUArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061913"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061913"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061914"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061914"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061915"><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="#local-6989586621679061915"><span class="hs-identifier hs-var">elemsToBytes</span></a></span></span><span>
</span><span id="line-1080"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><span class="hs-identifier hs-var">rangeSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061913"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061914"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1081"></span><span>       </span><span id="local-6989586621679061916"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679061916"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061917"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061917"><span class="hs-identifier hs-var">n#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1082"></span><span>           </span><span class="annot"><span class="annottext">STRep s (STUArray s i e) -&gt; ST s (STUArray s i e)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (STUArray s i e) -&gt; ST s (STUArray s i e))
-&gt; STRep s (STUArray s i e) -&gt; ST s (STUArray s i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061918"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061918"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1083"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; (# State# s, MutableByteArray# s #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><span class="hs-identifier hs-var">newByteArray#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="#local-6989586621679061915"><span class="hs-identifier hs-var">elemsToBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061917"><span class="hs-identifier hs-var">n#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061918"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1084"></span><span>                   </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679061919"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061919"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061920"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061920"><span class="hs-identifier hs-var">marr#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1085"></span><span>                       </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061919"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
forall s i e.
i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
</span><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061913"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061914"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061916"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061920"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-1086"></span><span>
</span><span id="line-1087"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059166"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059166"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059166"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1088"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1089"></span><span>    </span><span id="local-6989586621679061932"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Bool -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679061933"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061933"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679061934"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061934"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061933"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061934"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1091"></span><span>    </span><span id="local-6989586621679061937"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Bool -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061938"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061938"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061938"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1092"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray"><span class="hs-pragma hs-type">newArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1093"></span><span>    </span><span id="local-6989586621679061941"><span class="annot"><span class="annottext">newArray :: forall i. Ix i =&gt; (i, i) -&gt; Bool -&gt; ST s (STUArray s i Bool)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var hs-var hs-var">newArray</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061942"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061942"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061943"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061943"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061944"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061944"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (STUArray s i Bool) -&gt; ST s (STUArray s i Bool)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (STUArray s i Bool) -&gt; ST s (STUArray s i Bool))
-&gt; STRep s (STUArray s i Bool) -&gt; ST s (STUArray s i Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061945"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061945"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061942"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061943"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>                   </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061946"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679061946"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061947"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061947"><span class="hs-identifier hs-var">n#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1095"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_SCALE"><span class="hs-identifier hs-var">bOOL_SCALE</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061947"><span class="hs-identifier hs-var">n#</span></a></span><span>                         </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061949"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061949"><span class="hs-identifier hs-var">nbytes#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; (# State# s, MutableByteArray# s #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><span class="hs-identifier hs-var">newByteArray#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061949"><span class="hs-identifier hs-var">nbytes#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061945"><span class="hs-identifier hs-var">s1#</span></a></span><span>             </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679061950"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061950"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061951"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061951"><span class="hs-identifier hs-var">marr#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1097"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int# -&gt; Int# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int# -&gt; Int# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">setByteArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061951"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061949"><span class="hs-identifier hs-var">nbytes#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061952"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061950"><span class="hs-identifier hs-var">s2#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061953"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061953"><span class="hs-identifier hs-var">s3#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1098"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061953"><span class="hs-identifier hs-var">s3#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i Bool
forall s i e.
i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
</span><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061942"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061943"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679061946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061951"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1099"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1100"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061952"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061952"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061944"><span class="hs-identifier hs-var">initialValue</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xff</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x0</span></span><span>
</span><span id="line-1101"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1102"></span><span>    </span><span id="local-6989586621679061958"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Bool)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061959"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061959"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679061960"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Bool)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061959"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_SCALE"><span class="hs-identifier hs-var">bOOL_SCALE</span></a></span><span>
</span><span id="line-1103"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1104"></span><span>    </span><span id="local-6989586621679061964"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Bool)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679061965"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Bool -&gt; ST s (STUArray s i Bool)
forall i. Ix i =&gt; (i, i) -&gt; Bool -&gt; ST s (STUArray s i Bool)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1105"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1106"></span><span>    </span><span id="local-6989586621679061967"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Bool -&gt; Int -&gt; ST s Bool
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061968"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061968"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061969"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Bool -&gt; ST s Bool
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Bool -&gt; ST s Bool) -&gt; STRep s Bool -&gt; ST s Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061970"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061970"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word# #)
</span><span class="hs-identifier hs-var">readWordArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061968"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_INDEX"><span class="hs-identifier hs-var">bOOL_INDEX</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061970"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679061971"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061971"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061972"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061972"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061971"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061972"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-var">bOOL_BIT</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`neWord#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1109"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1110"></span><span>    </span><span id="local-6989586621679061974"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Bool -&gt; Int -&gt; Bool -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679061975"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061975"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679061976"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061976"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061977"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061977"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061978"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061978"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1111"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_INDEX"><span class="hs-identifier hs-var">bOOL_INDEX</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061976"><span class="hs-identifier hs-var">i#</span></a></span><span>              </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061979"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061979"><span class="hs-identifier hs-var">j#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1112"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word# #)
</span><span class="hs-identifier hs-var">readWordArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061975"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061979"><span class="hs-identifier hs-var">j#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061978"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679061980"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061980"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061981"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061981"><span class="hs-identifier hs-var">old#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1113"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061977"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061981"><span class="hs-identifier hs-var">old#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`or#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-var">bOOL_BIT</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061976"><span class="hs-identifier hs-var">i#</span></a></span><span>
</span><span id="line-1114"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061981"><span class="hs-identifier hs-var">old#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_NOT_BIT"><span class="hs-identifier hs-var">bOOL_NOT_BIT</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061976"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061983"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061983"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1115"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWordArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679061975"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679061979"><span class="hs-identifier hs-var">j#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679061983"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061980"><span class="hs-identifier hs-var">s2#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679061984"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-var">s3#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1116"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-var">s3#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1117"></span><span>
</span><span id="line-1118"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059180"><span id="local-6989586621679061990"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059180"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059180"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1119"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1120"></span><span>    </span><span id="local-6989586621679062000"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Char -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062001"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062001"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062002"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062001"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1122"></span><span>    </span><span id="local-6989586621679062005"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Char -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062006"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062006"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062006"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1123"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1124"></span><span>    </span><span id="local-6989586621679062009"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Char)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062010"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062010"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062011"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062011"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Char)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062010"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062011"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">4#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1125"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1126"></span><span>    </span><span id="local-6989586621679062016"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Char)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062017"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062017"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Char -&gt; ST s (STUArray s i Char)
forall i. Ix i =&gt; (i, i) -&gt; Char -&gt; ST s (STUArray s i Char)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062017"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">chr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1128"></span><span>    </span><span id="local-6989586621679062020"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Char -&gt; Int -&gt; ST s Char
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062021"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062021"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062022"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Char -&gt; ST s Char
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Char -&gt; ST s Char) -&gt; STRep s Char -&gt; ST s Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062023"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062023"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1129"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Char# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Char# #)
</span><span class="hs-identifier hs-var">readWideCharArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062021"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062023"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062024"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062024"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062025"><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1130"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062024"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char# -&gt; Char
</span><span class="hs-identifier hs-var">C#</span></span><span> </span><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1131"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1132"></span><span>    </span><span id="local-6989586621679062027"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Char -&gt; Int -&gt; Char -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062028"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062028"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062029"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062029"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C#</span></span><span> </span><span id="local-6989586621679062030"><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679062030"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062031"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062031"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1133"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Char# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Char# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWideCharArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062028"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062029"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679062030"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062031"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062032"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062032"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1134"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062032"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059194"><span id="local-6989586621679062038"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059194"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059194"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1137"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1138"></span><span>    </span><span id="local-6989586621679062048"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Int -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062049"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062049"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062050"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062049"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1140"></span><span>    </span><span id="local-6989586621679062053"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Int -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062054"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062054"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062054"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1141"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1142"></span><span>    </span><span id="local-6989586621679062057"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062058"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062059"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062059"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Int)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062059"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var">wORD_SCALE</span></a></span><span>
</span><span id="line-1143"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1144"></span><span>    </span><span id="local-6989586621679062065"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062066"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062066"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; ST s (STUArray s i Int)
forall i. Ix i =&gt; (i, i) -&gt; Int -&gt; ST s (STUArray s i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062066"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1145"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1146"></span><span>    </span><span id="local-6989586621679062068"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Int -&gt; Int -&gt; ST s Int
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062069"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062069"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062070"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062070"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Int -&gt; ST s Int
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Int -&gt; ST s Int) -&gt; STRep s Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062071"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1147"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Int# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Int# #)
</span><span class="hs-identifier hs-var">readIntArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062069"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062070"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062072"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062073"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062073"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1148"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062073"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1149"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1150"></span><span>    </span><span id="local-6989586621679062075"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062076"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062076"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062077"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062077"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062078"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062078"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062079"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1151"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeIntArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062076"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062077"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062078"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062080"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062080"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1152"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062080"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059208"><span id="local-6989586621679062086"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059208"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059208"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1155"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1156"></span><span>    </span><span id="local-6989586621679062096"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Word -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062097"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062097"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062098"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062098"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062097"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062098"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1158"></span><span>    </span><span id="local-6989586621679062101"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Word -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062102"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062102"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062102"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1159"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1160"></span><span>    </span><span id="local-6989586621679062105"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062106"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062107"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062107"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Word)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062107"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var">wORD_SCALE</span></a></span><span>
</span><span id="line-1161"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1162"></span><span>    </span><span id="local-6989586621679062112"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062113"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062113"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Word -&gt; ST s (STUArray s i Word)
forall i. Ix i =&gt; (i, i) -&gt; Word -&gt; ST s (STUArray s i Word)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062113"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1163"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1164"></span><span>    </span><span id="local-6989586621679062115"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Word -&gt; Int -&gt; ST s Word
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062116"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062116"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062117"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062117"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Word -&gt; ST s Word
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Word -&gt; ST s Word) -&gt; STRep s Word -&gt; ST s Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062118"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062118"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1165"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word# #)
</span><span class="hs-identifier hs-var">readWordArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062116"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062117"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062118"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062119"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062119"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062120"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062120"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1166"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062119"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word
</span><span class="hs-identifier hs-var">W#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062120"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1167"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1168"></span><span>    </span><span id="local-6989586621679062122"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Word -&gt; Int -&gt; Word -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062123"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062123"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062124"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062124"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621679062125"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062125"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062126"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062126"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1169"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWordArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062123"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062124"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062125"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062126"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062127"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062127"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1170"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062127"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059224"><span id="local-6989586621679059225"><span id="local-6989586621679062133"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059224"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059224"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1173"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1174"></span><span>    </span><span id="local-6989586621679062143"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i (Ptr a) -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062144"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062144"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062145"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062145"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062144"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062145"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1175"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1176"></span><span>    </span><span id="local-6989586621679062148"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i (Ptr a) -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062149"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062149"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062149"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1177"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1178"></span><span>    </span><span id="local-6989586621679062152"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (Ptr a))
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062153"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062154"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062154"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i (Ptr a))
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062154"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var">wORD_SCALE</span></a></span><span>
</span><span id="line-1179"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1180"></span><span>    </span><span id="local-6989586621679062158"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (Ptr a))
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062159"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062159"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Ptr a -&gt; ST s (STUArray s i (Ptr a))
forall i. Ix i =&gt; (i, i) -&gt; Ptr a -&gt; ST s (STUArray s i (Ptr a))
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062159"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span>
</span><span id="line-1181"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1182"></span><span>    </span><span id="local-6989586621679062161"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i (Ptr a) -&gt; Int -&gt; ST s (Ptr a)
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062162"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062162"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062163"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062163"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (Ptr a) -&gt; ST s (Ptr a)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (Ptr a) -&gt; ST s (Ptr a))
-&gt; STRep s (Ptr a) -&gt; ST s (Ptr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062164"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062164"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1183"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Addr# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Addr# #)
</span><span class="hs-identifier hs-var">readAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062162"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062163"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062164"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062165"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062165"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062166"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062166"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1184"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062165"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Ptr a
forall a. Addr# -&gt; Ptr a
</span><span class="hs-identifier hs-var">Ptr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062166"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1185"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1186"></span><span>    </span><span id="local-6989586621679062168"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i (Ptr a) -&gt; Int -&gt; Ptr a -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062169"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062170"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span id="local-6989586621679062171"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062171"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062172"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1187"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Addr# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062171"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062173"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1188"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059243"><span id="local-6989586621679059244"><span id="local-6989586621679062179"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059243"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059244"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059243"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1191"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1192"></span><span>    </span><span id="local-6989586621679062189"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i (FunPtr a) -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062190"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062191"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1194"></span><span>    </span><span id="local-6989586621679062194"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i (FunPtr a) -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062195"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062195"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062195"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1195"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1196"></span><span>    </span><span id="local-6989586621679062198"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (FunPtr a))
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062199"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062199"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062200"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062200"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i (FunPtr a))
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062199"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062200"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var">wORD_SCALE</span></a></span><span>
</span><span id="line-1197"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1198"></span><span>    </span><span id="local-6989586621679062204"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (FunPtr a))
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062205"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; FunPtr a -&gt; ST s (STUArray s i (FunPtr a))
forall i.
Ix i =&gt;
(i, i) -&gt; FunPtr a -&gt; ST s (STUArray s i (FunPtr a))
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">FunPtr a
forall a. FunPtr a
</span><span class="hs-identifier hs-var">nullFunPtr</span></span><span>
</span><span id="line-1199"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1200"></span><span>    </span><span id="local-6989586621679062207"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i (FunPtr a) -&gt; Int -&gt; ST s (FunPtr a)
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062208"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062208"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062209"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062209"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (FunPtr a) -&gt; ST s (FunPtr a)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (FunPtr a) -&gt; ST s (FunPtr a))
-&gt; STRep s (FunPtr a) -&gt; ST s (FunPtr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062210"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062210"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1201"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Addr# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Addr# #)
</span><span class="hs-identifier hs-var">readAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062208"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062209"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062210"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062211"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062211"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062212"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062212"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1202"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062211"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; FunPtr a
forall a. Addr# -&gt; FunPtr a
</span><span class="hs-identifier hs-var">FunPtr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062212"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1203"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1204"></span><span>    </span><span id="local-6989586621679062214"><span class="annot"><span class="annottext">unsafeWrite :: forall i.
Ix i =&gt;
STUArray s i (FunPtr a) -&gt; Int -&gt; FunPtr a -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062215"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062215"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062216"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062216"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunPtr</span></span><span> </span><span id="local-6989586621679062217"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062217"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062218"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062218"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1205"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Addr# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeAddrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062215"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062216"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679062217"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062218"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062219"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062219"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1206"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062219"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1207"></span><span>
</span><span id="line-1208"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059260"><span id="local-6989586621679062225"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059260"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059260"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1209"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1210"></span><span>    </span><span id="local-6989586621679062235"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Float -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062236"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062236"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062237"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062237"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062236"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062237"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1211"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1212"></span><span>    </span><span id="local-6989586621679062240"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Float -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062241"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062241"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062241"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1213"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1214"></span><span>    </span><span id="local-6989586621679062244"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Float)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062245"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062245"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062246"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062246"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Float)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062245"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062246"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#fLOAT_SCALE"><span class="hs-identifier hs-var">fLOAT_SCALE</span></a></span><span>
</span><span id="line-1215"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1216"></span><span>    </span><span id="local-6989586621679062252"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Float)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062253"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062253"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Float -&gt; ST s (STUArray s i Float)
forall i. Ix i =&gt; (i, i) -&gt; Float -&gt; ST s (STUArray s i Float)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062253"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1217"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1218"></span><span>    </span><span id="local-6989586621679062255"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Float -&gt; Int -&gt; ST s Float
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062256"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062256"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062257"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062257"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Float -&gt; ST s Float
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Float -&gt; ST s Float) -&gt; STRep s Float -&gt; ST s Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062258"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062258"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1219"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Float# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Float# #)
</span><span class="hs-identifier hs-var">readFloatArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062256"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062257"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062258"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062259"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062259"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062260"><span class="annot"><span class="annottext">Float#
</span><a href="#local-6989586621679062260"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1220"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062259"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float# -&gt; Float
</span><span class="hs-identifier hs-var">F#</span></span><span> </span><span class="annot"><span class="annottext">Float#
</span><a href="#local-6989586621679062260"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1221"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1222"></span><span>    </span><span id="local-6989586621679062262"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Float -&gt; Int -&gt; Float -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062263"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062263"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062264"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062264"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F#</span></span><span> </span><span id="local-6989586621679062265"><span class="annot"><span class="annottext">Float#
</span><a href="#local-6989586621679062265"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062266"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062266"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1223"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Float# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Float# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeFloatArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062263"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062264"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Float#
</span><a href="#local-6989586621679062265"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062266"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062267"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062267"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1224"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062267"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1225"></span><span>
</span><span id="line-1226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059274"><span id="local-6989586621679062273"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059274"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059274"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1227"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1228"></span><span>    </span><span id="local-6989586621679062283"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Double -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062284"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062284"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062285"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062285"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062284"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062285"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1230"></span><span>    </span><span id="local-6989586621679062288"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Double -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062289"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062289"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062289"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1231"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1232"></span><span>    </span><span id="local-6989586621679062292"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Double)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062293"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062293"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062294"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Double)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062293"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#dOUBLE_SCALE"><span class="hs-identifier hs-var">dOUBLE_SCALE</span></a></span><span>
</span><span id="line-1233"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1234"></span><span>    </span><span id="local-6989586621679062300"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Double)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062301"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062301"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Double -&gt; ST s (STUArray s i Double)
forall i. Ix i =&gt; (i, i) -&gt; Double -&gt; ST s (STUArray s i Double)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062301"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1235"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1236"></span><span>    </span><span id="local-6989586621679062303"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Double -&gt; Int -&gt; ST s Double
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062304"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062304"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062305"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062305"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Double -&gt; ST s Double
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Double -&gt; ST s Double) -&gt; STRep s Double -&gt; ST s Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062306"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062306"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1237"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Double# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Double# #)
</span><span class="hs-identifier hs-var">readDoubleArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062304"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062305"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062306"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062307"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062307"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062308"><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679062308"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1238"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062307"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><span class="hs-identifier hs-var">D#</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679062308"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1239"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1240"></span><span>    </span><span id="local-6989586621679062310"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Double -&gt; Int -&gt; Double -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062311"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062311"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062312"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062312"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">D#</span></span><span> </span><span id="local-6989586621679062313"><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679062313"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062314"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062314"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1241"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Double# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Double# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeDoubleArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062311"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062312"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679062313"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062314"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062315"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062315"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1242"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062315"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059290"><span id="local-6989586621679059291"><span id="local-6989586621679062321"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059290"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StablePtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059291"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059290"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1245"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1246"></span><span>    </span><span id="local-6989586621679062331"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i (StablePtr a) -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062332"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062332"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062333"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062333"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062332"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062333"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1247"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1248"></span><span>    </span><span id="local-6989586621679062336"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i (StablePtr a) -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062337"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062337"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062337"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1249"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1250"></span><span>    </span><span id="local-6989586621679062340"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (StablePtr a))
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062341"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062341"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062342"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062342"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i (StablePtr a))
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062341"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062342"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var">wORD_SCALE</span></a></span><span>
</span><span id="line-1251"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1252"></span><span>    </span><span id="local-6989586621679062346"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i (StablePtr a))
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062347"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; StablePtr a -&gt; ST s (STUArray s i (StablePtr a))
forall i.
Ix i =&gt;
(i, i) -&gt; StablePtr a -&gt; ST s (STUArray s i (StablePtr a))
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr () -&gt; StablePtr a
forall a. Ptr () -&gt; StablePtr a
</span><span class="hs-identifier hs-var">castPtrToStablePtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr ()
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1254"></span><span>    </span><span id="local-6989586621679062350"><span class="annot"><span class="annottext">unsafeRead :: forall i.
Ix i =&gt;
STUArray s i (StablePtr a) -&gt; Int -&gt; ST s (StablePtr a)
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062351"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062351"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062352"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062352"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (StablePtr a) -&gt; ST s (StablePtr a)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (StablePtr a) -&gt; ST s (StablePtr a))
-&gt; STRep s (StablePtr a) -&gt; ST s (StablePtr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062353"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1255"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
-&gt; Int# -&gt; State# s -&gt; (# State# s, StablePtr# a #)
forall d a.
MutableByteArray# d
-&gt; Int# -&gt; State# d -&gt; (# State# d, StablePtr# a #)
</span><span class="hs-identifier hs-var">readStablePtrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062351"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062352"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062354"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062354"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062355"><span class="annot"><span class="annottext">StablePtr# a
</span><a href="#local-6989586621679062355"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1256"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062354"><span class="hs-identifier hs-var">s2#</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StablePtr# a -&gt; StablePtr a
forall a. StablePtr# a -&gt; StablePtr a
</span><span class="hs-identifier hs-var">StablePtr</span></span><span> </span><span class="annot"><span class="annottext">StablePtr# a
</span><a href="#local-6989586621679062355"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1257"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1258"></span><span>    </span><span id="local-6989586621679062357"><span class="annot"><span class="annottext">unsafeWrite :: forall i.
Ix i =&gt;
STUArray s i (StablePtr a) -&gt; Int -&gt; StablePtr a -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062358"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062358"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062359"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062359"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StablePtr</span></span><span> </span><span id="local-6989586621679062360"><span class="annot"><span class="annottext">StablePtr# a
</span><a href="#local-6989586621679062360"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062361"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062361"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1259"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; StablePtr# a -&gt; State# s -&gt; State# s
forall d a.
MutableByteArray# d -&gt; Int# -&gt; StablePtr# a -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeStablePtrArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062358"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062359"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">StablePtr# a
</span><a href="#local-6989586621679062360"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062361"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062362"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062362"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1260"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062362"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059312"><span id="local-6989586621679062368"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059312"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059312"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1263"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1264"></span><span>    </span><span id="local-6989586621679062378"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Int8 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062379"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062379"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062380"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062380"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062379"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062380"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1265"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1266"></span><span>    </span><span id="local-6989586621679062383"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Int8 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062384"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062384"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062384"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1267"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1268"></span><span>    </span><span id="local-6989586621679062387"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int8)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062388"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062388"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062389"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062389"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Int8)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062388"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062389"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062390"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062390"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062390"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1270"></span><span>    </span><span id="local-6989586621679062395"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int8)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062396"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062396"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int8 -&gt; ST s (STUArray s i Int8)
forall i. Ix i =&gt; (i, i) -&gt; Int8 -&gt; ST s (STUArray s i Int8)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062396"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Int8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1271"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1272"></span><span>    </span><span id="local-6989586621679062398"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Int8 -&gt; Int -&gt; ST s Int8
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062399"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062399"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062400"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062400"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Int8 -&gt; ST s Int8
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Int8 -&gt; ST s Int8) -&gt; STRep s Int8 -&gt; ST s Int8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062401"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062401"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1273"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Int8# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Int8# #)
</span><span class="hs-identifier hs-var">readInt8Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062399"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062400"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062401"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062402"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062402"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062403"><span class="annot"><span class="annottext">Int8#
</span><a href="#local-6989586621679062403"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1274"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062402"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int8# -&gt; Int8
</span><span class="hs-identifier hs-var">I8#</span></span><span> </span><span class="annot"><span class="annottext">Int8#
</span><a href="#local-6989586621679062403"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1275"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1276"></span><span>    </span><span id="local-6989586621679062405"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Int8 -&gt; Int -&gt; Int8 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062406"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062406"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062407"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062407"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I8#</span></span><span> </span><span id="local-6989586621679062408"><span class="annot"><span class="annottext">Int8#
</span><a href="#local-6989586621679062408"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062409"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062409"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1277"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int8# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int8# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeInt8Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062406"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062407"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int8#
</span><a href="#local-6989586621679062408"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062409"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062410"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062410"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1278"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062410"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059326"><span id="local-6989586621679062416"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059326"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059326"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1281"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1282"></span><span>    </span><span id="local-6989586621679062426"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Int16 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062427"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062427"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062428"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062428"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062427"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062428"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1283"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1284"></span><span>    </span><span id="local-6989586621679062431"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Int16 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062432"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062432"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1285"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1286"></span><span>    </span><span id="local-6989586621679062435"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int16)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062436"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062436"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062437"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062437"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Int16)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062436"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062437"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1288"></span><span>    </span><span id="local-6989586621679062442"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int16)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062443"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062443"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int16 -&gt; ST s (STUArray s i Int16)
forall i. Ix i =&gt; (i, i) -&gt; Int16 -&gt; ST s (STUArray s i Int16)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062443"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1289"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1290"></span><span>    </span><span id="local-6989586621679062445"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Int16 -&gt; Int -&gt; ST s Int16
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062446"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062446"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062447"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062447"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Int16 -&gt; ST s Int16
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Int16 -&gt; ST s Int16) -&gt; STRep s Int16 -&gt; ST s Int16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062448"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062448"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1291"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Int16# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Int16# #)
</span><span class="hs-identifier hs-var">readInt16Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062446"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062447"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062448"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062449"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062449"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062450"><span class="annot"><span class="annottext">Int16#
</span><a href="#local-6989586621679062450"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1292"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062449"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int16# -&gt; Int16
</span><span class="hs-identifier hs-var">I16#</span></span><span> </span><span class="annot"><span class="annottext">Int16#
</span><a href="#local-6989586621679062450"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1293"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1294"></span><span>    </span><span id="local-6989586621679062452"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Int16 -&gt; Int -&gt; Int16 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062453"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062453"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062454"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062454"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I16#</span></span><span> </span><span id="local-6989586621679062455"><span class="annot"><span class="annottext">Int16#
</span><a href="#local-6989586621679062455"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062456"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062456"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1295"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int16# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int16# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeInt16Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062453"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062454"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int16#
</span><a href="#local-6989586621679062455"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062456"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062457"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062457"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1296"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062457"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1297"></span><span>
</span><span id="line-1298"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059340"><span id="local-6989586621679062463"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059340"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059340"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1299"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1300"></span><span>    </span><span id="local-6989586621679062473"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Int32 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062474"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062474"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062475"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062475"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062474"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062475"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1302"></span><span>    </span><span id="local-6989586621679062478"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Int32 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062479"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062479"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062479"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1303"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1304"></span><span>    </span><span id="local-6989586621679062482"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int32)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062483"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062483"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062484"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062484"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Int32)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062483"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062484"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">4#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1305"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1306"></span><span>    </span><span id="local-6989586621679062489"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int32)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062490"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062490"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int32 -&gt; ST s (STUArray s i Int32)
forall i. Ix i =&gt; (i, i) -&gt; Int32 -&gt; ST s (STUArray s i Int32)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062490"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1307"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1308"></span><span>    </span><span id="local-6989586621679062492"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Int32 -&gt; Int -&gt; ST s Int32
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062493"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062493"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062494"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062494"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Int32 -&gt; ST s Int32
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Int32 -&gt; ST s Int32) -&gt; STRep s Int32 -&gt; ST s Int32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062495"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062495"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1309"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Int32# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Int32# #)
</span><span class="hs-identifier hs-var">readInt32Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062493"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062494"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062495"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062496"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062496"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062497"><span class="annot"><span class="annottext">Int32#
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1310"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062496"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int32# -&gt; Int32
</span><span class="hs-identifier hs-var">I32#</span></span><span> </span><span class="annot"><span class="annottext">Int32#
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1311"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1312"></span><span>    </span><span id="local-6989586621679062499"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Int32 -&gt; Int -&gt; Int32 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062500"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062500"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062501"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062501"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I32#</span></span><span> </span><span id="local-6989586621679062502"><span class="annot"><span class="annottext">Int32#
</span><a href="#local-6989586621679062502"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062503"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062503"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1313"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int32# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int32# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeInt32Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062500"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062501"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int32#
</span><a href="#local-6989586621679062502"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062503"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062504"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062504"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1314"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062504"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1315"></span><span>
</span><span id="line-1316"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059354"><span id="local-6989586621679062510"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059354"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059354"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1317"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1318"></span><span>    </span><span id="local-6989586621679062520"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Int64 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062521"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062521"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062522"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062522"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062521"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062522"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1319"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1320"></span><span>    </span><span id="local-6989586621679062525"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Int64 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062526"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062526"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062526"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1321"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1322"></span><span>    </span><span id="local-6989586621679062529"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int64)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062530"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062530"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062531"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062531"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Int64)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062530"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062531"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1324"></span><span>    </span><span id="local-6989586621679062536"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Int64)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062537"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062537"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int64 -&gt; ST s (STUArray s i Int64)
forall i. Ix i =&gt; (i, i) -&gt; Int64 -&gt; ST s (STUArray s i Int64)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062537"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1325"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1326"></span><span>    </span><span id="local-6989586621679062539"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Int64 -&gt; Int -&gt; ST s Int64
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062540"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062540"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062541"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062541"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Int64 -&gt; ST s Int64
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Int64 -&gt; ST s Int64) -&gt; STRep s Int64 -&gt; ST s Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062542"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062542"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1327"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Int64# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Int64# #)
</span><span class="hs-identifier hs-var">readInt64Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062540"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062541"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062542"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062543"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062543"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062544"><span class="annot"><span class="annottext">Int64#
</span><a href="#local-6989586621679062544"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1328"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062543"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int64# -&gt; Int64
</span><span class="hs-identifier hs-var">I64#</span></span><span> </span><span class="annot"><span class="annottext">Int64#
</span><a href="#local-6989586621679062544"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1329"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1330"></span><span>    </span><span id="local-6989586621679062546"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Int64 -&gt; Int -&gt; Int64 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062547"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062547"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062548"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062548"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I64#</span></span><span> </span><span id="local-6989586621679062549"><span class="annot"><span class="annottext">Int64#
</span><a href="#local-6989586621679062549"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062550"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062550"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1331"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Int64# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Int64# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeInt64Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062547"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062548"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int64#
</span><a href="#local-6989586621679062549"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062550"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062551"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062551"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1332"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062551"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1333"></span><span>
</span><span id="line-1334"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059368"><span id="local-6989586621679062557"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059368"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059368"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1335"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1336"></span><span>    </span><span id="local-6989586621679062567"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Word8 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062568"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062568"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062569"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062569"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062568"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062569"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1338"></span><span>    </span><span id="local-6989586621679062572"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Word8 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062573"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062573"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062573"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1339"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1340"></span><span>    </span><span id="local-6989586621679062576"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word8)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062577"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062578"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062578"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Word8)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062578"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062579"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062579"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1341"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1342"></span><span>    </span><span id="local-6989586621679062584"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word8)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062585"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062585"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Word8 -&gt; ST s (STUArray s i Word8)
forall i. Ix i =&gt; (i, i) -&gt; Word8 -&gt; ST s (STUArray s i Word8)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062585"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1343"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1344"></span><span>    </span><span id="local-6989586621679062587"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Word8 -&gt; Int -&gt; ST s Word8
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062588"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062589"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062589"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Word8 -&gt; ST s Word8
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Word8 -&gt; ST s Word8) -&gt; STRep s Word8 -&gt; ST s Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062590"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062590"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1345"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word8# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word8# #)
</span><span class="hs-identifier hs-var">readWord8Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062589"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062590"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062591"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062591"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062592"><span class="annot"><span class="annottext">Word8#
</span><a href="#local-6989586621679062592"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1346"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062591"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word8
</span><span class="hs-identifier hs-var">W8#</span></span><span> </span><span class="annot"><span class="annottext">Word8#
</span><a href="#local-6989586621679062592"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1347"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1348"></span><span>    </span><span id="local-6989586621679062594"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062595"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062595"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062596"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062596"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W8#</span></span><span> </span><span id="local-6989586621679062597"><span class="annot"><span class="annottext">Word8#
</span><a href="#local-6989586621679062597"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062598"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062598"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word8# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word8# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWord8Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062595"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062596"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Word8#
</span><a href="#local-6989586621679062597"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062598"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062599"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062599"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1350"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062599"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1351"></span><span>
</span><span id="line-1352"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059382"><span id="local-6989586621679062605"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059382"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059382"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1353"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1354"></span><span>    </span><span id="local-6989586621679062615"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Word16 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062616"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062616"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062617"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062617"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062616"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062617"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1355"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1356"></span><span>    </span><span id="local-6989586621679062620"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Word16 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062621"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062621"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1357"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1358"></span><span>    </span><span id="local-6989586621679062624"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word16)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062625"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062625"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062626"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062626"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Word16)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062625"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062626"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1360"></span><span>    </span><span id="local-6989586621679062631"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word16)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062632"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062632"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Word16 -&gt; ST s (STUArray s i Word16)
forall i. Ix i =&gt; (i, i) -&gt; Word16 -&gt; ST s (STUArray s i Word16)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062632"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1361"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1362"></span><span>    </span><span id="local-6989586621679062634"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Word16 -&gt; Int -&gt; ST s Word16
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062635"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062636"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Word16 -&gt; ST s Word16
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Word16 -&gt; ST s Word16) -&gt; STRep s Word16 -&gt; ST s Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062637"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1363"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word16# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word16# #)
</span><span class="hs-identifier hs-var">readWord16Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062638"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062639"><span class="annot"><span class="annottext">Word16#
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1364"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16# -&gt; Word16
</span><span class="hs-identifier hs-var">W16#</span></span><span> </span><span class="annot"><span class="annottext">Word16#
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1365"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1366"></span><span>    </span><span id="local-6989586621679062641"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Word16 -&gt; Int -&gt; Word16 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062642"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062642"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062643"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062643"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W16#</span></span><span> </span><span id="local-6989586621679062644"><span class="annot"><span class="annottext">Word16#
</span><a href="#local-6989586621679062644"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062645"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062645"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1367"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word16# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word16# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWord16Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062642"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062643"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Word16#
</span><a href="#local-6989586621679062644"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062645"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062646"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062646"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1368"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062646"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059396"><span id="local-6989586621679062652"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059396"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059396"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1371"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1372"></span><span>    </span><span id="local-6989586621679062662"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Word32 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062663"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062663"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062664"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062664"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062663"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062664"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1373"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1374"></span><span>    </span><span id="local-6989586621679062667"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Word32 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062668"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062668"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062668"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1375"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1376"></span><span>    </span><span id="local-6989586621679062671"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word32)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062672"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062672"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062673"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062673"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Word32)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062672"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062673"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">4#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1377"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1378"></span><span>    </span><span id="local-6989586621679062678"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word32)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062679"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Word32 -&gt; ST s (STUArray s i Word32)
forall i. Ix i =&gt; (i, i) -&gt; Word32 -&gt; ST s (STUArray s i Word32)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1379"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1380"></span><span>    </span><span id="local-6989586621679062681"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Word32 -&gt; Int -&gt; ST s Word32
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062682"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062683"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062683"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Word32 -&gt; ST s Word32
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Word32 -&gt; ST s Word32) -&gt; STRep s Word32 -&gt; ST s Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062684"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062684"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1381"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word32# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word32# #)
</span><span class="hs-identifier hs-var">readWord32Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062683"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062684"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062685"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062686"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1382"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32# -&gt; Word32
</span><span class="hs-identifier hs-var">W32#</span></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1383"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1384"></span><span>    </span><span id="local-6989586621679062688"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Word32 -&gt; Int -&gt; Word32 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062689"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062689"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062690"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062690"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679062691"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062692"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1385"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word32# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word32# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWord32Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062689"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062690"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062693"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062693"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1386"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062693"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679059410"><span id="local-6989586621679062699"><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059410"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059410"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1389"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getBounds"><span class="hs-pragma hs-type">getBounds</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1390"></span><span>    </span><span id="local-6989586621679062709"><span class="annot"><span class="annottext">getBounds :: forall i. Ix i =&gt; STUArray s i Word64 -&gt; ST s (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var hs-var hs-var">getBounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062710"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062710"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062711"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062711"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (i, i)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062711"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1391"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-pragma hs-type">getNumElements</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1392"></span><span>    </span><span id="local-6989586621679062714"><span class="annot"><span class="annottext">getNumElements :: forall i. Ix i =&gt; STUArray s i Word64 -&gt; ST s Int
</span><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-var hs-var hs-var">getNumElements</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062715"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062715"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062715"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1393"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-pragma hs-type">unsafeNewArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1394"></span><span>    </span><span id="local-6989586621679062718"><span class="annot"><span class="annottext">unsafeNewArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word64)
</span><a href="Data.Array.Base.html#unsafeNewArray_"><span class="hs-identifier hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062719"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062719"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062720"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062720"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i Word64)
forall i s e.
Ix i =&gt;
(i, i) -&gt; (Int# -&gt; Int#) -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeNewArraySTUArray_"><span class="hs-identifier hs-var">unsafeNewArraySTUArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062719"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062720"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">)</span><span>
</span><span id="line-1395"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#newArray_"><span class="hs-pragma hs-type">newArray_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1396"></span><span>    </span><span id="local-6989586621679062725"><span class="annot"><span class="annottext">newArray_ :: forall i. Ix i =&gt; (i, i) -&gt; ST s (STUArray s i Word64)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var hs-var hs-var">newArray_</span></a></span></span><span> </span><span id="local-6989586621679062726"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062726"><span class="hs-identifier hs-var">arrBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Word64 -&gt; ST s (STUArray s i Word64)
forall i. Ix i =&gt; (i, i) -&gt; Word64 -&gt; ST s (STUArray s i Word64)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray"><span class="hs-identifier hs-var">newArray</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679062726"><span class="hs-identifier hs-var">arrBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1397"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-pragma hs-type">unsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1398"></span><span>    </span><span id="local-6989586621679062728"><span class="annot"><span class="annottext">unsafeRead :: forall i. Ix i =&gt; STUArray s i Word64 -&gt; Int -&gt; ST s Word64
</span><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062729"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062729"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062730"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062730"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s Word64 -&gt; ST s Word64
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s Word64 -&gt; ST s Word64) -&gt; STRep s Word64 -&gt; ST s Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062731"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062731"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1399"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; State# s -&gt; (# State# s, Word64# #)
forall d.
MutableByteArray# d -&gt; Int# -&gt; State# d -&gt; (# State# d, Word64# #)
</span><span class="hs-identifier hs-var">readWord64Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062729"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062730"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062731"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062732"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062732"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062733"><span class="annot"><span class="annottext">Word64#
</span><a href="#local-6989586621679062733"><span class="hs-identifier hs-var">e#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1400"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062732"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64# -&gt; Word64
</span><span class="hs-identifier hs-var">W64#</span></span><span> </span><span class="annot"><span class="annottext">Word64#
</span><a href="#local-6989586621679062733"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1401"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-pragma hs-type">unsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1402"></span><span>    </span><span id="local-6989586621679062735"><span class="annot"><span class="annottext">unsafeWrite :: forall i. Ix i =&gt; STUArray s i Word64 -&gt; Int -&gt; Word64 -&gt; ST s ()
</span><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679062736"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062736"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062737"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062737"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W64#</span></span><span> </span><span id="local-6989586621679062738"><span class="annot"><span class="annottext">Word64#
</span><a href="#local-6989586621679062738"><span class="hs-identifier hs-var">e#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062739"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062739"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1403"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word64# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word64# -&gt; State# d -&gt; State# d
</span><span class="hs-identifier hs-var">writeWord64Array#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062736"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062737"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Word64#
</span><a href="#local-6989586621679062738"><span class="hs-identifier hs-var">e#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062739"><span class="hs-identifier hs-var">s1#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062740"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062740"><span class="hs-identifier hs-var">s2#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1404"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062740"><span class="hs-identifier hs-var">s2#</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1405"></span><span>
</span><span id="line-1406"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- Translation between elements and bytes</span><span>
</span><span id="line-1408"></span><span>
</span><span id="line-1409"></span><span class="annot"><a href="Data.Array.Base.html#bOOL_SCALE"><span class="hs-identifier hs-type">bOOL_SCALE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-type">wORD_SCALE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#dOUBLE_SCALE"><span class="hs-identifier hs-type">dOUBLE_SCALE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#fLOAT_SCALE"><span class="hs-identifier hs-type">fLOAT_SCALE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-1410"></span><span id="bOOL_SCALE"><span class="annot"><span class="annottext">bOOL_SCALE :: Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_SCALE"><span class="hs-identifier hs-var hs-var">bOOL_SCALE</span></a></span></span><span> </span><span id="local-6989586621679062741"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062741"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1411"></span><span>    </span><span class="hs-comment">-- Round the number of bits up to the next whole-word-aligned number</span><span>
</span><span id="line-1412"></span><span>    </span><span class="hs-comment">-- of bytes to avoid ghc#23132; the addition can signed-overflow but</span><span>
</span><span id="line-1413"></span><span>    </span><span class="hs-comment">-- that's OK because it will not unsigned-overflow and the logical</span><span>
</span><span id="line-1414"></span><span>    </span><span class="hs-comment">-- right-shift brings us back in-bounds</span><span class="hs-cpp">
#if SIZEOF_HSWORD == 4
</span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">n#</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">31#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedIShiftRL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">5#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedIShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">2#</span><span class="hs-cpp">
#elif SIZEOF_HSWORD == 8
</span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062741"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">+#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">63#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span class="hs-cpp">
#endif
</span><span id="wORD_SCALE"><span class="annot"><span class="annottext">wORD_SCALE :: Int# -&gt; Int#
</span><a href="Data.Array.Base.html#wORD_SCALE"><span class="hs-identifier hs-var hs-var">wORD_SCALE</span></a></span></span><span>   </span><span id="local-6989586621679062742"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062742"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062743"><span class="hs-identifier hs-var">scale#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062742"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062743"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062743"><span class="hs-identifier hs-var">scale#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SIZEOF_HSWORD</span><span>
</span><span id="line-1421"></span><span id="dOUBLE_SCALE"><span class="annot"><span class="annottext">dOUBLE_SCALE :: Int# -&gt; Int#
</span><a href="Data.Array.Base.html#dOUBLE_SCALE"><span class="hs-identifier hs-var hs-var">dOUBLE_SCALE</span></a></span></span><span> </span><span id="local-6989586621679062745"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062745"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062746"><span class="hs-identifier hs-var">scale#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062745"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062746"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062746"><span class="hs-identifier hs-var">scale#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SIZEOF_HSDOUBLE</span><span>
</span><span id="line-1422"></span><span id="fLOAT_SCALE"><span class="annot"><span class="annottext">fLOAT_SCALE :: Int# -&gt; Int#
</span><a href="Data.Array.Base.html#fLOAT_SCALE"><span class="hs-identifier hs-var hs-var">fLOAT_SCALE</span></a></span></span><span>  </span><span id="local-6989586621679062748"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062748"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var">safe_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062749"><span class="hs-identifier hs-var">scale#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062748"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062749"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062749"><span class="hs-identifier hs-var">scale#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SIZEOF_HSFLOAT</span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span class="annot"><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-type">safe_scale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-1425"></span><span id="safe_scale"><span class="annot"><span class="annottext">safe_scale :: Int# -&gt; Int# -&gt; Int#
</span><a href="Data.Array.Base.html#safe_scale"><span class="hs-identifier hs-var hs-var">safe_scale</span></a></span></span><span> </span><span id="local-6989586621679062751"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062751"><span class="hs-identifier hs-var">scale#</span></a></span></span><span> </span><span id="local-6989586621679062752"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062752"><span class="hs-identifier hs-var">n#</span></a></span></span><span>
</span><span id="line-1426"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679062754"><span class="hs-identifier hs-var">overflow</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062755"><span class="hs-identifier hs-var">res#</span></a></span><span>
</span><span id="line-1427"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int#
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Int#) -&gt; [Char] -&gt; Int#
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Data.Array.Base.safe_scale: Overflow; scale: &quot;</span></span><span>
</span><span id="line-1428"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062751"><span class="hs-identifier hs-var">scale#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, n: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062752"><span class="hs-identifier hs-var">n#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1429"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1430"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679062755"><span class="annot"><span class="annottext">res# :: Int#
</span><a href="#local-6989586621679062755"><span class="hs-identifier hs-var hs-var">res#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062751"><span class="hs-identifier hs-var">scale#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">*#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062752"><span class="hs-identifier hs-var">n#</span></a></span><span>
</span><span id="line-1431"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679062754"><span class="annot"><span class="annottext">overflow :: Bool
</span><a href="#local-6989586621679062754"><span class="hs-identifier hs-var hs-var">overflow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062756"><span class="hs-identifier hs-var">maxN#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`divInt#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062751"><span class="hs-identifier hs-var">scale#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062752"><span class="hs-identifier hs-var">n#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1432"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679062756"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062756"><span class="hs-identifier hs-var">maxN#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-1433"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#safe_scale"><span class="hs-pragma hs-type">safe_scale</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1434"></span><span>
</span><span id="line-1435"></span><span class="annot"><span class="hs-comment">-- | The index of the word which the given @Bool@ array elements falls within.</span></span><span>
</span><span id="line-1436"></span><span class="annot"><a href="Data.Array.Base.html#bOOL_INDEX"><span class="hs-identifier hs-type">bOOL_INDEX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span class="hs-cpp">
#if SIZEOF_HSWORD == 4
</span><span class="hs-identifier">bOOL_INDEX</span><span> </span><span class="hs-identifier">i#</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">i#</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedIShiftRA#</span><span class="hs-special">`</span><span> </span><span class="hs-number">5#</span><span class="hs-cpp">
#elif SIZEOF_HSWORD == 8
</span><span id="bOOL_INDEX"><span class="annot"><span class="annottext">bOOL_INDEX :: Int# -&gt; Int#
</span><a href="Data.Array.Base.html#bOOL_INDEX"><span class="hs-identifier hs-var hs-var">bOOL_INDEX</span></a></span></span><span> </span><span id="local-6989586621679062760"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062760"><span class="hs-identifier hs-var">i#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062760"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftRA#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1443"></span><span class="annot"><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-type">bOOL_BIT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#bOOL_NOT_BIT"><span class="hs-identifier hs-type">bOOL_NOT_BIT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span>
</span><span id="line-1444"></span><span id="bOOL_BIT"><span class="annot"><span class="annottext">bOOL_BIT :: Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-var hs-var">bOOL_BIT</span></a></span></span><span>     </span><span id="local-6989586621679062761"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062761"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><span class="hs-operator hs-var">`uncheckedShiftL#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062761"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062762"><span class="hs-identifier hs-var">mask#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1445"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621679062762"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062762"><span class="hs-identifier hs-var">mask#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SIZEOF_HSWORD</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-1446"></span><span id="bOOL_NOT_BIT"><span class="annot"><span class="annottext">bOOL_NOT_BIT :: Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_NOT_BIT"><span class="hs-identifier hs-var hs-var">bOOL_NOT_BIT</span></a></span></span><span> </span><span id="local-6989586621679062769"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062769"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Data.Array.Base.html#bOOL_BIT"><span class="hs-identifier hs-var">bOOL_BIT</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062769"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`xor#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062770"><span class="hs-identifier hs-var">mb#</span></a></span><span>
</span><span id="line-1447"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621679062770"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679062770"><span class="hs-identifier hs-var">mb#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-1448"></span><span>
</span><span id="line-1449"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-1450"></span><span class="hs-comment">-- Freezing</span><span>
</span><span id="line-1451"></span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- | Converts a mutable array (any instance of 'MArray') to an</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- immutable array (any instance of 'IArray') by taking a complete</span><span>
</span><span id="line-1454"></span><span class="hs-comment">-- copy of it.</span><span>
</span><span id="line-1455"></span><span id="local-6989586621679062773"><span id="local-6989586621679062774"><span id="local-6989586621679062775"><span id="local-6989586621679062776"><span id="local-6989586621679062777"><span class="annot"><a href="Data.Array.Base.html#freeze"><span class="hs-identifier hs-type">freeze</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679062773"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062774"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062775"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062776"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062777"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062775"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062774"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062773"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062775"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062777"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062773"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062775"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1456"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#freeze"><span class="hs-pragma hs-type">freeze</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1457"></span><span id="freeze"><span class="annot"><span class="annottext">freeze :: forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#freeze"><span class="hs-identifier hs-var hs-var">freeze</span></a></span></span><span> </span><span id="local-6989586621679062801"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679062801"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679062802"><span class="annot"><a href="#local-6989586621679062802"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062803"><span class="annot"><a href="#local-6989586621679062803"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (i, i)
forall i. Ix i =&gt; a i e -&gt; m (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><a href="Data.Array.Base.html#getBounds"><span class="hs-identifier hs-var">getBounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679062801"><span class="hs-identifier hs-var">marr</span></a></span><span>
</span><span id="line-1459"></span><span>  </span><span id="local-6989586621679062804"><span class="annot"><a href="#local-6989586621679062804"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.Array.Base.html#getNumElements"><span class="hs-identifier hs-type">getNumElements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062801"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-1460"></span><span>  </span><span id="local-6989586621679062805"><span class="annot"><a href="#local-6989586621679062805"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#unsafeRead"><span class="hs-identifier hs-type">unsafeRead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062801"><span class="hs-identifier hs-type">marr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679062804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-1461"></span><span>  </span><span class="hs-comment">-- The old array and index might not be well-behaved, so we need to</span><span>
</span><span id="line-1462"></span><span>  </span><span class="hs-comment">-- use the safe array creation function here.</span><span>
</span><span id="line-1463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#listArray"><span class="hs-identifier hs-type">listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062802"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679062803"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679062805"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1464"></span><span>
</span><span id="line-1465"></span><span id="local-6989586621679062807"><span id="local-6989586621679062808"><span id="local-6989586621679062809"><span class="annot"><a href="Data.Array.Base.html#freezeSTUArray"><span class="hs-identifier hs-type">freezeSTUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062808"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062809"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679062807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062808"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062809"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1466"></span><span id="freezeSTUArray"><span class="annot"><span class="annottext">freezeSTUArray :: forall s i e. STUArray s i e -&gt; ST s (UArray i e)
</span><a href="Data.Array.Base.html#freezeSTUArray"><span class="hs-identifier hs-var hs-var">freezeSTUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062815"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062815"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062816"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062816"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679062817"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062817"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062818"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062818"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (UArray i e) -&gt; ST s (UArray i e)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (UArray i e) -&gt; ST s (UArray i e))
-&gt; STRep s (UArray i e) -&gt; ST s (UArray i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062819"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062819"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1467"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int#
forall d. MutableByteArray# d -&gt; Int#
</span><span class="hs-identifier hs-var">sizeofMutableByteArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062818"><span class="hs-identifier hs-var">marr#</span></a></span><span>  </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062820"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062820"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1468"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; (# State# s, MutableByteArray# s #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><span class="hs-identifier hs-var">newByteArray#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062820"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062819"><span class="hs-identifier hs-var">s1#</span></a></span><span>           </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062821"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062821"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062822"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062822"><span class="hs-identifier hs-var">marr'#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1469"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; MutableByteArray# s -&gt; CSize -&gt; IO (Ptr Any)
forall s a.
MutableByteArray# s -&gt; MutableByteArray# s -&gt; CSize -&gt; IO (Ptr a)
</span><a href="Data.Array.Base.html#memcpy_freeze"><span class="hs-identifier hs-var">memcpy_freeze</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062822"><span class="hs-identifier hs-var">marr'#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062818"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062820"><span class="hs-identifier hs-var">n#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span id="local-6989586621679062824"><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, Ptr Any #)
</span><a href="#local-6989586621679062824"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1470"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, Ptr Any #))
-&gt; State# s -&gt; (# State# s, Any #)
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce#</span></span><span> </span><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, Ptr Any #)
</span><a href="#local-6989586621679062824"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062821"><span class="hs-identifier hs-var">s2#</span></a></span><span>            </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062825"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062825"><span class="hs-identifier hs-var">s3#</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1471"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; State# s -&gt; (# State# s, ByteArray# #)
forall d.
MutableByteArray# d -&gt; State# d -&gt; (# State# d, ByteArray# #)
</span><span class="hs-identifier hs-var">unsafeFreezeByteArray#</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062822"><span class="hs-identifier hs-var">marr'#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062825"><span class="hs-identifier hs-var">s3#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062826"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062826"><span class="hs-identifier hs-var">s4#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062827"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062827"><span class="hs-identifier hs-var">arr#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1472"></span><span>    </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062826"><span class="hs-identifier hs-var">s4#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; ByteArray# -&gt; UArray i e
forall i e. i -&gt; i -&gt; Int -&gt; ByteArray# -&gt; UArray i e
</span><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-var">UArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062815"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062816"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062817"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062827"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1473"></span><span>
</span><span id="line-1474"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;memcpy&quot;</span></span><span>
</span><span id="line-1475"></span><span>    </span><span id="memcpy_freeze"><span class="annot"><a href="Data.Array.Base.html#memcpy_freeze"><span class="hs-identifier hs-var">memcpy_freeze</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059757"><span id="local-6989586621679059758"><span class="annot"><span class="hs-identifier hs-type">MutableByteArray#</span></span><span> </span><span class="annot"><a href="#local-6989586621679059757"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MutableByteArray#</span></span><span> </span><span class="annot"><a href="#local-6989586621679059757"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-1476"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059758"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1477"></span><span>
</span><span id="line-1478"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1479"></span><span class="annot"><span class="hs-pragma">&quot;freeze/STArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#freeze"><span class="hs-pragma hs-type">freeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">ArrST.freezeSTArray</span></span><span>
</span><span id="line-1480"></span><span class="annot"><span class="hs-pragma">&quot;freeze/STUArray&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#freeze"><span class="hs-pragma hs-type">freeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#freezeSTUArray"><span class="hs-pragma hs-type">freezeSTUArray</span></a></span><span>
</span><span id="line-1481"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1482"></span><span>
</span><span id="line-1483"></span><span class="hs-comment">-- In-place conversion of mutable arrays to immutable ones places</span><span>
</span><span id="line-1484"></span><span class="hs-comment">-- a proof obligation on the user: no other parts of your code can</span><span>
</span><span id="line-1485"></span><span class="hs-comment">-- have a reference to the array at the point where you unsafely</span><span>
</span><span id="line-1486"></span><span class="hs-comment">-- freeze it (and, subsequently mutate it, I suspect).</span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span class="annot"><span class="hs-comment">{- |
   Converts an mutable array into an immutable array.  The
   implementation may either simply cast the array from
   one type to the other without copying the array, or it
   may take a full copy of the array.

   Note that because the array is possibly not copied, any subsequent
   modifications made to the mutable version of the array may be
   shared with the immutable version.  It is safe to use, therefore, if
   the mutable version is never modified after the freeze operation.

   The non-copying implementation is supported between certain pairs
   of array types only; one constraint is that the array types must
   have identical representations.  In GHC, The following pairs of
   array types have a non-copying O(1) implementation of
   'unsafeFreeze'.  Because the optimised versions are enabled by
   specialisations, you will need to compile with optimisation (-O) to
   get them.

     * 'Data.Array.IO.IOUArray' -&gt; 'Data.Array.Unboxed.UArray'

     * 'Data.Array.ST.STUArray' -&gt; 'Data.Array.Unboxed.UArray'

     * 'Data.Array.IO.IOArray' -&gt; 'Data.Array.Array'

     * 'Data.Array.ST.STArray' -&gt; 'Data.Array.Array'
-}</span></span><span>
</span><span id="line-1515"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-pragma hs-type">unsafeFreeze</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1516"></span><span id="local-6989586621679058865"><span id="local-6989586621679058866"><span id="local-6989586621679058867"><span id="local-6989586621679058868"><span id="local-6989586621679058869"><span class="annot"><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-type">unsafeFreeze</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058865"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058867"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058868"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058869"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058867"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058865"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058867"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058869"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058865"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058867"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1517"></span><span id="unsafeFreeze"><span class="annot"><span class="annottext">unsafeFreeze :: forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-var hs-var">unsafeFreeze</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (b i e)
forall i (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) (b :: * -&gt; * -&gt; *).
(Ix i, MArray a e m, IArray b e) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#freeze"><span class="hs-identifier hs-var">freeze</span></a></span><span>
</span><span id="line-1518"></span><span>
</span><span id="line-1519"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1520"></span><span class="annot"><span class="hs-pragma">&quot;unsafeFreeze/STArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-pragma hs-type">unsafeFreeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">ArrST.unsafeFreezeSTArray</span></span><span>
</span><span id="line-1521"></span><span class="annot"><span class="hs-pragma">&quot;unsafeFreeze/STUArray&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-pragma hs-type">unsafeFreeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeSTUArray"><span class="hs-pragma hs-type">unsafeFreezeSTUArray</span></a></span><span>
</span><span id="line-1522"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- Thawing</span><span>
</span><span id="line-1526"></span><span>
</span><span id="line-1527"></span><span class="hs-comment">-- | Converts an immutable array (any instance of 'IArray') into a</span><span>
</span><span id="line-1528"></span><span class="hs-comment">-- mutable array (any instance of 'MArray') by taking a complete copy</span><span>
</span><span id="line-1529"></span><span class="hs-comment">-- of it.</span><span>
</span><span id="line-1530"></span><span id="local-6989586621679058904"><span id="local-6989586621679058905"><span id="local-6989586621679058906"><span id="local-6989586621679058907"><span id="local-6989586621679058908"><span class="annot"><a href="Data.Array.Base.html#thaw"><span class="hs-identifier hs-type">thaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679058904"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058905"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058906"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058907"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058906"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058905"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058904"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058906"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058908"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058907"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058904"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679058906"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1531"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#thaw"><span class="hs-pragma hs-type">thaw</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1532"></span><span id="thaw"><span class="annot"><span class="annottext">thaw :: forall i (a :: * -&gt; * -&gt; *) e (b :: * -&gt; * -&gt; *) (m :: * -&gt; *).
(Ix i, IArray a e, MArray b e m) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#thaw"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span id="local-6989586621679062858"><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679062858"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; (i, i)
forall i. Ix i =&gt; a i e -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><a href="Data.Array.Base.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">a i e
</span><a href="#local-6989586621679062858"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1533"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679062859"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062859"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062860"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062860"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1534"></span><span>    </span><span id="local-6989586621679062861"><span class="annot"><a href="#local-6989586621679062861"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; m (b i e)
forall i. Ix i =&gt; (i, i) -&gt; m (b i e)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="Data.Array.Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062859"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062860"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1535"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679062865"><span class="annot"><a href="#local-6989586621679062865"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int
forall i. Ix i =&gt; (i, i) -&gt; Int
</span><a href="Data.Array.Base.html#safeRangeSize"><span class="hs-identifier hs-var">safeRangeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062859"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062860"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1536"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeWrite"><span class="hs-identifier hs-type">unsafeWrite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062861"><span class="hs-identifier hs-type">marr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062866"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#unsafeAt"><span class="hs-identifier hs-type">unsafeAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062858"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062866"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679062866"><span class="annot"><a href="#local-6989586621679062866"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679062865"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1538"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679062861"><span class="hs-identifier hs-type">marr</span></a></span><span>
</span><span id="line-1539"></span><span>
</span><span id="line-1540"></span><span id="local-6989586621679059098"><span id="local-6989586621679059099"><span id="local-6989586621679059100"><span class="annot"><a href="Data.Array.Base.html#thawSTUArray"><span class="hs-identifier hs-type">thawSTUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059098"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059099"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059100"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059100"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059098"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059099"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1541"></span><span id="thawSTUArray"><span class="annot"><span class="annottext">thawSTUArray :: forall i e s. UArray i e -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#thawSTUArray"><span class="hs-identifier hs-var hs-var">thawSTUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679062869"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062869"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062870"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062870"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679062871"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062871"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062872"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062872"><span class="hs-identifier hs-var">arr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s (STUArray s i e) -&gt; ST s (STUArray s i e)
forall s a. STRep s a -&gt; ST s a
</span><span class="hs-identifier hs-var">ST</span></span><span> </span><span class="annot"><span class="annottext">(STRep s (STUArray s i e) -&gt; ST s (STUArray s i e))
-&gt; STRep s (STUArray s i e) -&gt; ST s (STUArray s i e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679062873"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062873"><span class="hs-identifier hs-var">s1#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1542"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">sizeofByteArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062872"><span class="hs-identifier hs-var">arr#</span></a></span><span>          </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679062874"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062874"><span class="hs-identifier hs-var">n#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1543"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; (# State# s, MutableByteArray# s #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><span class="hs-identifier hs-var">newByteArray#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062874"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062873"><span class="hs-identifier hs-var">s1#</span></a></span><span>           </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062875"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062875"><span class="hs-identifier hs-var">s2#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062876"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062876"><span class="hs-identifier hs-var">marr#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1544"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; ByteArray# -&gt; CSize -&gt; IO (Ptr Any)
forall s a.
MutableByteArray# s -&gt; ByteArray# -&gt; CSize -&gt; IO (Ptr a)
</span><a href="Data.Array.Base.html#memcpy_thaw"><span class="hs-identifier hs-var">memcpy_thaw</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062876"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062872"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679062874"><span class="hs-identifier hs-var">n#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span id="local-6989586621679062878"><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, Ptr Any #)
</span><a href="#local-6989586621679062878"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1545"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, Ptr Any #))
-&gt; State# s -&gt; (# State# s, Any #)
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce#</span></span><span> </span><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, Ptr Any #)
</span><a href="#local-6989586621679062878"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062875"><span class="hs-identifier hs-var">s2#</span></a></span><span>            </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679062879"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062879"><span class="hs-identifier hs-var">s3#</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1546"></span><span>    </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679062879"><span class="hs-identifier hs-var">s3#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
forall s i e.
i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
</span><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062869"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062870"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062871"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062876"><span class="hs-identifier hs-var">marr#</span></a></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1547"></span><span>
</span><span id="line-1548"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;memcpy&quot;</span></span><span>
</span><span id="line-1549"></span><span>    </span><span id="memcpy_thaw"><span class="annot"><a href="Data.Array.Base.html#memcpy_thaw"><span class="hs-identifier hs-var">memcpy_thaw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679059774"><span id="local-6989586621679059775"><span class="annot"><span class="hs-identifier hs-type">MutableByteArray#</span></span><span> </span><span class="annot"><a href="#local-6989586621679059774"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-1550"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679059775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1551"></span><span>
</span><span id="line-1552"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1553"></span><span class="annot"><span class="hs-pragma">&quot;thaw/STArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#thaw"><span class="hs-pragma hs-type">thaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">ArrST.thawSTArray</span></span><span>
</span><span id="line-1554"></span><span class="annot"><span class="hs-pragma">&quot;thaw/STUArray&quot;</span></span><span> </span><span class="annot"><a href="Data.Array.Base.html#thaw"><span class="hs-pragma hs-type">thaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#thawSTUArray"><span class="hs-pragma hs-type">thawSTUArray</span></a></span><span>
</span><span id="line-1555"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1556"></span><span>
</span><span id="line-1557"></span><span class="hs-comment">-- In-place conversion of immutable arrays to mutable ones places</span><span>
</span><span id="line-1558"></span><span class="hs-comment">-- a proof obligation on the user: no other parts of your code can</span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- have a reference to the array at the point where you unsafely</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- thaw it (and, subsequently mutate it, I suspect).</span><span>
</span><span id="line-1561"></span><span>
</span><span id="line-1562"></span><span class="annot"><span class="hs-comment">{- |
   Converts an immutable array into a mutable array.  The
   implementation may either simply cast the array from
   one type to the other without copying the array, or it
   may take a full copy of the array.

   Note that because the array is possibly not copied, any subsequent
   modifications made to the mutable version of the array may be
   shared with the immutable version.  It is only safe to use,
   therefore, if the immutable array is never referenced again in this
   thread, and there is no possibility that it can be also referenced
   in another thread.  If you use an unsafeThaw/write/unsafeFreeze
   sequence in a multi-threaded setting, then you must ensure that
   this sequence is atomic with respect to other threads, or a garbage
   collector crash may result (because the write may be writing to a
   frozen array).

   The non-copying implementation is supported between certain pairs
   of array types only; one constraint is that the array types must
   have identical representations.  In GHC, The following pairs of
   array types have a non-copying O(1) implementation of
   'unsafeThaw'.  Because the optimised versions are enabled by
   specialisations, you will need to compile with optimisation (-O) to
   get them.

     * 'Data.Array.Unboxed.UArray' -&gt; 'Data.Array.IO.IOUArray'

     * 'Data.Array.Unboxed.UArray' -&gt; 'Data.Array.ST.STUArray'

     * 'Data.Array.Array'  -&gt; 'Data.Array.IO.IOArray'

     * 'Data.Array.Array'  -&gt; 'Data.Array.ST.STArray'
-}</span></span><span>
</span><span id="line-1595"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-pragma hs-type">unsafeThaw</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1596"></span><span id="local-6989586621679062882"><span id="local-6989586621679062883"><span id="local-6989586621679062884"><span id="local-6989586621679062885"><span id="local-6989586621679062886"><span class="annot"><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-identifier hs-type">unsafeThaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621679062882"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#IArray"><span class="hs-identifier hs-type">IArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062884"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Array.Base.html#MArray"><span class="hs-identifier hs-type">MArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062885"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062884"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062882"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062884"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062885"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062882"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062884"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1597"></span><span id="unsafeThaw"><span class="annot"><span class="annottext">unsafeThaw :: forall i (a :: * -&gt; * -&gt; *) e (b :: * -&gt; * -&gt; *) (m :: * -&gt; *).
(Ix i, IArray a e, MArray b e m) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-identifier hs-var hs-var">unsafeThaw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i e -&gt; m (b i e)
forall i (a :: * -&gt; * -&gt; *) e (b :: * -&gt; * -&gt; *) (m :: * -&gt; *).
(Ix i, IArray a e, MArray b e m) =&gt;
a i e -&gt; m (b i e)
</span><a href="Data.Array.Base.html#thaw"><span class="hs-identifier hs-var">thaw</span></a></span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeThawSTUArray"><span class="hs-pragma hs-type">unsafeThawSTUArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1600"></span><span id="local-6989586621679062894"><span id="local-6989586621679062895"><span id="local-6989586621679062896"><span class="annot"><a href="Data.Array.Base.html#unsafeThawSTUArray"><span class="hs-identifier hs-type">unsafeThawSTUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062894"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062895"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679062896"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062896"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062894"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062895"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1601"></span><span id="unsafeThawSTUArray"><span class="annot"><span class="annottext">unsafeThawSTUArray :: forall i e s. UArray i e -&gt; ST s (STUArray s i e)
</span><a href="Data.Array.Base.html#unsafeThawSTUArray"><span class="hs-identifier hs-var hs-var">unsafeThawSTUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span id="local-6989586621679062898"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062898"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062899"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062899"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679062900"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062900"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062901"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062901"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1602"></span><span>    </span><span class="annot"><span class="annottext">STUArray s i e -&gt; ST s (STUArray s i e)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
forall s i e.
i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
</span><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062898"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062899"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062900"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; MutableByteArray# s
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679062901"><span class="hs-identifier hs-var">marr#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>
</span><span id="line-1604"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1605"></span><span class="annot"><span class="hs-pragma">&quot;unsafeThaw/STArray&quot;</span></span><span>    </span><span class="annot"><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-pragma hs-type">unsafeThaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">ArrST.unsafeThawSTArray</span></span><span>
</span><span id="line-1606"></span><span class="annot"><span class="hs-pragma">&quot;unsafeThaw/STUArray&quot;</span></span><span>   </span><span class="annot"><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-pragma hs-type">unsafeThaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeThawSTUArray"><span class="hs-pragma hs-type">unsafeThawSTUArray</span></a></span><span>
</span><span id="line-1607"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1608"></span><span>
</span><span id="line-1609"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeThawIOArray"><span class="hs-pragma hs-type">unsafeThawIOArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1610"></span><span id="local-6989586621679059784"><span id="local-6989586621679059785"><span class="annot"><a href="Data.Array.Base.html#unsafeThawIOArray"><span class="hs-identifier hs-type">unsafeThawIOArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arr.Array</span></span><span> </span><span class="annot"><a href="#local-6989586621679059784"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059785"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679059784"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059785"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1611"></span><span id="unsafeThawIOArray"><span class="annot"><span class="annottext">unsafeThawIOArray :: forall ix e. Array ix e -&gt; IO (IOArray ix e)
</span><a href="Data.Array.Base.html#unsafeThawIOArray"><span class="hs-identifier hs-var hs-var">unsafeThawIOArray</span></a></span></span><span> </span><span id="local-6989586621679062906"><span class="annot"><span class="annottext">Array ix e
</span><a href="#local-6989586621679062906"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e)
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="annot"><span class="annottext">(ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e))
-&gt; ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1612"></span><span>    </span><span id="local-6989586621679062907"><span class="annot"><a href="#local-6989586621679062907"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array ix e -&gt; ST RealWorld (STArray RealWorld ix e)
forall i e s. Array i e -&gt; ST s (STArray s i e)
</span><span class="hs-identifier hs-var">ArrST.unsafeThawSTArray</span></span><span> </span><span class="annot"><span class="annottext">Array ix e
</span><a href="#local-6989586621679062906"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-1613"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679062907"><span class="hs-identifier hs-type">marr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span>
</span><span id="line-1615"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1616"></span><span class="annot"><span class="hs-pragma">&quot;unsafeThaw/IOArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeThaw"><span class="hs-pragma hs-type">unsafeThaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeThawIOArray"><span class="hs-pragma hs-type">unsafeThawIOArray</span></a></span><span>
</span><span id="line-1617"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1618"></span><span>
</span><span id="line-1619"></span><span id="local-6989586621679062908"><span id="local-6989586621679062909"><span class="annot"><a href="Data.Array.Base.html#thawIOArray"><span class="hs-identifier hs-type">thawIOArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arr.Array</span></span><span> </span><span class="annot"><a href="#local-6989586621679062908"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062909"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679062908"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062909"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1620"></span><span id="thawIOArray"><span class="annot"><span class="annottext">thawIOArray :: forall ix e. Array ix e -&gt; IO (IOArray ix e)
</span><a href="Data.Array.Base.html#thawIOArray"><span class="hs-identifier hs-var hs-var">thawIOArray</span></a></span></span><span> </span><span id="local-6989586621679062913"><span class="annot"><span class="annottext">Array ix e
</span><a href="#local-6989586621679062913"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e)
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="annot"><span class="annottext">(ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e))
-&gt; ST RealWorld (IOArray ix e) -&gt; IO (IOArray ix e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1621"></span><span>    </span><span id="local-6989586621679062914"><span class="annot"><a href="#local-6989586621679062914"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array ix e -&gt; ST RealWorld (STArray RealWorld ix e)
forall i e s. Array i e -&gt; ST s (STArray s i e)
</span><span class="hs-identifier hs-var">ArrST.thawSTArray</span></span><span> </span><span class="annot"><span class="annottext">Array ix e
</span><a href="#local-6989586621679062913"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-1622"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679062914"><span class="hs-identifier hs-type">marr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1623"></span><span>
</span><span id="line-1624"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1625"></span><span class="annot"><span class="hs-pragma">&quot;thaw/IOArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#thaw"><span class="hs-pragma hs-type">thaw</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#thawIOArray"><span class="hs-pragma hs-type">thawIOArray</span></a></span><span>
</span><span id="line-1626"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span id="local-6989586621679059795"><span id="local-6989586621679059796"><span class="annot"><a href="Data.Array.Base.html#freezeIOArray"><span class="hs-identifier hs-type">freezeIOArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679059795"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059796"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arr.Array</span></span><span> </span><span class="annot"><a href="#local-6989586621679059795"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059796"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1629"></span><span id="freezeIOArray"><span class="annot"><span class="annottext">freezeIOArray :: forall ix e. IOArray ix e -&gt; IO (Array ix e)
</span><a href="Data.Array.Base.html#freezeIOArray"><span class="hs-identifier hs-var hs-var">freezeIOArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span id="local-6989586621679062916"><span class="annot"><span class="annottext">STArray RealWorld ix e
</span><a href="#local-6989586621679062916"><span class="hs-identifier hs-var">marr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld (Array ix e) -&gt; IO (Array ix e)
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STArray RealWorld ix e -&gt; ST RealWorld (Array ix e)
forall s i e. STArray s i e -&gt; ST s (Array i e)
</span><span class="hs-identifier hs-var">ArrST.freezeSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld ix e
</span><a href="#local-6989586621679062916"><span class="hs-identifier hs-var">marr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>
</span><span id="line-1631"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1632"></span><span class="annot"><span class="hs-pragma">&quot;freeze/IOArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#freeze"><span class="hs-pragma hs-type">freeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#freezeIOArray"><span class="hs-pragma hs-type">freezeIOArray</span></a></span><span>
</span><span id="line-1633"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1634"></span><span>
</span><span id="line-1635"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeIOArray"><span class="hs-pragma hs-type">unsafeFreezeIOArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1636"></span><span id="local-6989586621679062918"><span id="local-6989586621679062919"><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeIOArray"><span class="hs-identifier hs-type">unsafeFreezeIOArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679062918"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062919"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arr.Array</span></span><span> </span><span class="annot"><a href="#local-6989586621679062918"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062919"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1637"></span><span id="unsafeFreezeIOArray"><span class="annot"><span class="annottext">unsafeFreezeIOArray :: forall ix e. IOArray ix e -&gt; IO (Array ix e)
</span><a href="Data.Array.Base.html#unsafeFreezeIOArray"><span class="hs-identifier hs-var hs-var">unsafeFreezeIOArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span id="local-6989586621679062920"><span class="annot"><span class="annottext">STArray RealWorld ix e
</span><a href="#local-6989586621679062920"><span class="hs-identifier hs-var">marr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST RealWorld (Array ix e) -&gt; IO (Array ix e)
forall a. ST RealWorld a -&gt; IO a
</span><span class="hs-identifier hs-var">stToIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STArray RealWorld ix e -&gt; ST RealWorld (Array ix e)
forall s i e. STArray s i e -&gt; ST s (Array i e)
</span><span class="hs-identifier hs-var">ArrST.unsafeFreezeSTArray</span></span><span> </span><span class="annot"><span class="annottext">STArray RealWorld ix e
</span><a href="#local-6989586621679062920"><span class="hs-identifier hs-var">marr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1638"></span><span>
</span><span id="line-1639"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1640"></span><span class="annot"><span class="hs-pragma">&quot;unsafeFreeze/IOArray&quot;</span></span><span>  </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreeze"><span class="hs-pragma hs-type">unsafeFreeze</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Array.Base.html#unsafeFreezeIOArray"><span class="hs-pragma hs-type">unsafeFreezeIOArray</span></a></span><span>
</span><span id="line-1641"></span><span>    </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="hs-comment">-- | Casts an 'STUArray' with one element type into one with a</span><span>
</span><span id="line-1644"></span><span class="hs-comment">-- different element type.  All the elements of the resulting array</span><span>
</span><span id="line-1645"></span><span class="hs-comment">-- are undefined (unless you know what you\'re doing...).</span><span>
</span><span id="line-1646"></span><span>
</span><span id="line-1647"></span><span id="local-6989586621679059804"><span id="local-6989586621679059805"><span id="local-6989586621679059806"><span id="local-6989586621679059807"><span class="annot"><a href="Data.Array.Base.html#castSTUArray"><span class="hs-identifier hs-type">castSTUArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059805"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059806"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679059804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059805"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059807"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1648"></span><span id="castSTUArray"><span class="annot"><span class="annottext">castSTUArray :: forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="Data.Array.Base.html#castSTUArray"><span class="hs-identifier hs-var hs-var">castSTUArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-type">STUArray</span></a></span><span> </span><span id="local-6989586621679062923"><span class="annot"><span class="annottext">ix
</span><a href="#local-6989586621679062923"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679062924"><span class="annot"><span class="annottext">ix
</span><a href="#local-6989586621679062924"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679062925"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062925"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062926"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062926"><span class="hs-identifier hs-var">marr#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s ix b -&gt; ST s (STUArray s ix b)
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ix -&gt; ix -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s ix b
forall s i e.
i -&gt; i -&gt; Int -&gt; MutableByteArray# s -&gt; STUArray s i e
</span><a href="Data.Array.Base.html#STUArray"><span class="hs-identifier hs-var">STUArray</span></a></span><span> </span><span class="annot"><span class="annottext">ix
</span><a href="#local-6989586621679062923"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ix
</span><a href="#local-6989586621679062924"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062925"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679062926"><span class="hs-identifier hs-var">marr#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1649"></span><span>
</span><span id="line-1650"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1651"></span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- Note [Inlining and fusion]</span><span>
</span><span id="line-1653"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-1654"></span><span class="hs-comment">-- Many functions in this module are marked INLINE because they consume their</span><span>
</span><span id="line-1655"></span><span class="hs-comment">-- input with `foldr`. By inlining them, it is possible that the `foldr` will</span><span>
</span><span id="line-1656"></span><span class="hs-comment">-- meet a `build` from the call site, and beneficial fusion will take place.</span><span>
</span><span id="line-1657"></span><span class="hs-comment">-- That is, they become &quot;good consumers&quot;. See array issue #8 for data showing</span><span>
</span><span id="line-1658"></span><span class="hs-comment">-- the perf improvement that comes with fusion.</span><span>
</span><span id="line-1659"></span></pre></body></html>