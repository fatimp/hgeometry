<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Generating machine code (instruction selection)</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- (c) The University of Glasgow 1996-2004</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- This is a big module, but, if you pay attention to</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- (a) the sectioning, and (b) the type signatures, the</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- structure should not be too overwhelming.</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html"><span class="hs-identifier">GHC.CmmToAsm.X86.CodeGen</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier">cmmTopCodeGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier">generateJumpTableForInstr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier">extractUnwindPoints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier">invertCondBranches</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier">InstrBlock</span></a></span><span>
</span><span id="line-25"></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- NCG stuff:</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Instr</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Cond</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Regs</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Ppr.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Ppr</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.RegInfo.html"><span class="hs-identifier">GHC.CmmToAsm.X86.RegInfo</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Regs.html"><span class="hs-identifier">GHC.Platform.Regs</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html"><span class="hs-identifier">GHC.CmmToAsm.CPrim</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html"><span class="hs-identifier">GHC.CmmToAsm.Types</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html"><span class="hs-identifier">GHC.Cmm.DebugBlock</span></a></span><span>
</span><span id="line-42"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#DebugBlock"><span class="hs-identifier">DebugBlock</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier">UnwindPoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindTable"><span class="hs-identifier">UnwindTable</span></a></span><span>
</span><span id="line-43"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindExpr"><span class="hs-identifier">UnwindExpr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UwReg"><span class="hs-identifier">UwReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#toUnwindExpr"><span class="hs-identifier">toUnwindExpr</span></a></span><span>
</span><span id="line-44"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html"><span class="hs-identifier">GHC.CmmToAsm.PIC</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html"><span class="hs-identifier">GHC.CmmToAsm.Monad</span></a></span><span>
</span><span id="line-47"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier">NatM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier">getNewRegNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier">getNewLabelNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier">setDeltaNat</span></a></span><span>
</span><span id="line-48"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier">getDeltaNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier">getBlockIdNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier">getPicBaseNat</span></a></span><span>
</span><span id="line-49"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier">Reg64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier">RegCode64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier">getNewReg64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier">localReg64</span></a></span><span>
</span><span id="line-50"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier">getPicBaseMaybeNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier">getDebugBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier">getFileId</span></a></span><span>
</span><span id="line-51"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier">addImmediateSuccessorNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier">updateCfgNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier">getConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier">getPlatform</span></a></span><span>
</span><span id="line-52"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier">getCfgWeights</span></a></span><span>
</span><span id="line-53"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html"><span class="hs-identifier">GHC.CmmToAsm.CFG</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html"><span class="hs-identifier">GHC.CmmToAsm.Format</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html"><span class="hs-identifier">GHC.CmmToAsm.Config</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html"><span class="hs-identifier">GHC.Platform.Reg</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- Our intermediate code:</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html"><span class="hs-identifier">GHC.Cmm.BlockId</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html"><span class="hs-identifier">GHC.Unit.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#primUnitId"><span class="hs-identifier">primUnitId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Utils.html"><span class="hs-identifier">GHC.Cmm.Utils</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html"><span class="hs-identifier">GHC.Cmm.Switch</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.html"><span class="hs-identifier">GHC.Cmm</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Block</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Graph</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Label</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html#GenTickish"><span class="hs-identifier">GenTickish</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier">srcSpanFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier">srcSpanStartLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier">srcSpanStartCol</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- The rest:</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier">CCallConv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html"><span class="hs-identifier">GHC.Data.OrdList</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Constants.html"><span class="hs-identifier">GHC.Utils.Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier">debugIsOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#getUniqueM"><span class="hs-identifier">getUniqueM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Control.Monad.html/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Foldable.html/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fold</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Int.html/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Maybe.html/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.20.0.0-4014/src//Data.Word.html/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-7628/src//Data.Map.html/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-93"></span><span id="is32BitPlatform"><span class="annot"><span class="annottext">is32BitPlatform :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var hs-var">is32BitPlatform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621682657855"><span class="annot"><a href="#local-6989586621682657855"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-type">target32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657855"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-type">expect32BitPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span id="expect32BitPlatform"><span class="annot"><span class="annottext">expect32BitPlatform :: SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var hs-var">expect32BitPlatform</span></a></span></span><span> </span><span id="local-6989586621682657858"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682657858"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621682657859"><span class="annot"><a href="#local-6989586621682657859"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682657859"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Expecting 32-bit platform&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682657858"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-type">sse2Enabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-104"></span><span id="sse2Enabled"><span class="annot"><span class="annottext">sse2Enabled :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-var hs-var">sse2Enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621682657864"><span class="annot"><a href="#local-6989586621682657864"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgSseVersion"><span class="hs-identifier hs-var">ncgSseVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657864"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#SSE2"><span class="hs-identifier hs-type">SSE2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-type">sse4_2Enabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-109"></span><span id="sse4_2Enabled"><span class="annot"><span class="annottext">sse4_2Enabled :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-var hs-var">sse4_2Enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621682657868"><span class="annot"><a href="#local-6989586621682657868"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgSseVersion"><span class="hs-identifier hs-var">ncgSseVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657868"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#SSE42"><span class="hs-identifier hs-type">SSE42</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-type">cmmTopCodeGen</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmDecl"><span class="hs-identifier hs-type">RawCmmDecl</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="cmmTopCodeGen"><span class="annot"><span class="annottext">cmmTopCodeGen :: RawCmmDecl -&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var hs-var">cmmTopCodeGen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-type">CmmProc</span></a></span><span> </span><span id="local-6989586621682657871"><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682657871"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682657872"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682657872"><span class="hs-identifier hs-var">lab</span></a></span></span><span> </span><span id="local-6989586621682657873"><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682657873"><span class="hs-identifier hs-var">live</span></a></span></span><span> </span><span id="local-6989586621682657874"><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682657874"><span class="hs-identifier hs-var">graph</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657875"><span class="annot"><span class="annottext">blocks :: [CmmBlock]
</span><a href="#local-6989586621682657875"><span class="hs-identifier hs-var hs-var hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmGraph -&gt; [CmmBlock]
</span><a href="GHC.Cmm.Utils.html#toBlockListEntryFirst"><span class="hs-identifier hs-var">toBlockListEntryFirst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682657874"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682657877"><span class="annot"><a href="#local-6989586621682657877"><span class="hs-identifier hs-var">nat_blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657878"><span class="annot"><a href="#local-6989586621682657878"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CmmBlock
 -&gt; NatM
      ([NatBasicBlock Instr],
       [NatCmmDecl (Alignment, RawCmmStatics) Instr]))
-&gt; [CmmBlock]
-&gt; NatM
     ([[NatBasicBlock Instr]],
      [[NatCmmDecl (Alignment, RawCmmStatics) Instr]])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><span class="hs-identifier hs-var">mapAndUnzipM</span></span><span> </span><span class="annot"><span class="annottext">CmmBlock
-&gt; NatM
     ([NatBasicBlock Instr],
      [NatCmmDecl (Alignment, RawCmmStatics) Instr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-var">basicBlockCodeGen</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmBlock]
</span><a href="#local-6989586621682657875"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621682657881"><span class="annot"><a href="#local-6989586621682657881"><span class="hs-identifier hs-var">picBaseMb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-type">getPicBaseMaybeNat</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621682657882"><span class="annot"><a href="#local-6989586621682657882"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657883"><span class="annot"><a href="#local-6989586621682657883"><span class="hs-identifier hs-var hs-var">proc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
-&gt; CLabel
-&gt; [GlobalReg]
-&gt; ListGraph Instr
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall d h g. h -&gt; CLabel -&gt; [GlobalReg] -&gt; g -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-var">CmmProc</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682657871"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682657872"><span class="hs-identifier hs-var">lab</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682657873"><span class="hs-identifier hs-var">live</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; ListGraph Instr
forall i. [GenBasicBlock i] -&gt; ListGraph i
</span><a href="GHC.Cmm.html#ListGraph"><span class="hs-identifier hs-var">ListGraph</span></a></span><span> </span><span class="annot"><span class="annottext">([NatBasicBlock Instr] -&gt; ListGraph Instr)
-&gt; [NatBasicBlock Instr] -&gt; ListGraph Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]] -&gt; [NatBasicBlock Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]]
</span><a href="#local-6989586621682657877"><span class="hs-identifier hs-var">nat_blocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621682657886"><span class="annot"><a href="#local-6989586621682657886"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
</span><a href="#local-6989586621682657883"><span class="hs-identifier hs-var">proc</span></a></span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl (Alignment, RawCmmStatics) Instr]]
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl (Alignment, RawCmmStatics) Instr]]
</span><a href="#local-6989586621682657878"><span class="hs-identifier hs-var">statics</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621682657887"><span class="annot"><a href="#local-6989586621682657887"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682657882"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682657881"><span class="hs-identifier hs-type">picBaseMb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682657889"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682657889"><span class="hs-identifier hs-var">picBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arch
-&gt; OS
-&gt; Reg
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="GHC.CmmToAsm.PIC.html#initializePicBase_x86"><span class="hs-identifier hs-var">initializePicBase_x86</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier hs-var">ArchX86</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621682657887"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682657889"><span class="hs-identifier hs-var">picBase</span></a></span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="#local-6989586621682657886"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">Maybe Reg
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="#local-6989586621682657886"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var">cmmTopCodeGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span> </span><span id="local-6989586621682657893"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682657893"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682657894"><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682657894"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682657893"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682657894"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- no translation, we just use CmmStatic</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">{- Note [Verifying basic blocks]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   We want to guarantee a few things about the results
   of instruction selection.

   Namely that each basic blocks consists of:
    * A (potentially empty) sequence of straight line instructions
  followed by
    * A (potentially empty) sequence of jump like instructions.

    We can verify this by going through the instructions and
    making sure that any non-jumpish instruction can't appear
    after a jumpish instruction.

    There are gotchas however:
    * CALLs are strictly speaking control flow but here we care
      not about them. Hence we treat them as regular instructions.

      It's safe for them to appear inside a basic block
      as (ignoring side effects inside the call) they will result in
      straight line code.

    * NEWBLOCK marks the start of a new basic block so can
      be followed by any instructions.
-}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- Verifying basic blocks is cheap, but not cheap enough to enable it unconditionally.</span><span>
</span><span id="line-160"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-type">verifyBasicBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="verifyBasicBlock"><span class="annot"><span class="annottext">verifyBasicBlock :: Platform -&gt; [Instr] -&gt; ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-var hs-var">verifyBasicBlock</span></a></span></span><span> </span><span id="local-6989586621682657897"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682657897"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682657898"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657898"><span class="hs-identifier hs-var">instrs</span></a></span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657898"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621682657899"><span class="annot"><span class="annottext">go :: Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682657900"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682657900"><span class="hs-identifier hs-var">atEnd</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682657901"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682657902"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657902"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-comment">-- Start a new basic block</span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657902"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="hs-comment">-- Calls are not viable block terminators</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682657900"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; ()
</span><a href="#local-6989586621682657905"><span class="hs-identifier hs-var">faultyBlockWith</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-172"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682657900"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682657900"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657902"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-comment">-- All instructions ok, check if we reached the end and continue.</span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682657900"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.Instr.html#isJumpishInstr"><span class="hs-identifier hs-var">isJumpishInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657902"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-175"></span><span>              </span><span class="hs-comment">-- Only jumps allowed at the end of basic blocks.</span><span>
</span><span id="line-176"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.Instr.html#isJumpishInstr"><span class="hs-identifier hs-var">isJumpishInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-177"></span><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682657899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657902"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-178"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; ()
</span><a href="#local-6989586621682657905"><span class="hs-identifier hs-var">faultyBlockWith</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657901"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621682657905"><span class="annot"><span class="annottext">faultyBlockWith :: Instr -&gt; ()
</span><a href="#local-6989586621682657905"><span class="hs-identifier hs-var hs-var">faultyBlockWith</span></a></span></span><span> </span><span id="local-6989586621682657907"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657907"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; ()
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non control flow instructions after end of basic block.&quot;</span></span><span>
</span><span id="line-181"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Instr -&gt; SDoc
forall doc. IsDoc doc =&gt; Platform -&gt; Instr -&gt; doc
</span><a href="GHC.CmmToAsm.X86.Ppr.html#pprInstr"><span class="hs-identifier hs-var">pprInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682657897"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657907"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instr -&gt; SDoc) -&gt; [Instr] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Instr -&gt; SDoc
forall doc. IsDoc doc =&gt; Platform -&gt; Instr -&gt; doc
</span><a href="GHC.CmmToAsm.X86.Ppr.html#pprInstr"><span class="hs-identifier hs-var">pprInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682657897"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657898"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-type">basicBlockCodeGen</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmBlock"><span class="hs-identifier hs-type">CmmBlock</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="basicBlockCodeGen"><span class="annot"><span class="annottext">basicBlockCodeGen :: CmmBlock
-&gt; NatM
     ([NatBasicBlock Instr],
      [NatCmmDecl (Alignment, RawCmmStatics) Instr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-var hs-var">basicBlockCodeGen</span></a></span></span><span> </span><span id="local-6989586621682657913"><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682657913"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmNode C O
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682657914"><span class="annot"><span class="annottext">Block CmmNode O O
</span><a href="#local-6989586621682657914"><span class="hs-identifier hs-var hs-var">nodes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682657915"><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682657915"><span class="hs-identifier hs-var hs-var">tail</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmBlock -&gt; (CmmNode C O, Block CmmNode O O, CmmNode O C)
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Block n C C -&gt; (n C O, Block n O O, n O C)
</span><a href="GHC.Cmm.Dataflow.Block.html#blockSplit"><span class="hs-identifier hs-var">blockSplit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682657913"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621682657917"><span class="annot"><span class="annottext">id :: Label
</span><a href="#local-6989586621682657917"><span class="hs-identifier hs-var hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmBlock -&gt; Label
forall (x :: Extensibility). Block CmmNode C x -&gt; Label
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; Label
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682657913"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span id="local-6989586621682657919"><span class="annot"><span class="annottext">stmts :: [CmmNode O O]
</span><a href="#local-6989586621682657919"><span class="hs-identifier hs-var hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O -&gt; [CmmNode O O]
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Block n O O -&gt; [n O O]
</span><a href="GHC.Cmm.Dataflow.Block.html#blockToList"><span class="hs-identifier hs-var">blockToList</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O
</span><a href="#local-6989586621682657914"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- Generate location directive</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621682657921"><span class="annot"><a href="#local-6989586621682657921"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; NatM (Maybe DebugBlock)
</span><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier hs-var">getDebugBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmBlock -&gt; Label
forall (x :: Extensibility). Block CmmNode C x -&gt; Label
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; Label
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682657913"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621682657922"><span class="annot"><a href="#local-6989586621682657922"><span class="hs-identifier hs-var">loc_instrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#dblSourceTick"><span class="hs-identifier hs-var">dblSourceTick</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682657921"><span class="hs-identifier hs-type">dbg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#SourceNote"><span class="hs-identifier hs-type">SourceNote</span></a></span><span> </span><span id="local-6989586621682657926"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682657926"><span class="hs-identifier hs-var">span</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier hs-type">LexicalFastString</span></a></span><span> </span><span id="local-6989586621682657928"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682657928"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682657929"><span class="annot"><a href="#local-6989586621682657929"><span class="hs-identifier hs-var">fileId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier hs-var">getFileId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682657926"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657930"><span class="annot"><a href="#local-6989586621682657930"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682657926"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682657931"><span class="annot"><a href="#local-6989586621682657931"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier hs-var">srcSpanStartCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682657926"><span class="hs-identifier hs-var">span</span></a></span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LOCATION"><span class="hs-identifier hs-type">LOCATION</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657929"><span class="hs-identifier hs-type">fileId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657930"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657931"><span class="hs-identifier hs-type">col</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier hs-type">unpackFS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">Maybe CmmTickish
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682657936"><span class="annot"><a href="#local-6989586621682657936"><span class="hs-identifier hs-var">mid_instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657937"><span class="annot"><a href="#local-6989586621682657937"><span class="hs-identifier hs-var">mid_bid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657917"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657919"><span class="hs-identifier hs-type">stmts</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682657939"><span class="annot"><a href="#local-6989586621682657939"><span class="hs-identifier hs-var">tail_instrs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657937"><span class="hs-identifier hs-type">mid_bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657915"><span class="hs-identifier hs-type">tail</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657941"><span class="annot"><a href="#local-6989586621682657941"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657922"><span class="hs-identifier hs-var">loc_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657936"><span class="hs-identifier hs-var">mid_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657939"><span class="hs-identifier hs-var">tail_instrs</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621682657943"><span class="annot"><a href="#local-6989586621682657943"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-type">verifyBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657943"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#fromOL"><span class="hs-identifier hs-type">fromOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657941"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621682657946"><span class="annot"><a href="#local-6989586621682657946"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fold</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-type">addSpUnwindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657941"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- code generation may introduce new basic block boundaries, which</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- are indicated by the NEWBLOCK instruction.  We must split up the</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">-- instruction stream into basic blocks again.  Also, we extract</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">-- LDATAs here too.</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682657950"><span class="annot"><a href="#local-6989586621682657950"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657951"><span class="annot"><a href="#local-6989586621682657951"><span class="hs-identifier hs-var">other_blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657952"><span class="annot"><a href="#local-6989586621682657952"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#foldrOL"><span class="hs-identifier hs-type">foldrOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657954"><span class="hs-identifier hs-type">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682657946"><span class="hs-identifier hs-type">instrs'</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621682657954"><span class="annot"><a href="#local-6989586621682657954"><span class="hs-identifier hs-var hs-var">mkBlocks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span id="local-6989586621682657955"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657955"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682657956"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657956"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657957"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657957"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657958"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657958"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. Label -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657955"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657956"><span class="hs-identifier hs-var">instrs</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657957"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657958"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="#local-6989586621682657954"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LDATA"><span class="hs-identifier hs-type">LDATA</span></a></span><span> </span><span id="local-6989586621682657961"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682657961"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682657962"><span class="annot"><span class="annottext">(Alignment, RawCmmStatics)
</span><a href="#local-6989586621682657962"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682657963"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657963"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657964"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657964"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657965"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657965"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657963"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657964"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682657961"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">(Alignment, RawCmmStatics)
</span><a href="#local-6989586621682657962"><span class="hs-identifier hs-var">dat</span></a></span><span class="annot"><span class="annottext">GenCmmDecl (Alignment, RawCmmStatics) h g
-&gt; [GenCmmDecl (Alignment, RawCmmStatics) h g]
-&gt; [GenCmmDecl (Alignment, RawCmmStatics) h g]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657965"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="#local-6989586621682657954"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span id="local-6989586621682657966"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657966"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682657967"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657967"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657968"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657968"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682657969"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657969"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657966"><span class="hs-identifier hs-var">instr</span></a></span><span class="annot"><span class="annottext">Instr -&gt; [Instr] -&gt; [Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682657967"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682657968"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682657969"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657917"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657950"><span class="hs-identifier hs-type">top</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682657951"><span class="hs-identifier hs-type">other_blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682657952"><span class="hs-identifier hs-type">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Convert 'DELTA' instructions into 'UNWIND' instructions to capture changes</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- in the @sp@ register. See Note [What is this unwinding business?] in &quot;GHC.Cmm.DebugBlock&quot;</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- for details.</span><span>
</span><span id="line-224"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-type">addSpUnwindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span id="addSpUnwindings"><span class="annot"><span class="annottext">addSpUnwindings :: Instr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-var hs-var">addSpUnwindings</span></a></span></span><span> </span><span id="local-6989586621682657972"><span class="annot"><span class="annottext">instr :: Instr
</span><a href="#local-6989586621682657972"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span id="local-6989586621682657973"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682657973"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621682657974"><span class="annot"><a href="#local-6989586621682657974"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657975"><span class="annot"><a href="#local-6989586621682657975"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682657974"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgDwarfUnwindings"><span class="hs-identifier hs-var">ncgDwarfUnwindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657974"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682657978"><span class="annot"><a href="#local-6989586621682657978"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#mkAsmTempLabel"><span class="hs-identifier hs-type">mkAsmTempLabel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#getUniqueM"><span class="hs-identifier hs-type">getUniqueM</span></a></span><span>
</span><span id="line-230"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682657980"><span class="annot"><a href="#local-6989586621682657980"><span class="hs-identifier hs-var hs-var">unwind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; Maybe UnwindExpr -&gt; Map GlobalReg (Maybe UnwindExpr)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../containers-0.7-7628/src//Data.Map.Internal.html/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnwindExpr -&gt; Maybe UnwindExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UnwindExpr -&gt; Maybe UnwindExpr) -&gt; UnwindExpr -&gt; Maybe UnwindExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; Int -&gt; UnwindExpr
</span><a href="GHC.Cmm.DebugBlock.html#UwReg"><span class="hs-identifier hs-var">UwReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalReg -&gt; CmmType -&gt; GlobalRegUse
</span><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-var">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#bWord"><span class="hs-identifier hs-var">bWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682657975"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; UnwindExpr) -&gt; Int -&gt; UnwindExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682657973"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621682657972"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657978"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657980"><span class="hs-identifier hs-type">unwind</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657972"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-var">addSpUnwindings</span></a></span><span> </span><span id="local-6989586621682657986"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657986"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; NatM (OrdList Instr))
-&gt; OrdList Instr -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682657986"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">{- Note [Keeping track of the current block]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When generating instructions for Cmm we sometimes require
the current block for things like retry loops.

We also sometimes change the current block, if a MachOP
results in branching control flow.

Issues arise if we have two statements in the same block,
which both depend on the current block id *and* change the
basic block after them. This happens for atomic primops
in the X86 backend where we want to update the CFG data structure
when introducing new basic blocks.

For example in #17334 we got this Cmm code:

        c3Bf: // global
            (_s3t1::I64) = call MO_AtomicRMW W64 AMO_And(_s3sQ::P64 + 88, 18);
            (_s3t4::I64) = call MO_AtomicRMW W64 AMO_Or(_s3sQ::P64 + 88, 0);
            _s3sT::I64 = _s3sV::I64;
            goto c3B1;

This resulted in two new basic blocks being inserted:

        c3Bf:
                movl $18,%vI_n3Bo
                movq 88(%vI_s3sQ),%rax
                jmp _n3Bp
        n3Bp:
                ...
                cmpxchgq %vI_n3Bq,88(%vI_s3sQ)
                jne _n3Bp
                ...
                jmp _n3Bs
        n3Bs:
                ...
                cmpxchgq %vI_n3Bt,88(%vI_s3sQ)
                jne _n3Bs
                ...
                jmp _c3B1
        ...

Based on the Cmm we called stmtToInstrs we translated both atomic operations under
the assumption they would be placed into their Cmm basic block `c3Bf`.
However for the retry loop we introduce new labels, so this is not the case
for the second statement.
This resulted in a desync between the explicit control flow graph
we construct as a separate data type and the actual control flow graph in the code.

Instead we now return the new basic block if a statement causes a change
in the current block and use the block for all following statements.

For this reason genForeignCall is also split into two parts.  One for calls which
*won't* change the basic blocks in which successive instructions will be
placed (since they only evaluate CmmExpr, which can only contain MachOps, which
cannot introduce basic blocks in their lowerings).  A different one for calls
which *are* known to change the basic block.

-}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for why</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- we pass the BlockId.</span><span>
</span><span id="line-297"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Basic block these statement will start to be placed in.</span></span><span>
</span><span id="line-298"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Cmm Statement</span></span><span>
</span><span id="line-299"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Resulting instruction</span></span><span>
</span><span id="line-300"></span><span id="stmtsToInstrs"><span class="annot"><span class="annottext">stmtsToInstrs :: Label -&gt; [CmmNode O O] -&gt; NatM (OrdList Instr, Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-var hs-var">stmtsToInstrs</span></a></span></span><span> </span><span id="local-6989586621682657988"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657988"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682657989"><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682657989"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">Label
-&gt; [CmmNode O O] -&gt; OrdList Instr -&gt; NatM (OrdList Instr, Label)
forall {e :: Extensibility} {x :: Extensibility}.
Label
-&gt; [CmmNode e x] -&gt; OrdList Instr -&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682657990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657988"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682657989"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621682657990"><span class="annot"><span class="annottext">go :: Label
-&gt; [CmmNode e x] -&gt; OrdList Instr -&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682657990"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682657993"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657993"><span class="hs-identifier hs-var">bid</span></a></span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span id="local-6989586621682657994"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657994"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657994"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657993"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="#local-6989586621682657990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682657995"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657995"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682657996"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682657996"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682657997"><span class="annot"><span class="annottext">[CmmNode e x]
</span><a href="#local-6989586621682657997"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682657998"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682657998"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682657999"><span class="annot"><a href="#local-6989586621682657999"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658000"><span class="annot"><a href="#local-6989586621682658000"><span class="hs-identifier hs-var">bid'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CmmNode e x -&gt; NatM (OrdList Instr, Maybe Label)
forall (e :: Extensibility) (x :: Extensibility).
Label -&gt; CmmNode e x -&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var">stmtToInstrs</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657995"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682657996"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-comment">-- If the statement introduced a new block, we use that one</span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682658001"><span class="annot"><a href="#local-6989586621682658001"><span class="hs-identifier hs-var hs-var">newBid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Maybe Label -&gt; Label
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682657995"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682658000"><span class="hs-identifier hs-var">bid'</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><a href="#local-6989586621682657990"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658001"><span class="hs-identifier hs-type">newBid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657997"><span class="hs-identifier hs-type">stmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682657998"><span class="hs-identifier hs-type">instrs</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682657999"><span class="hs-identifier hs-type">instrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- | `bid` refers to the current block and is used to update the CFG</span><span>
</span><span id="line-311"></span><span class="hs-comment">--   if new blocks are inserted in the control flow.</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for more details.</span><span>
</span><span id="line-313"></span><span id="local-6989586621682656516"><span id="local-6989586621682656517"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Basic block this statement will start to be placed in.</span></span><span>
</span><span id="line-314"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682656516"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682656517"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-315"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-316"></span><span>             </span><span class="hs-comment">-- ^ Instructions, and bid of new block if successive</span><span>
</span><span id="line-317"></span><span>             </span><span class="hs-comment">-- statements are placed in a different basic block.</span><span>
</span><span id="line-318"></span><span id="stmtToInstrs"><span class="annot"><span class="annottext">stmtToInstrs :: forall (e :: Extensibility) (x :: Extensibility).
Label -&gt; CmmNode e x -&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var hs-var">stmtToInstrs</span></a></span></span><span> </span><span id="local-6989586621682658008"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658008"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682658009"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682658009"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621682658010"><span class="annot"><a href="#local-6989586621682658010"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621682658011"><span class="annot"><a href="#local-6989586621682658011"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682658009"><span class="hs-identifier hs-type">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682658015"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682658015"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682658016"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682658016"><span class="hs-identifier hs-var">result_regs</span></a></span></span><span> </span><span id="local-6989586621682658017"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682658017"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-323"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; Label
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-var">genForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682658015"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682658016"><span class="hs-identifier hs-var">result_regs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682658017"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658008"><span class="hs-identifier hs-var">bid</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; (OrdList Instr, Maybe Label))
-&gt; NatM (OrdList Instr) -&gt; NatM (OrdList Instr, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682658009"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span id="local-6989586621682658023"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682658023"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682658023"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682658044"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682658044"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682658045"><span class="hs-identifier hs-type">to_unwind_entry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindTable"><span class="hs-identifier hs-type">UnwindTable</span></a></span><span>
</span><span id="line-331"></span><span>            </span><span id="local-6989586621682658045"><span class="annot"><span class="annottext">to_unwind_entry :: (GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682658045"><span class="hs-identifier hs-var hs-var">to_unwind_entry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682658046"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682658046"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658047"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682658047"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; Maybe UnwindExpr -&gt; Map GlobalReg (Maybe UnwindExpr)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../containers-0.7-7628/src//Data.Map.Internal.html/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682658046"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; UnwindExpr) -&gt; Maybe CmmExpr -&gt; Maybe UnwindExpr
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; UnwindExpr
</span><a href="GHC.Cmm.DebugBlock.html#toUnwindExpr"><span class="hs-identifier hs-var">toUnwindExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658011"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682658047"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr))
-&gt; [(GlobalReg, Maybe CmmExpr)] -&gt; Map GlobalReg (Maybe UnwindExpr)
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">(GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682658045"><span class="hs-identifier hs-var">to_unwind_entry</span></a></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682658044"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>          </span><span id="local-6989586621682658049"><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682658049"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../containers-0.7-7628/src//Data.Map.Internal.html/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682658049"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-334"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>                  </span><span id="local-6989586621682658051"><span class="annot"><a href="#local-6989586621682658051"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CLabel
forall a. Uniquable a =&gt; a -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkAsmTempLabel"><span class="hs-identifier hs-var">mkAsmTempLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; CLabel) -&gt; NatM Unique -&gt; NatM CLabel
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM Unique
forall (m :: * -&gt; *). MonadUnique m =&gt; m Unique
</span><a href="GHC.Types.Unique.Supply.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a></span><span>
</span><span id="line-336"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658051"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658049"><span class="hs-identifier hs-type">tbl</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682658055"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658055"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658056"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658056"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658058"><span class="hs-identifier hs-var">ty</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var">assignReg_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658060"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658055"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658056"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658010"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658058"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var">assignReg_I64Code</span></a></span><span>      </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658055"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658056"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658060"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658055"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658056"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-342"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658058"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682658058"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658055"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-343"></span><span>                </span><span id="local-6989586621682658060"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658060"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658058"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682658070"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658070"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682658071"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658071"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682658072"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682658072"><span class="hs-identifier hs-var">_alignment</span></a></span></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658073"><span class="hs-identifier hs-var">ty</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var">assignMem_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658075"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658070"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658071"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658010"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658073"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-var">assignMem_I64Code</span></a></span><span>      </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658070"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658071"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658075"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658070"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658071"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658073"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682658073"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658011"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658071"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-350"></span><span>                </span><span id="local-6989586621682658075"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658075"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658073"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682658083"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658083"><span class="hs-identifier hs-var">id</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; NatM (OrdList Instr))
-&gt; OrdList Instr -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658083"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-comment">--We try to arrange blocks such that the likely branch is the fallthrough</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-comment">--in GHC.Cmm.ContFlowOpt. So we can assume the condition is likely false here.</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682658088"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658088"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682658089"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658089"><span class="hs-identifier hs-var">true</span></a></span></span><span> </span><span id="local-6989586621682658090"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658090"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var">genCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658008"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658089"><span class="hs-identifier hs-var">true</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658090"><span class="hs-identifier hs-var">false</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658088"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682658095"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658095"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682658096"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682658096"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-var">genSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658095"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682658096"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cml_target :: CmmNode O C -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682658102"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658102"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-359"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cml_args_regs :: CmmNode O C -&gt; [GlobalReg]
</span><a href="GHC.Cmm.Node.html#cml_args_regs"><span class="hs-identifier hs-var">cml_args_regs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682658104"><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682658104"><span class="hs-identifier hs-var">gregs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Reg] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658102"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [GlobalReg] -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-var">jumpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658011"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682658104"><span class="hs-identifier hs-var">gregs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stmtToInstrs: statement should have been cps'd away&quot;</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-type">jumpRegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span id="jumpRegs"><span class="annot"><span class="annottext">jumpRegs :: Platform -&gt; [GlobalReg] -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-var hs-var">jumpRegs</span></a></span></span><span> </span><span id="local-6989586621682658108"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658108"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658109"><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682658109"><span class="hs-identifier hs-var">gregs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RealReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a></span><span> </span><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682658111"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682658111"><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682658111"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GlobalReg -&gt; Maybe RealReg) -&gt; [GlobalReg] -&gt; [Maybe RealReg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Maybe RealReg
</span><a href="GHC.Platform.Regs.html#globalRegMaybe"><span class="hs-identifier hs-var">globalRegMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658108"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621682658109"><span class="hs-identifier hs-var">gregs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | 'InstrBlock's are the insn sequences generated by the insn selectors.</span><span>
</span><span id="line-369"></span><span class="hs-comment">--      They are really trees of insns to facilitate fast appending, where a</span><span>
</span><span id="line-370"></span><span class="hs-comment">--      left-to-right traversal yields the insns in the correct order.</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-keyword">type</span><span> </span><span id="InstrBlock"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-var">InstrBlock</span></a></span></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Condition codes passed up the tree.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-keyword">data</span><span> </span><span id="CondCode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-var">CondCode</span></a></span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="CondCode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-var">CondCode</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | Register's passed up the tree.  If the stix code forces the register</span><span>
</span><span id="line-383"></span><span class="hs-comment">--      to live in a pre-decided machine register, it comes out as @Fixed@;</span><span>
</span><span id="line-384"></span><span class="hs-comment">--      otherwise, it comes out as @Any@, and the parent can decide which</span><span>
</span><span id="line-385"></span><span class="hs-comment">--      register to put it in.</span><span>
</span><span id="line-386"></span><span class="hs-comment">--</span><span>
</span><span id="line-387"></span><span class="hs-keyword">data</span><span> </span><span id="Register"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-var">Register</span></a></span></span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="Fixed"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="Any"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-type">swizzleRegisterRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-393"></span><span id="swizzleRegisterRep"><span class="annot"><span class="annottext">swizzleRegisterRep :: Register -&gt; Format -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var hs-var">swizzleRegisterRep</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658117"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658117"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658118"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658118"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682658119"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658119"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658119"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658117"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658118"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-394"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var">swizzleRegisterRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658120"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658120"><span class="hs-identifier hs-var">codefn</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682658121"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658121"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>   </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658121"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658120"><span class="hs-identifier hs-var">codefn</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-type">getLocalRegReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-397"></span><span id="getLocalRegReg"><span class="annot"><span class="annottext">getLocalRegReg :: LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var hs-var">getLocalRegReg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span id="local-6989586621682658124"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682658124"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682658125"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658125"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- by Assuming SSE2, Int,Word,Float,Double all can be register allocated</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.X86.RegInfo.html#mkVirtualReg"><span class="hs-identifier hs-var">mkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682658124"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658125"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><span class="hs-comment">-- | Grab the Reg for a CmmReg</span></span><span>
</span><span id="line-402"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span id="getRegisterReg"><span class="annot"><span class="annottext">getRegisterReg :: Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var hs-var">getRegisterReg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682658130"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682658130"><span class="hs-identifier hs-var">lreg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682658130"><span class="hs-identifier hs-var">lreg</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span id="local-6989586621682658131"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658131"><span class="hs-identifier hs-var">platform</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span id="local-6989586621682658133"><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682658133"><span class="hs-identifier hs-var">mid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Maybe RealReg
</span><a href="GHC.Platform.Regs.html#globalRegMaybe"><span class="hs-identifier hs-var">globalRegMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658131"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobalReg -&gt; Maybe RealReg) -&gt; GlobalReg -&gt; Maybe RealReg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; GlobalReg
</span><a href="GHC.Cmm.Reg.html#globalRegUseGlobalReg"><span class="hs-identifier hs-var">globalRegUseGlobalReg</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682658133"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682658135"><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682658135"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RealReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a></span><span> </span><span class="annot"><span class="annottext">(RealReg -&gt; Reg) -&gt; RealReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682658135"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">Maybe RealReg
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Reg
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegisterReg-memory&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmReg -&gt; SDoc) -&gt; CmmReg -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682658133"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-comment">-- By this stage, the only MagicIds remaining should be the</span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-comment">-- ones which map to a real machine register on this</span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-comment">-- platform.  Hence ...</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><span class="hs-comment">-- | Memory addressing modes passed up the tree.</span></span><span>
</span><span id="line-416"></span><span class="hs-keyword">data</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">{-
Now, given a tree (the argument to a CmmLoad) that references memory,
produce a suitable addressing mode.

A Rule of the Game (tm) for Amodes: use of the addr bit must
immediately follow use of the code part, since the code part puts
values in registers which the addr then refers to.  So you can't put
anything in between, lest it overwrite some of those registers.  If
you need to do some other computation between the code part and use of
the addr bit, first store the effective address from the amode in a
temporary, then do the other computation, and then use the temporary:

    code
    LEA amode, tmp
    ... other computation ...
    ... (tmp) ...
-}</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-comment">{-
Note [%rip-relative addressing on x86-64]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
On x86-64 GHC produces code for use in the &quot;small&quot; or, when `-fPIC` is set,
&quot;small PIC&quot; code models defined by the x86-64 System V ABI (section 3.5.1 of
specification version 0.99).

In general the small code model would allow us to assume that code is located
between 0 and 2^31 - 1. However, this is not true on Windows which, due to
high-entropy ASLR, may place the executable image anywhere in 64-bit address
space. This is problematic since immediate operands in x86-64 are generally
32-bit sign-extended values (with the exception of the 64-bit MOVABS encoding).
Consequently, to avoid overflowing we use %rip-relative addressing universally.
Since %rip-relative addressing comes essentially for free and makes linking far
easier, we use it even on non-Windows platforms.

See also: the documentation for GCC's `-mcmodel=small` flag.
-}</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | Check whether an integer will fit in 32 bits.</span><span>
</span><span id="line-458"></span><span class="hs-comment">--      A CmmInt is intended to be truncated to the appropriate</span><span>
</span><span id="line-459"></span><span class="hs-comment">--      number of bits, so here we truncate it to Int64.  This is</span><span>
</span><span id="line-460"></span><span class="hs-comment">--      important because e.g. -1 as a CmmInt might be either</span><span>
</span><span id="line-461"></span><span class="hs-comment">--      -1 or 18446744073709551615.</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-type">is32BitInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-464"></span><span id="is32BitInteger"><span class="annot"><span class="annottext">is32BitInteger :: Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var hs-var">is32BitInteger</span></a></span></span><span> </span><span id="local-6989586621682658139"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658139"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682658140"><span class="hs-identifier hs-var">i64</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0x7fffffff</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682658140"><span class="hs-identifier hs-var">i64</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0x80000000</span></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658140"><span class="annot"><span class="annottext">i64 :: Int64
</span><a href="#local-6989586621682658140"><span class="hs-identifier hs-var hs-var">i64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658139"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><span class="hs-comment">-- | Convert a BlockId to some CmmStatic data</span></span><span>
</span><span id="line-469"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-type">jumpTableEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span>
</span><span id="line-470"></span><span id="jumpTableEntry"><span class="annot"><span class="annottext">jumpTableEntry :: NCGConfig -&gt; Maybe Label -&gt; CmmStatic
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var hs-var">jumpTableEntry</span></a></span></span><span> </span><span id="local-6989586621682658143"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682658143"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682658143"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var">jumpTableEntry</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682658147"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658147"><span class="hs-identifier hs-var">blockid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682658149"><span class="hs-identifier hs-var">blockLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658149"><span class="annot"><span class="annottext">blockLabel :: CLabel
</span><a href="#local-6989586621682658149"><span class="hs-identifier hs-var hs-var">blockLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658147"><span class="hs-identifier hs-var">blockid</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- General things for putting together code sequences</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- Expand CmmRegOff.  ToDo: should we do it this way around, or convert</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- CmmExprs into CmmRegOff?</span><span>
</span><span id="line-480"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-type">mangleIndexTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-481"></span><span id="mangleIndexTree"><span class="annot"><span class="annottext">mangleIndexTree :: CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var hs-var">mangleIndexTree</span></a></span></span><span> </span><span id="local-6989586621682658152"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658152"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658153"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658153"><span class="hs-identifier hs-var">off</span></a></span></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658156"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658152"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658153"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658156"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658156"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682658156"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658152"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | The dual to getAnyReg: compute an expression into a register, but</span><span>
</span><span id="line-486"></span><span class="hs-comment">--      we don't mind which one it is.</span><span>
</span><span id="line-487"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span id="getSomeReg"><span class="annot"><span class="annottext">getSomeReg :: CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var hs-var">getSomeReg</span></a></span></span><span> </span><span id="local-6989586621682658161"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658161"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621682658162"><span class="annot"><a href="#local-6989586621682658162"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658161"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682658162"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-491"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682658164"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658164"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658165"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658165"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>        </span><span id="local-6989586621682658166"><span class="annot"><a href="#local-6989586621682658166"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658164"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658166"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682658165"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658166"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658167"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658167"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658168"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658168"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-495"></span><span>        </span><span class="annot"><span class="annottext">(Reg, OrdList Instr) -&gt; NatM (Reg, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658167"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658168"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-type">assignMem_I64Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-499"></span><span id="assignMem_I64Code"><span class="annot"><span class="annottext">assignMem_I64Code :: CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-var hs-var">assignMem_I64Code</span></a></span></span><span> </span><span id="local-6989586621682658169"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658169"><span class="hs-identifier hs-var">addrTree</span></a></span></span><span> </span><span id="local-6989586621682658170"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658170"><span class="hs-identifier hs-var">valueTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682658171"><span class="annot"><a href="#local-6989586621682658171"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682658172"><span class="annot"><a href="#local-6989586621682658172"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658169"><span class="hs-identifier hs-var">addrTree</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658175"><span class="annot"><a href="#local-6989586621682658175"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682658176"><span class="annot"><a href="#local-6989586621682658176"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658177"><span class="annot"><a href="#local-6989586621682658177"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658170"><span class="hs-identifier hs-type">valueTree</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-comment">-- Little-endian store</span><span>
</span><span id="line-504"></span><span>        </span><span id="local-6989586621682658179"><span class="annot"><a href="#local-6989586621682658179"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658177"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682658171"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>        </span><span id="local-6989586621682658184"><span class="annot"><a href="#local-6989586621682658184"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658176"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AddrMode -&gt; AddrMode
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Int -&gt; Maybe AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrOffset"><span class="hs-identifier hs-var">addrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682658171"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658175"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658172"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658179"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658184"><span class="hs-identifier hs-type">mov_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-type">assignReg_I64Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-510"></span><span id="assignReg_I64Code"><span class="annot"><span class="annottext">assignReg_I64Code :: CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var hs-var">assignReg_I64Code</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682658188"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682658188"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682658189"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658189"><span class="hs-identifier hs-var">valueTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-511"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658190"><span class="annot"><a href="#local-6989586621682658190"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682658191"><span class="annot"><a href="#local-6989586621682658191"><span class="hs-identifier hs-var">r_src_hi</span></a></span></span><span> </span><span id="local-6989586621682658192"><span class="annot"><a href="#local-6989586621682658192"><span class="hs-identifier hs-var">r_src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658189"><span class="hs-identifier hs-var">valueTree</span></a></span><span>
</span><span id="line-512"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-513"></span><span>         </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658194"><span class="annot"><a href="#local-6989586621682658194"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658195"><span class="annot"><a href="#local-6989586621682658195"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-type">localReg64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658188"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-514"></span><span>         </span><span id="local-6989586621682658196"><span class="annot"><a href="#local-6989586621682658196"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658192"><span class="hs-identifier hs-var">r_src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658195"><span class="hs-identifier hs-var">r_dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>         </span><span id="local-6989586621682658197"><span class="annot"><a href="#local-6989586621682658197"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658191"><span class="hs-identifier hs-var">r_src_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658194"><span class="hs-identifier hs-var">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-517"></span><span>        </span><span class="annot"><a href="#local-6989586621682658190"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658196"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658197"><span class="hs-identifier hs-type">mov_hi</span></a></span><span>
</span><span id="line-518"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var">assignReg_I64Code</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-521"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assignReg_I64Code(i386): invalid lvalue&quot;</span></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span id="iselExpr64"><span class="annot"><span class="annottext">iselExpr64 :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var hs-var">iselExpr64</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658314"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658314"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658315"><span class="annot"><a href="#local-6989586621682658315"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658316"><span class="annot"><a href="#local-6989586621682658316"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Reg64
</span><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-var">getNewReg64</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-527"></span><span>        </span><span id="local-6989586621682658317"><span class="annot"><a href="#local-6989586621682658317"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658314"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>        </span><span id="local-6989586621682658318"><span class="annot"><a href="#local-6989586621682658318"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658314"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621682658320"><span class="annot"><a href="#local-6989586621682658320"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-530"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658317"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658316"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-531"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658318"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658315"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658320"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658315"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658316"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658324"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658324"><span class="hs-identifier hs-var">addrTree</span></a></span></span><span> </span><span id="local-6989586621682658325"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658325"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658325"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682658326"><span class="annot"><a href="#local-6989586621682658326"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682658327"><span class="annot"><a href="#local-6989586621682658327"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658324"><span class="hs-identifier hs-var">addrTree</span></a></span><span>
</span><span id="line-537"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658328"><span class="annot"><a href="#local-6989586621682658328"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658329"><span class="annot"><a href="#local-6989586621682658329"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-538"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-539"></span><span>        </span><span id="local-6989586621682658330"><span class="annot"><a href="#local-6989586621682658330"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682658326"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658329"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>        </span><span id="local-6989586621682658331"><span class="annot"><a href="#local-6989586621682658331"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AddrMode -&gt; AddrMode
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Int -&gt; Maybe AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrOffset"><span class="hs-identifier hs-var">addrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682658326"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658328"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-542"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658327"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658330"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658331"><span class="hs-identifier hs-type">mov_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682658328"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658329"><span class="hs-identifier hs-type">rlo</span></a></span><span>
</span><span id="line-543"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682658332"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682658332"><span class="hs-identifier hs-var">local_reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658333"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658333"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span id="local-6989586621682658334"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658334"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682658332"><span class="hs-identifier hs-var">local_reg</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><span class="annottext">RegCode64 (OrdList Instr) -&gt; NatM (RegCode64 (OrdList Instr))
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr -&gt; Reg -&gt; Reg -&gt; RegCode64 (OrdList Instr)
forall code. code -&gt; Reg -&gt; Reg -&gt; RegCode64 code
</span><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-var">RegCode64</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658333"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658334"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658335"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658335"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658336"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658336"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658337"><span class="annot"><a href="#local-6989586621682658337"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658338"><span class="annot"><a href="#local-6989586621682658338"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658339"><span class="annot"><a href="#local-6989586621682658339"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658335"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-551"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658340"><span class="annot"><a href="#local-6989586621682658340"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658341"><span class="annot"><a href="#local-6989586621682658341"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-552"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-553"></span><span>        </span><span id="local-6989586621682658342"><span class="annot"><a href="#local-6989586621682658342"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658336"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>        </span><span id="local-6989586621682658343"><span class="annot"><a href="#local-6989586621682658343"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658336"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621682658344"><span class="annot"><a href="#local-6989586621682658344"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658337"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-556"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658339"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658341"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-557"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658342"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658341"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-558"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658338"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658340"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-559"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658343"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658340"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658344"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658340"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658341"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658347"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658347"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658348"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658348"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-563"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658349"><span class="annot"><a href="#local-6989586621682658349"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658350"><span class="annot"><a href="#local-6989586621682658350"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658351"><span class="annot"><a href="#local-6989586621682658351"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658347"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-564"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658352"><span class="annot"><a href="#local-6989586621682658352"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682658353"><span class="annot"><a href="#local-6989586621682658353"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682658354"><span class="annot"><a href="#local-6989586621682658354"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658348"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-565"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658355"><span class="annot"><a href="#local-6989586621682658355"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658356"><span class="annot"><a href="#local-6989586621682658356"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-566"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621682658357"><span class="annot"><a href="#local-6989586621682658357"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658349"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-568"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658352"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-569"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658351"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658356"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-570"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658354"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658356"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-571"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658350"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658355"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-572"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658353"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658355"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-573"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658357"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658355"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658356"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658359"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658359"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658360"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658360"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-576"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658361"><span class="annot"><a href="#local-6989586621682658361"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658362"><span class="annot"><a href="#local-6989586621682658362"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658363"><span class="annot"><a href="#local-6989586621682658363"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658359"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-577"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658364"><span class="annot"><a href="#local-6989586621682658364"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682658365"><span class="annot"><a href="#local-6989586621682658365"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682658366"><span class="annot"><a href="#local-6989586621682658366"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658360"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-578"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658367"><span class="annot"><a href="#local-6989586621682658367"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658368"><span class="annot"><a href="#local-6989586621682658368"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-579"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-580"></span><span>        </span><span id="local-6989586621682658369"><span class="annot"><a href="#local-6989586621682658369"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658361"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-581"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658364"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-582"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658363"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658368"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-583"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658366"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658368"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-584"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658362"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658367"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-585"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658365"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658367"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-586"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658369"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658367"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658368"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658375"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658375"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>     </span><span id="local-6989586621682658376"><span class="annot"><a href="#local-6989586621682658376"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658375"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-590"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658378"><span class="annot"><a href="#local-6989586621682658378"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658379"><span class="annot"><a href="#local-6989586621682658379"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-591"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658376"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658379"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-592"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658378"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658378"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658378"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-594"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658379"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658382"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658382"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682658383"><span class="annot"><a href="#local-6989586621682658383"><span class="hs-identifier hs-var">rsrc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658384"><span class="annot"><a href="#local-6989586621682658384"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658382"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-598"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658386"><span class="annot"><a href="#local-6989586621682658386"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658387"><span class="annot"><a href="#local-6989586621682658387"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-599"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658384"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-600"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658383"><span class="hs-identifier hs-type">rsrc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658387"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-601"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658386"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658386"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>                          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658386"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-604"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658387"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658391"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658391"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682658392"><span class="annot"><a href="#local-6989586621682658392"><span class="hs-identifier hs-var">rsrc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658393"><span class="annot"><a href="#local-6989586621682658393"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658391"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-608"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658394"><span class="annot"><a href="#local-6989586621682658394"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658395"><span class="annot"><a href="#local-6989586621682658395"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-609"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658393"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-610"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658392"><span class="hs-identifier hs-type">rsrc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658395"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-611"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658394"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658394"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>                          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658394"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-614"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658395"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658398"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658398"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-617"></span><span>     </span><span id="local-6989586621682658399"><span class="annot"><a href="#local-6989586621682658399"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658398"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-618"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658400"><span class="annot"><a href="#local-6989586621682658400"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658401"><span class="annot"><a href="#local-6989586621682658401"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-619"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658399"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658401"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-620"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658401"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-621"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-622"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658401"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-623"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658400"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658400"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-625"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658401"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658405"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658405"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-628"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682658406"><span class="annot"><a href="#local-6989586621682658406"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658407"><span class="annot"><a href="#local-6989586621682658407"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658405"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-629"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658408"><span class="annot"><a href="#local-6989586621682658408"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658409"><span class="annot"><a href="#local-6989586621682658409"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-630"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658407"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-631"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-type">MOVSxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658406"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-632"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-633"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658409"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-634"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658408"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658408"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-636"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658409"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658411"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658411"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-639"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682658412"><span class="annot"><a href="#local-6989586621682658412"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658413"><span class="annot"><a href="#local-6989586621682658413"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658411"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-640"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658414"><span class="annot"><a href="#local-6989586621682658414"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682658415"><span class="annot"><a href="#local-6989586621682658415"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-641"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658413"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-642"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-type">MOVSxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658412"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-643"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-644"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658415"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-645"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658414"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658414"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-647"></span><span>                          </span><span class="annot"><a href="#local-6989586621682658415"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658417"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658417"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-650"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658418"><span class="annot"><a href="#local-6989586621682658418"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658419"><span class="annot"><a href="#local-6989586621682658419"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658420"><span class="annot"><a href="#local-6989586621682658420"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658417"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-651"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658421"><span class="annot"><a href="#local-6989586621682658421"><span class="hs-identifier hs-var">rohi</span></a></span></span><span> </span><span id="local-6989586621682658422"><span class="annot"><a href="#local-6989586621682658422"><span class="hs-identifier hs-var">rolo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-652"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621682658423"><span class="annot"><a href="#local-6989586621682658423"><span class="hs-identifier hs-var hs-var">ocode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658418"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-654"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658420"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658422"><span class="hs-identifier hs-var">rolo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-655"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658421"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658421"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-656"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658422"><span class="hs-identifier hs-var">rolo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-657"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658419"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658421"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-658"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658423"><span class="hs-identifier hs-type">ocode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658421"><span class="hs-identifier hs-type">rohi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658422"><span class="hs-identifier hs-type">rolo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- To multiply two 64-bit numbers we use the following decomposition (in C notation):</span><span>
</span><span id="line-661"></span><span class="hs-comment">--</span><span>
</span><span id="line-662"></span><span class="hs-comment">--     ((r1hi &lt;&lt; 32) + r1lo) * ((r2hi &lt;&lt; 32) + r2lo)</span><span>
</span><span id="line-663"></span><span class="hs-comment">--      = ((r2lo * r1hi) &lt;&lt; 32)</span><span>
</span><span id="line-664"></span><span class="hs-comment">--      + ((r1lo * r2hi) &lt;&lt; 32)</span><span>
</span><span id="line-665"></span><span class="hs-comment">--      + r1lo * r2lo</span><span>
</span><span id="line-666"></span><span class="hs-comment">--</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- Note that @(r1hi * r2hi) &lt;&lt; 64@ can be dropped because it overflows completely.</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658426"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658426"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658427"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658427"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-670"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658428"><span class="annot"><a href="#local-6989586621682658428"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658429"><span class="annot"><a href="#local-6989586621682658429"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658430"><span class="annot"><a href="#local-6989586621682658430"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658426"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-671"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658431"><span class="annot"><a href="#local-6989586621682658431"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682658432"><span class="annot"><a href="#local-6989586621682658432"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682658433"><span class="annot"><a href="#local-6989586621682658433"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658427"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-672"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658434"><span class="annot"><a href="#local-6989586621682658434"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658435"><span class="annot"><a href="#local-6989586621682658435"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-673"></span><span>   </span><span id="local-6989586621682658436"><span class="annot"><a href="#local-6989586621682658436"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-674"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-675"></span><span>        </span><span id="local-6989586621682658437"><span class="annot"><a href="#local-6989586621682658437"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658428"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-676"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658431"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-677"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658430"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-678"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658433"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658436"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-679"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658429"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658434"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-680"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658436"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658434"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-681"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658432"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658435"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-682"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658435"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-683"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658435"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658434"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-684"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658436"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-685"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658434"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-686"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658435"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-688"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658437"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658434"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658435"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>   </span><span class="hs-comment">-- Performance sensitive users won't use 32 bit so let's keep it simple:</span><span>
</span><span id="line-692"></span><span>   </span><span class="hs-comment">-- We always return a (usually false) positive.</span><span>
</span><span id="line-693"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658441"><span class="annot"><a href="#local-6989586621682658441"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658442"><span class="annot"><a href="#local-6989586621682658442"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Reg64
</span><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-var">getNewReg64</span></a></span><span>
</span><span id="line-694"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658443"><span class="annot"><a href="#local-6989586621682658443"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>   </span><span class="hs-special">[</span><span>
</span><span id="line-695"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658441"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-696"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658442"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-698"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658443"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658441"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658442"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">-- To shift a 64-bit number to the left we use the SHLD and SHL instructions.</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- We use SHLD to shift the bits in @rhi@ to the left while copying</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- high bits from @rlo@ to fill the new space in the low bits of @rhi@.</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- That leaves @rlo@ unchanged, so we use SHL to shift the bits of @rlo@ left.</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- However, both these instructions only use the lowest 5 bits from %cl to do</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- their shifting. So if the sixth bit (0x32) is set then we additionally move</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- the contents of @rlo@ to @rhi@ and clear @rlo@.</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658446"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658446"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658447"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658447"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-710"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658448"><span class="annot"><a href="#local-6989586621682658448"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658449"><span class="annot"><a href="#local-6989586621682658449"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658450"><span class="annot"><a href="#local-6989586621682658450"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658446"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-711"></span><span>   </span><span id="local-6989586621682658451"><span class="annot"><a href="#local-6989586621682658451"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658447"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-712"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658452"><span class="annot"><a href="#local-6989586621682658452"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658453"><span class="annot"><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-713"></span><span>   </span><span id="local-6989586621682658454"><span class="annot"><a href="#local-6989586621682658454"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-714"></span><span>   </span><span id="local-6989586621682658456"><span class="annot"><a href="#local-6989586621682658456"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-715"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-716"></span><span>        </span><span id="local-6989586621682658457"><span class="annot"><a href="#local-6989586621682658457"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658448"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-717"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658451"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-718"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658450"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-719"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658449"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658452"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-720"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHLD"><span class="hs-identifier hs-var">SHLD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658452"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-721"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-722"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-723"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658456"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-724"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658454"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-725"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658454"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-726"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658452"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-727"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658453"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-728"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658456"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-729"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658456"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-730"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-731"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658457"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658452"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658453"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- Similar to above, however now we're shifting to the right</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- and we're doing a signed shift which means that @rhi@ needs</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- to be set to either 0 if @rhi@ is positive or 0xffffffff otherwise,</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- and if the sixth bit of %cl is set (so the shift amount is more than 32).</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- To accomplish that we shift @rhi@ by 31.</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658466"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658466"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658467"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658467"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-740"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658468"><span class="annot"><a href="#local-6989586621682658468"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658469"><span class="annot"><a href="#local-6989586621682658469"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658470"><span class="annot"><a href="#local-6989586621682658470"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658466"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-741"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621682658471"><span class="annot"><a href="#local-6989586621682658471"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658472"><span class="annot"><a href="#local-6989586621682658472"><span class="hs-identifier hs-var">code2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658467"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-742"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658473"><span class="annot"><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658474"><span class="annot"><a href="#local-6989586621682658474"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-743"></span><span>   </span><span id="local-6989586621682658475"><span class="annot"><a href="#local-6989586621682658475"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-744"></span><span>   </span><span id="local-6989586621682658476"><span class="annot"><a href="#local-6989586621682658476"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-745"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-746"></span><span>        </span><span id="local-6989586621682658477"><span class="annot"><a href="#local-6989586621682658477"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658468"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-747"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658472"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-748"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658470"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658474"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-749"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658469"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-750"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658471"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-751"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHRD"><span class="hs-identifier hs-var">SHRD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658474"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-752"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-753"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-754"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658476"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-755"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658475"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-756"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658475"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-757"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658474"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-758"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658473"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-759"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658476"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-760"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658476"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-761"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-762"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658477"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658473"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658474"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">-- Similar to the above.</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658481"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658481"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658482"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658482"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658483"><span class="annot"><a href="#local-6989586621682658483"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658484"><span class="annot"><a href="#local-6989586621682658484"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658485"><span class="annot"><a href="#local-6989586621682658485"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658481"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-768"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621682658486"><span class="annot"><a href="#local-6989586621682658486"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658487"><span class="annot"><a href="#local-6989586621682658487"><span class="hs-identifier hs-var">code2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658482"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-769"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658488"><span class="annot"><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658489"><span class="annot"><a href="#local-6989586621682658489"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-770"></span><span>   </span><span id="local-6989586621682658490"><span class="annot"><a href="#local-6989586621682658490"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-771"></span><span>   </span><span id="local-6989586621682658491"><span class="annot"><a href="#local-6989586621682658491"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-772"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-773"></span><span>        </span><span id="local-6989586621682658492"><span class="annot"><a href="#local-6989586621682658492"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658483"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-774"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658487"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-775"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658485"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658489"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-776"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658484"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-777"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658486"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-778"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHRD"><span class="hs-identifier hs-var">SHRD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658489"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-779"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-780"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-781"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658491"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-782"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658490"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-783"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658490"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-784"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658489"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-785"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658488"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-786"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658491"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-787"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682658491"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-788"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-789"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658492"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658488"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658489"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658495"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658495"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658496"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658496"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658495"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658496"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-792"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658500"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658500"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658501"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658501"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658500"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658501"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-793"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658504"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658504"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658505"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658505"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658504"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658505"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658507"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658507"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-796"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658508"><span class="annot"><a href="#local-6989586621682658508"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658509"><span class="annot"><a href="#local-6989586621682658509"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658510"><span class="annot"><a href="#local-6989586621682658510"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658507"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-797"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658511"><span class="annot"><a href="#local-6989586621682658511"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658512"><span class="annot"><a href="#local-6989586621682658512"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-798"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-799"></span><span>        </span><span id="local-6989586621682658513"><span class="annot"><a href="#local-6989586621682658513"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658508"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-800"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658510"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658512"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-801"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658509"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658511"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-802"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658512"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-803"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658511"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-805"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658513"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658511"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658512"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682658516"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658516"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682658517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658517"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658516"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658517"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span id="local-6989586621682658518"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658518"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-810"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-811"></span><span>      </span><span id="local-6989586621682658519"><span class="annot"><a href="#local-6989586621682658519"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-812"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;iselExpr64(i386)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658519"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658518"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%2B%24"><span class="hs-operator hs-type">$+$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682658518"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-type">iselExpr64ParallelBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span id="iselExpr64ParallelBin"><span class="annot"><span class="annottext">iselExpr64ParallelBin :: (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var hs-var">iselExpr64ParallelBin</span></a></span></span><span> </span><span id="local-6989586621682658523"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658523"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682658524"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658524"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621682658525"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658525"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-817"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658526"><span class="annot"><a href="#local-6989586621682658526"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682658527"><span class="annot"><a href="#local-6989586621682658527"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682658528"><span class="annot"><a href="#local-6989586621682658528"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658524"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-818"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658529"><span class="annot"><a href="#local-6989586621682658529"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682658530"><span class="annot"><a href="#local-6989586621682658530"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682658531"><span class="annot"><a href="#local-6989586621682658531"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658525"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-819"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682658532"><span class="annot"><a href="#local-6989586621682658532"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658533"><span class="annot"><a href="#local-6989586621682658533"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-820"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-821"></span><span>        </span><span id="local-6989586621682658534"><span class="annot"><a href="#local-6989586621682658534"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658526"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-822"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658529"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-823"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658528"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658533"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-824"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658527"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658532"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-825"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658523"><span class="hs-identifier hs-var">op</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658531"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658533"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-826"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658523"><span class="hs-identifier hs-var">op</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658530"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658532"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-828"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658534"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658532"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658533"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-831"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-832"></span><span id="getRegister"><span class="annot"><span class="annottext">getRegister :: CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var hs-var">getRegister</span></a></span></span><span> </span><span id="local-6989586621682658535"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658535"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682658536"><span class="annot"><a href="#local-6989586621682658536"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-833"></span><span>                   </span><span id="local-6989586621682658537"><span class="annot"><a href="#local-6989586621682658537"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span>
</span><span id="line-834"></span><span>                   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658536"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658537"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658535"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span id="getRegister%27"><span class="annot"><span class="annottext">getRegister' :: Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var hs-var">getRegister'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658539"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658539"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682658540"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658540"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658540"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-840"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658539"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-842"></span><span>            </span><span class="hs-comment">-- on x86_64, we have %rip for PicBaseReg, but it's not</span><span>
</span><span id="line-843"></span><span>            </span><span class="hs-comment">-- a full-featured register, it can only be used for</span><span>
</span><span id="line-844"></span><span>            </span><span class="hs-comment">-- rip-relative addressing.</span><span>
</span><span id="line-845"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682658542"><span class="annot"><a href="#local-6989586621682658542"><span class="hs-identifier hs-var">reg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier hs-var">getPicBaseNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658539"><span class="hs-identifier hs-var">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658539"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682658542"><span class="hs-identifier hs-type">reg'</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>        </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-848"></span><span>            </span><span class="hs-keyword">do</span><span>
</span><span id="line-849"></span><span>               </span><span class="hs-keyword">let</span><span>
</span><span id="line-850"></span><span>                 </span><span id="local-6989586621682658544"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682658544"><span class="hs-identifier hs-var hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658540"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>                 </span><span id="local-6989586621682658545"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658545"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658544"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-852"></span><span>               </span><span class="hs-comment">--</span><span>
</span><span id="line-853"></span><span>               </span><span id="local-6989586621682658546"><span class="annot"><a href="#local-6989586621682658546"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-854"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658545"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-855"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658546"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658540"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>                             </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658547"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658547"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658548"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658548"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682658549"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658549"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682658550"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658550"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658547"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658548"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Register) -&gt; CmmExpr -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682658549"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658550"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658551"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658551"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658552"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658552"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_RelaxedRead"><span class="hs-identifier hs-type">MO_RelaxedRead</span></a></span><span> </span><span id="local-6989586621682658554"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658554"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658555"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658555"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658551"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658552"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmType -&gt; AlignmentSpec -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658555"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#cmmBits"><span class="hs-identifier hs-var">cmmBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658554"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-var">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658558"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658558"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658559"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658559"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AlignmentCheck"><span class="hs-identifier hs-type">MO_AlignmentCheck</span></a></span><span> </span><span id="local-6989586621682658561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658561"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658562"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658562"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-var">addAlignmentCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658561"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; Register) -&gt; NatM Register -&gt; NatM Register
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658558"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658559"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658562"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-comment">-- for 32-bit architectures, support some 64 -&gt; 32 bit conversions:</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- TO_W_(x), TO_W_(x &gt;&gt; 32)</span><span>
</span><span id="line-870"></span><span>
</span><span id="line-871"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658564"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658564"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658565"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658565"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658564"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-874"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658566"><span class="annot"><a href="#local-6989586621682658566"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658567"><span class="annot"><a href="#local-6989586621682658567"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658568"><span class="annot"><a href="#local-6989586621682658568"><span class="hs-identifier hs-var">_rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658565"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658567"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658566"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658569"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658569"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658570"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658570"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658569"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658571"><span class="annot"><a href="#local-6989586621682658571"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658572"><span class="annot"><a href="#local-6989586621682658572"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682658573"><span class="annot"><a href="#local-6989586621682658573"><span class="hs-identifier hs-var">_rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658570"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-881"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658572"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658571"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658574"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658574"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658575"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658575"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658574"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658576"><span class="annot"><a href="#local-6989586621682658576"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658577"><span class="annot"><a href="#local-6989586621682658577"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682658578"><span class="annot"><a href="#local-6989586621682658578"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658575"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-886"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658578"><span class="hs-identifier hs-type">rlo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658576"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658579"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658579"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658580"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658580"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658579"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-890"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658581"><span class="annot"><a href="#local-6989586621682658581"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658582"><span class="annot"><a href="#local-6989586621682658582"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682658583"><span class="annot"><a href="#local-6989586621682658583"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658580"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-891"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658583"><span class="hs-identifier hs-type">rlo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658581"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658584"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658584"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658585"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658585"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658584"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-895"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658586"><span class="annot"><a href="#local-6989586621682658586"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658587"><span class="annot"><a href="#local-6989586621682658587"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682658588"><span class="annot"><a href="#local-6989586621682658588"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658585"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-896"></span><span>  </span><span id="local-6989586621682658589"><span class="annot"><a href="#local-6989586621682658589"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658589"><span class="hs-identifier hs-type">ro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658586"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658588"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658589"><span class="hs-identifier hs-type">ro</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658590"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658590"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658591"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658591"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658590"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682658592"><span class="annot"><a href="#local-6989586621682658592"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658593"><span class="annot"><a href="#local-6989586621682658593"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682658594"><span class="annot"><a href="#local-6989586621682658594"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658591"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-902"></span><span>  </span><span id="local-6989586621682658595"><span class="annot"><a href="#local-6989586621682658595"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span>
</span><span id="line-903"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658595"><span class="hs-identifier hs-type">ro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658592"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658594"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658595"><span class="hs-identifier hs-type">ro</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658596"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682658596"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682658598"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682658598"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682658599"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658599"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682658600"><span class="hs-identifier hs-var">float_const_sse2</span></a></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621682658600"><span class="annot"><span class="annottext">float_const_sse2 :: NatM Register
</span><a href="#local-6989586621682658600"><span class="hs-identifier hs-var hs-var">float_const_sse2</span></a></span></span><span>
</span><span id="line-908"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682658598"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-909"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-910"></span><span>          </span><span id="local-6989586621682658601"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658601"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658599"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-911"></span><span>          </span><span id="local-6989586621682658603"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658603"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658604"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658604"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658601"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658604"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658604"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>        </span><span class="hs-comment">-- I don't know why there are xorpd, xorps, and pxor instructions.</span><span>
</span><span id="line-913"></span><span>        </span><span class="hs-comment">-- They all appear to do the same thing --SDM</span><span>
</span><span id="line-914"></span><span>      </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658601"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658603"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-917"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682658605"><span class="annot"><a href="#local-6989586621682658605"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682658606"><span class="annot"><a href="#local-6989586621682658606"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Alignment) -&gt; Int -&gt; Alignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658599"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658596"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-918"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadFloatAmode"><span class="hs-identifier hs-type">loadFloatAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658599"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658605"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658606"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- catch simple cases of zero- or sign-extended load</span><span>
</span><span id="line-921"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658610"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658610"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-922"></span><span>  </span><span id="local-6989586621682658611"><span class="annot"><a href="#local-6989586621682658611"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658610"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658611"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658613"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658613"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-926"></span><span>  </span><span id="local-6989586621682658614"><span class="annot"><a href="#local-6989586621682658614"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658613"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658614"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658615"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658615"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-930"></span><span>  </span><span id="local-6989586621682658616"><span class="annot"><a href="#local-6989586621682658616"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658615"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-931"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658616"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658617"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658617"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-934"></span><span>  </span><span id="local-6989586621682658618"><span class="annot"><a href="#local-6989586621682658618"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658617"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-935"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658618"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>
</span><span id="line-937"></span><span class="hs-comment">-- catch simple cases of zero- or sign-extended load</span><span>
</span><span id="line-938"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658619"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658619"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658620"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658620"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658619"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-940"></span><span>  </span><span id="local-6989586621682658621"><span class="annot"><a href="#local-6989586621682658621"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658620"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658621"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658623"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658623"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658624"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658624"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658623"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-945"></span><span>  </span><span id="local-6989586621682658625"><span class="annot"><a href="#local-6989586621682658625"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658624"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-946"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658625"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658626"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658626"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658627"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658627"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658626"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-950"></span><span>  </span><span id="local-6989586621682658628"><span class="annot"><a href="#local-6989586621682658628"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658627"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-951"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658628"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658629"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658629"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658630"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658630"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658629"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621682658631"><span class="annot"><a href="#local-6989586621682658631"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658630"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658631"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>
</span><span id="line-958"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658632"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658632"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658633"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658633"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658632"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-960"></span><span>  </span><span id="local-6989586621682658634"><span class="annot"><a href="#local-6989586621682658634"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658633"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-comment">-- 32-bit loads zero-extend</span><span>
</span><span id="line-961"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658634"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>
</span><span id="line-963"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658635"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658635"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658636"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658636"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658635"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-965"></span><span>  </span><span id="local-6989586621682658637"><span class="annot"><a href="#local-6989586621682658637"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658636"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-966"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658637"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658638"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658638"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-969"></span><span>                                     </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658639"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658639"><span class="hs-identifier hs-var">displacement</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658638"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-971"></span><span>      </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682658640"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658640"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-972"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-var">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658639"><span class="hs-identifier hs-var">displacement</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658640"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>
</span><span id="line-974"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658644"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658644"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658645"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682658646"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658646"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658647"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- unary MachOps</span><span>
</span><span id="line-975"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658646"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-976"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Neg"><span class="hs-identifier hs-type">MO_F_Neg</span></a></span><span> </span><span id="local-6989586621682658649"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658649"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-var">sse2NegCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658649"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span id="local-6989586621682658651"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658651"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682658652"><span class="hs-identifier hs-var">triv_ucode</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658651"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span id="local-6989586621682658654"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658654"><span class="hs-identifier hs-var">w</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682658652"><span class="hs-identifier hs-var">triv_ucode</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658654"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span>      </span><span class="hs-comment">-- Nop conversions</span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-984"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-985"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-986"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-987"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-988"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-989"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-990"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-991"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-994"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-995"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-996"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-997"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-998"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-999"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1000"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1001"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span id="local-6989586621682658659"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658659"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682658660"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658660"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658659"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658660"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658659"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1004"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span id="local-6989586621682658661"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658661"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682658662"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658662"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658661"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658662"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658661"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1005"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span id="local-6989586621682658663"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658663"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682658664"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658664"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658663"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658664"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658663"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span>      </span><span class="hs-comment">-- widenings</span><span>
</span><span id="line-1008"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1009"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1010"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1013"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1014"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span>      </span><span class="hs-comment">-- We don't care about the upper bits for MO_XX_Conv, so MOV is enough. However, on 32-bit we</span><span>
</span><span id="line-1017"></span><span>      </span><span class="hs-comment">-- have 8-bit registers only for a few registers (as opposed to x86-64 where every register</span><span>
</span><span id="line-1018"></span><span>      </span><span class="hs-comment">-- has 8-bit version). So for 32-bit code, we'll just zero-extend.</span><span>
</span><span id="line-1019"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1020"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1021"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1022"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1023"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1024"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1025"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1026"></span><span>
</span><span id="line-1027"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1028"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1029"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1030"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1031"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1033"></span><span>      </span><span class="hs-comment">-- For 32-to-64 bit zero extension, amd64 uses an ordinary movl.</span><span>
</span><span id="line-1034"></span><span>      </span><span class="hs-comment">-- However, we don't want the register allocator to throw it</span><span>
</span><span id="line-1035"></span><span>      </span><span class="hs-comment">-- away as an unnecessary reg-to-reg move, so we keep it in</span><span>
</span><span id="line-1036"></span><span>      </span><span class="hs-comment">-- the form of a movzl and print it as a movl later.</span><span>
</span><span id="line-1037"></span><span>      </span><span class="hs-comment">-- This doesn't apply to MO_XX_Conv since in this case we don't care about</span><span>
</span><span id="line-1038"></span><span>      </span><span class="hs-comment">-- the upper bits. So we can just use MOV.</span><span>
</span><span id="line-1039"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1041"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var">coerceFP2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span>
</span><span id="line-1046"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var">coerceFP2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FS_Conv"><span class="hs-identifier hs-type">MO_FS_Conv</span></a></span><span> </span><span id="local-6989586621682658669"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658669"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682658670"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658670"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-var">coerceFP2Int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658669"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658670"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SF_Conv"><span class="hs-identifier hs-type">MO_SF_Conv</span></a></span><span> </span><span id="local-6989586621682658673"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658673"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682658674"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658674"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-var">coerceInt2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658673"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658674"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1052"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1053"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Add"><span class="hs-identifier hs-type">MO_V_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1054"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Sub"><span class="hs-identifier hs-type">MO_V_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Mul"><span class="hs-identifier hs-type">MO_V_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1056"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Quot"><span class="hs-identifier hs-type">MO_VS_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1057"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Rem"><span class="hs-identifier hs-type">MO_VS_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1058"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Neg"><span class="hs-identifier hs-type">MO_VS_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1059"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Quot"><span class="hs-identifier hs-type">MO_VU_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1060"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Rem"><span class="hs-identifier hs-type">MO_VU_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1061"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1062"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1063"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Add"><span class="hs-identifier hs-type">MO_VF_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1064"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Sub"><span class="hs-identifier hs-type">MO_VF_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1065"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Mul"><span class="hs-identifier hs-type">MO_VF_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1066"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Quot"><span class="hs-identifier hs-type">MO_VF_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1067"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Neg"><span class="hs-identifier hs-type">MO_VF_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>      </span><span id="local-6989586621682658694"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658694"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658646"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1071"></span><span>        </span><span class="annot"><a href="#local-6989586621682658652"><span class="hs-identifier hs-type">triv_ucode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1072"></span><span>        </span><span id="local-6989586621682658652"><span class="annot"><span class="annottext">triv_ucode :: (Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682658652"><span class="hs-identifier hs-var hs-var">triv_ucode</span></a></span></span><span> </span><span id="local-6989586621682658696"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658696"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682658697"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658697"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Operand -&gt; Instr) -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-var">trivialUCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658697"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658696"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658697"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658647"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span>        </span><span class="hs-comment">-- signed or unsigned extension.</span><span>
</span><span id="line-1075"></span><span>        </span><span class="annot"><a href="#local-6989586621682658665"><span class="hs-identifier hs-type">integerExtend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1076"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1078"></span><span>        </span><span id="local-6989586621682658665"><span class="annot"><span class="annottext">integerExtend :: Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658665"><span class="hs-identifier hs-var hs-var">integerExtend</span></a></span></span><span> </span><span id="local-6989586621682658699"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658699"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682658700"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658700"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682658701"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658701"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682658702"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658702"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1079"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682658703"><span class="annot"><a href="#local-6989586621682658703"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682658704"><span class="annot"><a href="#local-6989586621682658704"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658699"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658702"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1080"></span><span>                                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658702"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1081"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-1082"></span><span>                </span><span id="local-6989586621682658705"><span class="annot"><a href="#local-6989586621682658705"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658706"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658706"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1083"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658704"><span class="hs-identifier hs-var">e_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1084"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658701"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658699"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658703"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658706"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658700"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682658705"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>
</span><span id="line-1087"></span><span>        </span><span class="annot"><a href="#local-6989586621682658655"><span class="hs-identifier hs-type">toI8Reg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1088"></span><span>        </span><span id="local-6989586621682658655"><span class="annot"><span class="annottext">toI8Reg :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var hs-var">toI8Reg</span></a></span></span><span> </span><span id="local-6989586621682658707"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658707"><span class="hs-identifier hs-var">new_rep</span></a></span></span><span> </span><span id="local-6989586621682658708"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658708"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-1089"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682658709"><span class="annot"><a href="#local-6989586621682658709"><span class="hs-identifier hs-var">codefn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658708"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1090"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658707"><span class="hs-identifier hs-type">new_rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682658709"><span class="hs-identifier hs-type">codefn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>                </span><span class="hs-comment">-- HACK: use getAnyReg to get a byte-addressable register.</span><span>
</span><span id="line-1092"></span><span>                </span><span class="hs-comment">-- If the source was a Fixed register, this will add the</span><span>
</span><span id="line-1093"></span><span>                </span><span class="hs-comment">-- mov instruction to put it into the desired destination.</span><span>
</span><span id="line-1094"></span><span>                </span><span class="hs-comment">-- We're assuming that the destination won't be a fixed</span><span>
</span><span id="line-1095"></span><span>                </span><span class="hs-comment">-- non-byte-addressable register; it won't be, because all</span><span>
</span><span id="line-1096"></span><span>                </span><span class="hs-comment">-- fixed registers are word-sized.</span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span>        </span><span id="local-6989586621682658657"><span class="annot"><span class="annottext">toI16Reg :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658657"><span class="hs-identifier hs-var hs-var">toI16Reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658655"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span> </span><span class="hs-comment">-- for now</span><span>
</span><span id="line-1099"></span><span>
</span><span id="line-1100"></span><span>        </span><span class="annot"><a href="#local-6989586621682658658"><span class="hs-identifier hs-type">conversionNop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1101"></span><span>        </span><span id="local-6989586621682658658"><span class="annot"><span class="annottext">conversionNop :: Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658658"><span class="hs-identifier hs-var hs-var">conversionNop</span></a></span></span><span> </span><span id="local-6989586621682658710"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658710"><span class="hs-identifier hs-var">new_format</span></a></span></span><span> </span><span id="local-6989586621682658711"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658711"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-1102"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682658712"><span class="annot"><a href="#local-6989586621682658712"><span class="hs-identifier hs-var">e_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658644"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658645"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658711"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1103"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-type">swizzleRegisterRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658712"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658710"><span class="hs-identifier hs-type">new_format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>
</span><span id="line-1105"></span><span>
</span><span id="line-1106"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658713"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682658714"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658714"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658715"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658716"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- dyadic MachOps</span><span>
</span><span id="line-1107"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658714"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1108"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1109"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1110"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1111"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1112"></span><span>      </span><span class="hs-comment">-- Invert comparison condition and swap operands</span><span>
</span><span id="line-1113"></span><span>      </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-1114"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1115"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658713"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1116"></span><span>
</span><span id="line-1117"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1118"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1121"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1122"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1123"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1124"></span><span>
</span><span id="line-1125"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1126"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1127"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1128"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1129"></span><span>
</span><span id="line-1130"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Add"><span class="hs-identifier hs-type">MO_F_Add</span></a></span><span>  </span><span id="local-6989586621682658745"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658745"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658745"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1131"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Sub"><span class="hs-identifier hs-type">MO_F_Sub</span></a></span><span>  </span><span id="local-6989586621682658748"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658748"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658748"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1132"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Quot"><span class="hs-identifier hs-type">MO_F_Quot</span></a></span><span> </span><span id="local-6989586621682658750"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658750"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658750"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1133"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Mul"><span class="hs-identifier hs-type">MO_F_Mul</span></a></span><span>  </span><span id="local-6989586621682658753"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658753"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658753"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682658755"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658755"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658756"><span class="hs-identifier hs-var">add_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658755"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1136"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682658757"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658757"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658758"><span class="hs-identifier hs-var">sub_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658757"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Quot"><span class="hs-identifier hs-type">MO_S_Quot</span></a></span><span> </span><span id="local-6989586621682658760"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658760"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658760"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1139"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Rem"><span class="hs-identifier hs-type">MO_S_Rem</span></a></span><span>  </span><span id="local-6989586621682658763"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658763"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658763"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1140"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Quot"><span class="hs-identifier hs-type">MO_U_Quot</span></a></span><span> </span><span id="local-6989586621682658765"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658765"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658765"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1141"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Rem"><span class="hs-identifier hs-type">MO_U_Rem</span></a></span><span>  </span><span id="local-6989586621682658767"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658767"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658767"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1142"></span><span>
</span><span id="line-1143"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span id="local-6989586621682658768"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658768"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658769"><span class="hs-identifier hs-var">imulMayOflo</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658768"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1144"></span><span>
</span><span id="line-1145"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658770"><span class="hs-identifier hs-var">imulW8</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1146"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span id="local-6989586621682658771"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658771"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682658772"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658771"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span>
</span><span id="line-1147"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span id="local-6989586621682658773"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658773"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682658772"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658773"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span>
</span><span id="line-1148"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span>  </span><span id="local-6989586621682658774"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658774"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682658772"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658774"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>
</span><span id="line-1149"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span id="local-6989586621682658775"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658775"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682658772"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658775"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span>        </span><span class="hs-comment">{- Shift ops on x86s have constraints on their source, it
           either has to be Imm, CL or 1
            =&gt; trivialCode is not restrictive enough (sigh.)
        -}</span><span>
</span><span id="line-1155"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span id="local-6989586621682658776"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658776"><span class="hs-identifier hs-var">rep</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658777"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658776"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1156"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682658778"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658778"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658777"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658778"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1157"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span id="local-6989586621682658779"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658779"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658777"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658779"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1158"></span><span>
</span><span id="line-1159"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1160"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1161"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Add"><span class="hs-identifier hs-type">MO_V_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1162"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Sub"><span class="hs-identifier hs-type">MO_V_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1163"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Mul"><span class="hs-identifier hs-type">MO_V_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1164"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Quot"><span class="hs-identifier hs-type">MO_VS_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1165"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Rem"><span class="hs-identifier hs-type">MO_VS_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1166"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Neg"><span class="hs-identifier hs-type">MO_VS_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1167"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1168"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1169"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Add"><span class="hs-identifier hs-type">MO_VF_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1170"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Sub"><span class="hs-identifier hs-type">MO_VF_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1171"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Mul"><span class="hs-identifier hs-type">MO_VF_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1172"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Quot"><span class="hs-identifier hs-type">MO_VF_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1173"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Neg"><span class="hs-identifier hs-type">MO_VF_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span>      </span><span id="local-6989586621682658780"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658780"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86) - binary CmmMachOp (1)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658714"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1177"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1178"></span><span>    </span><span id="local-6989586621682658772"><span class="annot"><span class="annottext">triv_op :: Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682658772"><span class="hs-identifier hs-var hs-var">triv_op</span></a></span></span><span> </span><span id="local-6989586621682658781"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658781"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682658782"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658782"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658781"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658784"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658784"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658716"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1179"></span><span>                        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658784"><span class="annot"><span class="annottext">op :: Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658784"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658782"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658781"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span>
</span><span id="line-1181"></span><span>    </span><span class="hs-comment">-- Special case for IMUL for bytes, since the result of IMULB will be in</span><span>
</span><span id="line-1182"></span><span>    </span><span class="hs-comment">-- %ax, the split to %dx/%edx/%rdx and %ax/%eax/%rax happens only for wider</span><span>
</span><span id="line-1183"></span><span>    </span><span class="hs-comment">-- values.</span><span>
</span><span id="line-1184"></span><span>    </span><span class="annot"><a href="#local-6989586621682658770"><span class="hs-identifier hs-type">imulW8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1185"></span><span>    </span><span id="local-6989586621682658770"><span class="annot"><span class="annottext">imulW8 :: CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658770"><span class="hs-identifier hs-var hs-var">imulW8</span></a></span></span><span> </span><span id="local-6989586621682658785"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658785"><span class="hs-identifier hs-var">arg_a</span></a></span></span><span> </span><span id="local-6989586621682658786"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658786"><span class="hs-identifier hs-var">arg_b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1186"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682658787"><span class="annot"><a href="#local-6989586621682658787"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658788"><span class="annot"><a href="#local-6989586621682658788"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658785"><span class="hs-identifier hs-var">arg_a</span></a></span><span>
</span><span id="line-1187"></span><span>        </span><span id="local-6989586621682658790"><span class="annot"><a href="#local-6989586621682658790"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658786"><span class="hs-identifier hs-type">arg_b</span></a></span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658791"><span class="annot"><a href="#local-6989586621682658791"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658788"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658790"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1190"></span><span>                   </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658793"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658787"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1191"></span><span>            </span><span id="local-6989586621682658793"><span class="annot"><a href="#local-6989586621682658793"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658793"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658791"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1194"></span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><a href="#local-6989586621682658769"><span class="hs-identifier hs-type">imulMayOflo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1196"></span><span>    </span><span id="local-6989586621682658769"><span class="annot"><span class="annottext">imulMayOflo :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658769"><span class="hs-identifier hs-var hs-var">imulMayOflo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span id="local-6989586621682658794"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658794"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682658795"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658795"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1197"></span><span>         </span><span class="hs-comment">-- The general case (W16, W32, W64) doesn't work for W8 as its</span><span>
</span><span id="line-1198"></span><span>         </span><span class="hs-comment">-- multiplication doesn't use two registers.</span><span>
</span><span id="line-1199"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-1200"></span><span>         </span><span class="hs-comment">-- The plan is:</span><span>
</span><span id="line-1201"></span><span>         </span><span class="hs-comment">-- 1. truncate and sign-extend a and b to 8bit width</span><span>
</span><span id="line-1202"></span><span>         </span><span class="hs-comment">-- 2. multiply a' = a * b in 32bit width</span><span>
</span><span id="line-1203"></span><span>         </span><span class="hs-comment">-- 3. copy and sign-extend 8bit from a' to c</span><span>
</span><span id="line-1204"></span><span>         </span><span class="hs-comment">-- 4. compare a' and c: they are equal if there was no overflow</span><span>
</span><span id="line-1205"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682658796"><span class="annot"><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658797"><span class="annot"><a href="#local-6989586621682658797"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658794"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1206"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682658798"><span class="annot"><a href="#local-6989586621682658798"><span class="hs-identifier hs-var">b_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658799"><span class="annot"><a href="#local-6989586621682658799"><span class="hs-identifier hs-var">b_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658795"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1207"></span><span>         </span><span class="hs-keyword">let</span><span>
</span><span id="line-1208"></span><span>             </span><span id="local-6989586621682658800"><span class="annot"><a href="#local-6989586621682658800"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658797"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658799"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1209"></span><span>                        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1210"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1211"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658798"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658798"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1212"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658798"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1213"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1214"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658796"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1215"></span><span>                           </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-1217"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658800"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span>    </span><span class="annot"><a href="#local-6989586621682658769"><span class="hs-identifier hs-var">imulMayOflo</span></a></span><span> </span><span id="local-6989586621682658803"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658803"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658804"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658804"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682658805"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658805"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1219"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682658806"><span class="annot"><a href="#local-6989586621682658806"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658807"><span class="annot"><a href="#local-6989586621682658807"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658804"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1220"></span><span>         </span><span id="local-6989586621682658808"><span class="annot"><a href="#local-6989586621682658808"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658805"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1221"></span><span>         </span><span class="hs-keyword">let</span><span>
</span><span id="line-1222"></span><span>             </span><span id="local-6989586621682658809"><span class="annot"><a href="#local-6989586621682658809"><span class="hs-identifier hs-var hs-var">shift_amt</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658803"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1223"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-1224"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span>
</span><span id="line-1225"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span>
</span><span id="line-1226"></span><span>                           </span><span id="local-6989586621682658810"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658810"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;shift_amt: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658810"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>
</span><span id="line-1228"></span><span>             </span><span id="local-6989586621682658811"><span class="annot"><a href="#local-6989586621682658811"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658803"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1229"></span><span>             </span><span id="local-6989586621682658812"><span class="annot"><a href="#local-6989586621682658812"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658807"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658808"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1230"></span><span>                        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1231"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658811"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658806"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- result in %edx:%eax</span><span>
</span><span id="line-1232"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658811"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682658809"><span class="hs-identifier hs-var">shift_amt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1233"></span><span>                                </span><span class="hs-comment">-- sign extend lower part</span><span>
</span><span id="line-1234"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658811"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1235"></span><span>                                </span><span class="hs-comment">-- compare against upper</span><span>
</span><span id="line-1236"></span><span>                           </span><span class="hs-comment">-- eax==0 if high part == sign extended low part</span><span>
</span><span id="line-1237"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-1238"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658811"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658812"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1241"></span><span>    </span><span class="annot"><a href="#local-6989586621682658777"><span class="hs-identifier hs-type">shift_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1242"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1244"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1245"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1246"></span><span>
</span><span id="line-1247"></span><span>    </span><span class="hs-comment">{- Case1: shift length as immediate -}</span><span>
</span><span id="line-1248"></span><span>    </span><span id="local-6989586621682658777"><span class="annot"><span class="annottext">shift_code :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682658777"><span class="hs-identifier hs-var hs-var">shift_code</span></a></span></span><span> </span><span id="local-6989586621682658813"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658813"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682658814"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658814"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682658815"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658815"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658816"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658816"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>      </span><span class="hs-comment">-- Handle the case of a shift larger than the width of the shifted value.</span><span>
</span><span id="line-1250"></span><span>      </span><span class="hs-comment">-- This is necessary since x86 applies a mask of 0x1f to the shift</span><span>
</span><span id="line-1251"></span><span>      </span><span class="hs-comment">-- amount, meaning that, e.g., `shr 47, $eax` will actually shift by</span><span>
</span><span id="line-1252"></span><span>      </span><span class="hs-comment">-- `47 &amp; 0x1f == 15`. See #20626.</span><span>
</span><span id="line-1253"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658817"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658817"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658816"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1254"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658817"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658813"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Register) -&gt; CmmExpr -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmExpr) -&gt; CmmLit -&gt; CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658813"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1258"></span><span>          </span><span id="local-6989586621682658819"><span class="annot"><a href="#local-6989586621682658819"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658815"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1259"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-1260"></span><span>               </span><span id="local-6989586621682658820"><span class="annot"><a href="#local-6989586621682658820"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658813"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1261"></span><span>               </span><span id="local-6989586621682658821"><span class="annot"><a href="#local-6989586621682658821"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658822"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658822"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1262"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658819"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658822"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1263"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658814"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658820"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658816"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658822"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1264"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658820"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658821"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1265"></span><span>
</span><span id="line-1266"></span><span>    </span><span class="hs-comment">{- Case2: shift length is complex (non-immediate)
      * y must go in %ecx.
      * we cannot do y first *and* put its result in %ecx, because
        %ecx might be clobbered by x.
      * if we do y second, then x cannot be
        in a clobbered reg.  Also, we cannot clobber x's reg
        with the instruction itself.
      * so we can either:
        - do y first, put its result in a fresh tmp, then copy it to %ecx later
        - do y second and put its result into %ecx.  x gets placed in a fresh
          tmp.  This is likely to be better, because the reg alloc can
          eliminate this reg-&gt;reg move here (it won't eliminate the other one,
          because the move is into the fixed %ecx).
      * in the case of C calls the use of ecx here can interfere with arguments.
        We avoid this with the hack described in Note [Evaluate C-call
        arguments before placing in destination registers]
    -}</span><span>
</span><span id="line-1283"></span><span>    </span><span class="annot"><a href="#local-6989586621682658777"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span id="local-6989586621682658823"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658823"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682658824"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658824"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682658825"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658825"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658826"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658826"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-comment">{-amount-}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1284"></span><span>        </span><span id="local-6989586621682658827"><span class="annot"><a href="#local-6989586621682658827"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658825"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1285"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658828"><span class="annot"><a href="#local-6989586621682658828"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658823"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1286"></span><span>        </span><span id="local-6989586621682658829"><span class="annot"><a href="#local-6989586621682658829"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658828"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-1287"></span><span>        </span><span id="local-6989586621682658830"><span class="annot"><a href="#local-6989586621682658830"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658826"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1288"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1289"></span><span>           </span><span id="local-6989586621682658831"><span class="annot"><a href="#local-6989586621682658831"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658827"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658829"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1290"></span><span>                  </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658830"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1291"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658824"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658828"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658829"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658828"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658829"><span class="hs-identifier hs-type">tmp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658831"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1295"></span><span>    </span><span class="annot"><a href="#local-6989586621682658756"><span class="hs-identifier hs-type">add_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1296"></span><span>    </span><span id="local-6989586621682658756"><span class="annot"><span class="annottext">add_code :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658756"><span class="hs-identifier hs-var hs-var">add_code</span></a></span></span><span> </span><span id="local-6989586621682658832"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658832"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658833"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658833"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658834"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658834"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658834"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1298"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658832"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-comment">-- LEA doesn't support byte size (#18614)</span><span>
</span><span id="line-1299"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682658836"><span class="hs-identifier hs-var">add_int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658832"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658833"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658834"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1300"></span><span>    </span><span class="annot"><a href="#local-6989586621682658756"><span class="hs-identifier hs-var">add_code</span></a></span><span> </span><span id="local-6989586621682658837"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658837"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658838"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658839"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658839"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658837"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658840"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658840"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658838"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658839"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1301"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658840"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658840"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658837"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1302"></span><span>    </span><span class="hs-comment">-- TODO: There are other interesting patterns we want to replace</span><span>
</span><span id="line-1303"></span><span>    </span><span class="hs-comment">--     with a LEA, e.g. `(x + offset) + (y &lt;&lt; shift)`.</span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1306"></span><span>    </span><span class="annot"><a href="#local-6989586621682658758"><span class="hs-identifier hs-type">sub_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1307"></span><span>    </span><span id="local-6989586621682658758"><span class="annot"><span class="annottext">sub_code :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658758"><span class="hs-identifier hs-var hs-var">sub_code</span></a></span></span><span> </span><span id="local-6989586621682658841"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658841"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658842"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658842"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658843"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658843"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1308"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658843"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658841"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-comment">-- LEA doesn't support byte size (#18614)</span><span>
</span><span id="line-1310"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682658836"><span class="hs-identifier hs-var">add_int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658841"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658842"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658843"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1311"></span><span>    </span><span class="annot"><a href="#local-6989586621682658758"><span class="hs-identifier hs-var">sub_code</span></a></span><span> </span><span id="local-6989586621682658844"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658844"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658845"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658845"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658846"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658846"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658844"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658844"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658845"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658846"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span>    </span><span class="hs-comment">-- our three-operand add instruction:</span><span>
</span><span id="line-1314"></span><span>    </span><span id="local-6989586621682658836"><span class="annot"><span class="annottext">add_int :: Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682658836"><span class="hs-identifier hs-var hs-var">add_int</span></a></span></span><span> </span><span id="local-6989586621682658850"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658850"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682658851"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658851"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658852"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658852"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1315"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682658853"><span class="annot"><a href="#local-6989586621682658853"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658854"><span class="annot"><a href="#local-6989586621682658854"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658851"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1316"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1317"></span><span>            </span><span id="local-6989586621682658855"><span class="annot"><a href="#local-6989586621682658855"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658850"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1318"></span><span>            </span><span id="local-6989586621682658856"><span class="annot"><a href="#local-6989586621682658856"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658852"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1319"></span><span>            </span><span id="local-6989586621682658857"><span class="annot"><a href="#local-6989586621682658857"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658858"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658858"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1320"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658854"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1321"></span><span>                 </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658855"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1322"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658853"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682658856"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658858"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1324"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1325"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658855"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658857"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1326"></span><span>
</span><span id="line-1327"></span><span>    </span><span class="hs-comment">----------------------</span><span>
</span><span id="line-1328"></span><span>
</span><span id="line-1329"></span><span>    </span><span class="hs-comment">-- See Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-1330"></span><span>    </span><span id="local-6989586621682658761"><span class="annot"><span class="annottext">div_code :: Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var hs-var">div_code</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span id="local-6989586621682658865"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658865"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682658866"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658866"><span class="hs-identifier hs-var">quotient</span></a></span></span><span> </span><span id="local-6989586621682658867"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658867"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658868"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658868"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1331"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658869"><span class="annot"><span class="annottext">widen :: MachOp
</span><a href="#local-6989586621682658869"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658865"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1332"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1333"></span><span>        </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span>
</span><span id="line-1334"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1335"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658865"><span class="hs-identifier hs-var">signed</span></a></span><span>
</span><span id="line-1336"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658866"><span class="hs-identifier hs-var">quotient</span></a></span><span>
</span><span id="line-1337"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658869"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658867"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1338"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658869"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658868"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>
</span><span id="line-1340"></span><span>    </span><span class="annot"><a href="#local-6989586621682658761"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span id="local-6989586621682658870"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658870"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682658871"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658871"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682658872"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658872"><span class="hs-identifier hs-var">quotient</span></a></span></span><span> </span><span id="local-6989586621682658873"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658873"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682658874"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658874"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1341"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621682658875"><span class="annot"><a href="#local-6989586621682658875"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658876"><span class="annot"><a href="#local-6989586621682658876"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658874"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">-- cannot be clobbered</span><span>
</span><span id="line-1342"></span><span>           </span><span id="local-6989586621682658878"><span class="annot"><a href="#local-6989586621682658878"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658873"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-1343"></span><span>           </span><span class="hs-keyword">let</span><span>
</span><span id="line-1344"></span><span>             </span><span id="local-6989586621682658879"><span class="annot"><a href="#local-6989586621682658879"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658870"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1345"></span><span>             </span><span id="local-6989586621682658880"><span class="annot"><a href="#local-6989586621682658880"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658871"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658879"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1346"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658879"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span>             </span><span id="local-6989586621682658881"><span class="annot"><a href="#local-6989586621682658881"><span class="hs-identifier hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658871"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a></span><span>
</span><span id="line-1349"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span>             </span><span id="local-6989586621682658884"><span class="annot"><a href="#local-6989586621682658884"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658876"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1352"></span><span>                    </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658878"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1353"></span><span>                    </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682658880"><span class="hs-identifier hs-var">widen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658881"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658879"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682658875"><span class="hs-identifier hs-var">y_op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1354"></span><span>
</span><span id="line-1355"></span><span>             </span><span id="local-6989586621682658885"><span class="annot"><a href="#local-6989586621682658885"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658872"><span class="hs-identifier hs-var">quotient</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span>
</span><span id="line-1356"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span>
</span><span id="line-1357"></span><span>
</span><span id="line-1358"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658879"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658885"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658884"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>
</span><span id="line-1360"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658886"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658886"><span class="hs-identifier hs-var">_plat</span></a></span></span><span> </span><span id="local-6989586621682658887"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658887"><span class="hs-identifier hs-var">_is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682658888"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658888"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682658889"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658889"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658890"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658890"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682658891"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658891"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- ternary MachOps</span><span>
</span><span id="line-1361"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658888"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1362"></span><span>      </span><span class="hs-comment">-- Floating point fused multiply-add operations @ &#177; x*y &#177; z@</span><span>
</span><span id="line-1363"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FMA"><span class="hs-identifier hs-type">MO_FMA</span></a></span><span> </span><span id="local-6989586621682658893"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682658893"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682658894"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658894"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; FMASign -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-var">genFMA3Code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658894"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682658893"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658889"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658890"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658891"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span>      </span><span id="local-6989586621682658896"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658896"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86) - ternary CmmMachOp (1)&quot;</span></span><span>
</span><span id="line-1366"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682658888"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1367"></span><span>
</span><span id="line-1368"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658897"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658897"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682658898"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658898"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1369"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658898"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-1370"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1371"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682658899"><span class="annot"><a href="#local-6989586621682658899"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682658900"><span class="annot"><a href="#local-6989586621682658900"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658897"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1372"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadFloatAmode"><span class="hs-identifier hs-type">loadFloatAmode</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-type">typeWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658898"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682658899"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658900"><span class="hs-identifier hs-type">mem_code</span></a></span><span>
</span><span id="line-1373"></span><span>
</span><span id="line-1374"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658901"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658901"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658902"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658902"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682658903"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658903"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1375"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658901"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658903"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1376"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1377"></span><span>    </span><span id="local-6989586621682658904"><span class="annot"><a href="#local-6989586621682658904"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658905"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658902"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1378"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658906"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658904"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1379"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1380"></span><span>    </span><span id="local-6989586621682658907"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682658907"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658903"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-1381"></span><span>    </span><span id="local-6989586621682658906"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658906"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658907"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1382"></span><span>    </span><span id="local-6989586621682658905"><span class="annot"><span class="annottext">instr :: Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658905"><span class="hs-identifier hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658907"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1383"></span><span>                </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>
</span><span id="line-1384"></span><span>                </span><span id="local-6989586621682658908"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658908"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658906"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1385"></span><span>        </span><span class="hs-comment">-- We always zero-extend 8-bit loads, if we</span><span>
</span><span id="line-1386"></span><span>        </span><span class="hs-comment">-- can't think of anything better.  This is because</span><span>
</span><span id="line-1387"></span><span>        </span><span class="hs-comment">-- we can't guarantee access to an 8-bit variant of every register</span><span>
</span><span id="line-1388"></span><span>        </span><span class="hs-comment">-- (esi and edi don't have 8-bit variants), so to make things</span><span>
</span><span id="line-1389"></span><span>        </span><span class="hs-comment">-- simpler we do our 8-bit arithmetic with full 32-bit registers.</span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span class="hs-comment">-- Simpler memory load code on x86_64</span><span>
</span><span id="line-1392"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658909"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658909"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682658910"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658910"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682658911"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658911"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658909"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1394"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1395"></span><span>    </span><span id="local-6989586621682658912"><span class="annot"><a href="#local-6989586621682658912"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658913"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658910"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1396"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658913"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658912"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1397"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682658913"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658913"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; Width -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682658911"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658914"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658914"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682658915"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658915"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1400"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1401"></span><span>        </span><span id="local-6989586621682658916"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658916"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682658915"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span>        </span><span class="hs-comment">-- x86_64: 32-bit xor is one byte shorter, and zero-extends to 64 bits</span><span>
</span><span id="line-1404"></span><span>        </span><span id="local-6989586621682658917"><span class="annot"><span class="annottext">format1 :: Format
</span><a href="#local-6989586621682658917"><span class="hs-identifier hs-var hs-var">format1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658914"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658916"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1405"></span><span>                           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658916"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1406"></span><span>                                </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span>
</span><span id="line-1407"></span><span>                                </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658916"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1408"></span><span>        </span><span id="local-6989586621682658918"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658918"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658919"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658919"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1409"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658917"><span class="hs-identifier hs-var">format1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1410"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-1411"></span><span>        </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658916"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658918"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span class="hs-comment">-- Handle symbol references with LEA and %rip-relative addressing.</span><span>
</span><span id="line-1414"></span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-1415"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658920"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658920"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658921"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658921"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658922"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658922"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1416"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682658923"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658922"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1417"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658921"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1418"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658924"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658924"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658920"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658922"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1419"></span><span>           </span><span id="local-6989586621682658926"><span class="annot"><span class="annottext">imm :: Imm
</span><a href="#local-6989586621682658926"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658922"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1420"></span><span>           </span><span id="local-6989586621682658927"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682658927"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682658926"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1421"></span><span>           </span><span id="local-6989586621682658929"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658929"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658930"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658930"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658924"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682658927"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658930"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1422"></span><span>       </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658924"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658929"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1423"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1424"></span><span>    </span><span id="local-6989586621682658923"><span class="annot"><span class="annottext">is_label :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682658923"><span class="hs-identifier hs-var hs-var">is_label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1425"></span><span>    </span><span class="annot"><a href="#local-6989586621682658923"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1426"></span><span>    </span><span class="annot"><a href="#local-6989586621682658923"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1427"></span><span>    </span><span class="annot"><a href="#local-6989586621682658923"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1428"></span><span>
</span><span id="line-1429"></span><span>  </span><span class="hs-comment">-- optimisation for loading small literals on x86_64: take advantage</span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-comment">-- of the automatic zero-extension from 32 to 64 bits, because the 32-bit</span><span>
</span><span id="line-1431"></span><span>  </span><span class="hs-comment">-- instruction forms are shorter.</span><span>
</span><span id="line-1432"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658933"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658933"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682658934"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658934"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658935"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658935"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1433"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658934"><span class="hs-identifier hs-var">is32Bit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658933"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658935"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682658936"><span class="hs-identifier hs-var">isBigLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658935"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1434"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1435"></span><span>        </span><span id="local-6989586621682658937"><span class="annot"><span class="annottext">imm :: Imm
</span><a href="#local-6989586621682658937"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658935"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1436"></span><span>        </span><span id="local-6989586621682658938"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658938"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658939"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658939"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682658937"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658939"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1437"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-1438"></span><span>        </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658938"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1439"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1440"></span><span>   </span><span id="local-6989586621682658936"><span class="annot"><span class="annottext">isBigLit :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682658936"><span class="hs-identifier hs-var hs-var">isBigLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682658944"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658944"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658944"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682658944"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xffffffff</span></span><span>
</span><span id="line-1441"></span><span>   </span><span class="annot"><a href="#local-6989586621682658936"><span class="hs-identifier hs-var">isBigLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1442"></span><span>        </span><span class="hs-comment">-- note1: not the same as (not.is32BitLit), because that checks for</span><span>
</span><span id="line-1443"></span><span>        </span><span class="hs-comment">-- signed literals that fit in 32 bits, but we want unsigned</span><span>
</span><span id="line-1444"></span><span>        </span><span class="hs-comment">-- literals here.</span><span>
</span><span id="line-1445"></span><span>        </span><span class="hs-comment">-- note2: all labels are small, because we're assuming the</span><span>
</span><span id="line-1446"></span><span>        </span><span class="hs-comment">-- small memory model. See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-1447"></span><span>
</span><span id="line-1448"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658948"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658948"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682658949"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658949"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1449"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658950"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682658950"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658948"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658949"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>           </span><span id="local-6989586621682658951"><span class="annot"><span class="annottext">imm :: Imm
</span><a href="#local-6989586621682658951"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682658949"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1451"></span><span>           </span><span id="local-6989586621682658952"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658952"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682658953"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658953"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658950"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682658951"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658953"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1452"></span><span>       </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658950"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658952"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span>
</span><span id="line-1454"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682658954"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658954"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658955"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658955"><span class="hs-identifier hs-var">other</span></a></span></span><span>
</span><span id="line-1455"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658955"><span class="hs-identifier hs-var">other</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span>
</span><span id="line-1456"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658954"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658955"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span>
</span><span id="line-1459"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-type">intLoadCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1460"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1461"></span><span id="intLoadCode"><span class="annot"><span class="annottext">intLoadCode :: (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var hs-var">intLoadCode</span></a></span></span><span> </span><span id="local-6989586621682658957"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658957"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682658958"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658958"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1462"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682658959"><span class="annot"><a href="#local-6989586621682658959"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682658960"><span class="annot"><a href="#local-6989586621682658960"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658958"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682658961"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658961"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658960"><span class="hs-identifier hs-var">mem_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682658957"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682658959"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658961"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1464"></span><span>
</span><span id="line-1465"></span><span class="hs-comment">-- Compute an expression into *any* register, adding the appropriate</span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- move instruction if necessary.</span><span>
</span><span id="line-1467"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1468"></span><span id="getAnyReg"><span class="annot"><span class="annottext">getAnyReg :: CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var hs-var">getAnyReg</span></a></span></span><span> </span><span id="local-6989586621682658962"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658962"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1469"></span><span>  </span><span id="local-6989586621682658963"><span class="annot"><a href="#local-6989586621682658963"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658962"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1470"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658963"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1473"></span><span id="anyReg"><span class="annot"><span class="annottext">anyReg :: Register -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-var hs-var">anyReg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682658965"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658965"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; OrdList Instr) -&gt; NatM (Reg -&gt; OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658965"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-1474"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-var">anyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682658966"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658966"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658967"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658967"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658968"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658968"><span class="hs-identifier hs-var">fcode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; OrdList Instr) -&gt; NatM (Reg -&gt; OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682658969"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658969"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658968"><span class="hs-identifier hs-var">fcode</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-var">reg2reg</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658966"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658967"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658969"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1475"></span><span>
</span><span id="line-1476"></span><span class="hs-comment">-- A bit like getSomeReg, but we want a reg that can be byte-addressed.</span><span>
</span><span id="line-1477"></span><span class="hs-comment">-- Fixed registers might not be byte-addressable, so we make sure we've</span><span>
</span><span id="line-1478"></span><span class="hs-comment">-- got a temporary, inserting an extra reg copy if necessary.</span><span>
</span><span id="line-1479"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-type">getByteReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span id="getByteReg"><span class="annot"><span class="annottext">getByteReg :: CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var hs-var">getByteReg</span></a></span></span><span> </span><span id="local-6989586621682658971"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658971"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1481"></span><span>  </span><span id="local-6989586621682658972"><span class="annot"><a href="#local-6989586621682658972"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-1482"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682658972"><span class="hs-identifier hs-type">is32Bit</span></a></span><span>
</span><span id="line-1483"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682658973"><span class="annot"><a href="#local-6989586621682658973"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658971"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-1484"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682658973"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1485"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682658974"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658974"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658975"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658975"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1486"></span><span>                    </span><span id="local-6989586621682658976"><span class="annot"><a href="#local-6989586621682658976"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658974"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1487"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658976"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682658975"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658976"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682658977"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658977"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658978"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658978"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658979"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658979"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-1489"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Bool
</span><a href="GHC.Platform.Reg.html#isVirtualReg"><span class="hs-identifier hs-var">isVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658978"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Reg, OrdList Instr) -&gt; NatM (Reg, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658978"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658979"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1490"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1491"></span><span>                        </span><span id="local-6989586621682658981"><span class="annot"><a href="#local-6989586621682658981"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658977"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1492"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658981"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682658979"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-type">reg2reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658977"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658978"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658981"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1493"></span><span>                    </span><span class="hs-comment">-- ToDo: could optimise slightly by checking for</span><span>
</span><span id="line-1494"></span><span>                    </span><span class="hs-comment">-- byte-addressable real registers, but that will</span><span>
</span><span id="line-1495"></span><span>                    </span><span class="hs-comment">-- happen very rarely if at all.</span><span>
</span><span id="line-1496"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658971"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-comment">-- all regs are byte-addressable on x86_64</span><span>
</span><span id="line-1497"></span><span>
</span><span id="line-1498"></span><span class="hs-comment">-- Another variant: this time we want the result in a register that cannot</span><span>
</span><span id="line-1499"></span><span class="hs-comment">-- be modified by code to evaluate an arbitrary expression.</span><span>
</span><span id="line-1500"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span id="getNonClobberedReg"><span class="annot"><span class="annottext">getNonClobberedReg :: CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var hs-var">getNonClobberedReg</span></a></span></span><span> </span><span id="local-6989586621682658982"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658982"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1502"></span><span>  </span><span id="local-6989586621682658983"><span class="annot"><a href="#local-6989586621682658983"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658982"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1503"></span><span>  </span><span id="local-6989586621682658984"><span class="annot"><a href="#local-6989586621682658984"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-1504"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682658983"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1505"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682658985"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658985"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658986"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682658986"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1506"></span><span>        </span><span id="local-6989586621682658987"><span class="annot"><a href="#local-6989586621682658987"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658985"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1507"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658987"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682658986"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658987"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1508"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682658988"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658988"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682658989"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658989"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682658990"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658990"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-1509"></span><span>        </span><span class="hs-comment">-- only certain regs can be clobbered</span><span>
</span><span id="line-1510"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658989"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#instrClobberedRegs"><span class="hs-identifier hs-var">instrClobberedRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658984"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1511"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1512"></span><span>                </span><span id="local-6989586621682658993"><span class="annot"><a href="#local-6989586621682658993"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658988"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1513"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682658993"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682658990"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-type">reg2reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658988"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658989"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682658993"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1514"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1515"></span><span>                </span><span class="annot"><span class="annottext">(Reg, OrdList Instr) -&gt; NatM (Reg, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658989"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682658990"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1516"></span><span>
</span><span id="line-1517"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-type">reg2reg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1518"></span><span id="reg2reg"><span class="annot"><span class="annottext">reg2reg :: Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-var hs-var">reg2reg</span></a></span></span><span> </span><span id="local-6989586621682658994"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658994"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621682658995"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658995"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682658996"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658996"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682658994"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658995"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682658996"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1519"></span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1522"></span><span>
</span><span id="line-1523"></span><span class="hs-comment">-- | Convert a 'CmmExpr' representing a memory address into an 'Amode'.</span><span>
</span><span id="line-1524"></span><span class="hs-comment">--</span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- An 'Amode' is a datatype representing a valid address form for the target</span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- (e.g. &quot;Base + Index + disp&quot; or immediate) and the code to compute it.</span><span>
</span><span id="line-1527"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-1528"></span><span id="getAmode"><span class="annot"><span class="annottext">getAmode :: CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var hs-var">getAmode</span></a></span></span><span> </span><span id="local-6989586621682658997"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658997"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1529"></span><span>   </span><span id="local-6989586621682658998"><span class="annot"><a href="#local-6989586621682658998"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1530"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682658999"><span class="annot"><a href="#local-6989586621682658999"><span class="hs-identifier hs-var hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658998"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1531"></span><span>
</span><span id="line-1532"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682658997"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1533"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682659000"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659000"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682659001"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659001"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1534"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Amode) -&gt; CmmExpr -&gt; NatM Amode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659000"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659001"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1535"></span><span>
</span><span id="line-1536"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659002"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659002"><span class="hs-identifier hs-var">displacement</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1537"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658999"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1538"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Amode -&gt; NatM Amode) -&gt; Amode -&gt; NatM Amode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; OrdList Instr -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-var">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659002"><span class="hs-identifier hs-var">displacement</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-1539"></span><span>
</span><span id="line-1540"></span><span>      </span><span class="hs-comment">-- This is all just ridiculous, since it carefully undoes</span><span>
</span><span id="line-1541"></span><span>      </span><span class="hs-comment">-- what mangleIndexTree has just done.</span><span>
</span><span id="line-1542"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682659003"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659003"><span class="hs-identifier hs-var">_rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659004"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659004"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659005"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682659005"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659006"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659006"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1543"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658998"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659005"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1544"></span><span>         </span><span class="hs-comment">-- assert (rep == II32)???</span><span>
</span><span id="line-1545"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1546"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682659008"><span class="annot"><a href="#local-6989586621682659008"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659009"><span class="annot"><a href="#local-6989586621682659009"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659004"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1547"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659010"><span class="annot"><a href="#local-6989586621682659010"><span class="hs-identifier hs-var hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659006"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1548"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659008"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659010"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659009"><span class="hs-identifier hs-type">x_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>
</span><span id="line-1550"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682659011"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659011"><span class="hs-identifier hs-var">_rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659012"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659012"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659013"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659013"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1551"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658998"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659013"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1552"></span><span>         </span><span class="hs-comment">-- assert (rep == II32)???</span><span>
</span><span id="line-1553"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1554"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682659014"><span class="annot"><a href="#local-6989586621682659014"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659015"><span class="annot"><a href="#local-6989586621682659015"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659012"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1555"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659016"><span class="annot"><a href="#local-6989586621682659016"><span class="hs-identifier hs-var hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659013"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1556"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659014"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659016"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659015"><span class="hs-identifier hs-type">x_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span>      </span><span class="hs-comment">-- Turn (lit1 &lt;&lt; n  + lit2) into  (lit2 + lit1 &lt;&lt; n) so it will be</span><span>
</span><span id="line-1559"></span><span>      </span><span class="hs-comment">-- recognised by the next rule.</span><span>
</span><span id="line-1560"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682659017"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659017"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659018"><span class="annot"><span class="annottext">a :: CmmExpr
</span><a href="#local-6989586621682659018"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659019"><span class="annot"><span class="annottext">b :: CmmExpr
</span><a href="#local-6989586621682659019"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1561"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659017"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659019"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659018"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span>      </span><span class="hs-comment">-- Matches: (x + offset) + (y &lt;&lt; shift)</span><span>
</span><span id="line-1564"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682659020"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659021"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659021"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659022"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659022"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659023"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1565"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1566"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659020"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659022"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659023"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659021"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1567"></span><span>
</span><span id="line-1568"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659025"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659025"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659026"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659026"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659027"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1569"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1570"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659025"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659026"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659027"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1571"></span><span>
</span><span id="line-1572"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659028"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659028"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>                                                    </span><span class="hs-special">[</span><span id="local-6989586621682659029"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659029"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659030"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659031"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659031"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1574"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1575"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659031"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-1576"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659028"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659029"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659030"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659031"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-1577"></span><span>
</span><span id="line-1578"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659032"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659032"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659033"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659033"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1579"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.Cmm.Expr.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659033"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- we already handle valid literals above.</span><span>
</span><span id="line-1580"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659032"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659033"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1581"></span><span>
</span><span id="line-1582"></span><span>      </span><span class="hs-comment">-- Handle labels with %rip-relative addressing since in general the image</span><span>
</span><span id="line-1583"></span><span>      </span><span class="hs-comment">-- may be loaded anywhere in the 64-bit address space (e.g. on Windows</span><span>
</span><span id="line-1584"></span><span>      </span><span class="hs-comment">-- with high-entropy ASLR). See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-1585"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659035"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659035"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-1586"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682658999"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1587"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682659036"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659035"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1588"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; OrdList Instr -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659035"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659037"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659037"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-1591"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682658998"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659037"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1592"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; OrdList Instr -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmAddr"><span class="hs-identifier hs-var">ImmAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659037"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>
</span><span id="line-1594"></span><span>      </span><span class="hs-comment">-- Literal with offsets too big (&gt; 32 bits) fails during the linking phase</span><span>
</span><span id="line-1595"></span><span>      </span><span class="hs-comment">-- (#15570). We already handled valid literals above so we don't have to</span><span>
</span><span id="line-1596"></span><span>      </span><span class="hs-comment">-- test anything here.</span><span>
</span><span id="line-1597"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span id="local-6989586621682659039"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659039"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682659040"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659040"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659039"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659040"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1600"></span><span>                                             </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1601"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span id="local-6989586621682659041"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659041"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621682659042"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659042"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621682659043"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659043"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682659044"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659044"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1602"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CLabel -&gt; Int -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659041"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659042"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659044"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659043"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1604"></span><span>                                             </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1605"></span><span>
</span><span id="line-1606"></span><span>      </span><span class="hs-comment">-- in case we can't do something better, we just compute the expression</span><span>
</span><span id="line-1607"></span><span>      </span><span class="hs-comment">-- and put the result in a register</span><span>
</span><span id="line-1608"></span><span>      </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1609"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682659045"><span class="annot"><a href="#local-6989586621682659045"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659046"><span class="annot"><a href="#local-6989586621682659046"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682658997"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1610"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659045"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659046"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1611"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1612"></span><span>    </span><span id="local-6989586621682659036"><span class="annot"><span class="annottext">is_label :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682659036"><span class="hs-identifier hs-var hs-var">is_label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1613"></span><span>    </span><span class="annot"><a href="#local-6989586621682659036"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1614"></span><span>    </span><span class="annot"><a href="#local-6989586621682659036"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1615"></span><span>    </span><span class="annot"><a href="#local-6989586621682659036"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1616"></span><span>
</span><span id="line-1617"></span><span>
</span><span id="line-1618"></span><span class="hs-comment">-- | Like 'getAmode', but on 32-bit use simple register addressing</span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- (i.e. no index register). This stops us from running out of</span><span>
</span><span id="line-1620"></span><span class="hs-comment">-- registers on x86 when using instructions such as cmpxchg, which can</span><span>
</span><span id="line-1621"></span><span class="hs-comment">-- use up to three virtual registers and one fixed register.</span><span>
</span><span id="line-1622"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-1623"></span><span id="getSimpleAmode"><span class="annot"><span class="annottext">getSimpleAmode :: CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-var hs-var">getSimpleAmode</span></a></span></span><span> </span><span id="local-6989586621682659048"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659048"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NatM Bool -&gt; (Bool -&gt; NatM Amode) -&gt; NatM Amode
forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1624"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659048"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-1625"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1626"></span><span>    </span><span id="local-6989586621682659049"><span class="annot"><a href="#local-6989586621682659049"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659048"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-1627"></span><span>    </span><span id="local-6989586621682659050"><span class="annot"><a href="#local-6989586621682659050"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-1628"></span><span>    </span><span id="local-6989586621682659051"><span class="annot"><a href="#local-6989586621682659051"><span class="hs-identifier hs-var">addr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-type">ncgWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659050"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1629"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659052"><span class="annot"><a href="#local-6989586621682659052"><span class="hs-identifier hs-var hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659051"><span class="hs-identifier hs-var">addr_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659052"><span class="hs-identifier hs-type">amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659049"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659051"><span class="hs-identifier hs-type">addr_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-type">x86_complex_amode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-1633"></span><span id="x86_complex_amode"><span class="annot"><span class="annottext">x86_complex_amode :: CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var hs-var">x86_complex_amode</span></a></span></span><span> </span><span id="local-6989586621682659053"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659053"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621682659054"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659054"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621682659055"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659055"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621682659056"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659056"><span class="hs-identifier hs-var">offset</span></a></span></span><span>
</span><span id="line-1634"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682659057"><span class="annot"><a href="#local-6989586621682659057"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659058"><span class="annot"><a href="#local-6989586621682659058"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659053"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-1635"></span><span>        </span><span class="hs-comment">-- x must be in a temp, because it has to stay live over y_code</span><span>
</span><span id="line-1636"></span><span>        </span><span class="hs-comment">-- we could compare x_reg and y_reg and do something better here...</span><span>
</span><span id="line-1637"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682659059"><span class="annot"><a href="#local-6989586621682659059"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659060"><span class="annot"><a href="#local-6989586621682659060"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659054"><span class="hs-identifier hs-type">index</span></a></span><span>
</span><span id="line-1638"></span><span>       </span><span class="hs-keyword">let</span><span>
</span><span id="line-1639"></span><span>           </span><span id="local-6989586621682659061"><span class="annot"><a href="#local-6989586621682659061"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659058"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659060"><span class="hs-identifier hs-var">y_code</span></a></span><span>
</span><span id="line-1640"></span><span>           </span><span id="local-6989586621682659062"><span class="annot"><a href="#local-6989586621682659062"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659055"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">;</span><span>
</span><span id="line-1641"></span><span>                                </span><span id="local-6989586621682659063"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659063"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x86_complex_amode: unhandled shift! (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659063"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1642"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659057"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-type">EAIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659059"><span class="hs-identifier hs-type">y_reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659062"><span class="hs-identifier hs-type">base</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682659056"><span class="hs-identifier hs-type">offset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1643"></span><span>               </span><span class="annot"><a href="#local-6989586621682659061"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span>
</span><span id="line-1645"></span><span>
</span><span id="line-1646"></span><span>
</span><span id="line-1647"></span><span>
</span><span id="line-1648"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1649"></span><span class="hs-comment">-- getOperand: sometimes any operand will do.</span><span>
</span><span id="line-1650"></span><span>
</span><span id="line-1651"></span><span class="hs-comment">-- getNonClobberedOperand: the value of the operand will remain valid across</span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- the computation of an arbitrary expression, unless the expression</span><span>
</span><span id="line-1653"></span><span class="hs-comment">-- is computed directly into a register which the operand refers to</span><span>
</span><span id="line-1654"></span><span class="hs-comment">-- (see trivialCode where this function is used for an example).</span><span>
</span><span id="line-1655"></span><span>
</span><span id="line-1656"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-type">getNonClobberedOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1657"></span><span id="getNonClobberedOperand"><span class="annot"><span class="annottext">getNonClobberedOperand :: CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var hs-var">getNonClobberedOperand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659066"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659066"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1658"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659066"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1659"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1660"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659068"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659068"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659066"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1661"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659069"><span class="annot"><a href="#local-6989586621682659069"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659070"><span class="annot"><a href="#local-6989586621682659070"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Alignment) -&gt; Int -&gt; Alignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659068"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659066"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1662"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659069"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659070"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1664"></span><span>    </span><span id="local-6989586621682659071"><span class="annot"><a href="#local-6989586621682659071"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1665"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659071"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659066"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-type">isFloatType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-type">cmmLitType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659071"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659066"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1666"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-type">litToImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659066"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1667"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659066"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1668"></span><span>
</span><span id="line-1669"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659073"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659073"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682659074"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659074"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1670"></span><span>  </span><span id="local-6989586621682659075"><span class="annot"><a href="#local-6989586621682659075"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-1671"></span><span>  </span><span class="hs-comment">-- this logic could be simplified</span><span>
</span><span id="line-1672"></span><span>  </span><span class="hs-comment">-- TODO FIXME</span><span>
</span><span id="line-1673"></span><span>  </span><span class="hs-keyword">if</span><span>   </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682659075"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659074"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1674"></span><span>      </span><span class="hs-comment">-- if 32bit and pk is at float/double/simd value</span><span>
</span><span id="line-1675"></span><span>      </span><span class="hs-comment">-- or if 64bit</span><span>
</span><span id="line-1676"></span><span>      </span><span class="hs-comment">--  this could use some eyeballs or i'll need to stare at it more later</span><span>
</span><span id="line-1677"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1678"></span><span>      </span><span id="local-6989586621682659076"><span class="annot"><a href="#local-6989586621682659076"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-1679"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659077"><span class="annot"><a href="#local-6989586621682659077"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682659078"><span class="annot"><a href="#local-6989586621682659078"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659073"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-1680"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682659079"><span class="annot"><a href="#local-6989586621682659079"><span class="hs-identifier hs-var">src'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659080"><span class="annot"><a href="#local-6989586621682659080"><span class="hs-identifier hs-var">save_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1681"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-type">amodeCouldBeClobbered</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659076"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659077"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1682"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1683"></span><span>                   </span><span id="local-6989586621682659082"><span class="annot"><a href="#local-6989586621682659082"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659075"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1684"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659082"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1685"></span><span>                           </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-type">LEA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659075"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1686"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659077"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1687"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659082"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1688"></span><span>                </span><span class="hs-keyword">else</span><span>
</span><span id="line-1689"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659077"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1690"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659079"><span class="hs-identifier hs-type">src'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659078"><span class="hs-identifier hs-type">mem_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659080"><span class="hs-identifier hs-type">save_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1691"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-1692"></span><span>      </span><span class="hs-comment">-- if its a word or gcptr on 32bit?</span><span>
</span><span id="line-1693"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659073"><span class="hs-identifier hs-type">mem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659074"><span class="hs-identifier hs-type">pk</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-type">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>
</span><span id="line-1695"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span id="local-6989586621682659083"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659083"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-var">getNonClobberedOperand_generic</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659083"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1696"></span><span>
</span><span id="line-1697"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1698"></span><span id="getNonClobberedOperand_generic"><span class="annot"><span class="annottext">getNonClobberedOperand_generic :: CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-var hs-var">getNonClobberedOperand_generic</span></a></span></span><span> </span><span id="local-6989586621682659084"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659084"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1699"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659085"><span class="annot"><a href="#local-6989586621682659085"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659086"><span class="annot"><a href="#local-6989586621682659086"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659084"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1700"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659085"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659086"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1701"></span><span>
</span><span id="line-1702"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-type">amodeCouldBeClobbered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1703"></span><span id="amodeCouldBeClobbered"><span class="annot"><span class="annottext">amodeCouldBeClobbered :: Platform -&gt; AddrMode -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-var hs-var">amodeCouldBeClobbered</span></a></span></span><span> </span><span id="local-6989586621682659087"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659087"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659088"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659088"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Bool) -&gt; [Reg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Reg -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var">regClobbered</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659087"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659088"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1704"></span><span>
</span><span id="line-1705"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-type">regClobbered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1706"></span><span id="regClobbered"><span class="annot"><span class="annottext">regClobbered :: Platform -&gt; Reg -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var hs-var">regClobbered</span></a></span></span><span> </span><span id="local-6989586621682659092"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659092"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-type">RegReal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#RealRegSingle"><span class="hs-identifier hs-type">RealRegSingle</span></a></span><span> </span><span id="local-6989586621682659094"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659094"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; Bool
</span><a href="GHC.Platform.Regs.html#freeReg"><span class="hs-identifier hs-var">freeReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659092"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659094"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-1707"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var">regClobbered</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1708"></span><span>
</span><span id="line-1709"></span><span class="hs-comment">-- getOperand: the operand is not required to remain valid across the</span><span>
</span><span id="line-1710"></span><span class="hs-comment">-- computation of an arbitrary expression.</span><span>
</span><span id="line-1711"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>
</span><span id="line-1713"></span><span id="getOperand"><span class="annot"><span class="annottext">getOperand :: CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var hs-var">getOperand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659097"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659097"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1714"></span><span>  </span><span id="local-6989586621682659098"><span class="annot"><a href="#local-6989586621682659098"><span class="hs-identifier hs-var">use_sse2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-var">sse2Enabled</span></a></span><span>
</span><span id="line-1715"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659098"><span class="hs-identifier hs-type">use_sse2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-type">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1716"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1717"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659099"><span class="annot"><a href="#local-6989586621682659099"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span>
</span><span id="line-1718"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659100"><span class="annot"><a href="#local-6989586621682659100"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659101"><span class="annot"><a href="#local-6989586621682659101"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659099"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span>
</span><span id="line-1719"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659100"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659101"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1720"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1721"></span><span>
</span><span id="line-1722"></span><span>  </span><span id="local-6989586621682659102"><span class="annot"><a href="#local-6989586621682659102"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659102"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-type">isFloatType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-type">cmmLitType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659102"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1724"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-type">litToImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659097"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>
</span><span id="line-1727"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659104"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659104"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682659105"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659105"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1728"></span><span>  </span><span id="local-6989586621682659106"><span class="annot"><a href="#local-6989586621682659106"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-1729"></span><span>  </span><span id="local-6989586621682659107"><span class="annot"><a href="#local-6989586621682659107"><span class="hs-identifier hs-var">use_sse2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-type">sse2Enabled</span></a></span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-type">isFloatType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659105"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682659107"><span class="hs-identifier hs-type">use_sse2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682659106"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659105"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1732"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659108"><span class="annot"><a href="#local-6989586621682659108"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682659109"><span class="annot"><a href="#local-6989586621682659109"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659104"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-1733"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659108"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659109"><span class="hs-identifier hs-type">mem_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1734"></span><span>     </span><span class="hs-keyword">else</span><span>
</span><span id="line-1735"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659104"><span class="hs-identifier hs-type">mem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659105"><span class="hs-identifier hs-type">pk</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-type">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1736"></span><span>
</span><span id="line-1737"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span id="local-6989586621682659110"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659110"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-var">getOperand_generic</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659110"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1738"></span><span>
</span><span id="line-1739"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1740"></span><span id="getOperand_generic"><span class="annot"><span class="annottext">getOperand_generic :: CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-var hs-var">getOperand_generic</span></a></span></span><span> </span><span id="local-6989586621682659111"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659111"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1741"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659112"><span class="annot"><a href="#local-6989586621682659112"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659113"><span class="annot"><a href="#local-6989586621682659113"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659111"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1742"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659112"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659113"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span>
</span><span id="line-1744"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-type">isOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1745"></span><span id="isOperand"><span class="annot"><span class="annottext">isOperand :: Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var hs-var">isOperand</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1746"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span id="local-6989586621682659115"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659115"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659116"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659116"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1747"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659115"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659116"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1748"></span><span>                          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659116"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1749"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1750"></span><span>
</span><span id="line-1751"></span><span class="hs-comment">-- | Given a 'Register', produce a new 'Register' with an instruction block</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- which will check the value for alignment. Used for @-falignment-sanitisation@.</span><span>
</span><span id="line-1753"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-type">addAlignmentCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1754"></span><span id="addAlignmentCheck"><span class="annot"><span class="annottext">addAlignmentCheck :: Int -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-var hs-var">addAlignmentCheck</span></a></span></span><span> </span><span id="local-6989586621682659117"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659117"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682659118"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621682659118"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1755"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621682659118"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1756"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682659119"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659119"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682659120"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659120"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682659121"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659121"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659119"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659120"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659121"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659122"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659119"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659120"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1757"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682659123"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659123"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682659124"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659124"><span class="hs-identifier hs-var">f</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659123"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682659125"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659125"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659124"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659125"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659122"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659123"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659125"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1758"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1759"></span><span>    </span><span class="annot"><a href="#local-6989586621682659122"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1760"></span><span>    </span><span id="local-6989586621682659122"><span class="annot"><span class="annottext">check :: Format -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659122"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621682659126"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659126"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682659127"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659127"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1761"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659126"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr) -&gt; OrdList Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1762"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659126"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; Imm -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659117"><span class="hs-identifier hs-var">align</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659127"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1763"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Imm -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Instr) -&gt; Imm -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="GHC.Cmm.CLabel.html#mkBadAlignmentLabel"><span class="hs-identifier hs-var">mkBadAlignmentLabel</span></a></span><span>
</span><span id="line-1764"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-1765"></span><span>
</span><span id="line-1766"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-1767"></span><span id="memConstant"><span class="annot"><span class="annottext">memConstant :: Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var hs-var">memConstant</span></a></span></span><span> </span><span id="local-6989586621682659133"><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682659133"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682659134"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659134"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1768"></span><span>  </span><span id="local-6989586621682659135"><span class="annot"><a href="#local-6989586621682659135"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM CLabel
</span><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-var">getNewLabelNat</span></a></span><span>
</span><span id="line-1769"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659136"><span class="annot"><a href="#local-6989586621682659136"><span class="hs-identifier hs-var hs-var">rosection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659135"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-1770"></span><span>  </span><span id="local-6989586621682659139"><span class="annot"><a href="#local-6989586621682659139"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-1771"></span><span>  </span><span id="local-6989586621682659140"><span class="annot"><a href="#local-6989586621682659140"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1772"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659141"><span class="annot"><a href="#local-6989586621682659141"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659142"><span class="annot"><a href="#local-6989586621682659142"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-type">target32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659140"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1773"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682659143"><span class="annot"><a href="#local-6989586621682659143"><span class="hs-identifier hs-var">dynRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span>
</span><span id="line-1774"></span><span>                                             </span><span class="annot"><a href="#local-6989586621682659139"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-1775"></span><span>                                             </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#DataReference"><span class="hs-identifier hs-type">DataReference</span></a></span><span>
</span><span id="line-1776"></span><span>                                             </span><span class="annot"><a href="#local-6989586621682659135"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-1777"></span><span>                               </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659146"><span class="annot"><a href="#local-6989586621682659146"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659147"><span class="annot"><a href="#local-6989586621682659147"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659143"><span class="hs-identifier hs-type">dynRef</span></a></span><span>
</span><span id="line-1778"></span><span>                               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659146"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659147"><span class="hs-identifier hs-type">addr_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1779"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-type">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-type">ImmCLbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659135"><span class="hs-identifier hs-type">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1780"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659148"><span class="annot"><a href="#local-6989586621682659148"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1781"></span><span>        </span><span class="annot"><span class="annottext">Section -&gt; (Alignment, RawCmmStatics) -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LDATA"><span class="hs-identifier hs-var">LDATA</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682659136"><span class="hs-identifier hs-var">rosection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682659133"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; [CmmStatic] -&gt; RawCmmStatics
forall (rawOnly :: Bool).
CLabel -&gt; [CmmStatic] -&gt; GenCmmStatics rawOnly
</span><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-var">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682659135"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659134"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1782"></span><span>        </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-var">`consOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659142"><span class="hs-identifier hs-var">addr_code</span></a></span><span>
</span><span id="line-1783"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659141"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659148"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1784"></span><span>
</span><span id="line-1785"></span><span>
</span><span id="line-1786"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadFloatAmode"><span class="hs-identifier hs-type">loadFloatAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1787"></span><span id="loadFloatAmode"><span class="annot"><span class="annottext">loadFloatAmode :: Width -&gt; AddrMode -&gt; OrdList Instr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadFloatAmode"><span class="hs-identifier hs-var hs-var">loadFloatAmode</span></a></span></span><span> </span><span id="local-6989586621682659151"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659151"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682659152"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659152"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659153"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659153"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1788"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659154"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682659154"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659151"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1789"></span><span>      </span><span id="local-6989586621682659155"><span class="annot"><span class="annottext">code :: Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659155"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682659156"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659156"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659153"><span class="hs-identifier hs-var">addr_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1790"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659154"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659152"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659156"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1791"></span><span>
</span><span id="line-1792"></span><span>  </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659154"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682659155"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1793"></span><span>
</span><span id="line-1794"></span><span>
</span><span id="line-1795"></span><span class="hs-comment">-- if we want a floating-point literal as an operand, we can</span><span>
</span><span id="line-1796"></span><span class="hs-comment">-- use it directly from memory.  However, if the literal is</span><span>
</span><span id="line-1797"></span><span class="hs-comment">-- zero, we're better off generating it into a register using</span><span>
</span><span id="line-1798"></span><span class="hs-comment">-- xor.</span><span>
</span><span id="line-1799"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-type">isSuitableFloatingPointLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1800"></span><span id="isSuitableFloatingPointLit"><span class="annot"><span class="annottext">isSuitableFloatingPointLit :: CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var hs-var">isSuitableFloatingPointLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682659157"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682659157"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682659157"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-1801"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1802"></span><span>
</span><span id="line-1803"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-type">getRegOrMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1804"></span><span id="getRegOrMem"><span class="annot"><span class="annottext">getRegOrMem :: CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var hs-var">getRegOrMem</span></a></span></span><span> </span><span id="local-6989586621682659158"><span class="annot"><span class="annottext">e :: CmmExpr
</span><a href="#local-6989586621682659158"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659159"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659159"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682659160"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659160"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1805"></span><span>  </span><span id="local-6989586621682659161"><span class="annot"><a href="#local-6989586621682659161"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-1806"></span><span>  </span><span id="local-6989586621682659162"><span class="annot"><a href="#local-6989586621682659162"><span class="hs-identifier hs-var">use_sse2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-type">sse2Enabled</span></a></span><span>
</span><span id="line-1807"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-type">isFloatType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659160"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682659162"><span class="hs-identifier hs-type">use_sse2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682659161"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659160"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1808"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1809"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659163"><span class="annot"><a href="#local-6989586621682659163"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682659164"><span class="annot"><a href="#local-6989586621682659164"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659159"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-1810"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659163"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659164"><span class="hs-identifier hs-type">mem_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1811"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1812"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682659165"><span class="annot"><a href="#local-6989586621682659165"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659166"><span class="annot"><a href="#local-6989586621682659166"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659158"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1813"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659165"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659166"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1814"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span id="local-6989586621682659167"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659167"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1815"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659168"><span class="annot"><a href="#local-6989586621682659168"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659169"><span class="annot"><a href="#local-6989586621682659169"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659167"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1816"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659168"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659169"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1817"></span><span>
</span><span id="line-1818"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1819"></span><span id="is32BitLit"><span class="annot"><span class="annottext">is32BitLit :: Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var hs-var">is32BitLit</span></a></span></span><span> </span><span id="local-6989586621682659170"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659170"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659171"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659171"><span class="hs-identifier hs-var">_lit</span></a></span></span><span>
</span><span id="line-1820"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659170"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1821"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span id="local-6989586621682659172"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659172"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659173"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659173"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1822"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659173"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1823"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659174"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659174"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659174"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1824"></span><span>      </span><span class="hs-comment">-- Except on Windows, assume that labels are in the range 0-2^31-1: this</span><span>
</span><span id="line-1825"></span><span>      </span><span class="hs-comment">-- assumes the small memory model. Note [%rip-relative addressing on</span><span>
</span><span id="line-1826"></span><span>      </span><span class="hs-comment">-- x86-64].</span><span>
</span><span id="line-1827"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682659175"><span class="hs-identifier hs-var">low_image</span></a></span><span>
</span><span id="line-1828"></span><span>      </span><span class="hs-comment">-- however we can't assume that label offsets are in this range</span><span>
</span><span id="line-1829"></span><span>      </span><span class="hs-comment">-- (see #15570)</span><span>
</span><span id="line-1830"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659176"><span class="hs-identifier hs-var">off</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682659175"><span class="hs-identifier hs-var">low_image</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659176"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1831"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659177"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659177"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682659175"><span class="hs-identifier hs-var">low_image</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659177"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1832"></span><span>      </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1833"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1834"></span><span>    </span><span class="hs-comment">-- Is the executable image certain to be located below 4GB? As noted in</span><span>
</span><span id="line-1835"></span><span>    </span><span class="hs-comment">-- Note [%rip-relative addressing on x86-64], this is not true on Windows.</span><span>
</span><span id="line-1836"></span><span>    </span><span id="local-6989586621682659175"><span class="annot"><span class="annottext">low_image :: Bool
</span><a href="#local-6989586621682659175"><span class="hs-identifier hs-var hs-var">low_image</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1837"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659172"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1838"></span><span>        </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64]</span><span>
</span><span id="line-1839"></span><span>        </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1840"></span><span>
</span><span id="line-1841"></span><span>
</span><span id="line-1842"></span><span class="hs-comment">-- Set up a condition code for a conditional branch.</span><span>
</span><span id="line-1843"></span><span>
</span><span id="line-1844"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-type">getCondCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-1845"></span><span>
</span><span id="line-1846"></span><span class="hs-comment">-- yes, they really do seem to want exactly the same!</span><span>
</span><span id="line-1847"></span><span>
</span><span id="line-1848"></span><span id="getCondCode"><span class="annot"><span class="annottext">getCondCode :: CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var hs-var">getCondCode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682659180"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659180"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659181"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659182"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1849"></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1850"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659180"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1851"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1852"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1853"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1854"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1855"></span><span>      </span><span class="hs-comment">-- Invert comparison condition and swap operands</span><span>
</span><span id="line-1856"></span><span>      </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-1857"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1858"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1859"></span><span>
</span><span id="line-1860"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1861"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1862"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1863"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1864"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1865"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1866"></span><span>
</span><span id="line-1867"></span><span>      </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var">condIntCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; Cond
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-var">machOpToCond</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659180"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659182"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1868"></span><span>
</span><span id="line-1869"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var">getCondCode</span></a></span><span> </span><span id="local-6989586621682659186"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659186"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1870"></span><span>   </span><span id="local-6989586621682659187"><span class="annot"><a href="#local-6989586621682659187"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1871"></span><span>   </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;getCondCode(2)(x86,x86_64)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659187"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659186"><span class="hs-identifier hs-type">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>
</span><span id="line-1873"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-type">machOpToCond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span>
</span><span id="line-1874"></span><span id="machOpToCond"><span class="annot"><span class="annottext">machOpToCond :: MachOp -&gt; Cond
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-var hs-var">machOpToCond</span></a></span></span><span> </span><span id="local-6989586621682659188"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659188"><span class="hs-identifier hs-var">mo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659188"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1875"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span>
</span><span id="line-1876"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-1877"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>
</span><span id="line-1878"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>
</span><span id="line-1879"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span>
</span><span id="line-1880"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>
</span><span id="line-1881"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>
</span><span id="line-1882"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span>
</span><span id="line-1883"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>
</span><span id="line-1884"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span>
</span><span id="line-1885"></span><span>  </span><span id="local-6989586621682659189"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659189"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Cond
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;machOpToCond&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659188"><span class="hs-identifier hs-var">mo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1886"></span><span>
</span><span id="line-1887"></span><span class="hs-comment">{-  Note [64-bit integer comparisons on 32-bit]
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    When doing these comparisons there are 2 kinds of
    comparisons.

    * Comparison for equality (or lack thereof)

    We use xor to check if high/low bits are
    equal. Then combine the results using or.

    * Other comparisons:

    We first compare the low registers
    and use a subtraction with borrow to compare the high registers.

    For signed numbers the condition is determined by
    the sign and overflow flags agreeing or not
    and for unsigned numbers the condition is the carry flag.

-}</span><span>
</span><span id="line-1908"></span><span>
</span><span id="line-1909"></span><span class="hs-comment">-- @cond(Int|Flt)Code@: Turn a boolean expression into a condition, to be</span><span>
</span><span id="line-1910"></span><span class="hs-comment">-- passed back up the tree.</span><span>
</span><span id="line-1911"></span><span>
</span><span id="line-1912"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-type">condIntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-1913"></span><span id="condIntCode"><span class="annot"><span class="annottext">condIntCode :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var hs-var">condIntCode</span></a></span></span><span> </span><span id="local-6989586621682659190"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659190"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659191"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659191"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659192"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659192"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682659193"><span class="annot"><a href="#local-6989586621682659193"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1914"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-type">condIntCode'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659193"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659190"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659191"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659192"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1915"></span><span>
</span><span id="line-1916"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-type">condIntCode'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-1917"></span><span>
</span><span id="line-1918"></span><span class="hs-comment">-- 64-bit integer comparisons on 32-bit</span><span>
</span><span id="line-1919"></span><span class="hs-comment">-- See Note [64-bit integer comparisons on 32-bit]</span><span>
</span><span id="line-1920"></span><span id="condIntCode%27"><span class="annot"><span class="annottext">condIntCode' :: Platform -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var hs-var">condIntCode'</span></a></span></span><span> </span><span id="local-6989586621682659195"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659195"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659196"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659196"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659197"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659197"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659198"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659198"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-1921"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659195"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659195"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659197"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1922"></span><span>
</span><span id="line-1923"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682659199"><span class="annot"><a href="#local-6989586621682659199"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682659200"><span class="annot"><a href="#local-6989586621682659200"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682659201"><span class="annot"><a href="#local-6989586621682659201"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659197"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1924"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682659202"><span class="annot"><a href="#local-6989586621682659202"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682659203"><span class="annot"><a href="#local-6989586621682659203"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682659204"><span class="annot"><a href="#local-6989586621682659204"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659198"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1925"></span><span>
</span><span id="line-1926"></span><span>  </span><span class="hs-comment">-- we mustn't clobber r1/r2 so we use temporaries</span><span>
</span><span id="line-1927"></span><span>  </span><span id="local-6989586621682659205"><span class="annot"><a href="#local-6989586621682659205"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-1928"></span><span>  </span><span id="local-6989586621682659206"><span class="annot"><a href="#local-6989586621682659206"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-1929"></span><span>
</span><span id="line-1930"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682659207"><span class="annot"><a href="#local-6989586621682659207"><span class="hs-identifier hs-var">cond'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659208"><span class="annot"><a href="#local-6989586621682659208"><span class="hs-identifier hs-var">cmpCode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682659209"><span class="hs-identifier hs-type">intComparison</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659196"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659200"><span class="hs-identifier hs-type">r1hi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659201"><span class="hs-identifier hs-type">r1lo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659203"><span class="hs-identifier hs-type">r2hi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659204"><span class="hs-identifier hs-type">r2lo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659205"><span class="hs-identifier hs-type">tmp1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659206"><span class="hs-identifier hs-type">tmp2</span></a></span><span>
</span><span id="line-1931"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659207"><span class="hs-identifier hs-type">cond'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659199"><span class="hs-identifier hs-type">code1</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659202"><span class="hs-identifier hs-type">code2</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659208"><span class="hs-identifier hs-type">cmpCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1932"></span><span>
</span><span id="line-1933"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1934"></span><span>    </span><span id="local-6989586621682659209"><span class="annot"><span class="annottext">intComparison :: Cond
-&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; (Cond, OrdList Instr)
</span><a href="#local-6989586621682659209"><span class="hs-identifier hs-var hs-var">intComparison</span></a></span></span><span> </span><span id="local-6989586621682659224"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659224"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659225"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659225"><span class="hs-identifier hs-var">r1_hi</span></a></span></span><span> </span><span id="local-6989586621682659226"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659226"><span class="hs-identifier hs-var">r1_lo</span></a></span></span><span> </span><span id="local-6989586621682659227"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659227"><span class="hs-identifier hs-var">r2_hi</span></a></span></span><span> </span><span id="local-6989586621682659228"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659228"><span class="hs-identifier hs-var">r2_lo</span></a></span></span><span> </span><span id="local-6989586621682659229"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span id="local-6989586621682659230"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659230"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1935"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659224"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1936"></span><span>        </span><span class="hs-comment">-- These don't occur as argument of condIntCode'</span><span>
</span><span id="line-1937"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1938"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NEG"><span class="hs-identifier hs-var">NEG</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1939"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#POS"><span class="hs-identifier hs-var">POS</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1940"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1941"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1942"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1943"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NOTPARITY"><span class="hs-identifier hs-var">NOTPARITY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-1944"></span><span>        </span><span class="hs-comment">-- Special case #1 x == y and x != y</span><span>
</span><span id="line-1945"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659237"><span class="hs-identifier hs-var">cmpExact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1946"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659237"><span class="hs-identifier hs-var">cmpExact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1947"></span><span>        </span><span class="hs-comment">-- [x &gt;= y]</span><span>
</span><span id="line-1948"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659238"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1949"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659238"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1950"></span><span>        </span><span class="hs-comment">-- [x &gt;  y]</span><span>
</span><span id="line-1951"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659239"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1952"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659239"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1953"></span><span>        </span><span class="hs-comment">-- [x &lt;= y]</span><span>
</span><span id="line-1954"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659239"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1955"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659239"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1956"></span><span>        </span><span class="hs-comment">-- [x &lt;  y]</span><span>
</span><span id="line-1957"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659238"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1958"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659238"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1959"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1960"></span><span>        </span><span class="annot"><a href="#local-6989586621682659237"><span class="hs-identifier hs-type">cmpExact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1961"></span><span>        </span><span id="local-6989586621682659237"><span class="annot"><span class="annottext">cmpExact :: OrdList Instr
</span><a href="#local-6989586621682659237"><span class="hs-identifier hs-var hs-var">cmpExact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1962"></span><span>          </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1963"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659225"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1964"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659226"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659230"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1965"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659227"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1966"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659228"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659230"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1967"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659230"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1968"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1969"></span><span>        </span><span id="local-6989586621682659238"><span class="annot"><span class="annottext">cmpGE :: OrdList Instr
</span><a href="#local-6989586621682659238"><span class="hs-identifier hs-var hs-var">cmpGE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1970"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659225"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1971"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659228"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659226"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1972"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659227"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1973"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1974"></span><span>        </span><span id="local-6989586621682659239"><span class="annot"><span class="annottext">cmpLE :: OrdList Instr
</span><a href="#local-6989586621682659239"><span class="hs-identifier hs-var hs-var">cmpLE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1975"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659227"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1976"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659226"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659228"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1977"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659225"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659229"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1978"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1979"></span><span>
</span><span id="line-1980"></span><span class="hs-comment">-- memory vs immediate</span><span>
</span><span id="line-1981"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682659240"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659240"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659241"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659241"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659242"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659242"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659243"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659243"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659244"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659244"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1982"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659240"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659244"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1983"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659245"><span class="annot"><a href="#local-6989586621682659245"><span class="hs-identifier hs-var">x_addr</span></a></span></span><span> </span><span id="local-6989586621682659246"><span class="annot"><a href="#local-6989586621682659246"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659242"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1984"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-1985"></span><span>        </span><span id="local-6989586621682659247"><span class="annot"><a href="#local-6989586621682659247"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659244"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1986"></span><span>        </span><span id="local-6989586621682659248"><span class="annot"><a href="#local-6989586621682659248"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659246"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1987"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659243"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682659247"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659245"><span class="hs-identifier hs-var">x_addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1988"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1989"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659241"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659248"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1990"></span><span>
</span><span id="line-1991"></span><span class="hs-comment">-- anything vs zero, using a mask</span><span>
</span><span id="line-1992"></span><span class="hs-comment">-- TODO: Add some sanity checking!!!!</span><span>
</span><span id="line-1993"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682659249"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659249"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659250"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659250"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659251"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659251"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659252"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659252"><span class="hs-identifier hs-var">o2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682659253"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659253"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1994"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659254"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682659254"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659255"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659255"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659252"><span class="hs-identifier hs-var">o2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659249"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659254"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1995"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1996"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682659256"><span class="annot"><a href="#local-6989586621682659256"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659257"><span class="annot"><a href="#local-6989586621682659257"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659251"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1997"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-1998"></span><span>         </span><span id="local-6989586621682659258"><span class="annot"><a href="#local-6989586621682659258"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659257"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1999"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659253"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659255"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659256"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2000"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-2001"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659250"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659258"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2002"></span><span>
</span><span id="line-2003"></span><span class="hs-comment">-- anything vs zero</span><span>
</span><span id="line-2004"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659259"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659259"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659260"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659260"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682659261"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659261"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2005"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659262"><span class="annot"><a href="#local-6989586621682659262"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659263"><span class="annot"><a href="#local-6989586621682659263"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659260"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2006"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2007"></span><span>        </span><span id="local-6989586621682659264"><span class="annot"><a href="#local-6989586621682659264"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659263"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2008"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659261"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659262"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659262"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2009"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2010"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659259"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659264"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2011"></span><span>
</span><span id="line-2012"></span><span class="hs-comment">-- anything vs operand</span><span>
</span><span id="line-2013"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682659265"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659265"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659266"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659266"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659267"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659267"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659268"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659268"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-2014"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659265"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659268"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2015"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659269"><span class="annot"><a href="#local-6989586621682659269"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659270"><span class="annot"><a href="#local-6989586621682659270"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2016"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659271"><span class="annot"><a href="#local-6989586621682659271"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621682659272"><span class="annot"><a href="#local-6989586621682659272"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659268"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2017"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2018"></span><span>        </span><span id="local-6989586621682659273"><span class="annot"><a href="#local-6989586621682659273"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659270"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659272"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2019"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659265"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659267"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682659271"><span class="hs-identifier hs-var">y_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659269"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659266"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659273"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2021"></span><span class="hs-comment">-- operand vs. anything: invert the comparison so that we can use a</span><span>
</span><span id="line-2022"></span><span class="hs-comment">-- single comparison instruction.</span><span>
</span><span id="line-2023"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659265"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2024"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682659274"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659274"><span class="hs-identifier hs-var">revcond</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Maybe Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#maybeFlipCond"><span class="hs-identifier hs-var">maybeFlipCond</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659266"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2025"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659276"><span class="annot"><a href="#local-6989586621682659276"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659277"><span class="annot"><a href="#local-6989586621682659277"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659268"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2026"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659278"><span class="annot"><a href="#local-6989586621682659278"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621682659279"><span class="annot"><a href="#local-6989586621682659279"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659267"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2027"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2028"></span><span>        </span><span id="local-6989586621682659280"><span class="annot"><a href="#local-6989586621682659280"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659277"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659279"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2029"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659265"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659267"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682659278"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659276"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2030"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659274"><span class="hs-identifier hs-type">revcond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659280"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2031"></span><span>
</span><span id="line-2032"></span><span class="hs-comment">-- anything vs anything</span><span>
</span><span id="line-2033"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682659281"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659281"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682659282"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659282"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659283"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659283"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659284"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659284"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2034"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659285"><span class="annot"><a href="#local-6989586621682659285"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659286"><span class="annot"><a href="#local-6989586621682659286"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659284"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2035"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659287"><span class="annot"><a href="#local-6989586621682659287"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659288"><span class="annot"><a href="#local-6989586621682659288"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-type">getRegOrMem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659283"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2036"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2037"></span><span>        </span><span id="local-6989586621682659289"><span class="annot"><a href="#local-6989586621682659289"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659286"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2038"></span><span>               </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659288"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2039"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659281"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659283"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659285"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682659287"><span class="hs-identifier hs-var">x_op</span></a></span><span>
</span><span id="line-2040"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682659282"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659289"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2041"></span><span>
</span><span id="line-2042"></span><span>
</span><span id="line-2043"></span><span>
</span><span id="line-2044"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2045"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-type">condFltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-2046"></span><span>
</span><span id="line-2047"></span><span id="condFltCode"><span class="annot"><span class="annottext">condFltCode :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var hs-var">condFltCode</span></a></span></span><span> </span><span id="local-6989586621682659290"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659290"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659291"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659291"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682659292"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659292"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-2048"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM CondCode
</span><a href="#local-6989586621682659293"><span class="hs-identifier hs-var">condFltCode_sse2</span></a></span><span>
</span><span id="line-2049"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2050"></span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span>  </span><span class="hs-comment">-- in the SSE2 comparison ops (ucomiss, ucomisd) the left arg may be</span><span>
</span><span id="line-2053"></span><span>  </span><span class="hs-comment">-- an operand, but the right must be a reg.  We can probably do better</span><span>
</span><span id="line-2054"></span><span>  </span><span class="hs-comment">-- than this general case...</span><span>
</span><span id="line-2055"></span><span>  </span><span id="local-6989586621682659293"><span class="annot"><span class="annottext">condFltCode_sse2 :: NatM CondCode
</span><a href="#local-6989586621682659293"><span class="hs-identifier hs-var hs-var">condFltCode_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2056"></span><span>    </span><span id="local-6989586621682659294"><span class="annot"><a href="#local-6989586621682659294"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2057"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659295"><span class="annot"><a href="#local-6989586621682659295"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659296"><span class="annot"><a href="#local-6989586621682659296"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659291"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2058"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659297"><span class="annot"><a href="#local-6989586621682659297"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659298"><span class="annot"><a href="#local-6989586621682659298"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659292"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2059"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2060"></span><span>        </span><span id="local-6989586621682659299"><span class="annot"><a href="#local-6989586621682659299"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659296"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2061"></span><span>               </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659298"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2062"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; Width -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659294"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659291"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682659297"><span class="hs-identifier hs-var">y_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659295"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2063"></span><span>        </span><span class="hs-comment">-- NB(1): we need to use the unsigned comparison operators on the</span><span>
</span><span id="line-2064"></span><span>        </span><span class="hs-comment">-- result of this comparison.</span><span>
</span><span id="line-2065"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#condToUnsigned"><span class="hs-identifier hs-type">condToUnsigned</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659290"><span class="hs-identifier hs-type">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659299"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2066"></span><span>
</span><span id="line-2067"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2068"></span><span class="hs-comment">-- Generating assignments</span><span>
</span><span id="line-2069"></span><span>
</span><span id="line-2070"></span><span class="hs-comment">-- Assignments are really at the heart of the whole code generation</span><span>
</span><span id="line-2071"></span><span class="hs-comment">-- business.  Almost all top-level nodes of any real importance are</span><span>
</span><span id="line-2072"></span><span class="hs-comment">-- assignments, which correspond to loads, stores, or register</span><span>
</span><span id="line-2073"></span><span class="hs-comment">-- transfers.  If we're really lucky, some of the register transfers</span><span>
</span><span id="line-2074"></span><span class="hs-comment">-- will go away, because we can use the destination register to</span><span>
</span><span id="line-2075"></span><span class="hs-comment">-- complete the code generation for the right hand side.  This only</span><span>
</span><span id="line-2076"></span><span class="hs-comment">-- fails when the right hand side is forced into a fixed register</span><span>
</span><span id="line-2077"></span><span class="hs-comment">-- (e.g. the result of a call).</span><span>
</span><span id="line-2078"></span><span>
</span><span id="line-2079"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-type">assignMem_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2080"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-type">assignReg_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2081"></span><span>
</span><span id="line-2082"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-type">assignMem_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2083"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-type">assignReg_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2084"></span><span>
</span><span id="line-2085"></span><span>
</span><span id="line-2086"></span><span class="hs-comment">-- integer assignment to memory</span><span>
</span><span id="line-2087"></span><span>
</span><span id="line-2088"></span><span class="hs-comment">-- specific case of adding/subtracting an integer to a particular address.</span><span>
</span><span id="line-2089"></span><span class="hs-comment">-- ToDo: catch other cases where we can use an operation directly on a memory</span><span>
</span><span id="line-2090"></span><span class="hs-comment">-- address.</span><span>
</span><span id="line-2091"></span><span id="assignMem_IntCode"><span class="annot"><span class="annottext">assignMem_IntCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var hs-var">assignMem_IntCode</span></a></span></span><span> </span><span id="local-6989586621682659302"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659302"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621682659303"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659303"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682659304"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659304"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659305"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659305"><span class="hs-identifier hs-var">addr2</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>
</span><span id="line-2092"></span><span>                                                 </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682659306"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659306"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2093"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659303"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659305"><span class="hs-identifier hs-var">addr2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659302"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659306"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2094"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682659307"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682659307"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682659308"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682659304"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-2095"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659309"><span class="annot"><a href="#local-6989586621682659309"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682659310"><span class="annot"><a href="#local-6989586621682659310"><span class="hs-identifier hs-var">code_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659303"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2096"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659311"><span class="annot"><a href="#local-6989586621682659311"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659310"><span class="hs-identifier hs-var">code_addr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2097"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682659307"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659302"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682659306"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659309"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2098"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682659311"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2099"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2100"></span><span>        </span><span id="local-6989586621682659308"><span class="annot"><span class="annottext">check :: MachOp -&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682659308"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>
</span><span id="line-2101"></span><span>        </span><span class="annot"><a href="#local-6989586621682659308"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>
</span><span id="line-2102"></span><span>        </span><span class="annot"><a href="#local-6989586621682659308"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2103"></span><span>        </span><span class="hs-comment">-- ToDo: more?</span><span>
</span><span id="line-2104"></span><span>
</span><span id="line-2105"></span><span class="hs-comment">-- general case</span><span>
</span><span id="line-2106"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span id="local-6989586621682659312"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659312"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621682659313"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659313"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659314"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659314"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2107"></span><span>    </span><span id="local-6989586621682659315"><span class="annot"><a href="#local-6989586621682659315"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2108"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659316"><span class="annot"><a href="#local-6989586621682659316"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659317"><span class="annot"><a href="#local-6989586621682659317"><span class="hs-identifier hs-var">code_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659313"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-2109"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682659318"><span class="annot"><a href="#local-6989586621682659318"><span class="hs-identifier hs-var">code_src</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659319"><span class="annot"><a href="#local-6989586621682659319"><span class="hs-identifier hs-var">op_src</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682659320"><span class="hs-identifier hs-type">get_op_RI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659315"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659314"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-2110"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2111"></span><span>        </span><span id="local-6989586621682659321"><span class="annot"><a href="#local-6989586621682659321"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659318"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2112"></span><span>               </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659317"><span class="hs-identifier hs-var">code_addr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2113"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659312"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682659319"><span class="hs-identifier hs-var">op_src</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659316"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2114"></span><span>        </span><span class="hs-comment">-- NOTE: op_src is stable, so it will still be valid</span><span>
</span><span id="line-2115"></span><span>        </span><span class="hs-comment">-- after code_addr.  This may involve the introduction</span><span>
</span><span id="line-2116"></span><span>        </span><span class="hs-comment">-- of an extra MOV to a temporary register, but we hope</span><span>
</span><span id="line-2117"></span><span>        </span><span class="hs-comment">-- the register allocator will get rid of it.</span><span>
</span><span id="line-2118"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2119"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682659321"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2121"></span><span>    </span><span class="annot"><a href="#local-6989586621682659320"><span class="hs-identifier hs-type">get_op_RI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- code, operator</span><span>
</span><span id="line-2122"></span><span>    </span><span id="local-6989586621682659320"><span class="annot"><span class="annottext">get_op_RI :: Platform -&gt; CmmExpr -&gt; NatM (OrdList Instr, Operand)
</span><a href="#local-6989586621682659320"><span class="hs-identifier hs-var hs-var">get_op_RI</span></a></span></span><span> </span><span id="local-6989586621682659322"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659322"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659323"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659323"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659322"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659323"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2123"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr, Operand) -&gt; NatM (OrdList Instr, Operand)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659323"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2124"></span><span>    </span><span class="annot"><a href="#local-6989586621682659320"><span class="hs-identifier hs-var">get_op_RI</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659324"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659324"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-2125"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682659325"><span class="annot"><a href="#local-6989586621682659325"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659326"><span class="annot"><a href="#local-6989586621682659326"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659324"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-2126"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659326"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659325"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2127"></span><span>
</span><span id="line-2128"></span><span>
</span><span id="line-2129"></span><span class="hs-comment">-- Assign; dst is a reg, rhs is mem</span><span>
</span><span id="line-2130"></span><span id="assignReg_IntCode"><span class="annot"><span class="annottext">assignReg_IntCode :: Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var hs-var">assignReg_IntCode</span></a></span></span><span> </span><span id="local-6989586621682659327"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659327"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621682659328"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659328"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659329"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659329"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2131"></span><span>  </span><span id="local-6989586621682659330"><span class="annot"><a href="#local-6989586621682659330"><span class="hs-identifier hs-var">load_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659327"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659329"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2132"></span><span>  </span><span id="local-6989586621682659331"><span class="annot"><a href="#local-6989586621682659331"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2133"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659330"><span class="hs-identifier hs-type">load_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659331"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659328"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2134"></span><span>
</span><span id="line-2135"></span><span class="hs-comment">-- dst is a reg, but src could be anything</span><span>
</span><span id="line-2136"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659332"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659332"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682659333"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659333"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2137"></span><span>  </span><span id="local-6989586621682659334"><span class="annot"><a href="#local-6989586621682659334"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2138"></span><span>  </span><span id="local-6989586621682659335"><span class="annot"><a href="#local-6989586621682659335"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659333"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-2139"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659335"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659334"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659332"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2140"></span><span>
</span><span id="line-2141"></span><span>
</span><span id="line-2142"></span><span class="hs-comment">-- Floating point assignment to memory</span><span>
</span><span id="line-2143"></span><span id="assignMem_FltCode"><span class="annot"><span class="annottext">assignMem_FltCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var hs-var">assignMem_FltCode</span></a></span></span><span> </span><span id="local-6989586621682659336"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659336"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621682659337"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659337"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659338"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659338"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2144"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659339"><span class="annot"><a href="#local-6989586621682659339"><span class="hs-identifier hs-var">src_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659340"><span class="annot"><a href="#local-6989586621682659340"><span class="hs-identifier hs-var">src_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659338"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2145"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659341"><span class="annot"><a href="#local-6989586621682659341"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659342"><span class="annot"><a href="#local-6989586621682659342"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659337"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-2146"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2147"></span><span>        </span><span id="local-6989586621682659343"><span class="annot"><a href="#local-6989586621682659343"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659340"><span class="hs-identifier hs-var">src_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2148"></span><span>               </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659342"><span class="hs-identifier hs-var">addr_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2149"></span><span>               </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682659336"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682659339"><span class="hs-identifier hs-var">src_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682659341"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2150"></span><span>
</span><span id="line-2151"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682659343"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2152"></span><span>
</span><span id="line-2153"></span><span class="hs-comment">-- Floating point assignment to a register/temporary</span><span>
</span><span id="line-2154"></span><span id="assignReg_FltCode"><span class="annot"><span class="annottext">assignReg_FltCode :: Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var hs-var">assignReg_FltCode</span></a></span></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659344"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682659344"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682659345"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659345"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2155"></span><span>  </span><span id="local-6989586621682659346"><span class="annot"><a href="#local-6989586621682659346"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659345"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2156"></span><span>  </span><span id="local-6989586621682659347"><span class="annot"><a href="#local-6989586621682659347"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2157"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659346"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659347"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659344"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2158"></span><span>
</span><span id="line-2159"></span><span>
</span><span id="line-2160"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-type">genJump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-comment">{-the branch target-}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2161"></span><span>
</span><span id="line-2162"></span><span id="genJump"><span class="annot"><span class="annottext">genJump :: CmmExpr -&gt; [Reg] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var hs-var">genJump</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682659348"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659348"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682659349"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682659349"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2163"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682659350"><span class="annot"><a href="#local-6989586621682659350"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682659351"><span class="annot"><a href="#local-6989586621682659351"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659348"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-2164"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659351"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659350"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659349"><span class="hs-identifier hs-type">regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2165"></span><span>
</span><span id="line-2166"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682659353"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659353"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682659354"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682659354"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2167"></span><span>  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; [Reg] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682659353"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682659354"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2168"></span><span>
</span><span id="line-2169"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span id="local-6989586621682659355"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659355"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682659356"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682659356"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2170"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659357"><span class="annot"><a href="#local-6989586621682659357"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659358"><span class="annot"><a href="#local-6989586621682659358"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659355"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-2171"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659358"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659357"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659356"><span class="hs-identifier hs-type">regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2172"></span><span>
</span><span id="line-2173"></span><span>
</span><span id="line-2174"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2175"></span><span class="hs-comment">--  Unconditional branches</span><span>
</span><span id="line-2176"></span><span>
</span><span id="line-2177"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-type">genBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2178"></span><span id="genBranch"><span class="annot"><span class="annottext">genBranch :: Label -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var hs-var">genBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="annot"><span class="annottext">([Instr] -&gt; OrdList Instr)
-&gt; (Label -&gt; [Instr]) -&gt; Label -&gt; OrdList Instr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; [Instr]
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkJumpInstr"><span class="hs-identifier hs-var">mkJumpInstr</span></a></span><span>
</span><span id="line-2179"></span><span>
</span><span id="line-2180"></span><span>
</span><span id="line-2181"></span><span>
</span><span id="line-2182"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2183"></span><span class="hs-comment">--  Conditional jumps/branches</span><span>
</span><span id="line-2184"></span><span>
</span><span id="line-2185"></span><span class="hs-comment">{-
Conditional jumps are always to local labels, so we can use branch
instructions.  We peek at the arguments to decide what kind of
comparison to do.

I386: First, we have to ensure that the condition
codes are set according to the supplied comparison operation.
-}</span><span>
</span><span id="line-2193"></span><span>
</span><span id="line-2194"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-type">genCondBranch</span></a></span><span>
</span><span id="line-2195"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the source of the jump</span><span>
</span><span id="line-2196"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the true branch target</span><span>
</span><span id="line-2197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the false branch target</span><span>
</span><span id="line-2198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>      </span><span class="hs-comment">-- the condition on which to branch</span><span>
</span><span id="line-2199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-comment">-- Instructions</span><span>
</span><span id="line-2200"></span><span>
</span><span id="line-2201"></span><span id="genCondBranch"><span class="annot"><span class="annottext">genCondBranch :: Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var hs-var">genCondBranch</span></a></span></span><span> </span><span id="local-6989586621682659361"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659361"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659362"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659362"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682659363"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659363"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682659364"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659364"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2202"></span><span>  </span><span id="local-6989586621682659365"><span class="annot"><a href="#local-6989586621682659365"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2203"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-type">genCondBranch'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659365"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659361"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659362"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659363"><span class="hs-identifier hs-type">false</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659364"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-2204"></span><span>
</span><span id="line-2205"></span><span class="annot"><span class="hs-comment">-- | We return the instructions generated.</span></span><span>
</span><span id="line-2206"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-type">genCondBranch'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-2207"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2208"></span><span>
</span><span id="line-2209"></span><span id="genCondBranch%27"><span class="annot"><span class="annottext">genCondBranch' :: Bool -&gt; Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-var hs-var">genCondBranch'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682659367"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659367"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659368"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659368"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682659369"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659369"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682659370"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659370"><span class="hs-identifier hs-var">bool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2210"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span id="local-6989586621682659371"><span class="annot"><a href="#local-6989586621682659371"><span class="hs-identifier hs-var">is_float</span></a></span></span><span> </span><span id="local-6989586621682659372"><span class="annot"><a href="#local-6989586621682659372"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682659373"><span class="annot"><a href="#local-6989586621682659373"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var">getCondCode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659370"><span class="hs-identifier hs-var">bool</span></a></span><span>
</span><span id="line-2211"></span><span>  </span><span id="local-6989586621682659374"><span class="annot"><a href="#local-6989586621682659374"><span class="hs-identifier hs-var">use_sse2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2Enabled"><span class="hs-identifier hs-type">sse2Enabled</span></a></span><span>
</span><span id="line-2212"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682659371"><span class="hs-identifier hs-type">is_float</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682659374"><span class="hs-identifier hs-type">use_sse2</span></a></span><span>
</span><span id="line-2213"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-2214"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659373"><span class="hs-identifier hs-type">cond_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659372"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659368"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-type">genBranch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659369"><span class="hs-identifier hs-type">false</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2215"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2216"></span><span>        </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-2217"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659375"><span class="annot"><a href="#local-6989586621682659375"><span class="hs-identifier hs-var hs-var">jmpFalse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659369"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-2218"></span><span>            </span><span id="local-6989586621682659376"><span class="annot"><a href="#local-6989586621682659376"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>
</span><span id="line-2219"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659372"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2220"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659377"><span class="hs-identifier hs-var">or_unordered</span></a></span><span>
</span><span id="line-2221"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659378"><span class="hs-identifier hs-var">plain_test</span></a></span><span>
</span><span id="line-2222"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659378"><span class="hs-identifier hs-var">plain_test</span></a></span><span>
</span><span id="line-2223"></span><span>                  </span><span class="hs-comment">-- Use ASSERT so we don't break releases if</span><span>
</span><span id="line-2224"></span><span>                  </span><span class="hs-comment">-- LTT/LE creep in somehow.</span><span>
</span><span id="line-2225"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2226"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2227"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659380"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2228"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2229"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2230"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659380"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2231"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659380"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2232"></span><span>
</span><span id="line-2233"></span><span>            </span><span id="local-6989586621682659378"><span class="annot"><a href="#local-6989586621682659378"><span class="hs-identifier hs-var hs-var">plain_test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2234"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659372"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659368"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-2235"></span><span>                </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659375"><span class="hs-identifier hs-var">jmpFalse</span></a></span><span>
</span><span id="line-2236"></span><span>            </span><span id="local-6989586621682659377"><span class="annot"><a href="#local-6989586621682659377"><span class="hs-identifier hs-var hs-var">or_unordered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2237"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659372"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659368"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2238"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659368"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-2239"></span><span>                </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682659375"><span class="hs-identifier hs-var">jmpFalse</span></a></span><span>
</span><span id="line-2240"></span><span>            </span><span id="local-6989586621682659380"><span class="annot"><a href="#local-6989586621682659380"><span class="hs-identifier hs-var hs-var">and_ordered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2241"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659369"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2242"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682659372"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659368"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2243"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659369"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-2244"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-2245"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682659381"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682659381"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CFG -&gt; (EdgeWeight -&gt; EdgeWeight) -&gt; Label -&gt; Label -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#adjustEdgeWeight"><span class="hs-identifier hs-var">adjustEdgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682659381"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeWeight -&gt; EdgeWeight -&gt; EdgeWeight
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">EdgeWeight
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659367"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659369"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2246"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659373"><span class="hs-identifier hs-type">cond_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659376"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2247"></span><span>
</span><span id="line-2248"></span><span class="hs-comment">{-  Note [Introducing cfg edges inside basic blocks]
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    During instruction selection a statement `s`
    in a block B with control of the sort: B -&gt; C
    will sometimes result in control
    flow of the sort:

            &#9484; &lt; &#9488;
            v   ^
      B -&gt;  B1  &#9524; -&gt; C

    as is the case for some atomic operations.

    Now to keep the CFG in sync when introducing B1 we clearly
    want to insert it between B and C. However there is
    a catch when we have to deal with self loops.

    We might start with code and a CFG of these forms:

    loop:
        stmt1               &#9484; &lt; &#9488;
        ....                v   ^
        stmtX              loop &#9496;
        stmtY
        ....
        goto loop:

    Now we introduce B1:
                            &#9484; &#9472; &#9472; &#9472; &#9472; &#9472;&#9488;
        loop:               &#9474;   &#9484; &lt;  &#9488; &#9474;
        instrs              v   &#9474;    &#9474; ^
        ....               loop &#9524; B1 &#9524; &#9496;
        instrsFromX
        stmtY
        goto loop:

    This is simple, all outgoing edges from loop now simply
    start from B1 instead and the code generator knows which
    new edges it introduced for the self loop of B1.

    Disaster strikes if the statement Y follows the same pattern.
    If we apply the same rule that all outgoing edges change then
    we end up with:

        loop &#9472;&gt; B1 &#9472;&gt; B2 &#9516;&#9472;&#9488;
          &#9474;      &#9474;    &#9492;&#9472;&lt;&#9508; &#9474;
          &#9474;      &#9492;&#9472;&#9472;&#9472;&lt;&#9472;&#9472;&#9472;&#9496; &#9474;
          &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&lt;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;

    This is problematic. The edge B1-&gt;B1 is modified as expected.
    However the modification is wrong!

    The assembly in this case looked like this:

    _loop:
        &lt;instrs&gt;
    _B1:
        ...
        cmpxchgq ...
        jne _B1
        &lt;instrs&gt;
        &lt;end _B1&gt;
    _B2:
        ...
        cmpxchgq ...
        jne _B2
        &lt;instrs&gt;
        jmp loop

    There is no edge _B2 -&gt; _B1 here. It's still a self loop onto _B1.

    The problem here is that really B1 should be two basic blocks.
    Otherwise we have control flow in the *middle* of a basic block.
    A contradiction!

    So to account for this we add yet another basic block marker:

    _B:
        &lt;instrs&gt;
    _B1:
        ...
        cmpxchgq ...
        jne _B1
        jmp _B1'
    _B1':
        &lt;instrs&gt;
        &lt;end _B1&gt;
    _B2:
        ...

    Now when inserting B2 we will only look at the outgoing edges of B1' and
    everything will work out nicely.

    You might also wonder why we don't insert jumps at the end of _B1'. There is
    no way another block ends up jumping to the labels _B1 or _B2 since they are
    essentially invisible to other blocks. View them as control flow labels local
    to the basic block if you'd like.

    Not doing this ultimately caused (part 2 of) #17334.
-}</span><span>
</span><span id="line-2349"></span><span>
</span><span id="line-2350"></span><span>
</span><span id="line-2351"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2352"></span><span class="hs-comment">--  Generating C calls</span><span>
</span><span id="line-2353"></span><span>
</span><span id="line-2354"></span><span class="hs-comment">-- Now the biggest nightmare---calls.  Most of the nastiness is buried in</span><span>
</span><span id="line-2355"></span><span class="hs-comment">-- @get_arg@, which moves the arguments to the correct registers/stack</span><span>
</span><span id="line-2356"></span><span class="hs-comment">-- locations.  Apart from that, the code is easy.</span><span>
</span><span id="line-2357"></span><span class="hs-comment">--</span><span>
</span><span id="line-2358"></span><span class="hs-comment">-- (If applicable) Do not fill the delay slots here; you will confuse the</span><span>
</span><span id="line-2359"></span><span class="hs-comment">-- register allocator.</span><span>
</span><span id="line-2360"></span><span class="hs-comment">--</span><span>
</span><span id="line-2361"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for information why we need</span><span>
</span><span id="line-2362"></span><span class="hs-comment">-- to take/return a block id.</span><span>
</span><span id="line-2363"></span><span>
</span><span id="line-2364"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-type">genForeignCall</span></a></span><span>
</span><span id="line-2365"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ function to call</span></span><span>
</span><span id="line-2366"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-2367"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-2368"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ The block we are in</span></span><span>
</span><span id="line-2369"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2370"></span><span>
</span><span id="line-2371"></span><span id="genForeignCall"><span class="annot"><span class="annottext">genForeignCall :: ForeignTarget
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; Label
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-var hs-var">genForeignCall</span></a></span></span><span> </span><span id="local-6989586621682659386"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682659386"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682659387"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659387"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682659388"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659388"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682659389"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659389"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2372"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682659386"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2373"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span id="local-6989586621682659391"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682659391"><span class="hs-keyword hs-var">prim</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CallishMachOp
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659389"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682659391"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659387"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659388"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2374"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682659394"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659394"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659395"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682659395"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; (OrdList Instr, Maybe Label))
-&gt; NatM (OrdList Instr) -&gt; NatM (OrdList Instr, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-var">genCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659389"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659394"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682659395"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659387"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659388"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2375"></span><span>
</span><span id="line-2376"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-type">genPrim</span></a></span><span>
</span><span id="line-2377"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ The block we are in</span></span><span>
</span><span id="line-2378"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ MachOp</span></span><span>
</span><span id="line-2379"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-2380"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-2381"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2382"></span><span>
</span><span id="line-2383"></span><span class="hs-comment">-- First we deal with cases which might introduce new blocks in the stream.</span><span>
</span><span id="line-2384"></span><span id="genPrim"><span class="annot"><span class="annottext">genPrim :: Label
-&gt; CallishMachOp
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var hs-var">genPrim</span></a></span></span><span> </span><span id="local-6989586621682659397"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659397"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRMW"><span class="hs-identifier hs-type">MO_AtomicRMW</span></a></span><span> </span><span id="local-6989586621682659399"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659399"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682659400"><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682659400"><span class="hs-identifier hs-var">amop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659401"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659401"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659402"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659402"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659403"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659403"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2385"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width
-&gt; AtomicMachOp
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-var">genAtomicRMW</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659397"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659399"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682659400"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659401"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659402"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659403"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2386"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span id="local-6989586621682659405"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659405"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ctz"><span class="hs-identifier hs-type">MO_Ctz</span></a></span><span> </span><span id="local-6989586621682659407"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659407"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659408"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659408"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659409"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659409"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2387"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-var">genCtz</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659405"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659407"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659408"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659409"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2388"></span><span>
</span><span id="line-2389"></span><span class="hs-comment">-- Then we deal with cases which not introducing new blocks in the stream.</span><span>
</span><span id="line-2390"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span id="local-6989586621682659411"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659411"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659412"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682659412"><span class="hs-keyword hs-var">prim</span></a></span></span><span> </span><span id="local-6989586621682659413"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659413"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682659414"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659414"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-2391"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; (OrdList Instr, Maybe Label))
-&gt; NatM (OrdList Instr) -&gt; NatM (OrdList Instr, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CallishMachOp -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659411"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682659412"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659413"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659414"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2392"></span><span>
</span><span id="line-2393"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-type">genSimplePrim</span></a></span><span>
</span><span id="line-2394"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ the block we are in</span></span><span>
</span><span id="line-2395"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ MachOp</span></span><span>
</span><span id="line-2396"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-2397"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-2398"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2399"></span><span id="genSimplePrim"><span class="annot"><span class="annottext">genSimplePrim :: Label
-&gt; CallishMachOp -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var hs-var">genSimplePrim</span></a></span></span><span> </span><span id="local-6989586621682659416"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659416"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcpy"><span class="hs-identifier hs-type">MO_Memcpy</span></a></span><span> </span><span id="local-6989586621682659418"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659418"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659419"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659419"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659420"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659420"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659421"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659421"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-var">genMemCpy</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659416"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659418"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659419"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659420"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659421"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2400"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659423"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659423"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memmove"><span class="hs-identifier hs-type">MO_Memmove</span></a></span><span> </span><span id="local-6989586621682659425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659425"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659426"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659426"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659427"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659427"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659428"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659428"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
forall p.
Label -&gt; p -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-var">genMemMove</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659423"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659425"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659426"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659427"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659428"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2401"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659430"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659430"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcmp"><span class="hs-identifier hs-type">MO_Memcmp</span></a></span><span> </span><span id="local-6989586621682659432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659432"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682659433"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659433"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659434"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659434"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659435"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659435"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659436"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659436"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Int
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
forall p.
Label
-&gt; p
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-var">genMemCmp</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659430"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659432"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659433"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659434"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659435"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659436"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2402"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659438"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659438"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memset"><span class="hs-identifier hs-type">MO_Memset</span></a></span><span> </span><span id="local-6989586621682659440"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659440"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659441"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659441"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659442"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659442"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659443"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659443"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-var">genMemSet</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659438"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659440"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659441"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659442"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659443"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2403"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_AcquireFence"><span class="hs-identifier hs-var">MO_AcquireFence</span></a></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- barriers compile to no code on x86/x86-64;</span><span>
</span><span id="line-2404"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ReleaseFence"><span class="hs-identifier hs-var">MO_ReleaseFence</span></a></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- we keep it this long in order to prevent earlier optimisations.</span><span>
</span><span id="line-2405"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SeqCstFence"><span class="hs-identifier hs-var">MO_SeqCstFence</span></a></span><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; NatM (OrdList Instr))
-&gt; OrdList Instr -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MFENCE"><span class="hs-identifier hs-var">MFENCE</span></a></span><span>
</span><span id="line-2406"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Touch"><span class="hs-identifier hs-var">MO_Touch</span></a></span><span>             </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-2407"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Prefetch_Data"><span class="hs-identifier hs-type">MO_Prefetch_Data</span></a></span><span> </span><span id="local-6989586621682659451"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659451"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659452"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659452"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-var">genPrefetchData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682659451"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659452"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2408"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BSwap"><span class="hs-identifier hs-type">MO_BSwap</span></a></span><span> </span><span id="local-6989586621682659455"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659455"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682659456"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659456"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659457"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659457"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-var">genByteSwap</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659455"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659456"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659457"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2409"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659459"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659459"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BRev"><span class="hs-identifier hs-type">MO_BRev</span></a></span><span> </span><span id="local-6989586621682659461"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659461"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659462"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659462"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659463"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659463"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-var">genBitRev</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659459"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659461"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659462"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659463"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2410"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659465"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659465"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_PopCnt"><span class="hs-identifier hs-type">MO_PopCnt</span></a></span><span> </span><span id="local-6989586621682659467"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659467"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682659468"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659468"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659469"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659469"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-var">genPopCnt</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659465"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659467"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659468"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659469"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2411"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659471"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659471"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pdep"><span class="hs-identifier hs-type">MO_Pdep</span></a></span><span> </span><span id="local-6989586621682659473"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659473"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659474"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659474"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659475"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659475"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659476"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659476"><span class="hs-identifier hs-var">mask</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-var">genPdep</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659471"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659473"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659474"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659475"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659476"><span class="hs-identifier hs-var">mask</span></a></span><span>
</span><span id="line-2412"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659478"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659478"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pext"><span class="hs-identifier hs-type">MO_Pext</span></a></span><span> </span><span id="local-6989586621682659480"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659480"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659481"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659481"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659482"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659482"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659483"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659483"><span class="hs-identifier hs-var">mask</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-var">genPext</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659478"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659480"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659481"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659482"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659483"><span class="hs-identifier hs-var">mask</span></a></span><span>
</span><span id="line-2413"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659485"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659485"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Clz"><span class="hs-identifier hs-type">MO_Clz</span></a></span><span> </span><span id="local-6989586621682659487"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659487"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682659488"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659488"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659489"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659489"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-var">genClz</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659485"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659487"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659488"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659489"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2414"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659491"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659491"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UF_Conv"><span class="hs-identifier hs-type">MO_UF_Conv</span></a></span><span> </span><span id="local-6989586621682659493"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659493"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659494"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659494"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659495"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659495"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-var">genWordToFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659491"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659493"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659494"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659495"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2415"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRead"><span class="hs-identifier hs-type">MO_AtomicRead</span></a></span><span> </span><span id="local-6989586621682659498"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659498"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682659499"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682659499"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682659500"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659500"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682659501"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659501"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; MemoryOrdering -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-var">genAtomicRead</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659498"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682659499"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659500"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659501"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2416"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicWrite"><span class="hs-identifier hs-type">MO_AtomicWrite</span></a></span><span> </span><span id="local-6989586621682659504"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659504"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682659505"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682659505"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682659506"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659506"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659507"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659507"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; MemoryOrdering -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-var">genAtomicWrite</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659504"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682659505"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659506"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659507"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-2417"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659509"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659509"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Cmpxchg"><span class="hs-identifier hs-type">MO_Cmpxchg</span></a></span><span> </span><span id="local-6989586621682659511"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659511"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659512"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659512"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659513"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659513"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659514"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659514"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659515"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659515"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-var">genCmpXchg</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659509"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659511"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659512"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659513"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659514"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659515"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-2418"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xchg"><span class="hs-identifier hs-type">MO_Xchg</span></a></span><span> </span><span id="local-6989586621682659518"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659518"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659519"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659519"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659520"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659520"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659521"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659521"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-var">genXchg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659518"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659519"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659520"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659521"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-2419"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddWordC"><span class="hs-identifier hs-type">MO_AddWordC</span></a></span><span> </span><span id="local-6989586621682659524"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659524"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659525"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659525"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659526"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659526"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659527"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659527"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659528"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659528"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659524"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659525"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659526"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659528"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2420"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubWordC"><span class="hs-identifier hs-type">MO_SubWordC</span></a></span><span> </span><span id="local-6989586621682659533"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659533"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659534"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659534"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659535"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659535"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659536"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659536"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659537"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659537"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659533"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659534"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659535"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659536"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659537"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2421"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddIntC"><span class="hs-identifier hs-type">MO_AddIntC</span></a></span><span> </span><span id="local-6989586621682659540"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659540"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682659541"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659541"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659542"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659542"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659543"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659543"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659544"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659544"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659540"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Operand -&gt; Instr)
 -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Format
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659541"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659542"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659543"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659544"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2422"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubIntC"><span class="hs-identifier hs-type">MO_SubIntC</span></a></span><span> </span><span id="local-6989586621682659546"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659546"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682659547"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659547"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659548"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659548"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659549"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659549"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659550"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659550"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659546"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659547"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659548"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659549"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659550"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2423"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add2"><span class="hs-identifier hs-type">MO_Add2</span></a></span><span> </span><span id="local-6989586621682659552"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659552"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659553"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659553"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659554"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659554"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659555"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659555"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659556"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659556"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-var">genAddWithCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659552"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659553"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659554"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659555"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659556"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2424"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Mul2"><span class="hs-identifier hs-type">MO_U_Mul2</span></a></span><span> </span><span id="local-6989586621682659559"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659559"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682659560"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659560"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659561"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659561"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659562"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659562"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659563"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659563"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-var">genUnsignedLargeMul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659559"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659560"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659561"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659562"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659563"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2425"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Mul2"><span class="hs-identifier hs-type">MO_S_Mul2</span></a></span><span> </span><span id="local-6989586621682659566"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659566"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682659567"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659567"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659568"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659568"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659569"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659569"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682659570"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659570"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659571"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659571"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-var">genSignedLargeMul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659566"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659567"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659568"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659569"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659570"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659571"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2426"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-type">MO_S_QuotRem</span></a></span><span> </span><span id="local-6989586621682659574"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659574"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682659575"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659575"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659576"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659576"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659577"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659577"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659578"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659578"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659574"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659575"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659576"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659577"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659578"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2427"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-type">MO_U_QuotRem</span></a></span><span> </span><span id="local-6989586621682659581"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659581"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682659582"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659582"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659583"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659583"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659584"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659584"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659585"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659585"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659581"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659582"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659583"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659584"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659585"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2428"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem2"><span class="hs-identifier hs-type">MO_U_QuotRem2</span></a></span><span> </span><span id="local-6989586621682659587"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659587"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682659588"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659588"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659589"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659589"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659590"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659590"><span class="hs-identifier hs-var">hx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659591"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659591"><span class="hs-identifier hs-var">lx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659592"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659592"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682659587"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659588"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659589"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659590"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659591"><span class="hs-identifier hs-var">lx</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659592"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2429"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Fabs"><span class="hs-identifier hs-var">MO_F32_Fabs</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659594"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659594"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659595"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659595"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var">genFloatAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659594"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659595"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2430"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Fabs"><span class="hs-identifier hs-var">MO_F64_Fabs</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659598"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659598"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659599"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659599"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var">genFloatAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659598"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659599"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2431"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sqrt"><span class="hs-identifier hs-var">MO_F32_Sqrt</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659601"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659601"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659602"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659602"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var">genFloatSqrt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659601"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659602"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2432"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sqrt"><span class="hs-identifier hs-var">MO_F64_Sqrt</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659606"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659606"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659607"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659607"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var">genFloatSqrt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659606"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659607"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2433"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659609"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659609"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sin"><span class="hs-identifier hs-var">MO_F32_Sin</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659611"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659611"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659612"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659612"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659609"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659611"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659612"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2434"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659615"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659615"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cos"><span class="hs-identifier hs-var">MO_F32_Cos</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659617"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659617"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659618"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659618"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659615"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659617"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659618"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2435"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659619"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659619"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tan"><span class="hs-identifier hs-var">MO_F32_Tan</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659621"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659621"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659622"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659622"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659619"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659621"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659622"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2436"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659623"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659623"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Exp"><span class="hs-identifier hs-var">MO_F32_Exp</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659625"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659625"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659626"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659626"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659623"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659625"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659626"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2437"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659627"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659627"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_ExpM1"><span class="hs-identifier hs-var">MO_F32_ExpM1</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659629"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659629"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659630"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659630"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659627"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expm1f&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659629"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659630"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2438"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659631"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659631"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log"><span class="hs-identifier hs-var">MO_F32_Log</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659633"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659633"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659634"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659634"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659631"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659633"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659634"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2439"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659635"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659635"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log1P"><span class="hs-identifier hs-var">MO_F32_Log1P</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659637"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659637"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659638"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659638"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659635"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log1pf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659637"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659638"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2440"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659639"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659639"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asin"><span class="hs-identifier hs-var">MO_F32_Asin</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659641"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659641"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659642"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659642"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659639"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659641"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659642"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2441"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659643"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659643"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acos"><span class="hs-identifier hs-var">MO_F32_Acos</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659645"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659645"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659646"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659646"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659643"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659645"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659646"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2442"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659647"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659647"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atan"><span class="hs-identifier hs-var">MO_F32_Atan</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659649"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659649"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659650"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659650"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659647"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659649"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659650"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2443"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659651"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659651"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sinh"><span class="hs-identifier hs-var">MO_F32_Sinh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659653"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659653"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659654"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659654"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659651"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659653"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659654"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2444"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659655"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659655"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cosh"><span class="hs-identifier hs-var">MO_F32_Cosh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659657"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659657"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659658"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659658"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659655"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coshf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659657"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659658"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2445"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659659"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659659"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tanh"><span class="hs-identifier hs-var">MO_F32_Tanh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659661"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659661"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659662"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659662"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659659"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659661"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659662"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2446"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659663"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659663"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Pwr"><span class="hs-identifier hs-var">MO_F32_Pwr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659665"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659665"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659666"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659666"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659667"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659667"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659663"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;powf&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659665"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659666"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659667"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2447"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659668"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659668"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asinh"><span class="hs-identifier hs-var">MO_F32_Asinh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659670"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659670"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659671"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659671"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659668"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659670"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659671"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2448"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659672"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659672"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acosh"><span class="hs-identifier hs-var">MO_F32_Acosh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659674"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659674"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659675"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659675"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659672"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acoshf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659674"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659675"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2449"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659676"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659676"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atanh"><span class="hs-identifier hs-var">MO_F32_Atanh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659678"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659678"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659679"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659679"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659676"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659678"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659679"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2450"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659680"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659680"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sin"><span class="hs-identifier hs-var">MO_F64_Sin</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659682"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659682"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659683"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659683"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659680"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sin&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659682"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659683"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2451"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659684"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659684"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cos"><span class="hs-identifier hs-var">MO_F64_Cos</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659686"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659686"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659687"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659687"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659684"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cos&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659686"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659687"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2452"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659688"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659688"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tan"><span class="hs-identifier hs-var">MO_F64_Tan</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659690"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659690"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659691"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659691"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659688"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tan&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659690"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659691"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2453"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659692"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659692"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Exp"><span class="hs-identifier hs-var">MO_F64_Exp</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659694"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659694"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659695"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659695"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659692"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659694"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659695"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2454"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659696"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659696"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_ExpM1"><span class="hs-identifier hs-var">MO_F64_ExpM1</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659698"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659698"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659699"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659699"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659696"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expm1&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659698"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659699"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2455"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659700"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659700"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log"><span class="hs-identifier hs-var">MO_F64_Log</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659702"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659702"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659703"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659703"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659700"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659702"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659703"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2456"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659704"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659704"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log1P"><span class="hs-identifier hs-var">MO_F64_Log1P</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659706"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659706"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659707"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659707"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659704"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log1p&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659706"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659707"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2457"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659708"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659708"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asin"><span class="hs-identifier hs-var">MO_F64_Asin</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659710"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659710"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659711"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659711"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659708"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asin&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659710"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659711"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2458"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659712"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659712"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acos"><span class="hs-identifier hs-var">MO_F64_Acos</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659714"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659714"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659715"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659715"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659712"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acos&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659714"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659715"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2459"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659716"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659716"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atan"><span class="hs-identifier hs-var">MO_F64_Atan</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659718"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659718"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659719"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659719"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659716"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atan&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659718"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659719"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2460"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659720"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659720"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sinh"><span class="hs-identifier hs-var">MO_F64_Sinh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659722"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659722"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659723"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659723"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659720"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659722"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659723"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2461"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659724"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659724"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cosh"><span class="hs-identifier hs-var">MO_F64_Cosh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659726"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659726"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659727"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659727"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659724"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659726"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659727"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2462"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659728"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659728"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tanh"><span class="hs-identifier hs-var">MO_F64_Tanh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659730"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659730"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659731"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659731"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659728"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659730"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659731"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2463"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659732"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659732"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Pwr"><span class="hs-identifier hs-var">MO_F64_Pwr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659734"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659734"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659735"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659735"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659736"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659736"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659732"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pow&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659734"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659735"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659736"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2464"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659737"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659737"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asinh"><span class="hs-identifier hs-var">MO_F64_Asinh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659739"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659739"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659740"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659740"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659737"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659739"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659740"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2465"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659741"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659741"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acosh"><span class="hs-identifier hs-var">MO_F64_Acosh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659743"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659743"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659744"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659744"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659741"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659743"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659744"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2466"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659745"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659745"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atanh"><span class="hs-identifier hs-var">MO_F64_Atanh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659747"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659747"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659748"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659748"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659745"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659747"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659748"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2467"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659749"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659749"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SuspendThread"><span class="hs-identifier hs-var">MO_SuspendThread</span></a></span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682659751"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659751"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659752"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659752"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659753"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659753"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var">genRTSCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659749"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;suspendThread&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659751"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659752"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659753"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2468"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659755"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659755"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ResumeThread"><span class="hs-identifier hs-var">MO_ResumeThread</span></a></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682659757"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659757"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682659758"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659758"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var">genRTSCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659755"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;resumeThread&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659757"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659758"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2469"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_ToI"><span class="hs-identifier hs-var">MO_I64_ToI</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659760"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659760"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659761"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659761"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genInt64ToInt"><span class="hs-identifier hs-var">genInt64ToInt</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659760"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659761"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2470"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_FromI"><span class="hs-identifier hs-var">MO_I64_FromI</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659764"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659764"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659765"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659765"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genIntToInt64"><span class="hs-identifier hs-var">genIntToInt64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659764"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659765"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2471"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_ToW"><span class="hs-identifier hs-var">MO_W64_ToW</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659768"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659768"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659769"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659769"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWord64ToWord"><span class="hs-identifier hs-var">genWord64ToWord</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659768"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659769"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2472"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_FromW"><span class="hs-identifier hs-var">MO_W64_FromW</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682659772"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659772"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659773"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659773"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToWord64"><span class="hs-identifier hs-var">genWordToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659772"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659773"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2473"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Neg"><span class="hs-identifier hs-var">MO_x64_Neg</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659776"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659776"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659777"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659777"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNeg64"><span class="hs-identifier hs-var">genNeg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659776"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659777"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2474"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Add"><span class="hs-identifier hs-var">MO_x64_Add</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659780"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659780"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659781"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659781"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659782"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659782"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAdd64"><span class="hs-identifier hs-var">genAdd64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659780"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659781"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659782"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2475"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Sub"><span class="hs-identifier hs-var">MO_x64_Sub</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659785"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659785"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659786"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659786"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659787"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659787"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSub64"><span class="hs-identifier hs-var">genSub64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659785"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659786"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659787"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2476"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659789"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659789"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Mul"><span class="hs-identifier hs-var">MO_x64_Mul</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659791"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659791"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659792"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659792"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659793"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659793"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659789"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_mul64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659791"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659792"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659793"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2477"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659795"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659795"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Quot"><span class="hs-identifier hs-var">MO_I64_Quot</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659797"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659797"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659798"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659798"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659799"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659799"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659795"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_quotInt64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659797"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659798"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659799"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2478"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659800"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659800"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Rem"><span class="hs-identifier hs-var">MO_I64_Rem</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659802"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659802"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659803"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659803"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659804"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659804"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659800"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_remInt64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659802"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659803"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659804"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2479"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659805"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659805"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Quot"><span class="hs-identifier hs-var">MO_W64_Quot</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682659807"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659807"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659808"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659808"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659809"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659809"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659805"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_quotWord64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659807"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659808"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659809"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2480"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659810"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659810"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Rem"><span class="hs-identifier hs-var">MO_W64_Rem</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659812"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659812"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659813"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659813"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659814"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659814"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659810"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_remWord64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659812"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659813"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659814"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2481"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_And"><span class="hs-identifier hs-var">MO_x64_And</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659816"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659816"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659817"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659817"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659818"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659818"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAnd64"><span class="hs-identifier hs-var">genAnd64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659816"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659817"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659818"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2482"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Or"><span class="hs-identifier hs-var">MO_x64_Or</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659821"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659821"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659822"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659822"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659823"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659823"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genOr64"><span class="hs-identifier hs-var">genOr64</span></a></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659821"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659822"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659823"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2483"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Xor"><span class="hs-identifier hs-var">MO_x64_Xor</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659826"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659826"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659827"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659827"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659828"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659828"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXor64"><span class="hs-identifier hs-var">genXor64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659826"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659827"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659828"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2484"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Not"><span class="hs-identifier hs-var">MO_x64_Not</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659831"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659831"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659832"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659832"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNot64"><span class="hs-identifier hs-var">genNot64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659831"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659832"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2485"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659834"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659834"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Shl"><span class="hs-identifier hs-var">MO_x64_Shl</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659836"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659836"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659837"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659837"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659838"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659838"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659834"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_uncheckedShiftL64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659836"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659837"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659838"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2486"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659839"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659839"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Shr"><span class="hs-identifier hs-var">MO_I64_Shr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659841"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659841"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659842"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659842"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659843"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659843"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659839"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_uncheckedIShiftRA64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659841"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659842"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659843"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2487"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682659844"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659844"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Shr"><span class="hs-identifier hs-var">MO_W64_Shr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682659846"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659846"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659847"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659847"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659848"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659848"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659844"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_uncheckedShiftRL64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659846"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659847"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659848"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2488"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Eq"><span class="hs-identifier hs-var">MO_x64_Eq</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659850"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659850"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659851"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659851"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659852"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659852"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genEq64"><span class="hs-identifier hs-var">genEq64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659850"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659851"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659852"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2489"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Ne"><span class="hs-identifier hs-var">MO_x64_Ne</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659855"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659855"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659856"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659856"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659857"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659857"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNe64"><span class="hs-identifier hs-var">genNe64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659855"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659857"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2490"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Ge"><span class="hs-identifier hs-var">MO_I64_Ge</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659860"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659860"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659861"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659861"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659862"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659862"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeInt64"><span class="hs-identifier hs-var">genGeInt64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659860"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659861"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659862"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2491"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Gt"><span class="hs-identifier hs-var">MO_I64_Gt</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659865"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659865"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659866"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659866"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659867"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659867"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtInt64"><span class="hs-identifier hs-var">genGtInt64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659865"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659866"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659867"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2492"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Le"><span class="hs-identifier hs-var">MO_I64_Le</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659870"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659870"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659871"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659871"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659872"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659872"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeInt64"><span class="hs-identifier hs-var">genLeInt64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659870"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659871"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659872"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2493"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Lt"><span class="hs-identifier hs-var">MO_I64_Lt</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659875"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659875"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659876"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659876"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659877"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659877"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtInt64"><span class="hs-identifier hs-var">genLtInt64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659875"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659876"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659877"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2494"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Ge"><span class="hs-identifier hs-var">MO_W64_Ge</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659880"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659880"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659881"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659881"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659882"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659882"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeWord64"><span class="hs-identifier hs-var">genGeWord64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659880"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659881"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659882"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2495"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Gt"><span class="hs-identifier hs-var">MO_W64_Gt</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659885"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659885"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659886"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659886"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659887"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659887"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtWord64"><span class="hs-identifier hs-var">genGtWord64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659885"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659886"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659887"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2496"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Le"><span class="hs-identifier hs-var">MO_W64_Le</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659890"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659890"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659891"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659891"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659892"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659892"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeWord64"><span class="hs-identifier hs-var">genLeWord64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659890"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659891"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659892"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2497"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Lt"><span class="hs-identifier hs-var">MO_W64_Lt</span></a></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682659895"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659895"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682659896"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659896"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682659897"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659897"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtWord64"><span class="hs-identifier hs-var">genLtWord64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682659895"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659896"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659897"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2498"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682659899"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682659899"><span class="hs-identifier hs-var">op</span></a></span></span><span>                   </span><span id="local-6989586621682659900"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659900"><span class="hs-identifier hs-var">dst</span></a></span></span><span>     </span><span id="local-6989586621682659901"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659901"><span class="hs-identifier hs-var">args</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2499"></span><span>  </span><span id="local-6989586621682659902"><span class="annot"><a href="#local-6989586621682659902"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2500"></span><span>  </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genSimplePrim: unhandled primop&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#pprCallishMachOp"><span class="hs-identifier hs-type">pprCallishMachOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659899"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659900"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659902"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659901"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2501"></span><span>
</span><span id="line-2502"></span><span class="hs-comment">{-
Note [Evaluate C-call arguments before placing in destination registers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When producing code for C calls we must take care when placing arguments
in their final registers. Specifically, we must ensure that temporary register
usage due to evaluation of one argument does not clobber a register in which we
already placed a previous argument (e.g. as the code generation logic for
MO_Shl can clobber %rcx due to x86 instruction limitations).

This is precisely what happened in #18527. Consider this C--:

    (result::I64) = call &quot;ccall&quot; doSomething(_s2hp::I64, 2244, _s2hq::I64, _s2hw::I64 | (1 &lt;&lt; _s2hz::I64));

Here we are calling the C function `doSomething` with three arguments, the last
involving a non-trivial expression involving MO_Shl. In this case the NCG could
naively generate the following assembly (where $tmp denotes some temporary
register and $argN denotes the register for argument N, as dictated by the
platform's calling convention):

    mov _s2hp, $arg1   # place first argument
    mov _s2hq, $arg2   # place second argument

    # Compute 1 &lt;&lt; _s2hz
    mov _s2hz, %rcx
    shl %cl, $tmp

    # Compute (_s2hw | (1 &lt;&lt; _s2hz))
    mov _s2hw, $arg3
    or $tmp, $arg3

    # Perform the call
    call func

This code is outright broken on Windows which assigns $arg1 to %rcx. This means
that the evaluation of the last argument clobbers the first argument.

To avoid this we use a rather awful hack: when producing code for a C call with
at least one non-trivial argument, we first evaluate all of the arguments into
local registers before moving them into their final calling-convention-defined
homes.  This is performed by 'evalArgs'. Here we define &quot;non-trivial&quot; to be an
expression which might contain a MachOp since these are the only cases which
might clobber registers. Furthermore, we use a conservative approximation of
this condition (only looking at the top-level of CmmExprs) to avoid spending
too much effort trying to decide whether we want to take the fast path.

Note that this hack *also* applies to calls to out-of-line PrimTargets (which
are lowered via a C call), which will ultimately end up in
genForeignCall{32,64}.
-}</span><span>
</span><span id="line-2552"></span><span>
</span><span id="line-2553"></span><span class="annot"><span class="hs-comment">-- | See Note [Evaluate C-call arguments before placing in destination registers]</span></span><span>
</span><span id="line-2554"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-type">evalArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2555"></span><span id="evalArgs"><span class="annot"><span class="annottext">evalArgs :: Label -&gt; [CmmExpr] -&gt; NatM (OrdList Instr, [CmmExpr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-var hs-var">evalArgs</span></a></span></span><span> </span><span id="local-6989586621682659905"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659905"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659906"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659906"><span class="hs-identifier hs-var">actuals</span></a></span></span><span>
</span><span id="line-2556"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Bool) -&gt; [CmmExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="#local-6989586621682659907"><span class="hs-identifier hs-var">mightContainMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659906"><span class="hs-identifier hs-var">actuals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2557"></span><span>      </span><span id="local-6989586621682659908"><span class="annot"><a href="#local-6989586621682659908"><span class="hs-identifier hs-var">regs_blks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM (OrdList Instr, CmmExpr))
-&gt; [CmmExpr] -&gt; NatM [(OrdList Instr, CmmExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (OrdList Instr, CmmExpr)
</span><a href="#local-6989586621682659910"><span class="hs-identifier hs-var">evalArg</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659906"><span class="hs-identifier hs-var">actuals</span></a></span><span>
</span><span id="line-2558"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-type">concatOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621682659908"><span class="hs-identifier hs-type">regs_blks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621682659908"><span class="hs-identifier hs-type">regs_blks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2559"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr, [CmmExpr]) -&gt; NatM (OrdList Instr, [CmmExpr])
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659906"><span class="hs-identifier hs-var">actuals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2560"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2561"></span><span>    </span><span id="local-6989586621682659907"><span class="annot"><span class="annottext">mightContainMachOp :: CmmExpr -&gt; Bool
</span><a href="#local-6989586621682659907"><span class="hs-identifier hs-var hs-var">mightContainMachOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2562"></span><span>    </span><span class="annot"><a href="#local-6989586621682659907"><span class="hs-identifier hs-var">mightContainMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2563"></span><span>    </span><span class="annot"><a href="#local-6989586621682659907"><span class="hs-identifier hs-var">mightContainMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2564"></span><span>    </span><span class="annot"><a href="#local-6989586621682659907"><span class="hs-identifier hs-var">mightContainMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2565"></span><span>
</span><span id="line-2566"></span><span>    </span><span class="annot"><a href="#local-6989586621682659910"><span class="hs-identifier hs-type">evalArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2567"></span><span>    </span><span id="local-6989586621682659910"><span class="annot"><span class="annottext">evalArg :: CmmExpr -&gt; NatM (OrdList Instr, CmmExpr)
</span><a href="#local-6989586621682659910"><span class="hs-identifier hs-var hs-var">evalArg</span></a></span></span><span> </span><span id="local-6989586621682659914"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659914"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2568"></span><span>        </span><span id="local-6989586621682659915"><span class="annot"><a href="#local-6989586621682659915"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2569"></span><span>        </span><span id="local-6989586621682659916"><span class="annot"><a href="#local-6989586621682659916"><span class="hs-identifier hs-var">lreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682659917"><span class="hs-identifier hs-type">newLocalReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-type">cmmExprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659915"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659914"><span class="hs-identifier hs-type">actual</span></a></span><span>
</span><span id="line-2570"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682659918"><span class="annot"><a href="#local-6989586621682659918"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659919"><span class="annot"><a href="#local-6989586621682659919"><span class="hs-identifier hs-var">bid1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659905"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659916"><span class="hs-identifier hs-type">lreg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682659914"><span class="hs-identifier hs-type">actual</span></a></span><span>
</span><span id="line-2571"></span><span>        </span><span class="hs-comment">-- The above assignment shouldn't change the current block</span><span>
</span><span id="line-2572"></span><span>        </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">isNothing</span></span><span> </span><span class="annot"><a href="#local-6989586621682659919"><span class="hs-identifier hs-type">bid1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2573"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659918"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659916"><span class="hs-identifier hs-type">lreg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2574"></span><span>
</span><span id="line-2575"></span><span>    </span><span class="annot"><a href="#local-6989586621682659917"><span class="hs-identifier hs-type">newLocalReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#CmmType"><span class="hs-identifier hs-type">CmmType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-2576"></span><span>    </span><span id="local-6989586621682659917"><span class="annot"><span class="annottext">newLocalReg :: CmmType -&gt; NatM LocalReg
</span><a href="#local-6989586621682659917"><span class="hs-identifier hs-var hs-var">newLocalReg</span></a></span></span><span> </span><span id="local-6989586621682659922"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659922"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CmmType -&gt; LocalReg
</span><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; CmmType -&gt; LocalReg)
-&gt; NatM Unique -&gt; NatM (CmmType -&gt; LocalReg)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM Unique
forall (m :: * -&gt; *). MonadUnique m =&gt; m Unique
</span><a href="GHC.Types.Unique.Supply.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a></span><span> </span><span class="annot"><span class="annottext">NatM (CmmType -&gt; LocalReg) -&gt; NatM CmmType -&gt; NatM LocalReg
forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; NatM CmmType
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659922"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2577"></span><span>
</span><span id="line-2578"></span><span class="hs-comment">-- Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-2579"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-2580"></span><span class="hs-comment">-- IDIV reminder:</span><span>
</span><span id="line-2581"></span><span class="hs-comment">--   Size    Dividend   Divisor   Quotient    Remainder</span><span>
</span><span id="line-2582"></span><span class="hs-comment">--   byte    %ax         r/m8      %al          %ah</span><span>
</span><span id="line-2583"></span><span class="hs-comment">--   word    %dx:%ax     r/m16     %ax          %dx</span><span>
</span><span id="line-2584"></span><span class="hs-comment">--   dword   %edx:%eax   r/m32     %eax         %edx</span><span>
</span><span id="line-2585"></span><span class="hs-comment">--   qword   %rdx:%rax   r/m64     %rax         %rdx</span><span>
</span><span id="line-2586"></span><span class="hs-comment">--</span><span>
</span><span id="line-2587"></span><span class="hs-comment">-- We do a special case for the byte division because the current</span><span>
</span><span id="line-2588"></span><span class="hs-comment">-- codegen doesn't deal well with accessing %ah register (also,</span><span>
</span><span id="line-2589"></span><span class="hs-comment">-- accessing %ah in 64-bit mode is complicated because it cannot be an</span><span>
</span><span id="line-2590"></span><span class="hs-comment">-- operand of many instructions). So we just widen operands to 16 bits</span><span>
</span><span id="line-2591"></span><span class="hs-comment">-- and get the results from %al, %dl. This is not optimal, but a few</span><span>
</span><span id="line-2592"></span><span class="hs-comment">-- register moves are probably not a huge deal when doing division.</span><span>
</span><span id="line-2593"></span><span>
</span><span id="line-2594"></span><span>
</span><span id="line-2595"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in ghc-prim</span></span><span>
</span><span id="line-2596"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span>
</span><span id="line-2597"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-2598"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-2599"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2600"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2601"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2602"></span><span id="genPrimCCall"><span class="annot"><span class="annottext">genPrimCCall :: Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var hs-var">genPrimCCall</span></a></span></span><span> </span><span id="local-6989586621682659923"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659923"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659924"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659924"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682659925"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659925"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682659926"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659926"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2603"></span><span>  </span><span id="local-6989586621682659927"><span class="annot"><a href="#local-6989586621682659927"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2604"></span><span>  </span><span class="hs-comment">-- FIXME: we should use mkForeignLabel instead of mkCmmCodeLabel</span><span>
</span><span id="line-2605"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659928"><span class="annot"><a href="#local-6989586621682659928"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; FastString -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkCmmCodeLabel"><span class="hs-identifier hs-var">mkCmmCodeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="GHC.Unit.Types.html#primUnitId"><span class="hs-identifier hs-var">primUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659924"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span>
</span><span id="line-2606"></span><span>  </span><span id="local-6989586621682659930"><span class="annot"><a href="#local-6989586621682659930"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659927"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659928"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-2607"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659932"><span class="annot"><a href="#local-6989586621682659932"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-2608"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659923"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659930"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659932"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659925"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659926"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2609"></span><span>
</span><span id="line-2610"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in libc</span></span><span>
</span><span id="line-2611"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-type">genLibCCall</span></a></span><span>
</span><span id="line-2612"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-2613"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-2614"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2615"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2616"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2617"></span><span id="genLibCCall"><span class="annot"><span class="annottext">genLibCCall :: Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var hs-var">genLibCCall</span></a></span></span><span> </span><span id="local-6989586621682659936"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659936"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659937"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659937"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682659938"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659938"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682659939"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659939"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2618"></span><span>  </span><span id="local-6989586621682659940"><span class="annot"><a href="#local-6989586621682659940"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2619"></span><span>  </span><span class="hs-comment">-- Assume we can call these functions directly, and that they're not in a dynamic library.</span><span>
</span><span id="line-2620"></span><span>  </span><span class="hs-comment">-- TODO: Why is this ok? Under linux this code will be in libm.so</span><span>
</span><span id="line-2621"></span><span>  </span><span class="hs-comment">--       Is it because they're really implemented as a primitive instruction by the assembler??  -- BL 2009/12/31</span><span>
</span><span id="line-2622"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659941"><span class="annot"><a href="#local-6989586621682659941"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString
-&gt; Maybe Int -&gt; ForeignLabelSource -&gt; FunctionOrData -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659937"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ForeignLabelSource
</span><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-var">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-var">IsFunction</span></a></span><span>
</span><span id="line-2623"></span><span>  </span><span id="local-6989586621682659945"><span class="annot"><a href="#local-6989586621682659945"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659940"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659941"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-2624"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659946"><span class="annot"><a href="#local-6989586621682659946"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-2625"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659936"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659945"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659946"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659938"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659939"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2626"></span><span>
</span><span id="line-2627"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in the RTS</span></span><span>
</span><span id="line-2628"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-type">genRTSCCall</span></a></span><span>
</span><span id="line-2629"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-2630"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-2631"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2632"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2633"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2634"></span><span id="genRTSCCall"><span class="annot"><span class="annottext">genRTSCCall :: Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var hs-var">genRTSCCall</span></a></span></span><span> </span><span id="local-6989586621682659947"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659947"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659948"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659948"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682659949"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659949"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682659950"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659950"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2635"></span><span>  </span><span id="local-6989586621682659951"><span class="annot"><a href="#local-6989586621682659951"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2636"></span><span>  </span><span class="hs-comment">-- Assume we can call these functions directly, and that they're not in a dynamic library.</span><span>
</span><span id="line-2637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659952"><span class="annot"><a href="#local-6989586621682659952"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString
-&gt; Maybe Int -&gt; ForeignLabelSource -&gt; FunctionOrData -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682659948"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ForeignLabelSource
</span><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-var">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-var">IsFunction</span></a></span><span>
</span><span id="line-2638"></span><span>  </span><span id="local-6989586621682659953"><span class="annot"><a href="#local-6989586621682659953"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659951"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659952"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-2639"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659954"><span class="annot"><a href="#local-6989586621682659954"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-2640"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659947"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659953"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659954"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659949"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659950"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2641"></span><span>
</span><span id="line-2642"></span><span class="annot"><span class="hs-comment">-- | Generate a real C call to the given address with the given convention</span></span><span>
</span><span id="line-2643"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span>
</span><span id="line-2644"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-2645"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-2646"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span>
</span><span id="line-2647"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2648"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2649"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2650"></span><span id="genCCall"><span class="annot"><span class="annottext">genCCall :: Label
-&gt; CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-var hs-var">genCCall</span></a></span></span><span> </span><span id="local-6989586621682659955"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682659955"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682659956"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659956"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659957"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682659957"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621682659958"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659958"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682659959"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659959"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2651"></span><span>  </span><span id="local-6989586621682659960"><span class="annot"><a href="#local-6989586621682659960"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2652"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682659961"><span class="annot"><a href="#local-6989586621682659961"><span class="hs-identifier hs-var">instrs0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682659962"><span class="annot"><a href="#local-6989586621682659962"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-type">evalArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659955"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659959"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2653"></span><span>  </span><span id="local-6989586621682659963"><span class="annot"><a href="#local-6989586621682659963"><span class="hs-identifier hs-var">instrs1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682659960"><span class="hs-identifier hs-type">is32Bit</span></a></span><span>
</span><span id="line-2654"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-type">genCCall32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659956"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659957"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659958"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659962"><span class="hs-identifier hs-type">args'</span></a></span><span>
</span><span id="line-2655"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-type">genCCall64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659956"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659957"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659958"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659962"><span class="hs-identifier hs-type">args'</span></a></span><span>
</span><span id="line-2656"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682659961"><span class="hs-identifier hs-type">instrs0</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659963"><span class="hs-identifier hs-type">instrs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2657"></span><span>
</span><span id="line-2658"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-type">genCCall32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ address of the function to call</span></span><span>
</span><span id="line-2659"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ calling convention</span></span><span>
</span><span id="line-2660"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-2661"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-2662"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2663"></span><span id="genCCall32"><span class="annot"><span class="annottext">genCCall32 :: CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-var hs-var">genCCall32</span></a></span></span><span> </span><span id="local-6989586621682659966"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659966"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682659967"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682659967"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621682659968"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682659968"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682659969"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659969"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2664"></span><span>        </span><span id="local-6989586621682659970"><span class="annot"><a href="#local-6989586621682659970"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2665"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682659971"><span class="annot"><a href="#local-6989586621682659971"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682659970"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-2666"></span><span>            </span><span id="local-6989586621682659972"><span class="annot"><a href="#local-6989586621682659972"><span class="hs-identifier hs-var hs-var">prom_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArg"><span class="hs-identifier hs-var">maybePromoteCArg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659969"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2667"></span><span>
</span><span id="line-2668"></span><span>            </span><span class="hs-comment">-- If the size is smaller than the word, we widen things (see maybePromoteCArg)</span><span>
</span><span id="line-2669"></span><span>            </span><span class="annot"><a href="#local-6989586621682659974"><span class="hs-identifier hs-type">arg_size_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#CmmType"><span class="hs-identifier hs-type">CmmType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2670"></span><span>            </span><span id="local-6989586621682659974"><span class="annot"><a href="#local-6989586621682659974"><span class="hs-identifier hs-var hs-var">arg_size_bytes</span></a></span></span><span> </span><span id="local-6989586621682659975"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659975"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682659975"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.Cmm.Type.html#wordWidth"><span class="hs-identifier hs-var">wordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2671"></span><span>
</span><span id="line-2672"></span><span>            </span><span id="local-6989586621682660000"><span class="annot"><a href="#local-6989586621682660000"><span class="hs-identifier hs-var hs-var">roundTo</span></a></span></span><span> </span><span id="local-6989586621682660001"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660001"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682660002"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660002"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660002"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660001"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660002"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2673"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660002"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660001"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660002"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660001"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span>
</span><span id="line-2675"></span><span>            </span><span class="annot"><a href="#local-6989586621682660004"><span class="hs-identifier hs-type">push_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-comment">{-current argument-}</span><span>
</span><span id="line-2676"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>  </span><span class="hs-comment">-- code</span><span>
</span><span id="line-2677"></span><span>
</span><span id="line-2678"></span><span>            </span><span id="local-6989586621682660004"><span class="annot"><a href="#local-6989586621682660004"><span class="hs-identifier hs-var hs-var">push_arg</span></a></span></span><span>  </span><span id="local-6989586621682660005"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660005"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-comment">-- we don't need the hints on x86</span><span>
</span><span id="line-2679"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2680"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660007"><span class="annot"><a href="#local-6989586621682660007"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660008"><span class="annot"><a href="#local-6989586621682660008"><span class="hs-identifier hs-var">r_hi</span></a></span></span><span> </span><span id="local-6989586621682660009"><span class="annot"><a href="#local-6989586621682660009"><span class="hs-identifier hs-var">r_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660005"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2681"></span><span>                </span><span id="local-6989586621682660010"><span class="annot"><a href="#local-6989586621682660010"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2682"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660010"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-2683"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>       </span><span class="annot"><a href="#local-6989586621682660007"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-2684"></span><span>                               </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660008"><span class="hs-identifier hs-type">r_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660010"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2685"></span><span>                                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660009"><span class="hs-identifier hs-type">r_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660010"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2686"></span><span>                                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660010"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2687"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-2688"></span><span>
</span><span id="line-2689"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2690"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621682660012"><span class="annot"><a href="#local-6989586621682660012"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660013"><span class="annot"><a href="#local-6989586621682660013"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660005"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2691"></span><span>                </span><span id="local-6989586621682660014"><span class="annot"><a href="#local-6989586621682660014"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2692"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660014"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660015"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2693"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660013"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-2694"></span><span>                                </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660015"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-type">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2695"></span><span>                                      </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660014"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660015"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2696"></span><span>                                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660017"><span class="annot"><a href="#local-6989586621682660017"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2697"></span><span>                                                                </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-2698"></span><span>                                                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2699"></span><span>                                          </span><span id="local-6989586621682660018"><span class="annot"><a href="#local-6989586621682660018"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2700"></span><span>                                      </span><span class="hs-keyword">in</span><span>
</span><span id="line-2701"></span><span>
</span><span id="line-2702"></span><span>                                      </span><span class="hs-comment">-- assume SSE2</span><span>
</span><span id="line-2703"></span><span>                                       </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660018"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660012"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660017"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2704"></span><span>
</span><span id="line-2705"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-2706"></span><span>                               </span><span class="hs-special">)</span><span>
</span><span id="line-2707"></span><span>
</span><span id="line-2708"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2709"></span><span>                </span><span class="hs-comment">-- Arguments can be smaller than 32-bit, but we still use @PUSH</span><span>
</span><span id="line-2710"></span><span>                </span><span class="hs-comment">-- II32@ - the usual calling conventions expect integers to be</span><span>
</span><span id="line-2711"></span><span>                </span><span class="hs-comment">-- 4-byte aligned.</span><span>
</span><span id="line-2712"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; NatM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2713"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621682660019"><span class="annot"><a href="#local-6989586621682660019"><span class="hs-identifier hs-var">operand</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660020"><span class="annot"><a href="#local-6989586621682660020"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660005"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2714"></span><span>                </span><span id="local-6989586621682660021"><span class="annot"><a href="#local-6989586621682660021"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2715"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660021"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660015"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2716"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660020"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-2717"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660019"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-2718"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660021"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660015"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2719"></span><span>
</span><span id="line-2720"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-2721"></span><span>                 </span><span id="local-6989586621682660006"><span class="annot"><span class="annottext">arg_ty :: CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var hs-var">arg_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660005"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2722"></span><span>                 </span><span id="local-6989586621682660015"><span class="annot"><span class="annottext">size :: Int
</span><a href="#local-6989586621682660015"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Int
</span><a href="#local-6989586621682659974"><span class="hs-identifier hs-var">arg_size_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660006"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-comment">-- Byte size</span><span>
</span><span id="line-2723"></span><span>
</span><span id="line-2724"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-2725"></span><span>            </span><span class="hs-comment">-- Align stack to 16n for calls, assuming a starting stack</span><span>
</span><span id="line-2726"></span><span>            </span><span class="hs-comment">-- alignment of 16n - word_size on procedure entry. Which we</span><span>
</span><span id="line-2727"></span><span>            </span><span class="hs-comment">-- maintiain. See Note [Stack Alignment on X86] in rts/StgCRun.c.</span><span>
</span><span id="line-2728"></span><span>            </span><span id="local-6989586621682660022"><span class="annot"><a href="#local-6989586621682660022"><span class="hs-identifier hs-var hs-var">sizes</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Int) -&gt; [CmmExpr] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Int
</span><a href="#local-6989586621682659974"><span class="hs-identifier hs-var">arg_size_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; Int) -&gt; (CmmExpr -&gt; CmmType) -&gt; CmmExpr -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682659969"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2729"></span><span>            </span><span id="local-6989586621682660024"><span class="annot"><a href="#local-6989586621682660024"><span class="hs-identifier hs-var hs-var">raw_arg_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682660022"><span class="hs-identifier hs-var">sizes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2730"></span><span>            </span><span id="local-6989586621682660027"><span class="annot"><a href="#local-6989586621682660027"><span class="hs-identifier hs-var hs-var">arg_pad_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682660000"><span class="hs-identifier hs-var">roundTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660024"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660024"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span>
</span><span id="line-2731"></span><span>            </span><span id="local-6989586621682660028"><span class="annot"><a href="#local-6989586621682660028"><span class="hs-identifier hs-var hs-var">tot_arg_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660024"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660027"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682659971"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2732"></span><span>
</span><span id="line-2733"></span><span>
</span><span id="line-2734"></span><span>        </span><span id="local-6989586621682660029"><span class="annot"><a href="#local-6989586621682660029"><span class="hs-identifier hs-var">delta0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2735"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660029"><span class="hs-identifier hs-type">delta0</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660027"><span class="hs-identifier hs-type">arg_pad_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2736"></span><span>
</span><span id="line-2737"></span><span>        </span><span id="local-6989586621682660030"><span class="annot"><a href="#local-6989586621682660030"><span class="hs-identifier hs-var">push_codes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682660004"><span class="hs-identifier hs-type">push_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">reverse</span></span><span> </span><span class="annot"><a href="#local-6989586621682659972"><span class="hs-identifier hs-type">prom_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2738"></span><span>        </span><span id="local-6989586621682660031"><span class="annot"><a href="#local-6989586621682660031"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2739"></span><span>        </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660031"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682660029"><span class="hs-identifier hs-type">delta0</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660028"><span class="hs-identifier hs-type">tot_arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2740"></span><span>
</span><span id="line-2741"></span><span>        </span><span class="hs-comment">-- deal with static vs dynamic call targets</span><span>
</span><span id="line-2742"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660032"><span class="annot"><a href="#local-6989586621682660032"><span class="hs-identifier hs-var">callinsns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660033"><span class="annot"><a href="#local-6989586621682660033"><span class="hs-identifier hs-var">cconv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2743"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682659966"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2744"></span><span>            </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span id="local-6989586621682660034"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660034"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2745"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- ToDo: stdcall arg sizes</span><span>
</span><span id="line-2746"></span><span>                  </span><span class="annot"><span class="annottext">(OrdList Instr, ForeignConvention)
-&gt; NatM (OrdList Instr, ForeignConvention)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Imm Reg -&gt; [Reg] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Either Imm Reg
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682660035"><span class="hs-identifier hs-var">fn_imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682659967"><span class="hs-identifier hs-var">conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2747"></span><span>               </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682660035"><span class="annot"><span class="annottext">fn_imm :: Imm
</span><a href="#local-6989586621682660035"><span class="hs-identifier hs-var hs-var">fn_imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660034"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-2748"></span><span>            </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2749"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660036"><span class="annot"><a href="#local-6989586621682660036"><span class="hs-identifier hs-var">dyn_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660037"><span class="annot"><a href="#local-6989586621682660037"><span class="hs-identifier hs-var">dyn_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682659966"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2750"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord32"><span class="hs-identifier hs-type">isWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-type">cmmExprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659971"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659966"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2751"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660037"><span class="hs-identifier hs-type">dyn_c</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682660036"><span class="hs-identifier hs-type">dyn_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682659967"><span class="hs-identifier hs-type">conv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2752"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660039"><span class="annot"><a href="#local-6989586621682660039"><span class="hs-identifier hs-var hs-var">push_code</span></a></span></span><span>
</span><span id="line-2753"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660027"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2754"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660027"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2755"></span><span>                        </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660029"><span class="hs-identifier hs-var">delta0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660027"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2756"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[OrdList Instr] -&gt; OrdList Instr
forall a. [OrdList a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-var">concatOL</span></a></span><span> </span><span class="annot"><span class="annottext">[OrdList Instr]
</span><a href="#local-6989586621682660030"><span class="hs-identifier hs-var">push_codes</span></a></span><span>
</span><span id="line-2757"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2758"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OrdList Instr] -&gt; OrdList Instr
forall a. [OrdList a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-var">concatOL</span></a></span><span> </span><span class="annot"><span class="annottext">[OrdList Instr]
</span><a href="#local-6989586621682660030"><span class="hs-identifier hs-var">push_codes</span></a></span><span>
</span><span id="line-2759"></span><span>
</span><span id="line-2760"></span><span>              </span><span class="hs-comment">-- Deallocate parameters after call for ccall;</span><span>
</span><span id="line-2761"></span><span>              </span><span class="hs-comment">-- but not for stdcall (callee does it)</span><span>
</span><span id="line-2762"></span><span>              </span><span class="hs-comment">--</span><span>
</span><span id="line-2763"></span><span>              </span><span class="hs-comment">-- We have to pop any stack padding we added</span><span>
</span><span id="line-2764"></span><span>              </span><span class="hs-comment">-- even if we are doing stdcall, though (#5052)</span><span>
</span><span id="line-2765"></span><span>            </span><span id="local-6989586621682660040"><span class="annot"><a href="#local-6989586621682660040"><span class="hs-identifier hs-var hs-var">pop_size</span></a></span></span><span>
</span><span id="line-2766"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#StdCallConv"><span class="hs-identifier hs-var">StdCallConv</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682660033"><span class="hs-identifier hs-var">cconv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660027"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span>
</span><span id="line-2767"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660028"><span class="hs-identifier hs-var">tot_arg_size</span></a></span><span>
</span><span id="line-2768"></span><span>
</span><span id="line-2769"></span><span>            </span><span id="local-6989586621682660042"><span class="annot"><a href="#local-6989586621682660042"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660032"><span class="hs-identifier hs-var">callinsns</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2770"></span><span>                   </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2771"></span><span>                      </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660040"><span class="hs-identifier hs-var">pop_size</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-2772"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660040"><span class="hs-identifier hs-var">pop_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2773"></span><span>                      </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-2774"></span><span>                      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660029"><span class="hs-identifier hs-var">delta0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2775"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-2776"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660029"><span class="hs-identifier hs-type">delta0</span></a></span><span>
</span><span id="line-2777"></span><span>
</span><span id="line-2778"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-2779"></span><span>            </span><span class="hs-comment">-- assign the results, if necessary</span><span>
</span><span id="line-2780"></span><span>            </span><span id="local-6989586621682660043"><span class="annot"><a href="#local-6989586621682660043"><span class="hs-identifier hs-var hs-var">assign_code</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-2781"></span><span>            </span><span class="annot"><a href="#local-6989586621682660043"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682660044"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660044"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2782"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660045"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2783"></span><span>                  </span><span class="hs-comment">-- we assume SSE2</span><span>
</span><span id="line-2784"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660046"><span class="annot"><span class="annottext">tmp_amode :: AddrMode
</span><a href="#local-6989586621682660046"><span class="hs-identifier hs-var hs-var">tmp_amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2785"></span><span>                                                       </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-2786"></span><span>                                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2787"></span><span>                      </span><span id="local-6989586621682660047"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682660047"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660048"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2788"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660049"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2789"></span><span>                                   </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660029"><span class="hs-identifier hs-var">delta0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660049"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2790"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; AddrMode -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#X87Store"><span class="hs-identifier hs-var">X87Store</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660047"><span class="hs-identifier hs-var">fmt</span></a></span><span>  </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660046"><span class="hs-identifier hs-var">tmp_amode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2791"></span><span>                                   </span><span class="hs-comment">-- X87Store only supported for the CDECL ABI</span><span>
</span><span id="line-2792"></span><span>                                   </span><span class="hs-comment">-- NB: This code will need to be</span><span>
</span><span id="line-2793"></span><span>                                   </span><span class="hs-comment">-- revisited once GHC does more work around</span><span>
</span><span id="line-2794"></span><span>                                   </span><span class="hs-comment">-- SIGFPE f</span><span>
</span><span id="line-2795"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660047"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660046"><span class="hs-identifier hs-var">tmp_amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660051"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2796"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660049"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2797"></span><span>                                   </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660029"><span class="hs-identifier hs-var">delta0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2798"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660045"><span class="hs-identifier hs-var">ty</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660051"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2799"></span><span>                                        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660052"><span class="hs-identifier hs-var">r_dest_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2800"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660048"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2801"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2802"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660051"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2803"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-2804"></span><span>                    </span><span id="local-6989586621682660045"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682660045"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660044"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-2805"></span><span>                    </span><span id="local-6989586621682660048"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682660048"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660045"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2806"></span><span>                    </span><span id="local-6989586621682660049"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621682660049"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660048"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2807"></span><span>                    </span><span id="local-6989586621682660052"><span class="annot"><span class="annottext">r_dest_hi :: Reg
</span><a href="#local-6989586621682660052"><span class="hs-identifier hs-var hs-var">r_dest_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#getHiVRegFromLo"><span class="hs-identifier hs-var">getHiVRegFromLo</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660051"><span class="hs-identifier hs-var">r_dest</span></a></span><span>
</span><span id="line-2808"></span><span>                    </span><span id="local-6989586621682660051"><span class="annot"><span class="annottext">r_dest :: Reg
</span><a href="#local-6989586621682660051"><span class="hs-identifier hs-var hs-var">r_dest</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660044"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-2809"></span><span>            </span><span class="annot"><a href="#local-6989586621682660043"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span id="local-6989586621682660055"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682660055"><span class="hs-identifier hs-var">many</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genForeignCall.assign_code - too many return values:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocalReg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682660055"><span class="hs-identifier hs-var">many</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2810"></span><span>
</span><span id="line-2811"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660039"><span class="hs-identifier hs-type">push_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-2812"></span><span>                </span><span class="annot"><a href="#local-6989586621682660042"><span class="hs-identifier hs-type">call</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-2813"></span><span>                </span><span class="annot"><a href="#local-6989586621682660043"><span class="hs-identifier hs-type">assign_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682659968"><span class="hs-identifier hs-type">dest_regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2814"></span><span>
</span><span id="line-2815"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-type">genCCall64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ address of function to call</span></span><span>
</span><span id="line-2816"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ calling convention</span></span><span>
</span><span id="line-2817"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-2818"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-2819"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2820"></span><span id="genCCall64"><span class="annot"><span class="annottext">genCCall64 :: CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-var hs-var">genCCall64</span></a></span></span><span> </span><span id="local-6989586621682660056"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660056"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660057"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682660057"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621682660058"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682660058"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682660059"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660059"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2821"></span><span>    </span><span id="local-6989586621682660060"><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2822"></span><span>    </span><span class="hs-comment">-- load up the register arguments</span><span>
</span><span id="line-2823"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660061"><span class="annot"><a href="#local-6989586621682660061"><span class="hs-identifier hs-var hs-var">prom_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArg"><span class="hs-identifier hs-var">maybePromoteCArg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660059"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2824"></span><span>
</span><span id="line-2825"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-type">load_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2826"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- int regs avail for args</span><span>
</span><span id="line-2827"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- FP regs avail for args</span><span>
</span><span id="line-2828"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>    </span><span class="hs-comment">-- code computing args</span><span>
</span><span id="line-2829"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>    </span><span class="hs-comment">-- code assigning args to ABI regs</span><span>
</span><span id="line-2830"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2831"></span><span>        </span><span class="hs-comment">-- no more regs to use</span><span>
</span><span id="line-2832"></span><span>        </span><span id="local-6989586621682660062"><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-var hs-var">load_args</span></a></span></span><span> </span><span id="local-6989586621682660063"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660063"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682660064"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660064"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660065"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660065"><span class="hs-identifier hs-var">acode</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span>
</span><span id="line-2833"></span><span>            </span><span class="annot"><span class="annottext">([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
-&gt; NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660063"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660064"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660065"><span class="hs-identifier hs-var">acode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2834"></span><span>
</span><span id="line-2835"></span><span>        </span><span class="hs-comment">-- no more args to push</span><span>
</span><span id="line-2836"></span><span>        </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-var">load_args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682660066"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660066"><span class="hs-identifier hs-var">aregs</span></a></span></span><span> </span><span id="local-6989586621682660067"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660067"><span class="hs-identifier hs-var">fregs</span></a></span></span><span> </span><span id="local-6989586621682660068"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660068"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660069"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660069"><span class="hs-identifier hs-var">acode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2837"></span><span>            </span><span class="annot"><span class="annottext">([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
-&gt; NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660066"><span class="hs-identifier hs-var">aregs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660067"><span class="hs-identifier hs-var">fregs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660068"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660069"><span class="hs-identifier hs-var">acode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2838"></span><span>
</span><span id="line-2839"></span><span>        </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-var">load_args</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660070"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682660071"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660071"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660072"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660072"><span class="hs-identifier hs-var">aregs</span></a></span></span><span> </span><span id="local-6989586621682660073"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660073"><span class="hs-identifier hs-var">fregs</span></a></span></span><span> </span><span id="local-6989586621682660074"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660074"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660075"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660075"><span class="hs-identifier hs-var">acode</span></a></span></span><span>
</span><span id="line-2840"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660076"><span class="hs-identifier hs-var">arg_rep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660073"><span class="hs-identifier hs-var">fregs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2841"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660077"><span class="hs-identifier hs-var">push_this_arg</span></a></span><span>
</span><span id="line-2842"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682660078"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660078"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660079"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660079"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2843"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621682660080"><span class="annot"><a href="#local-6989586621682660080"><span class="hs-identifier hs-var">code'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660081"><span class="annot"><a href="#local-6989586621682660081"><span class="hs-identifier hs-var">acode'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; NatM (OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660082"><span class="hs-identifier hs-var">reg_this_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660078"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2844"></span><span>                    </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-type">load_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660071"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660072"><span class="hs-identifier hs-type">aregs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660079"><span class="hs-identifier hs-type">rs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660080"><span class="hs-identifier hs-type">code'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660081"><span class="hs-identifier hs-type">acode'</span></a></span><span>
</span><span id="line-2845"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660072"><span class="hs-identifier hs-var">aregs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2846"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660077"><span class="hs-identifier hs-var">push_this_arg</span></a></span><span>
</span><span id="line-2847"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682660083"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660083"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660084"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660084"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2848"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621682660085"><span class="annot"><a href="#local-6989586621682660085"><span class="hs-identifier hs-var">code'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660086"><span class="annot"><a href="#local-6989586621682660086"><span class="hs-identifier hs-var">acode'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; NatM (OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660082"><span class="hs-identifier hs-var">reg_this_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660083"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2849"></span><span>                    </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-type">load_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660071"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660084"><span class="hs-identifier hs-type">rs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660073"><span class="hs-identifier hs-type">fregs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660085"><span class="hs-identifier hs-type">code'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660086"><span class="hs-identifier hs-type">acode'</span></a></span><span>
</span><span id="line-2850"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-2851"></span><span>
</span><span id="line-2852"></span><span>              </span><span class="hs-comment">-- put arg into the list of stack pushed args</span><span>
</span><span id="line-2853"></span><span>              </span><span id="local-6989586621682660077"><span class="annot"><span class="annottext">push_this_arg :: NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660077"><span class="hs-identifier hs-var hs-var">push_this_arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2854"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682660087"><span class="annot"><a href="#local-6989586621682660087"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660088"><span class="annot"><a href="#local-6989586621682660088"><span class="hs-identifier hs-var">ars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660089"><span class="annot"><a href="#local-6989586621682660089"><span class="hs-identifier hs-var">frs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660090"><span class="annot"><a href="#local-6989586621682660090"><span class="hs-identifier hs-var">code'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660091"><span class="annot"><a href="#local-6989586621682660091"><span class="hs-identifier hs-var">acode'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2855"></span><span>                     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
-&gt; [Reg]
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; OrdList Instr
-&gt; NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660062"><span class="hs-identifier hs-var">load_args</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660071"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660072"><span class="hs-identifier hs-var">aregs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660073"><span class="hs-identifier hs-var">fregs</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660074"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660075"><span class="hs-identifier hs-var">acode</span></a></span><span>
</span><span id="line-2856"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660070"><span class="hs-identifier hs-type">arg</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621682660087"><span class="hs-identifier hs-type">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660088"><span class="hs-identifier hs-type">ars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660089"><span class="hs-identifier hs-type">frs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660090"><span class="hs-identifier hs-type">code'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660091"><span class="hs-identifier hs-type">acode'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2857"></span><span>
</span><span id="line-2858"></span><span>              </span><span class="hs-comment">-- pass the arg into the given register</span><span>
</span><span id="line-2859"></span><span>              </span><span id="local-6989586621682660082"><span class="annot"><span class="annottext">reg_this_arg :: Reg -&gt; NatM (OrdList Instr, OrdList Instr)
</span><a href="#local-6989586621682660082"><span class="hs-identifier hs-var hs-var">reg_this_arg</span></a></span></span><span> </span><span id="local-6989586621682660092"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660092"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-2860"></span><span>                </span><span class="hs-comment">-- &quot;operand&quot; args can be directly assigned into r</span><span>
</span><span id="line-2861"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2862"></span><span>                    </span><span id="local-6989586621682660093"><span class="annot"><a href="#local-6989586621682660093"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2863"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660074"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660075"><span class="hs-identifier hs-type">acode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660093"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660092"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2864"></span><span>                </span><span class="hs-comment">-- The last non-operand arg can be directly assigned after its</span><span>
</span><span id="line-2865"></span><span>                </span><span class="hs-comment">-- computation without going into a temporary register</span><span>
</span><span id="line-2866"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Bool) -&gt; [CmmExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660071"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2867"></span><span>                    </span><span id="local-6989586621682660095"><span class="annot"><a href="#local-6989586621682660095"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2868"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660074"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660095"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660092"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660075"><span class="hs-identifier hs-type">acode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2869"></span><span>
</span><span id="line-2870"></span><span>                </span><span class="hs-comment">-- other args need to be computed beforehand to avoid clobbering</span><span>
</span><span id="line-2871"></span><span>                </span><span class="hs-comment">-- previously assigned registers used to pass parameters (see</span><span>
</span><span id="line-2872"></span><span>                </span><span class="hs-comment">-- #11792, #12614). They are assigned into temporary registers</span><span>
</span><span id="line-2873"></span><span>                </span><span class="hs-comment">-- and get assigned to proper call ABI registers after they all</span><span>
</span><span id="line-2874"></span><span>                </span><span class="hs-comment">-- have been computed.</span><span>
</span><span id="line-2875"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2876"></span><span>                    </span><span id="local-6989586621682660096"><span class="annot"><a href="#local-6989586621682660096"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2877"></span><span>                    </span><span id="local-6989586621682660097"><span class="annot"><a href="#local-6989586621682660097"><span class="hs-identifier hs-var">tmp</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660098"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span>
</span><span id="line-2878"></span><span>                    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2879"></span><span>                      </span><span id="local-6989586621682660099"><span class="annot"><a href="#local-6989586621682660099"><span class="hs-identifier hs-var hs-var">code'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660074"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660096"><span class="hs-identifier hs-var">arg_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660097"><span class="hs-identifier hs-var">tmp</span></a></span><span>
</span><span id="line-2880"></span><span>                      </span><span id="local-6989586621682660100"><span class="annot"><a href="#local-6989586621682660100"><span class="hs-identifier hs-var hs-var">acode'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660075"><span class="hs-identifier hs-var">acode</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#reg2reg"><span class="hs-identifier hs-var">reg2reg</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660098"><span class="hs-identifier hs-var">arg_fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660097"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660092"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2881"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660099"><span class="hs-identifier hs-type">code'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660100"><span class="hs-identifier hs-type">acode'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2882"></span><span>
</span><span id="line-2883"></span><span>              </span><span id="local-6989586621682660076"><span class="annot"><span class="annottext">arg_rep :: CmmType
</span><a href="#local-6989586621682660076"><span class="hs-identifier hs-var hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660070"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2884"></span><span>              </span><span id="local-6989586621682660098"><span class="annot"><span class="annottext">arg_fmt :: Format
</span><a href="#local-6989586621682660098"><span class="hs-identifier hs-var hs-var">arg_fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660076"><span class="hs-identifier hs-var">arg_rep</span></a></span><span>
</span><span id="line-2885"></span><span>
</span><span id="line-2886"></span><span>        </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-type">load_args_win</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2887"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- used int regs</span><span>
</span><span id="line-2888"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- used FP regs</span><span>
</span><span id="line-2889"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (int, FP) regs avail for args</span><span>
</span><span id="line-2890"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2891"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2892"></span><span>        </span><span id="local-6989586621682660101"><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-var hs-var">load_args_win</span></a></span></span><span> </span><span id="local-6989586621682660102"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660102"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682660103"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660103"><span class="hs-identifier hs-var">usedInt</span></a></span></span><span> </span><span id="local-6989586621682660104"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660104"><span class="hs-identifier hs-var">usedFP</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682660105"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660105"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2893"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
-&gt; NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660102"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660103"><span class="hs-identifier hs-var">usedInt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660104"><span class="hs-identifier hs-var">usedFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660105"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2894"></span><span>            </span><span class="hs-comment">-- no more regs to use</span><span>
</span><span id="line-2895"></span><span>        </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-var">load_args_win</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682660106"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660106"><span class="hs-identifier hs-var">usedInt</span></a></span></span><span> </span><span id="local-6989586621682660107"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660107"><span class="hs-identifier hs-var">usedFP</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(Reg, Reg)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660108"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660108"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2896"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
-&gt; NatM ([CmmExpr], [Reg], [Reg], OrdList Instr, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660106"><span class="hs-identifier hs-var">usedInt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660107"><span class="hs-identifier hs-var">usedFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660108"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2897"></span><span>            </span><span class="hs-comment">-- no more args to push</span><span>
</span><span id="line-2898"></span><span>        </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-var">load_args_win</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660109"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660109"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682660110"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660110"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660111"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660111"><span class="hs-identifier hs-var">usedInt</span></a></span></span><span> </span><span id="local-6989586621682660112"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660112"><span class="hs-identifier hs-var">usedFP</span></a></span></span><span>
</span><span id="line-2899"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682660113"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660113"><span class="hs-identifier hs-var">ireg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660114"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660114"><span class="hs-identifier hs-var">freg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682660115"><span class="annot"><span class="annottext">[(Reg, Reg)]
</span><a href="#local-6989586621682660115"><span class="hs-identifier hs-var">regs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660116"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660116"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2900"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660117"><span class="hs-identifier hs-var">arg_rep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2901"></span><span>                 </span><span id="local-6989586621682660118"><span class="annot"><a href="#local-6989586621682660118"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660109"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2902"></span><span>                 </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-type">load_args_win</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660110"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660113"><span class="hs-identifier hs-type">ireg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682660111"><span class="hs-identifier hs-type">usedInt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660114"><span class="hs-identifier hs-type">freg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682660112"><span class="hs-identifier hs-type">usedFP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660115"><span class="hs-identifier hs-type">regs</span></a></span><span>
</span><span id="line-2903"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660116"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-2904"></span><span>                                </span><span class="annot"><a href="#local-6989586621682660118"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660114"><span class="hs-identifier hs-type">freg</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-2905"></span><span>                                </span><span class="hs-comment">-- If we are calling a varargs function</span><span>
</span><span id="line-2906"></span><span>                                </span><span class="hs-comment">-- then we need to define ireg as well</span><span>
</span><span id="line-2907"></span><span>                                </span><span class="hs-comment">-- as freg</span><span>
</span><span id="line-2908"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660114"><span class="hs-identifier hs-type">freg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660113"><span class="hs-identifier hs-type">ireg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2909"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2910"></span><span>                 </span><span id="local-6989586621682660119"><span class="annot"><a href="#local-6989586621682660119"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660109"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2911"></span><span>                 </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-type">load_args_win</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660110"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660113"><span class="hs-identifier hs-type">ireg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682660111"><span class="hs-identifier hs-type">usedInt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660112"><span class="hs-identifier hs-type">usedFP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660115"><span class="hs-identifier hs-type">regs</span></a></span><span>
</span><span id="line-2912"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660116"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660119"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660113"><span class="hs-identifier hs-type">ireg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2913"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-2914"></span><span>              </span><span id="local-6989586621682660117"><span class="annot"><span class="annottext">arg_rep :: CmmType
</span><a href="#local-6989586621682660117"><span class="hs-identifier hs-var hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660109"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2915"></span><span>
</span><span id="line-2916"></span><span>        </span><span id="local-6989586621682660121"><span class="annot"><a href="#local-6989586621682660121"><span class="hs-identifier hs-var hs-var">arg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-comment">-- always, at the mo</span><span>
</span><span id="line-2917"></span><span>
</span><span id="line-2918"></span><span>        </span><span id="local-6989586621682660122"><span class="annot"><a href="#local-6989586621682660122"><span class="hs-identifier hs-var hs-var">push_args</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682660123"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660123"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660123"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-2919"></span><span>        </span><span class="annot"><a href="#local-6989586621682660122"><span class="hs-identifier hs-var">push_args</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660124"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660124"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660125"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660125"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660126"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660126"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2920"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660127"><span class="hs-identifier hs-var">arg_rep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2921"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621682660128"><span class="annot"><a href="#local-6989586621682660128"><span class="hs-identifier hs-var">arg_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660129"><span class="annot"><a href="#local-6989586621682660129"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660124"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2922"></span><span>             </span><span id="local-6989586621682660130"><span class="annot"><a href="#local-6989586621682660130"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2923"></span><span>             </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660130"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660121"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2924"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660131"><span class="annot"><a href="#local-6989586621682660131"><span class="hs-identifier hs-var hs-var">code'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660126"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660129"><span class="hs-identifier hs-var">arg_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2925"></span><span>                            </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.Cmm.Type.html#wordWidth"><span class="hs-identifier hs-var">wordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660121"><span class="hs-identifier hs-var">arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2926"></span><span>                            </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660130"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660121"><span class="hs-identifier hs-var">arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2927"></span><span>                            </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660133"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660128"><span class="hs-identifier hs-var">arg_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2928"></span><span>             </span><span class="annot"><a href="#local-6989586621682660122"><span class="hs-identifier hs-type">push_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660125"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660131"><span class="hs-identifier hs-type">code'</span></a></span><span>
</span><span id="line-2929"></span><span>
</span><span id="line-2930"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2931"></span><span>             </span><span class="hs-comment">-- Arguments can be smaller than 64-bit, but we still use @PUSH</span><span>
</span><span id="line-2932"></span><span>             </span><span class="hs-comment">-- II64@ - the usual calling conventions expect integers to be</span><span>
</span><span id="line-2933"></span><span>             </span><span class="hs-comment">-- 8-byte aligned.</span><span>
</span><span id="line-2934"></span><span>             </span><span class="annot"><span class="annottext">Bool -&gt; NatM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660133"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2935"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621682660135"><span class="annot"><a href="#local-6989586621682660135"><span class="hs-identifier hs-var">arg_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660136"><span class="annot"><a href="#local-6989586621682660136"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660124"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2936"></span><span>             </span><span id="local-6989586621682660137"><span class="annot"><a href="#local-6989586621682660137"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2937"></span><span>             </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660137"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682660121"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2938"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660138"><span class="annot"><a href="#local-6989586621682660138"><span class="hs-identifier hs-var hs-var">code'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660126"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660136"><span class="hs-identifier hs-var">arg_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2939"></span><span>                                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-var">PUSH</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660135"><span class="hs-identifier hs-var">arg_op</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2940"></span><span>                                    </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660137"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660121"><span class="hs-identifier hs-var">arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2941"></span><span>             </span><span class="annot"><a href="#local-6989586621682660122"><span class="hs-identifier hs-type">push_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660125"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660138"><span class="hs-identifier hs-type">code'</span></a></span><span>
</span><span id="line-2942"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-2943"></span><span>              </span><span id="local-6989586621682660127"><span class="annot"><span class="annottext">arg_rep :: CmmType
</span><a href="#local-6989586621682660127"><span class="hs-identifier hs-var hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660124"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2944"></span><span>              </span><span id="local-6989586621682660133"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682660133"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660127"><span class="hs-identifier hs-var">arg_rep</span></a></span><span>
</span><span id="line-2945"></span><span>
</span><span id="line-2946"></span><span>        </span><span id="local-6989586621682660139"><span class="annot"><a href="#local-6989586621682660139"><span class="hs-identifier hs-var hs-var">leaveStackSpace</span></a></span></span><span> </span><span id="local-6989586621682660140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660140"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2947"></span><span>             </span><span id="local-6989586621682660141"><span class="annot"><a href="#local-6989586621682660141"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-var">getDeltaNat</span></a></span><span>
</span><span id="line-2948"></span><span>             </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660141"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660140"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="#local-6989586621682660121"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2949"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2950"></span><span>                         </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660140"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-type">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-type">rsp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2951"></span><span>                         </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660141"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660140"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="#local-6989586621682660121"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2952"></span><span>
</span><span id="line-2953"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682660143"><span class="annot"><a href="#local-6989586621682660143"><span class="hs-identifier hs-var">stack_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660144"><span class="annot"><a href="#local-6989586621682660144"><span class="hs-identifier hs-var">int_regs_used</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660145"><span class="annot"><a href="#local-6989586621682660145"><span class="hs-identifier hs-var">fp_regs_used</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660146"><span class="annot"><a href="#local-6989586621682660146"><span class="hs-identifier hs-var">load_args_code</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660147"><span class="annot"><a href="#local-6989586621682660147"><span class="hs-identifier hs-var">assign_args_code</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2954"></span><span>         </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2955"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-type">platformOS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OSMinGW32</span></span><span>
</span><span id="line-2956"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682660101"><span class="hs-identifier hs-type">load_args_win</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660061"><span class="hs-identifier hs-type">prom_args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#allArgRegs"><span class="hs-identifier hs-type">allArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-2957"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2958"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621682660149"><span class="annot"><a href="#local-6989586621682660149"><span class="hs-identifier hs-var">stack_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660150"><span class="annot"><a href="#local-6989586621682660150"><span class="hs-identifier hs-var">aregs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660151"><span class="annot"><a href="#local-6989586621682660151"><span class="hs-identifier hs-var">fregs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660152"><span class="annot"><a href="#local-6989586621682660152"><span class="hs-identifier hs-var">load_args_code</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660153"><span class="annot"><a href="#local-6989586621682660153"><span class="hs-identifier hs-var">assign_args_code</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2959"></span><span>               </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682660062"><span class="hs-identifier hs-type">load_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660061"><span class="hs-identifier hs-type">prom_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#allIntArgRegs"><span class="hs-identifier hs-type">allIntArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2960"></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#allFPArgRegs"><span class="hs-identifier hs-type">allFPArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2961"></span><span>                                      </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-2962"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660158"><span class="annot"><a href="#local-6989586621682660158"><span class="hs-identifier hs-var hs-var">used_regs</span></a></span></span><span> </span><span id="local-6989586621682660159"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621682660159"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621682660160"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682660160"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#dropTail"><span class="hs-identifier hs-var">dropTail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall a. t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621682660159"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682660160"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-2963"></span><span>               </span><span id="local-6989586621682660163"><span class="annot"><a href="#local-6989586621682660163"><span class="hs-identifier hs-var hs-var">fregs_used</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Reg] -&gt; [Reg] -&gt; [Reg]
forall {t :: * -&gt; *} {a} {a}. Foldable t =&gt; t a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621682660158"><span class="hs-identifier hs-var">used_regs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660151"><span class="hs-identifier hs-var">fregs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allFPArgRegs"><span class="hs-identifier hs-var">allFPArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2964"></span><span>               </span><span id="local-6989586621682660164"><span class="annot"><a href="#local-6989586621682660164"><span class="hs-identifier hs-var hs-var">aregs_used</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Reg] -&gt; [Reg] -&gt; [Reg]
forall {t :: * -&gt; *} {a} {a}. Foldable t =&gt; t a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621682660158"><span class="hs-identifier hs-var">used_regs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660150"><span class="hs-identifier hs-var">aregs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allIntArgRegs"><span class="hs-identifier hs-var">allIntArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2965"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660149"><span class="hs-identifier hs-type">stack_args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660164"><span class="hs-identifier hs-type">aregs_used</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660163"><span class="hs-identifier hs-type">fregs_used</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660152"><span class="hs-identifier hs-type">load_args_code</span></a></span><span>
</span><span id="line-2966"></span><span>                                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660153"><span class="hs-identifier hs-type">assign_args_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2967"></span><span>
</span><span id="line-2968"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2969"></span><span>        </span><span id="local-6989586621682660165"><span class="annot"><a href="#local-6989586621682660165"><span class="hs-identifier hs-var hs-var">arg_regs_used</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660144"><span class="hs-identifier hs-var">int_regs_used</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg] -&gt; [Reg] -&gt; [Reg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660145"><span class="hs-identifier hs-var">fp_regs_used</span></a></span><span>
</span><span id="line-2970"></span><span>        </span><span id="local-6989586621682660166"><span class="annot"><a href="#local-6989586621682660166"><span class="hs-identifier hs-var hs-var">arg_regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Reg] -&gt; [Reg] -&gt; [Reg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660165"><span class="hs-identifier hs-var">arg_regs_used</span></a></span><span>
</span><span id="line-2971"></span><span>                </span><span class="hs-comment">-- for annotating the call instruction with</span><span>
</span><span id="line-2972"></span><span>        </span><span id="local-6989586621682660167"><span class="annot"><a href="#local-6989586621682660167"><span class="hs-identifier hs-var hs-var">sse_regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Reg] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660145"><span class="hs-identifier hs-var">fp_regs_used</span></a></span><span>
</span><span id="line-2973"></span><span>        </span><span id="local-6989586621682660168"><span class="annot"><a href="#local-6989586621682660168"><span class="hs-identifier hs-var hs-var">arg_stack_slots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span>
</span><span id="line-2974"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660143"><span class="hs-identifier hs-var">stack_args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[(Reg, Reg)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [(Reg, Reg)]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allArgRegs"><span class="hs-identifier hs-var">allArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2975"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660143"><span class="hs-identifier hs-var">stack_args</span></a></span><span>
</span><span id="line-2976"></span><span>        </span><span id="local-6989586621682660169"><span class="annot"><a href="#local-6989586621682660169"><span class="hs-identifier hs-var hs-var">tot_arg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660121"><span class="hs-identifier hs-var">arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660168"><span class="hs-identifier hs-var">arg_stack_slots</span></a></span><span>
</span><span id="line-2977"></span><span>
</span><span id="line-2978"></span><span>
</span><span id="line-2979"></span><span>    </span><span class="hs-comment">-- Align stack to 16n for calls, assuming a starting stack</span><span>
</span><span id="line-2980"></span><span>    </span><span class="hs-comment">-- alignment of 16n - word_size on procedure entry. Which we</span><span>
</span><span id="line-2981"></span><span>    </span><span class="hs-comment">-- maintain. See Note [Stack Alignment on X86] in rts/StgCRun.c</span><span>
</span><span id="line-2982"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660170"><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-var hs-var">word_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2983"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682660171"><span class="annot"><a href="#local-6989586621682660171"><span class="hs-identifier hs-var">real_size</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660172"><span class="annot"><a href="#local-6989586621682660172"><span class="hs-identifier hs-var">adjust_rsp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2984"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660169"><span class="hs-identifier hs-type">tot_arg_size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-type">word_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">`rem`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-2985"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660169"><span class="hs-identifier hs-type">tot_arg_size</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2986"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- we need to adjust...</span><span>
</span><span id="line-2987"></span><span>                </span><span id="local-6989586621682660174"><span class="annot"><a href="#local-6989586621682660174"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-2988"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660174"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-type">word_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2989"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660169"><span class="hs-identifier hs-type">tot_arg_size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-type">word_size</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2990"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-type">word_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-type">rsp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2991"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660174"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682660170"><span class="hs-identifier hs-type">word_size</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2992"></span><span>
</span><span id="line-2993"></span><span>    </span><span class="hs-comment">-- push the stack args, right to left</span><span>
</span><span id="line-2994"></span><span>    </span><span id="local-6989586621682660175"><span class="annot"><a href="#local-6989586621682660175"><span class="hs-identifier hs-var">push_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682660122"><span class="hs-identifier hs-type">push_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">reverse</span></span><span> </span><span class="annot"><a href="#local-6989586621682660143"><span class="hs-identifier hs-type">stack_args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-2995"></span><span>    </span><span class="hs-comment">-- On Win64, we also have to leave stack space for the arguments</span><span>
</span><span id="line-2996"></span><span>    </span><span class="hs-comment">-- that we are passing in registers</span><span>
</span><span id="line-2997"></span><span>    </span><span id="local-6989586621682660176"><span class="annot"><a href="#local-6989586621682660176"><span class="hs-identifier hs-var">lss_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-type">platformOS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OSMinGW32</span></span><span>
</span><span id="line-2998"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682660139"><span class="hs-identifier hs-type">leaveStackSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#allArgRegs"><span class="hs-identifier hs-type">allArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660060"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2999"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-3000"></span><span>    </span><span id="local-6989586621682660177"><span class="annot"><a href="#local-6989586621682660177"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3001"></span><span>
</span><span id="line-3002"></span><span>    </span><span class="hs-comment">-- deal with static vs dynamic call targets</span><span>
</span><span id="line-3003"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682660178"><span class="annot"><a href="#local-6989586621682660178"><span class="hs-identifier hs-var">callinsns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660179"><span class="annot"><a href="#local-6989586621682660179"><span class="hs-identifier hs-var">_cconv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660056"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3004"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span id="local-6989586621682660180"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660180"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3005"></span><span>        </span><span class="hs-comment">-- ToDo: stdcall arg sizes</span><span>
</span><span id="line-3006"></span><span>        </span><span class="annot"><span class="annottext">(OrdList Instr, ForeignConvention)
-&gt; NatM (OrdList Instr, ForeignConvention)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Imm Reg -&gt; [Reg] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Either Imm Reg
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660180"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682660166"><span class="hs-identifier hs-var">arg_regs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682660057"><span class="hs-identifier hs-var">conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3007"></span><span>      </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3008"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660181"><span class="annot"><a href="#local-6989586621682660181"><span class="hs-identifier hs-var">dyn_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660182"><span class="annot"><a href="#local-6989586621682660182"><span class="hs-identifier hs-var">dyn_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660056"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-3009"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660182"><span class="hs-identifier hs-type">dyn_c</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682660181"><span class="hs-identifier hs-type">dyn_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660166"><span class="hs-identifier hs-type">arg_regs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660057"><span class="hs-identifier hs-type">conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3010"></span><span>
</span><span id="line-3011"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-3012"></span><span>        </span><span class="hs-comment">-- The x86_64 ABI requires us to set %al to the number of SSE2</span><span>
</span><span id="line-3013"></span><span>        </span><span class="hs-comment">-- registers that contain arguments, if the called routine</span><span>
</span><span id="line-3014"></span><span>        </span><span class="hs-comment">-- is a varargs function.  We don't know whether it's a</span><span>
</span><span id="line-3015"></span><span>        </span><span class="hs-comment">-- varargs function or not, so we have to assume it is.</span><span>
</span><span id="line-3016"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-3017"></span><span>        </span><span class="hs-comment">-- It's not safe to omit this assignment, even if the number</span><span>
</span><span id="line-3018"></span><span>        </span><span class="hs-comment">-- of SSE2 regs in use is zero.  If %al is larger than 8</span><span>
</span><span id="line-3019"></span><span>        </span><span class="hs-comment">-- on entry to a varargs function, seg faults ensue.</span><span>
</span><span id="line-3020"></span><span>        </span><span id="local-6989586621682660183"><span class="annot"><a href="#local-6989586621682660183"><span class="hs-identifier hs-var hs-var">assign_eax</span></a></span></span><span> </span><span id="local-6989586621682660184"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660184"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660184"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3021"></span><span>
</span><span id="line-3022"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660185"><span class="annot"><a href="#local-6989586621682660185"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660178"><span class="hs-identifier hs-var">callinsns</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3023"></span><span>               </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3024"></span><span>                    </span><span class="hs-comment">-- Deallocate parameters after call for ccall;</span><span>
</span><span id="line-3025"></span><span>                    </span><span class="hs-comment">-- stdcall has callee do it, but is not supported on</span><span>
</span><span id="line-3026"></span><span>                    </span><span class="hs-comment">-- x86_64 target (see #3336)</span><span>
</span><span id="line-3027"></span><span>                  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660171"><span class="hs-identifier hs-var">real_size</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-3028"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-var">platformWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660171"><span class="hs-identifier hs-var">real_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3029"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3030"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660177"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660171"><span class="hs-identifier hs-var">real_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3031"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-3032"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660177"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682660171"><span class="hs-identifier hs-type">real_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3033"></span><span>
</span><span id="line-3034"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-3035"></span><span>        </span><span class="hs-comment">-- assign the results, if necessary</span><span>
</span><span id="line-3036"></span><span>        </span><span id="local-6989586621682660187"><span class="annot"><a href="#local-6989586621682660187"><span class="hs-identifier hs-var hs-var">assign_code</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3037"></span><span>        </span><span class="annot"><a href="#local-6989586621682660187"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682660188"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660188"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3038"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660189"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3039"></span><span>                </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660189"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3040"></span><span>                                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#xmm0"><span class="hs-identifier hs-var">xmm0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3041"></span><span>                                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660191"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3042"></span><span>                </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660189"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3043"></span><span>                                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#xmm0"><span class="hs-identifier hs-var">xmm0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3044"></span><span>                                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660191"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3045"></span><span>                </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682660189"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660191"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3046"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-3047"></span><span>                </span><span id="local-6989586621682660189"><span class="annot"><span class="annottext">rep :: CmmType
</span><a href="#local-6989586621682660189"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660188"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-3048"></span><span>                </span><span id="local-6989586621682660191"><span class="annot"><span class="annottext">r_dest :: Reg
</span><a href="#local-6989586621682660191"><span class="hs-identifier hs-var hs-var">r_dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660060"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660188"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3049"></span><span>        </span><span class="annot"><a href="#local-6989586621682660187"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span id="local-6989586621682660193"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682660193"><span class="hs-identifier hs-var">_many</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OrdList Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genForeignCall.assign_code many&quot;</span></span><span>
</span><span id="line-3050"></span><span>
</span><span id="line-3051"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660172"><span class="hs-identifier hs-type">adjust_rsp</span></a></span><span>          </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3052"></span><span>            </span><span class="annot"><a href="#local-6989586621682660175"><span class="hs-identifier hs-type">push_code</span></a></span><span>           </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3053"></span><span>            </span><span class="annot"><a href="#local-6989586621682660146"><span class="hs-identifier hs-type">load_args_code</span></a></span><span>      </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3054"></span><span>            </span><span class="annot"><a href="#local-6989586621682660147"><span class="hs-identifier hs-type">assign_args_code</span></a></span><span>    </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3055"></span><span>            </span><span class="annot"><a href="#local-6989586621682660176"><span class="hs-identifier hs-type">lss_code</span></a></span><span>            </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3056"></span><span>            </span><span class="annot"><a href="#local-6989586621682660183"><span class="hs-identifier hs-type">assign_eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660167"><span class="hs-identifier hs-type">sse_regs</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3057"></span><span>            </span><span class="annot"><a href="#local-6989586621682660185"><span class="hs-identifier hs-type">call</span></a></span><span>                </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3058"></span><span>            </span><span class="annot"><a href="#local-6989586621682660187"><span class="hs-identifier hs-type">assign_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660058"><span class="hs-identifier hs-type">dest_regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3059"></span><span>
</span><span id="line-3060"></span><span>
</span><span id="line-3061"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArg"><span class="hs-identifier hs-type">maybePromoteCArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3062"></span><span id="maybePromoteCArg"><span class="annot"><span class="annottext">maybePromoteCArg :: Platform -&gt; Width -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArg"><span class="hs-identifier hs-var hs-var">maybePromoteCArg</span></a></span></span><span> </span><span id="local-6989586621682660194"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660194"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682660195"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660195"><span class="hs-identifier hs-var">wto</span></a></span></span><span> </span><span id="local-6989586621682660196"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660196"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-3063"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660197"><span class="hs-identifier hs-var">wfrom</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660195"><span class="hs-identifier hs-var">wto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660197"><span class="hs-identifier hs-var">wfrom</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660195"><span class="hs-identifier hs-var">wto</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660196"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3064"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660196"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3065"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3066"></span><span>   </span><span id="local-6989586621682660197"><span class="annot"><span class="annottext">wfrom :: Width
</span><a href="#local-6989586621682660197"><span class="hs-identifier hs-var hs-var">wfrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660194"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660196"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3067"></span><span>
</span><span id="line-3068"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3069"></span><span class="hs-comment">-- Generating a table-branch</span><span>
</span><span id="line-3070"></span><span>
</span><span id="line-3071"></span><span class="hs-comment">{-
Note [Sub-word subtlety during jump-table indexing]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Offset the index by the start index of the jump table.
It's important that we do this *before* the widening below. To see
why, consider a switch with a sub-word, signed discriminant such as:

    switch [-5...+2] x::I16 {
        case -5: ...
        ...
        case +2: ...
    }

Consider what happens if we offset *after* widening in the case that
x=-4:

                                         // x == -4 == 0xfffc::I16
    indexWidened = UU_Conv(x);           // == 0xfffc::I64
    indexExpr    = indexWidened - (-5);  // == 0x10000::I64

This index is clearly nonsense given that the jump table only has
eight entries.

By contrast, if we widen *after* we offset then we get the correct
index (1),

                                         // x == -4 == 0xfffc::I16
    indexOffset  = x - (-5);             // == 1::I16
    indexExpr    = UU_Conv(indexOffset); // == 1::I64

See #21186.
-}</span><span>
</span><span id="line-3103"></span><span>
</span><span id="line-3104"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-type">genSwitch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html#SwitchTargets"><span class="hs-identifier hs-type">SwitchTargets</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3105"></span><span>
</span><span id="line-3106"></span><span id="genSwitch"><span class="annot"><span class="annottext">genSwitch :: CmmExpr -&gt; SwitchTargets -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-var hs-var">genSwitch</span></a></span></span><span> </span><span id="local-6989586621682660198"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660198"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682660199"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682660199"><span class="hs-identifier hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3107"></span><span>  </span><span id="local-6989586621682660200"><span class="annot"><a href="#local-6989586621682660200"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3108"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660201"><span class="annot"><a href="#local-6989586621682660201"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660200"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3109"></span><span>      </span><span id="local-6989586621682660202"><span class="annot"><a href="#local-6989586621682660202"><span class="hs-identifier hs-var hs-var">expr_w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660198"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-3110"></span><span>      </span><span id="local-6989586621682660203"><span class="annot"><a href="#local-6989586621682660203"><span class="hs-identifier hs-var hs-var">indexExpr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int -&gt; CmmExpr
</span><a href="GHC.Cmm.Utils.html#cmmOffset"><span class="hs-identifier hs-var">cmmOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660198"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660205"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-3111"></span><span>      </span><span class="hs-comment">-- We widen to a native-width register because we cannot use arbitrary sizes</span><span>
</span><span id="line-3112"></span><span>      </span><span class="hs-comment">-- in x86 addressing modes.</span><span>
</span><span id="line-3113"></span><span>      </span><span class="hs-comment">-- See Note [Sub-word subtlety during jump-table indexing].</span><span>
</span><span id="line-3114"></span><span>      </span><span id="local-6989586621682660206"><span class="annot"><a href="#local-6989586621682660206"><span class="hs-identifier hs-var hs-var">indexExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span>
</span><span id="line-3115"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660202"><span class="hs-identifier hs-var">expr_w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-var">platformWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3116"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660203"><span class="hs-identifier hs-var">indexExpr0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3117"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPIC"><span class="hs-identifier hs-var">ncgPIC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660200"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-3118"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3119"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660208"><span class="annot"><a href="#local-6989586621682660208"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660209"><span class="annot"><a href="#local-6989586621682660209"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660206"><span class="hs-identifier hs-type">indexExpr</span></a></span><span>
</span><span id="line-3120"></span><span>           </span><span class="hs-comment">-- getNonClobberedReg because it needs to survive across t_code</span><span>
</span><span id="line-3121"></span><span>        </span><span id="local-6989586621682660210"><span class="annot"><a href="#local-6989586621682660210"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span>
</span><span id="line-3122"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660211"><span class="annot"><a href="#local-6989586621682660211"><span class="hs-identifier hs-var hs-var">is32bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3123"></span><span>            </span><span id="local-6989586621682660212"><span class="annot"><a href="#local-6989586621682660212"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3124"></span><span>            </span><span class="hs-comment">-- Might want to use .rodata.&lt;function we're in&gt; instead, but as</span><span>
</span><span id="line-3125"></span><span>            </span><span class="hs-comment">-- long as it's something unique it'll work out since the</span><span>
</span><span id="line-3126"></span><span>            </span><span class="hs-comment">-- references to the jump table are in the appropriate section.</span><span>
</span><span id="line-3127"></span><span>            </span><span id="local-6989586621682660213"><span class="annot"><a href="#local-6989586621682660213"><span class="hs-identifier hs-var hs-var">rosection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621682660212"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3128"></span><span>              </span><span class="hs-comment">-- on Mac OS X/x86_64, put the jump table in the text section to</span><span>
</span><span id="line-3129"></span><span>              </span><span class="hs-comment">-- work around a limitation of the linker.</span><span>
</span><span id="line-3130"></span><span>              </span><span class="hs-comment">-- ld64 is unable to handle the relocations for</span><span>
</span><span id="line-3131"></span><span>              </span><span class="hs-comment">--     .quad L1 - L0</span><span>
</span><span id="line-3132"></span><span>              </span><span class="hs-comment">-- if L0 is not preceded by a non-anonymous label in its section.</span><span>
</span><span id="line-3133"></span><span>              </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSDarwin</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660211"><span class="hs-identifier hs-var">is32bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#Text"><span class="hs-identifier hs-var">Text</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660210"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-3134"></span><span>              </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660210"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-3135"></span><span>        </span><span id="local-6989586621682660216"><span class="annot"><a href="#local-6989586621682660216"><span class="hs-identifier hs-var">dynRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660200"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#DataReference"><span class="hs-identifier hs-type">DataReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660210"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-3136"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660217"><span class="annot"><a href="#local-6989586621682660217"><span class="hs-identifier hs-var">tableReg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660218"><span class="annot"><a href="#local-6989586621682660218"><span class="hs-identifier hs-var">t_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660216"><span class="hs-identifier hs-type">dynRef</span></a></span><span>
</span><span id="line-3137"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660219"><span class="annot"><a href="#local-6989586621682660219"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660217"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3138"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660208"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3139"></span><span>
</span><span id="line-3140"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660209"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660218"><span class="hs-identifier hs-type">t_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3141"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-type">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660201"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660219"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660217"><span class="hs-identifier hs-type">tableReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3142"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-type">JMP_TBL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660217"><span class="hs-identifier hs-type">tableReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660221"><span class="hs-identifier hs-type">ids</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660213"><span class="hs-identifier hs-type">rosection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660210"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-3143"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-3144"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3145"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660222"><span class="annot"><a href="#local-6989586621682660222"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660223"><span class="annot"><a href="#local-6989586621682660223"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660206"><span class="hs-identifier hs-type">indexExpr</span></a></span><span>
</span><span id="line-3146"></span><span>        </span><span id="local-6989586621682660224"><span class="annot"><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span>
</span><span id="line-3147"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660225"><span class="annot"><a href="#local-6989586621682660225"><span class="hs-identifier hs-var hs-var">is32bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3148"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660225"><span class="hs-identifier hs-type">is32bit</span></a></span><span>
</span><span id="line-3149"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660226"><span class="annot"><a href="#local-6989586621682660226"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseNone"><span class="hs-identifier hs-var">EABaseNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660222"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3150"></span><span>                   </span><span id="local-6989586621682660228"><span class="annot"><a href="#local-6989586621682660228"><span class="hs-identifier hs-var hs-var">jmp_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Maybe JumpDest] -&gt; Section -&gt; CLabel -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660226"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682660221"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-3151"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660223"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660228"><span class="hs-identifier hs-type">jmp_code</span></a></span><span>
</span><span id="line-3152"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3153"></span><span>            </span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-3154"></span><span>            </span><span id="local-6989586621682660229"><span class="annot"><a href="#local-6989586621682660229"><span class="hs-identifier hs-var">tableReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660201"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3155"></span><span>            </span><span id="local-6989586621682660230"><span class="annot"><a href="#local-6989586621682660230"><span class="hs-identifier hs-var">targetReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660201"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3156"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660231"><span class="annot"><a href="#local-6989586621682660231"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660229"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660222"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660201"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3157"></span><span>                </span><span id="local-6989586621682660232"><span class="annot"><a href="#local-6989586621682660232"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660223"><span class="hs-identifier hs-var">e_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3158"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660225"><span class="hs-identifier hs-var">is32bit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660229"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3159"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660225"><span class="hs-identifier hs-var">is32bit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660231"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660230"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3160"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Maybe JumpDest] -&gt; Section -&gt; CLabel -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660230"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682660221"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660224"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-3161"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-3162"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660232"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-3163"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682660205"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660205"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660233"><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660233"><span class="hs-identifier hs-var">blockIds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; (Int, [Maybe Label])
</span><a href="GHC.Cmm.Switch.html#switchTargetsToTable"><span class="hs-identifier hs-var">switchTargetsToTable</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682660199"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-3165"></span><span>    </span><span id="local-6989586621682660221"><span class="annot"><span class="annottext">ids :: [Maybe JumpDest]
</span><a href="#local-6989586621682660221"><span class="hs-identifier hs-var hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; Maybe JumpDest)
-&gt; [Maybe Label] -&gt; [Maybe JumpDest]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Label -&gt; JumpDest) -&gt; Maybe Label -&gt; Maybe JumpDest
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; JumpDest
</span><a href="GHC.CmmToAsm.X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660233"><span class="hs-identifier hs-var">blockIds</span></a></span><span>
</span><span id="line-3166"></span><span>
</span><span id="line-3167"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-type">generateJumpTableForInstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3168"></span><span id="generateJumpTableForInstr"><span class="annot"><span class="annottext">generateJumpTableForInstr :: NCGConfig
-&gt; Instr -&gt; Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var hs-var">generateJumpTableForInstr</span></a></span></span><span> </span><span id="local-6989586621682660236"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660236"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-type">JMP_TBL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660237"><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682660237"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682660238"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682660238"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621682660239"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660239"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3169"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660242"><span class="annot"><span class="annottext">getBlockId :: JumpDest -&gt; Label
</span><a href="#local-6989586621682660242"><span class="hs-identifier hs-var hs-var">getBlockId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DestBlockId"><span class="hs-identifier hs-type">DestBlockId</span></a></span><span> </span><span id="local-6989586621682660243"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660243"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660243"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3170"></span><span>          </span><span class="annot"><a href="#local-6989586621682660242"><span class="hs-identifier hs-var">getBlockId</span></a></span><span> </span><span class="annot"><span class="annottext">JumpDest
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-Label target in Jump Table&quot;</span></span><span>
</span><span id="line-3171"></span><span>          </span><span id="local-6989586621682660244"><span class="annot"><span class="annottext">blockIds :: [Maybe Label]
</span><a href="#local-6989586621682660244"><span class="hs-identifier hs-var hs-var">blockIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe JumpDest -&gt; Maybe Label)
-&gt; [Maybe JumpDest] -&gt; [Maybe Label]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(JumpDest -&gt; Label) -&gt; Maybe JumpDest -&gt; Maybe Label
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">JumpDest -&gt; Label
</span><a href="#local-6989586621682660242"><span class="hs-identifier hs-var">getBlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682660237"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-3172"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
-&gt; Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall h g.
NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-var">createJumpTable</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660236"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660244"><span class="hs-identifier hs-var">blockIds</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682660238"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660239"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3173"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var">generateJumpTableForInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3174"></span><span>
</span><span id="line-3175"></span><span id="local-6989586621682656653"><span id="local-6989586621682656654"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-type">createJumpTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span>
</span><span id="line-3176"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#GenCmmDecl"><span class="hs-identifier hs-type">GenCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682656653"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682656654"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-3177"></span><span id="createJumpTable"><span class="annot"><span class="annottext">createJumpTable :: forall h g.
NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-var hs-var">createJumpTable</span></a></span></span><span> </span><span id="local-6989586621682660246"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660246"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682660247"><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660247"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682660248"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682660248"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621682660249"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660249"><span class="hs-identifier hs-var">lbl</span></a></span></span><span>
</span><span id="line-3178"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660250"><span class="annot"><span class="annottext">jumpTable :: [CmmStatic]
</span><a href="#local-6989586621682660250"><span class="hs-identifier hs-var hs-var">jumpTable</span></a></span></span><span>
</span><span id="line-3179"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Bool
</span><a href="GHC.CmmToAsm.Config.html#ncgPIC"><span class="hs-identifier hs-var">ncgPIC</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660246"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3180"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660251"><span class="annot"><span class="annottext">ww :: Width
</span><a href="#local-6989586621682660251"><span class="hs-identifier hs-var hs-var">ww</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660246"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3181"></span><span>                      </span><span id="local-6989586621682660252"><span class="annot"><span class="annottext">jumpTableEntryRel :: Maybe Label -&gt; CmmStatic
</span><a href="#local-6989586621682660252"><span class="hs-identifier hs-var hs-var">jumpTableEntryRel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3182"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660251"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3183"></span><span>                      </span><span class="annot"><a href="#local-6989586621682660252"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660253"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660253"><span class="hs-identifier hs-var">blockid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3184"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CLabel -&gt; Int -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660254"><span class="hs-identifier hs-var">blockLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660249"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660251"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3185"></span><span>                          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682660254"><span class="annot"><span class="annottext">blockLabel :: CLabel
</span><a href="#local-6989586621682660254"><span class="hs-identifier hs-var hs-var">blockLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660253"><span class="hs-identifier hs-var">blockid</span></a></span><span>
</span><span id="line-3186"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; CmmStatic) -&gt; [Maybe Label] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Maybe Label -&gt; CmmStatic
</span><a href="#local-6989586621682660252"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660247"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-3187"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; CmmStatic) -&gt; [Maybe Label] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Maybe Label -&gt; CmmStatic
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var">jumpTableEntry</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660246"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682660247"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-3188"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682660248"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; [CmmStatic] -&gt; RawCmmStatics
forall (rawOnly :: Bool).
CLabel -&gt; [CmmStatic] -&gt; GenCmmStatics rawOnly
</span><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-var">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660249"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmStatic]
</span><a href="#local-6989586621682660250"><span class="hs-identifier hs-var">jumpTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3189"></span><span>
</span><span id="line-3190"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier hs-type">extractUnwindPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier hs-type">UnwindPoint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3191"></span><span id="extractUnwindPoints"><span class="annot"><span class="annottext">extractUnwindPoints :: [Instr] -&gt; [UnwindPoint]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier hs-var hs-var">extractUnwindPoints</span></a></span></span><span> </span><span id="local-6989586621682660255"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660255"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3192"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Map GlobalReg (Maybe UnwindExpr) -&gt; UnwindPoint
</span><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier hs-var">UnwindPoint</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660257"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682660258"><span class="hs-identifier hs-var">unwinds</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span id="local-6989586621682660257"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682660257"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682660258"><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682660258"><span class="hs-identifier hs-var">unwinds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660255"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3193"></span><span>
</span><span id="line-3194"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3195"></span><span class="hs-comment">-- 'condIntReg' and 'condFltReg': condition codes into registers</span><span>
</span><span id="line-3196"></span><span>
</span><span id="line-3197"></span><span class="hs-comment">-- Turn those condition codes into integers now (when they appear on</span><span>
</span><span id="line-3198"></span><span class="hs-comment">-- the right hand side of an assignment).</span><span>
</span><span id="line-3199"></span><span class="hs-comment">--</span><span>
</span><span id="line-3200"></span><span class="hs-comment">-- (If applicable) Do not fill the delay slots here; you will confuse the</span><span>
</span><span id="line-3201"></span><span class="hs-comment">-- register allocator.</span><span>
</span><span id="line-3202"></span><span>
</span><span id="line-3203"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-type">condIntReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3204"></span><span>
</span><span id="line-3205"></span><span id="condIntReg"><span class="annot"><span class="annottext">condIntReg :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var hs-var">condIntReg</span></a></span></span><span> </span><span id="local-6989586621682660259"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660259"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682660260"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660260"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660261"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660261"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3206"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660262"><span class="annot"><a href="#local-6989586621682660262"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682660263"><span class="annot"><a href="#local-6989586621682660263"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var">condIntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660259"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660260"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660261"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3207"></span><span>  </span><span id="local-6989586621682660264"><span class="annot"><a href="#local-6989586621682660264"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-3208"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3209"></span><span>        </span><span id="local-6989586621682660265"><span class="annot"><a href="#local-6989586621682660265"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660266"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660266"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660263"><span class="hs-identifier hs-var">cond_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3210"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660262"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660264"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3211"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660264"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660266"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3212"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-3213"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660265"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3214"></span><span>
</span><span id="line-3215"></span><span>
</span><span id="line-3216"></span><span class="hs-comment">-- Note [SSE Parity Checks]</span><span>
</span><span id="line-3217"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-3218"></span><span class="hs-comment">-- We have to worry about unordered operands (eg. comparisons</span><span>
</span><span id="line-3219"></span><span class="hs-comment">-- against NaN).  If the operands are unordered, the comparison</span><span>
</span><span id="line-3220"></span><span class="hs-comment">-- sets the parity flag, carry flag and zero flag.</span><span>
</span><span id="line-3221"></span><span class="hs-comment">-- All comparisons are supposed to return false for unordered</span><span>
</span><span id="line-3222"></span><span class="hs-comment">-- operands except for !=, which returns true.</span><span>
</span><span id="line-3223"></span><span class="hs-comment">--</span><span>
</span><span id="line-3224"></span><span class="hs-comment">-- Optimisation: we don't have to test the parity flag if we</span><span>
</span><span id="line-3225"></span><span class="hs-comment">-- know the test has already excluded the unordered case: eg &gt;</span><span>
</span><span id="line-3226"></span><span class="hs-comment">-- and &gt;= test for a zero carry flag, which can only occur for</span><span>
</span><span id="line-3227"></span><span class="hs-comment">-- ordered operands.</span><span>
</span><span id="line-3228"></span><span class="hs-comment">--</span><span>
</span><span id="line-3229"></span><span class="hs-comment">-- By reversing comparisons we can avoid testing the parity</span><span>
</span><span id="line-3230"></span><span class="hs-comment">-- for &lt; and &lt;= as well. If any of the arguments is an NaN we</span><span>
</span><span id="line-3231"></span><span class="hs-comment">-- return false either way. If both arguments are valid then</span><span>
</span><span id="line-3232"></span><span class="hs-comment">-- x &lt;= y  &lt;-&gt;  y &gt;= x  holds. So it's safe to swap these.</span><span>
</span><span id="line-3233"></span><span class="hs-comment">--</span><span>
</span><span id="line-3234"></span><span class="hs-comment">-- We invert the condition inside getRegister'and  getCondCode</span><span>
</span><span id="line-3235"></span><span class="hs-comment">-- which should cover all invertable cases.</span><span>
</span><span id="line-3236"></span><span class="hs-comment">-- All other functions translating FP comparisons to assembly</span><span>
</span><span id="line-3237"></span><span class="hs-comment">-- use these to two generate the comparison code.</span><span>
</span><span id="line-3238"></span><span class="hs-comment">--</span><span>
</span><span id="line-3239"></span><span class="hs-comment">-- As an example consider a simple check:</span><span>
</span><span id="line-3240"></span><span class="hs-comment">--</span><span>
</span><span id="line-3241"></span><span class="hs-comment">-- func :: Float -&gt; Float -&gt; Int</span><span>
</span><span id="line-3242"></span><span class="hs-comment">-- func x y = if x &lt; y then 1 else 0</span><span>
</span><span id="line-3243"></span><span class="hs-comment">--</span><span>
</span><span id="line-3244"></span><span class="hs-comment">-- Which in Cmm gives the floating point comparison.</span><span>
</span><span id="line-3245"></span><span class="hs-comment">--</span><span>
</span><span id="line-3246"></span><span class="hs-comment">--  if (%MO_F_Lt_W32(F1, F2)) goto c2gg; else goto c2gf;</span><span>
</span><span id="line-3247"></span><span class="hs-comment">--</span><span>
</span><span id="line-3248"></span><span class="hs-comment">-- We used to compile this to an assembly code block like this:</span><span>
</span><span id="line-3249"></span><span class="hs-comment">-- _c2gh:</span><span>
</span><span id="line-3250"></span><span class="hs-comment">--  ucomiss %xmm2,%xmm1</span><span>
</span><span id="line-3251"></span><span class="hs-comment">--  jp _c2gf</span><span>
</span><span id="line-3252"></span><span class="hs-comment">--  jb _c2gg</span><span>
</span><span id="line-3253"></span><span class="hs-comment">--  jmp _c2gf</span><span>
</span><span id="line-3254"></span><span class="hs-comment">--</span><span>
</span><span id="line-3255"></span><span class="hs-comment">-- Where we have to introduce an explicit</span><span>
</span><span id="line-3256"></span><span class="hs-comment">-- check for unordered results (using jmp parity):</span><span>
</span><span id="line-3257"></span><span class="hs-comment">--</span><span>
</span><span id="line-3258"></span><span class="hs-comment">-- We can avoid this by exchanging the arguments and inverting the direction</span><span>
</span><span id="line-3259"></span><span class="hs-comment">-- of the comparison. This results in the sequence of:</span><span>
</span><span id="line-3260"></span><span class="hs-comment">--</span><span>
</span><span id="line-3261"></span><span class="hs-comment">--  ucomiss %xmm1,%xmm2</span><span>
</span><span id="line-3262"></span><span class="hs-comment">--  ja _c2g2</span><span>
</span><span id="line-3263"></span><span class="hs-comment">--  jmp _c2g1</span><span>
</span><span id="line-3264"></span><span class="hs-comment">--</span><span>
</span><span id="line-3265"></span><span class="hs-comment">-- Removing the jump reduces the pressure on the branch prediction system</span><span>
</span><span id="line-3266"></span><span class="hs-comment">-- and plays better with the uOP cache.</span><span>
</span><span id="line-3267"></span><span>
</span><span id="line-3268"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-type">condFltReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3269"></span><span id="condFltReg"><span class="annot"><span class="annottext">condFltReg :: Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var hs-var">condFltReg</span></a></span></span><span> </span><span id="local-6989586621682660267"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660267"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span id="local-6989586621682660268"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660268"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682660269"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660269"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660270"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660270"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682660271"><span class="hs-identifier hs-var">condFltReg_sse2</span></a></span><span>
</span><span id="line-3270"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3271"></span><span>
</span><span id="line-3272"></span><span>
</span><span id="line-3273"></span><span>  </span><span id="local-6989586621682660271"><span class="annot"><span class="annottext">condFltReg_sse2 :: NatM Register
</span><a href="#local-6989586621682660271"><span class="hs-identifier hs-var hs-var">condFltReg_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3274"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660272"><span class="annot"><a href="#local-6989586621682660272"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682660273"><span class="annot"><a href="#local-6989586621682660273"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660268"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660269"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660270"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3275"></span><span>    </span><span id="local-6989586621682660274"><span class="annot"><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660267"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3276"></span><span>    </span><span id="local-6989586621682660275"><span class="annot"><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660267"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3277"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-3278"></span><span>        </span><span id="local-6989586621682660276"><span class="annot"><a href="#local-6989586621682660276"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660277"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3279"></span><span>           </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660273"><span class="hs-identifier hs-var">cond_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3280"></span><span>             </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660272"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3281"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660278"><span class="hs-identifier hs-var">or_unordered</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3282"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660279"><span class="hs-identifier hs-var">plain_test</span></a></span><span>   </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3283"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660279"><span class="hs-identifier hs-var">plain_test</span></a></span><span>   </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3284"></span><span>                </span><span class="hs-comment">-- Use ASSERT so we don't break releases if these creep in.</span><span>
</span><span id="line-3285"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr) -&gt; OrdList Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3286"></span><span>                       </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660280"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3287"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr) -&gt; OrdList Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3288"></span><span>                       </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660280"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3289"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660280"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660277"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3290"></span><span>
</span><span id="line-3291"></span><span>        </span><span id="local-6989586621682660279"><span class="annot"><a href="#local-6989586621682660279"><span class="hs-identifier hs-var hs-var">plain_test</span></a></span></span><span> </span><span id="local-6989586621682660281"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660281"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3292"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660272"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3293"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660281"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3294"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-3295"></span><span>        </span><span id="local-6989586621682660278"><span class="annot"><a href="#local-6989586621682660278"><span class="hs-identifier hs-var hs-var">or_unordered</span></a></span></span><span> </span><span id="local-6989586621682660282"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660282"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3296"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660272"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3297"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3298"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3299"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660282"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3300"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-3301"></span><span>        </span><span id="local-6989586621682660280"><span class="annot"><a href="#local-6989586621682660280"><span class="hs-identifier hs-var hs-var">and_ordered</span></a></span></span><span> </span><span id="local-6989586621682660283"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660283"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3302"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660272"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3303"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NOTPARITY"><span class="hs-identifier hs-var">NOTPARITY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3304"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660274"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3305"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660275"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660283"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3306"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-3307"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660276"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3308"></span><span>
</span><span id="line-3309"></span><span>
</span><span id="line-3310"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3311"></span><span class="hs-comment">-- 'trivial*Code': deal with trivial instructions</span><span>
</span><span id="line-3312"></span><span>
</span><span id="line-3313"></span><span class="hs-comment">-- Trivial (dyadic: 'trivialCode', floating-point: 'trivialFCode',</span><span>
</span><span id="line-3314"></span><span class="hs-comment">-- unary: 'trivialUCode', unary fl-pt:'trivialUFCode') instructions.</span><span>
</span><span id="line-3315"></span><span class="hs-comment">-- Only look for constants on the right hand side, because that's</span><span>
</span><span id="line-3316"></span><span class="hs-comment">-- where the generic optimizer will have put them.</span><span>
</span><span id="line-3317"></span><span>
</span><span id="line-3318"></span><span class="hs-comment">-- Similarly, for unary instructions, we don't have to worry about</span><span>
</span><span id="line-3319"></span><span class="hs-comment">-- matching an StInt as the argument, because genericOpt will already</span><span>
</span><span id="line-3320"></span><span class="hs-comment">-- have handled the constant-folding.</span><span>
</span><span id="line-3321"></span><span>
</span><span id="line-3322"></span><span>
</span><span id="line-3323"></span><span class="hs-comment">{-
The Rules of the Game are:

* You cannot assume anything about the destination register dst;
  it may be anything, including a fixed reg.

* You may compute an operand into a fixed reg, but you may not
  subsequently change the contents of that fixed reg.  If you
  want to do so, first copy the value either to a temporary
  or into dst.  You are free to modify dst even if it happens
  to be a fixed reg -- that's not your problem.

* You cannot assume that a fixed reg will stay live over an
  arbitrary computation.  The same applies to the dst reg.

* Temporary regs obtained from getNewRegNat are distinct from
  each other and from all other regs, and stay live over
  arbitrary computations.

--------------------

SDM's version of The Rules:

* If getRegister returns Any, that means it can generate correct
  code which places the result in any register, period.  Even if that
  register happens to be read during the computation.

  Corollary #1: this means that if you are generating code for an
  operation with two arbitrary operands, you cannot assign the result
  of the first operand into the destination register before computing
  the second operand.  The second operand might require the old value
  of the destination register.

  Corollary #2: A function might be able to generate more efficient
  code if it knows the destination register is a new temporary (and
  therefore not read by any of the sub-computations).

* If getRegister returns Any, then the code it generates may modify only:
        (a) fresh temporaries
        (b) the destination register
        (c) known registers (eg. %ecx is used by shifts)
  In particular, it may *not* modify global registers, unless the global
  register happens to be the destination register.
-}</span><span>
</span><span id="line-3367"></span><span>
</span><span id="line-3368"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3369"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3370"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3371"></span><span id="trivialCode"><span class="annot"><span class="annottext">trivialCode :: Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var hs-var">trivialCode</span></a></span></span><span> </span><span id="local-6989586621682660284"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660284"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660285"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660285"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682660286"><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682660286"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682660287"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660287"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682660288"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660288"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-3372"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682660289"><span class="annot"><a href="#local-6989586621682660289"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-3373"></span><span>         </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-type">trivialCode'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660289"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660284"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660285"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660286"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660287"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660288"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3374"></span><span>
</span><span id="line-3375"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-type">trivialCode'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3376"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3377"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3378"></span><span id="trivialCode%27"><span class="annot"><span class="annottext">trivialCode' :: Platform
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-var hs-var">trivialCode'</span></a></span></span><span> </span><span id="local-6989586621682660291"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660291"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682660292"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660292"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660293"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660293"><span class="hs-identifier hs-var">revinstr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682660294"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682660294"><span class="hs-identifier hs-var">lit_a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660295"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660295"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-3379"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660291"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682660294"><span class="hs-identifier hs-var">lit_a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3380"></span><span>  </span><span id="local-6989586621682660296"><span class="annot"><a href="#local-6989586621682660296"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660295"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3381"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3382"></span><span>       </span><span id="local-6989586621682660297"><span class="annot"><a href="#local-6989586621682660297"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660298"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660298"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-3383"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660296"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660298"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3384"></span><span>           </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660293"><span class="hs-identifier hs-var">revinstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682660294"><span class="hs-identifier hs-var">lit_a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660298"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3385"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660292"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660297"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3386"></span><span>
</span><span id="line-3387"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-var">trivialCode'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660299"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660299"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660300"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660300"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682660301"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660301"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682660302"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660302"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-3388"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var">genTrivialCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660299"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660300"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660301"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660302"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3389"></span><span>
</span><span id="line-3390"></span><span class="hs-comment">-- This is re-used for floating pt instructions too.</span><span>
</span><span id="line-3391"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-type">genTrivialCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3392"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3393"></span><span id="genTrivialCode"><span class="annot"><span class="annottext">genTrivialCode :: Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var hs-var">genTrivialCode</span></a></span></span><span> </span><span id="local-6989586621682660304"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660304"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682660305"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660305"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682660306"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660306"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682660307"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660307"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3394"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660308"><span class="annot"><a href="#local-6989586621682660308"><span class="hs-identifier hs-var">b_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660309"><span class="annot"><a href="#local-6989586621682660309"><span class="hs-identifier hs-var">b_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660307"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3395"></span><span>  </span><span id="local-6989586621682660310"><span class="annot"><a href="#local-6989586621682660310"><span class="hs-identifier hs-var">a_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660306"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3396"></span><span>  </span><span id="local-6989586621682660311"><span class="annot"><a href="#local-6989586621682660311"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660304"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-3397"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3398"></span><span>     </span><span class="hs-comment">-- We want the value of 'b' to stay alive across the computation of 'a'.</span><span>
</span><span id="line-3399"></span><span>     </span><span class="hs-comment">-- But, we want to calculate 'a' straight into the destination register,</span><span>
</span><span id="line-3400"></span><span>     </span><span class="hs-comment">-- because the instruction only has two operands (dst := dst `op` src).</span><span>
</span><span id="line-3401"></span><span>     </span><span class="hs-comment">-- The troublesome case is when the result of 'b' is in the same register</span><span>
</span><span id="line-3402"></span><span>     </span><span class="hs-comment">-- as the destination 'reg'.  In this case, we have to save 'b' in a</span><span>
</span><span id="line-3403"></span><span>     </span><span class="hs-comment">-- new temporary across the computation of 'a'.</span><span>
</span><span id="line-3404"></span><span>     </span><span id="local-6989586621682660312"><span class="annot"><a href="#local-6989586621682660312"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660313"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-3405"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Operand -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660308"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3406"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660309"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3407"></span><span>                </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660304"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660308"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660311"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3408"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660310"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3409"></span><span>                </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660305"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660311"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3410"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3411"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660309"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3412"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660310"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3413"></span><span>                </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660305"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660308"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660313"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3414"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660304"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660312"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3415"></span><span>
</span><span id="line-3416"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-identifier hs-type">regClashesWithOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3417"></span><span id="local-6989586621682660315"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660315"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="regClashesWithOp"><span class="annot"><span class="annottext">regClashesWithOp :: Reg -&gt; Operand -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var hs-var">`regClashesWithOp`</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span id="local-6989586621682660316"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660316"><span class="hs-identifier hs-var">reg2</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660315"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660316"><span class="hs-identifier hs-var">reg2</span></a></span><span>
</span><span id="line-3418"></span><span id="local-6989586621682660317"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660317"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span id="local-6989586621682660318"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660318"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Bool) -&gt; [Reg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660317"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660318"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3419"></span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3420"></span><span>
</span><span id="line-3421"></span><span class="hs-comment">-- | Generate code for a fused multiply-add operation, of the form @&#177; x * y &#177; z@,</span><span>
</span><span id="line-3422"></span><span class="hs-comment">-- with 3 operands (FMA3 instruction set).</span><span>
</span><span id="line-3423"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-type">genFMA3Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-3424"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span>
</span><span id="line-3425"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3426"></span><span id="genFMA3Code"><span class="annot"><span class="annottext">genFMA3Code :: Width -&gt; FMASign -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-var hs-var">genFMA3Code</span></a></span></span><span> </span><span id="local-6989586621682660319"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660319"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682660320"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682660320"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682660321"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660321"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660322"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660322"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682660323"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660323"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3427"></span><span>  </span><span class="hs-comment">-- For the FMA instruction, we want to compute x * y + z</span><span>
</span><span id="line-3428"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3429"></span><span>  </span><span class="hs-comment">-- There are three possible instructions we could emit:</span><span>
</span><span id="line-3430"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3431"></span><span>  </span><span class="hs-comment">--   - fmadd213 z y x, result in x, z can be a memory address</span><span>
</span><span id="line-3432"></span><span>  </span><span class="hs-comment">--   - fmadd132 x z y, result in y, x can be a memory address</span><span>
</span><span id="line-3433"></span><span>  </span><span class="hs-comment">--   - fmadd231 y x z, result in z, y can be a memory address</span><span>
</span><span id="line-3434"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3435"></span><span>  </span><span class="hs-comment">-- This suggests two possible optimisations:</span><span>
</span><span id="line-3436"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3437"></span><span>  </span><span class="hs-comment">--   - OPTIMISATION 1</span><span>
</span><span id="line-3438"></span><span>  </span><span class="hs-comment">--     If one argument is an address, use the instruction that allows</span><span>
</span><span id="line-3439"></span><span>  </span><span class="hs-comment">--     a memory address in that position.</span><span>
</span><span id="line-3440"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3441"></span><span>  </span><span class="hs-comment">--   - OPTIMISATION 2</span><span>
</span><span id="line-3442"></span><span>  </span><span class="hs-comment">--     If one argument is in a fixed register, use the instruction that puts</span><span>
</span><span id="line-3443"></span><span>  </span><span class="hs-comment">--     the result in that same register.</span><span>
</span><span id="line-3444"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3445"></span><span>  </span><span class="hs-comment">-- Currently we follow neither of these optimisations,</span><span>
</span><span id="line-3446"></span><span>  </span><span class="hs-comment">-- opting to always use fmadd213 for simplicity.</span><span>
</span><span id="line-3447"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3448"></span><span>  </span><span class="hs-comment">-- We would like to compute the result directly into the requested register.</span><span>
</span><span id="line-3449"></span><span>  </span><span class="hs-comment">-- To do so we must first compute `x` into the destination register. This is</span><span>
</span><span id="line-3450"></span><span>  </span><span class="hs-comment">-- only possible if the other arguments don't use the destination register.</span><span>
</span><span id="line-3451"></span><span>  </span><span class="hs-comment">-- We check for this and if there is a conflict we move the result only after</span><span>
</span><span id="line-3452"></span><span>  </span><span class="hs-comment">-- the computation. See #24496 how this went wrong in the past.</span><span>
</span><span id="line-3453"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660324"><span class="annot"><span class="annottext">rep :: Format
</span><a href="#local-6989586621682660324"><span class="hs-identifier hs-var hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660319"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-3454"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660325"><span class="annot"><a href="#local-6989586621682660325"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660326"><span class="annot"><a href="#local-6989586621682660326"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660322"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3455"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660327"><span class="annot"><a href="#local-6989586621682660327"><span class="hs-identifier hs-var">z_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660328"><span class="annot"><a href="#local-6989586621682660328"><span class="hs-identifier hs-var">z_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-type">getNonClobberedOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660323"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-3456"></span><span>  </span><span id="local-6989586621682660329"><span class="annot"><a href="#local-6989586621682660329"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660321"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-3457"></span><span>  </span><span id="local-6989586621682660330"><span class="annot"><a href="#local-6989586621682660330"><span class="hs-identifier hs-var">x_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660324"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-3458"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3459"></span><span>     </span><span id="local-6989586621682660331"><span class="annot"><a href="#local-6989586621682660331"><span class="hs-identifier hs-var hs-var">fma213</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; FMASign -&gt; FMAPermutation -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#FMA3"><span class="hs-identifier hs-var">FMA3</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660324"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682660320"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMAPermutation
</span><a href="GHC.CmmToAsm.X86.Instr.html#FMA213"><span class="hs-identifier hs-var">FMA213</span></a></span><span>
</span><span id="line-3460"></span><span>
</span><span id="line-3461"></span><span>     </span><span class="annot"><a href="#local-6989586621682660334"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660335"><span class="hs-identifier hs-type">code_direct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682660336"><span class="hs-identifier hs-type">code_mov</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3462"></span><span>     </span><span class="hs-comment">-- Ideal: Compute the result directly into dst</span><span>
</span><span id="line-3463"></span><span>     </span><span id="local-6989586621682660335"><span class="annot"><a href="#local-6989586621682660335"><span class="hs-identifier hs-var hs-var">code_direct</span></a></span></span><span> </span><span id="local-6989586621682660337"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660337"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660329"><span class="hs-identifier hs-var">x_code</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660337"><span class="hs-identifier hs-var">dst</span></a></span><span>   </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3464"></span><span>                       </span><span class="annot"><span class="annottext">Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682660331"><span class="hs-identifier hs-var">fma213</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660327"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660325"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660337"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3465"></span><span>     </span><span class="hs-comment">-- Fallback: Compute the result into a tmp reg and then move it.</span><span>
</span><span id="line-3466"></span><span>     </span><span id="local-6989586621682660336"><span class="annot"><a href="#local-6989586621682660336"><span class="hs-identifier hs-var hs-var">code_mov</span></a></span></span><span> </span><span id="local-6989586621682660338"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660338"><span class="hs-identifier hs-var">dst</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660329"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660330"><span class="hs-identifier hs-var">x_tmp</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3467"></span><span>                       </span><span class="annot"><span class="annottext">Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682660331"><span class="hs-identifier hs-var">fma213</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660327"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660325"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660330"><span class="hs-identifier hs-var">x_tmp</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3468"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660324"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660330"><span class="hs-identifier hs-var">x_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660338"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3469"></span><span>
</span><span id="line-3470"></span><span>     </span><span id="local-6989586621682660334"><span class="annot"><a href="#local-6989586621682660334"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660339"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3471"></span><span>         </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660326"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3472"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660328"><span class="hs-identifier hs-var">z_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3473"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660340"><span class="hs-identifier hs-var">arg_regs_conflict</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660336"><span class="hs-identifier hs-var">code_mov</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660335"><span class="hs-identifier hs-var">code_direct</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3474"></span><span>
</span><span id="line-3475"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-3476"></span><span>
</span><span id="line-3477"></span><span>        </span><span id="local-6989586621682660340"><span class="annot"><span class="annottext">arg_regs_conflict :: Bool
</span><a href="#local-6989586621682660340"><span class="hs-identifier hs-var hs-var">arg_regs_conflict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3478"></span><span>          </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660325"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-3479"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660327"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3480"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span id="local-6989586621682660341"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660341"><span class="hs-identifier hs-var">z_reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660341"><span class="hs-identifier hs-var">z_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3481"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span id="local-6989586621682660342"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660342"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660339"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660342"><span class="hs-identifier hs-var">amode</span></a></span><span>
</span><span id="line-3482"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3483"></span><span>
</span><span id="line-3484"></span><span>  </span><span class="hs-comment">-- NB: Computing the result into a desired register using Any can be tricky.</span><span>
</span><span id="line-3485"></span><span>  </span><span class="hs-comment">-- So for now, we keep it simple. (See #24496).</span><span>
</span><span id="line-3486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660324"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660334"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3487"></span><span>
</span><span id="line-3488"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-3489"></span><span>
</span><span id="line-3490"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-type">trivialUCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3491"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3492"></span><span id="trivialUCode"><span class="annot"><span class="annottext">trivialUCode :: Format -&gt; (Operand -&gt; Instr) -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-var hs-var">trivialUCode</span></a></span></span><span> </span><span id="local-6989586621682660343"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660343"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682660344"><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682660344"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682660345"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660345"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3493"></span><span>  </span><span id="local-6989586621682660346"><span class="annot"><a href="#local-6989586621682660346"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660345"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3494"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3495"></span><span>     </span><span id="local-6989586621682660347"><span class="annot"><a href="#local-6989586621682660347"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660348"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660348"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3496"></span><span>        </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660346"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660348"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-3497"></span><span>        </span><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682660344"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660348"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3498"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660343"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660347"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3499"></span><span>
</span><span id="line-3500"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-3501"></span><span>
</span><span id="line-3502"></span><span>
</span><span id="line-3503"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-type">trivialFCode_sse2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3504"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3505"></span><span id="trivialFCode_sse2"><span class="annot"><span class="annottext">trivialFCode_sse2 :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var hs-var">trivialFCode_sse2</span></a></span></span><span> </span><span id="local-6989586621682660349"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660349"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621682660350"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660350"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682660351"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660351"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660352"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660352"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-3506"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var">genTrivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660353"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660350"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660353"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660351"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660352"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3507"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682660353"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682660353"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660349"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-3508"></span><span>
</span><span id="line-3509"></span><span>
</span><span id="line-3510"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3511"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-type">coerceInt2FP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3512"></span><span id="coerceInt2FP"><span class="annot"><span class="annottext">coerceInt2FP :: Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-var hs-var">coerceInt2FP</span></a></span></span><span> </span><span id="local-6989586621682660354"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660354"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682660355"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660355"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682660356"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660356"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682660357"><span class="hs-identifier hs-var">coerce_sse2</span></a></span><span>
</span><span id="line-3513"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3514"></span><span>
</span><span id="line-3515"></span><span>   </span><span id="local-6989586621682660357"><span class="annot"><span class="annottext">coerce_sse2 :: NatM Register
</span><a href="#local-6989586621682660357"><span class="hs-identifier hs-var hs-var">coerce_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3516"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682660358"><span class="annot"><a href="#local-6989586621682660358"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660359"><span class="annot"><a href="#local-6989586621682660359"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660356"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="hs-comment">-- ToDo: could be a safe operand</span><span>
</span><span id="line-3517"></span><span>     </span><span class="hs-keyword">let</span><span>
</span><span id="line-3518"></span><span>           </span><span id="local-6989586621682660360"><span class="annot"><a href="#local-6989586621682660360"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660355"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSI2SS"><span class="hs-identifier hs-var">CVTSI2SS</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSI2SD"><span class="hs-identifier hs-var">CVTSI2SD</span></a></span><span>
</span><span id="line-3519"></span><span>                             </span><span id="local-6989586621682660363"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660363"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr)
-&gt; String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceInt2FP.sse: unhandled width (&quot;</span></span><span>
</span><span id="line-3520"></span><span>                                         </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660363"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-3521"></span><span>           </span><span id="local-6989586621682660364"><span class="annot"><a href="#local-6989586621682660364"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660365"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660365"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660359"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682660360"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660354"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660358"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660365"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3522"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660355"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660364"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3523"></span><span>        </span><span class="hs-comment">-- works even if the destination rep is &lt;II32</span><span>
</span><span id="line-3524"></span><span>
</span><span id="line-3525"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3526"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-type">coerceFP2Int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3527"></span><span id="coerceFP2Int"><span class="annot"><span class="annottext">coerceFP2Int :: Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-var hs-var">coerceFP2Int</span></a></span></span><span> </span><span id="local-6989586621682660366"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660366"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682660367"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660367"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682660368"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660368"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682660369"><span class="hs-identifier hs-var">coerceFP2Int_sse2</span></a></span><span>
</span><span id="line-3528"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3529"></span><span>   </span><span id="local-6989586621682660369"><span class="annot"><span class="annottext">coerceFP2Int_sse2 :: NatM Register
</span><a href="#local-6989586621682660369"><span class="hs-identifier hs-var hs-var">coerceFP2Int_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3530"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682660370"><span class="annot"><a href="#local-6989586621682660370"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660371"><span class="annot"><a href="#local-6989586621682660371"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660368"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="hs-comment">-- ToDo: could be a safe operand</span><span>
</span><span id="line-3531"></span><span>     </span><span class="hs-keyword">let</span><span>
</span><span id="line-3532"></span><span>           </span><span id="local-6989586621682660372"><span class="annot"><a href="#local-6989586621682660372"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660366"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier hs-var">CVTTSS2SIQ</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier hs-var">CVTTSD2SIQ</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-3533"></span><span>                               </span><span id="local-6989586621682660375"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660375"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr)
-&gt; String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceFP2Init.sse: unhandled width (&quot;</span></span><span>
</span><span id="line-3534"></span><span>                                           </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660375"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-3535"></span><span>           </span><span id="local-6989586621682660376"><span class="annot"><a href="#local-6989586621682660376"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660377"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660377"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660371"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682660372"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660367"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660370"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660377"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3536"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660367"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660376"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3537"></span><span>         </span><span class="hs-comment">-- works even if the destination rep is &lt;II32</span><span>
</span><span id="line-3538"></span><span>
</span><span id="line-3539"></span><span>
</span><span id="line-3540"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3541"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-type">coerceFP2FP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3542"></span><span id="coerceFP2FP"><span class="annot"><span class="annottext">coerceFP2FP :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var hs-var">coerceFP2FP</span></a></span></span><span> </span><span id="local-6989586621682660378"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660378"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682660379"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660379"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3543"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660380"><span class="annot"><a href="#local-6989586621682660380"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660381"><span class="annot"><a href="#local-6989586621682660381"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660379"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3544"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3545"></span><span>        </span><span id="local-6989586621682660382"><span class="annot"><a href="#local-6989586621682660382"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660378"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSD2SS"><span class="hs-identifier hs-var">CVTSD2SS</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSS2SD"><span class="hs-identifier hs-var">CVTSS2SD</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-3546"></span><span>                                     </span><span id="local-6989586621682660385"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660385"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Reg -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; String -&gt; Reg -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceFP2FP: unhandled width (&quot;</span></span><span>
</span><span id="line-3547"></span><span>                                                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660385"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-3548"></span><span>        </span><span id="local-6989586621682660386"><span class="annot"><a href="#local-6989586621682660386"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660387"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660387"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660381"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682660382"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660380"><span class="hs-identifier hs-var">x_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660387"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3549"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660378"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660386"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3550"></span><span>
</span><span id="line-3551"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3552"></span><span>
</span><span id="line-3553"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-type">sse2NegCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-3554"></span><span id="sse2NegCode"><span class="annot"><span class="annottext">sse2NegCode :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-var hs-var">sse2NegCode</span></a></span></span><span> </span><span id="local-6989586621682660388"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660388"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682660389"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660389"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3555"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660390"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682660390"><span class="hs-identifier hs-var hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660388"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-3556"></span><span>  </span><span id="local-6989586621682660391"><span class="annot"><a href="#local-6989586621682660391"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660389"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3557"></span><span>  </span><span class="hs-comment">-- This is how gcc does it, so it can't be that bad:</span><span>
</span><span id="line-3558"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3559"></span><span>    </span><span id="local-6989586621682660392"><span class="annot"><a href="#local-6989586621682660392"><span class="hs-identifier hs-var hs-var">const</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660390"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3560"></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x80000000</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-3561"></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x8000000000000000</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-3562"></span><span>      </span><span id="local-6989586621682660393"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682660393"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {a}. Show a =&gt; a -&gt; a
</span><a href="#local-6989586621682660394"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660393"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3563"></span><span>      </span><span id="local-6989586621682660395"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682660395"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {a}. Show a =&gt; a -&gt; a
</span><a href="#local-6989586621682660394"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660395"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3564"></span><span>      </span><span id="local-6989586621682660396"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682660396"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {a}. Show a =&gt; a -&gt; a
</span><a href="#local-6989586621682660394"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660396"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3565"></span><span>      </span><span id="local-6989586621682660397"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682660397"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {a}. Show a =&gt; a -&gt; a
</span><a href="#local-6989586621682660394"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660397"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3566"></span><span>
</span><span id="line-3567"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-3568"></span><span>        </span><span id="local-6989586621682660394"><span class="annot"><span class="annottext">wrongFmt :: a -&gt; a
</span><a href="#local-6989586621682660394"><span class="hs-identifier hs-var hs-var">wrongFmt</span></a></span></span><span> </span><span id="local-6989586621682660402"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660402"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sse2NegCode: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682660402"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3569"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682660403"><span class="annot"><a href="#local-6989586621682660403"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682660404"><span class="annot"><a href="#local-6989586621682660404"><span class="hs-identifier hs-var">amode_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660388"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660392"><span class="hs-identifier hs-type">const</span></a></span><span>
</span><span id="line-3570"></span><span>  </span><span id="local-6989586621682660405"><span class="annot"><a href="#local-6989586621682660405"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660390"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-3571"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3572"></span><span>    </span><span id="local-6989586621682660406"><span class="annot"><a href="#local-6989586621682660406"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660407"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660407"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660391"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660407"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660404"><span class="hs-identifier hs-var">amode_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3573"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660390"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660403"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660405"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3574"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660390"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660405"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660407"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3575"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-3576"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3577"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660390"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660406"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3578"></span><span>
</span><span id="line-3579"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-type">isVecExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3580"></span><span id="isVecExpr"><span class="annot"><span class="annottext">isVecExpr :: CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var hs-var">isVecExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3581"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3582"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Add"><span class="hs-identifier hs-type">MO_V_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3583"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Sub"><span class="hs-identifier hs-type">MO_V_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3584"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Mul"><span class="hs-identifier hs-type">MO_V_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3585"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Quot"><span class="hs-identifier hs-type">MO_VS_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3586"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Rem"><span class="hs-identifier hs-type">MO_VS_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3587"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Neg"><span class="hs-identifier hs-type">MO_VS_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3588"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3589"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3590"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Add"><span class="hs-identifier hs-type">MO_VF_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3591"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Sub"><span class="hs-identifier hs-type">MO_VF_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3592"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Mul"><span class="hs-identifier hs-type">MO_VF_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3593"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Quot"><span class="hs-identifier hs-type">MO_VF_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3594"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Neg"><span class="hs-identifier hs-type">MO_VF_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3595"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682660408"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660408"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660408"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3596"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isVecExpr"><span class="hs-identifier hs-var">isVecExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3597"></span><span>
</span><span id="line-3598"></span><span id="local-6989586621682656590"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-type">needLlvm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682656590"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3599"></span><span id="needLlvm"><span class="annot"><span class="annottext">needLlvm :: forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var hs-var">needLlvm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3600"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; NatM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; NatM a) -&gt; String -&gt; NatM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The native code generator does not support vector&quot;</span></span><span>
</span><span id="line-3601"></span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;instructions. Please use -fllvm.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-3602"></span><span>
</span><span id="line-3603"></span><span class="hs-comment">-- | This works on the invariant that all jumps in the given blocks are required.</span><span>
</span><span id="line-3604"></span><span class="hs-comment">--   Starting from there we try to make a few more jumps redundant by reordering</span><span>
</span><span id="line-3605"></span><span class="hs-comment">--   them.</span><span>
</span><span id="line-3606"></span><span class="hs-comment">--   We depend on the information in the CFG to do so so without a given CFG</span><span>
</span><span id="line-3607"></span><span class="hs-comment">--   we do nothing.</span><span>
</span><span id="line-3608"></span><span id="local-6989586621682656662"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-type">invertCondBranches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ CFG if present</span></span><span>
</span><span id="line-3609"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682656662"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Blocks with info tables</span></span><span>
</span><span id="line-3610"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ List of basic blocks</span></span><span>
</span><span id="line-3611"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-3612"></span><span id="invertCondBranches"><span class="annot"><span class="annottext">invertCondBranches :: forall a.
Maybe CFG
-&gt; LabelMap a -&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-var hs-var">invertCondBranches</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe CFG
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LabelMap a
</span><span class="hs-identifier">_</span></span><span>       </span><span id="local-6989586621682660417"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660417"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660417"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-3613"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-var">invertCondBranches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660418"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682660418"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682660419"><span class="annot"><span class="annottext">LabelMap a
</span><a href="#local-6989586621682660419"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span id="local-6989586621682660420"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660420"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3614"></span><span>    </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682660421"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660420"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-3615"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3616"></span><span>    </span><span class="annot"><a href="#local-6989586621682660421"><span class="hs-identifier hs-type">invert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3617"></span><span>    </span><span id="local-6989586621682660421"><span class="annot"><span class="annottext">invert :: [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682660421"><span class="hs-identifier hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682660422"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660422"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span id="local-6989586621682660423"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660423"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660424"><span class="annot"><span class="annottext">b2 :: NatBasicBlock Instr
</span><a href="#local-6989586621682660424"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682660425"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660425"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660426"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660426"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3618"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">--pprTrace &quot;Block&quot; (ppr lbl1) True,</span><span>
</span><span id="line-3619"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660427"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660427"><span class="hs-identifier hs-var">jmp1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682660428"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660428"><span class="hs-identifier hs-var">jmp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; Maybe (Instr, Instr)
forall a. [a] -&gt; Maybe (a, a)
</span><a href="GHC.Utils.Misc.html#last2"><span class="hs-identifier hs-var">last2</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660423"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-3620"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span id="local-6989586621682660430"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660430"><span class="hs-identifier hs-var">cond1</span></a></span></span><span> </span><span id="local-6989586621682660431"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660431"><span class="hs-identifier hs-var">target1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660427"><span class="hs-identifier hs-var">jmp1</span></a></span><span>
</span><span id="line-3621"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660431"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660425"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-3622"></span><span>      </span><span class="hs-comment">--, pprTrace &quot;CutChance&quot; (ppr b1) True</span><span>
</span><span id="line-3623"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span id="local-6989586621682660432"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660432"><span class="hs-identifier hs-var">target2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660428"><span class="hs-identifier hs-var">jmp2</span></a></span><span>
</span><span id="line-3624"></span><span>      </span><span class="hs-comment">-- We have enough information to check if we can perform the inversion</span><span>
</span><span id="line-3625"></span><span>      </span><span class="hs-comment">-- TODO: We could also check for the last asm instruction which sets</span><span>
</span><span id="line-3626"></span><span>      </span><span class="hs-comment">-- status flags instead. Which I suspect is worse in terms of compiler</span><span>
</span><span id="line-3627"></span><span>      </span><span class="hs-comment">-- performance, but might be applicable to more cases</span><span>
</span><span id="line-3628"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660433"><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660433"><span class="hs-identifier hs-var">edgeInfo1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; CFG -&gt; Maybe EdgeInfo
</span><a href="GHC.CmmToAsm.CFG.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660422"><span class="hs-identifier hs-var">lbl1</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660431"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682660418"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3629"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660435"><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660435"><span class="hs-identifier hs-var">edgeInfo2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; CFG -&gt; Maybe EdgeInfo
</span><a href="GHC.CmmToAsm.CFG.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660422"><span class="hs-identifier hs-var">lbl1</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660432"><span class="hs-identifier hs-var">target2</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682660418"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3630"></span><span>      </span><span class="hs-comment">-- Both jumps come from the same cmm statement</span><span>
</span><span id="line-3631"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660433"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionSource -&gt; TransitionSource -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660435"><span class="hs-identifier hs-var">edgeInfo2</span></a></span><span>
</span><span id="line-3632"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CmmSource"><span class="hs-identifier hs-type">CmmSource</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">trans_cmmNode :: TransitionSource -&gt; CmmNode O C
</span><a href="GHC.CmmToAsm.CFG.html#trans_cmmNode"><span class="hs-identifier hs-var">trans_cmmNode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682660439"><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682660439"><span class="hs-identifier hs-var">cmmCondBranch</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660433"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span>
</span><span id="line-3633"></span><span>
</span><span id="line-3634"></span><span>      </span><span class="hs-comment">--Int comparisons are invertable</span><span>
</span><span id="line-3635"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682660444"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682660444"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682660445"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682660445"><span class="hs-identifier hs-var">_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682660439"><span class="hs-identifier hs-var">cmmCondBranch</span></a></span><span>
</span><span id="line-3636"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; Maybe Width
</span><a href="GHC.Cmm.MachOp.html#maybeIntComparison"><span class="hs-identifier hs-var">maybeIntComparison</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682660444"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-3637"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660447"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660447"><span class="hs-identifier hs-var">invCond</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Maybe Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#maybeInvertCond"><span class="hs-identifier hs-var">maybeInvertCond</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660430"><span class="hs-identifier hs-var">cond1</span></a></span><span>
</span><span id="line-3638"></span><span>
</span><span id="line-3639"></span><span>      </span><span class="hs-comment">--Swap the last two jumps, invert the conditional jumps condition.</span><span>
</span><span id="line-3640"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660449"><span class="annot"><span class="annottext">jumps :: [Instr]
</span><a href="#local-6989586621682660449"><span class="hs-identifier hs-var hs-var">jumps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3641"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3642"></span><span>                </span><span class="hs-comment">-- We are free the eliminate the jmp. So we do so.</span><span>
</span><span id="line-3643"></span><span>                </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; LabelMap a -&gt; Bool
forall a. Label -&gt; LabelMap a -&gt; Bool
</span><a href="GHC.Cmm.Dataflow.Label.html#mapMember"><span class="hs-identifier hs-var">mapMember</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660431"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap a
</span><a href="#local-6989586621682660419"><span class="hs-identifier hs-var">keep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3644"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660447"><span class="hs-identifier hs-var">invCond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660432"><span class="hs-identifier hs-var">target2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3645"></span><span>                </span><span class="hs-comment">-- If the conditional target is unlikely we put the other</span><span>
</span><span id="line-3646"></span><span>                </span><span class="hs-comment">-- target at the front.</span><span>
</span><span id="line-3647"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; EdgeWeight
</span><a href="GHC.CmmToAsm.CFG.html#edgeWeight"><span class="hs-identifier hs-var">edgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660435"><span class="hs-identifier hs-var">edgeInfo2</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeWeight -&gt; EdgeWeight -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; EdgeWeight
</span><a href="GHC.CmmToAsm.CFG.html#edgeWeight"><span class="hs-identifier hs-var">edgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682660433"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span>
</span><span id="line-3648"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660447"><span class="hs-identifier hs-var">invCond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660432"><span class="hs-identifier hs-var">target2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660431"><span class="hs-identifier hs-var">target1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3649"></span><span>                </span><span class="hs-comment">-- Keep things as-is otherwise</span><span>
</span><span id="line-3650"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3651"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660427"><span class="hs-identifier hs-var">jmp1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660428"><span class="hs-identifier hs-var">jmp2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3652"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">--pprTrace &quot;Cutable&quot; (ppr [jmp1,jmp2] &lt;+&gt; text &quot;=&gt;&quot; &lt;+&gt; ppr jumps) $</span><span>
</span><span id="line-3653"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. Label -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660422"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-3654"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Instr] -&gt; [Instr]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#dropTail"><span class="hs-identifier hs-var">dropTail</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660423"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682660449"><span class="hs-identifier hs-var">jumps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3655"></span><span>            </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682660421"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682660424"><span class="hs-identifier hs-var">b2</span></a></span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660426"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3656"></span><span>    </span><span class="annot"><a href="#local-6989586621682660421"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682660452"><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682660452"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682660453"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660453"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682660452"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682660421"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682660453"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-3657"></span><span>    </span><span class="annot"><a href="#local-6989586621682660421"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3658"></span><span>
</span><span id="line-3659"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-type">genAtomicRMW</span></a></span><span>
</span><span id="line-3660"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3661"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-3662"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#AtomicMachOp"><span class="hs-identifier hs-type">AtomicMachOp</span></a></span><span>
</span><span id="line-3663"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-3664"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3665"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3666"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3667"></span><span id="genAtomicRMW"><span class="annot"><span class="annottext">genAtomicRMW :: Label
-&gt; Width
-&gt; AtomicMachOp
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-var hs-var">genAtomicRMW</span></a></span></span><span> </span><span id="local-6989586621682660454"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660454"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660455"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660455"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660456"><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682660456"><span class="hs-identifier hs-var">amop</span></a></span></span><span> </span><span id="local-6989586621682660457"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660457"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660458"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660458"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660459"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660459"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3668"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682660460"><span class="annot"><a href="#local-6989586621682660460"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682660461"><span class="annot"><a href="#local-6989586621682660461"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3669"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682660456"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicMachOp -&gt; [AtomicMachOp] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Add"><span class="hs-identifier hs-var">AMO_Add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Sub"><span class="hs-identifier hs-var">AMO_Sub</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3670"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660458"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-3671"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-var">getSimpleAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660458"><span class="hs-identifier hs-var">addr</span></a></span><span>  </span><span class="hs-comment">-- See genForeignCall for MO_Cmpxchg</span><span>
</span><span id="line-3672"></span><span>    </span><span id="local-6989586621682660464"><span class="annot"><a href="#local-6989586621682660464"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3673"></span><span>    </span><span id="local-6989586621682660466"><span class="annot"><a href="#local-6989586621682660466"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660459"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-3674"></span><span>    </span><span id="local-6989586621682660467"><span class="annot"><a href="#local-6989586621682660467"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-3675"></span><span>
</span><span id="line-3676"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660468"><span class="annot"><a href="#local-6989586621682660468"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660467"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660457"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3677"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682660469"><span class="annot"><a href="#local-6989586621682660469"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660470"><span class="annot"><a href="#local-6989586621682660470"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682660471"><span class="hs-identifier hs-type">op_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660468"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660464"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660460"><span class="hs-identifier hs-type">amode</span></a></span><span>
</span><span id="line-3678"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660461"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660466"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660464"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660469"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682660470"><span class="hs-identifier hs-type">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3679"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3680"></span><span>    </span><span class="hs-comment">-- Code for the operation</span><span>
</span><span id="line-3681"></span><span>    </span><span class="annot"><a href="#local-6989586621682660471"><span class="hs-identifier hs-type">op_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>       </span><span class="hs-comment">-- Destination reg</span><span>
</span><span id="line-3682"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>       </span><span class="hs-comment">-- Register containing argument</span><span>
</span><span id="line-3683"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span>  </span><span class="hs-comment">-- Address of location to mutate</span><span>
</span><span id="line-3684"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: Return Maybe BlockId</span><span>
</span><span id="line-3685"></span><span>    </span><span id="local-6989586621682660471"><span class="annot"><span class="annottext">op_code :: Reg -&gt; Reg -&gt; AddrMode -&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660471"><span class="hs-identifier hs-var hs-var">op_code</span></a></span></span><span> </span><span id="local-6989586621682660472"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660472"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span id="local-6989586621682660473"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682660474"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660474"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682660456"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3686"></span><span>        </span><span class="hs-comment">-- In the common case where dst_r is a virtual register the</span><span>
</span><span id="line-3687"></span><span>        </span><span class="hs-comment">-- final move should go away, because it's the last use of arg</span><span>
</span><span id="line-3688"></span><span>        </span><span class="hs-comment">-- and the first use of dst_r.</span><span>
</span><span id="line-3689"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Add"><span class="hs-identifier hs-var">AMO_Add</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label))
-&gt; (OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660474"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3690"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660472"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3691"></span><span>                                   </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660454"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3692"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Sub"><span class="hs-identifier hs-var">AMO_Sub</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label))
-&gt; (OrdList Instr, Label) -&gt; NatM (OrdList Instr, Label)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3693"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660474"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3694"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660473"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660472"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3695"></span><span>                                   </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660454"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3696"></span><span>        </span><span class="hs-comment">-- In these cases we need a new block id, and have to return it so</span><span>
</span><span id="line-3697"></span><span>        </span><span class="hs-comment">-- that later instruction selection can reference it.</span><span>
</span><span id="line-3698"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_And"><span class="hs-identifier hs-var">AMO_And</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660478"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682660479"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660479"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660480"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660480"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660479"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660480"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3699"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Nand"><span class="hs-identifier hs-var">AMO_Nand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660478"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682660482"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660482"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660483"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660483"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660482"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660483"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3700"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660483"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3701"></span><span>                                                    </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3702"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Or"><span class="hs-identifier hs-var">AMO_Or</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660478"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682660485"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660485"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660486"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660486"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660485"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660486"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3703"></span><span>        </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Xor"><span class="hs-identifier hs-var">AMO_Xor</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660478"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682660488"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660488"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660489"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660489"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660488"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660489"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3704"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-3705"></span><span>        </span><span class="hs-comment">-- Simulate operation that lacks a dedicated instruction using</span><span>
</span><span id="line-3706"></span><span>        </span><span class="hs-comment">-- cmpxchg.</span><span>
</span><span id="line-3707"></span><span>        </span><span class="annot"><a href="#local-6989586621682660478"><span class="hs-identifier hs-type">cmpxchg_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3708"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3709"></span><span>        </span><span id="local-6989586621682660478"><span class="annot"><span class="annottext">cmpxchg_code :: (Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr, Label)
</span><a href="#local-6989586621682660478"><span class="hs-identifier hs-var hs-var">cmpxchg_code</span></a></span></span><span> </span><span id="local-6989586621682660490"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682660490"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3710"></span><span>            </span><span id="local-6989586621682660491"><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Label
</span><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-var">getBlockIdNat</span></a></span><span>
</span><span id="line-3711"></span><span>            </span><span id="local-6989586621682660492"><span class="annot"><a href="#local-6989586621682660492"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-3712"></span><span>            </span><span id="local-6989586621682660493"><span class="annot"><a href="#local-6989586621682660493"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3713"></span><span>
</span><span id="line-3714"></span><span>            </span><span class="hs-comment">--Record inserted blocks</span><span>
</span><span id="line-3715"></span><span>            </span><span class="hs-comment">--  We turn A -&gt; B into A -&gt; A' -&gt; A'' -&gt; B</span><span>
</span><span id="line-3716"></span><span>            </span><span class="hs-comment">--  with a self loop on A'.</span><span>
</span><span id="line-3717"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-type">addImmediateSuccessorNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660454"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-3718"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-type">addImmediateSuccessorNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660492"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-3719"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-3720"></span><span>
</span><span id="line-3721"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-3722"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660474"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3723"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-type">ALWAYS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-3724"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-3725"></span><span>                  </span><span class="hs-comment">-- Keep old value so we can return it:</span><span>
</span><span id="line-3726"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660472"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3727"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660493"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3728"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-3729"></span><span>                </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660490"><span class="hs-identifier hs-type">instrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660473"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660493"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-3730"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-type">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-type">CMPXCHG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660465"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660493"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660474"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3731"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660491"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-3732"></span><span>                </span><span class="hs-comment">-- See Note [Introducing cfg edges inside basic blocks]</span><span>
</span><span id="line-3733"></span><span>                </span><span class="hs-comment">-- why this basic block is required.</span><span>
</span><span id="line-3734"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-type">ALWAYS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660492"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-3735"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660492"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-3736"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3737"></span><span>                </span><span class="annot"><a href="#local-6989586621682660492"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3738"></span><span>    </span><span id="local-6989586621682660465"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682660465"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660455"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-3739"></span><span>
</span><span id="line-3740"></span><span class="annot"><span class="hs-comment">-- | Count trailing zeroes</span></span><span>
</span><span id="line-3741"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-type">genCtz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3742"></span><span id="genCtz"><span class="annot"><span class="annottext">genCtz :: Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-var hs-var">genCtz</span></a></span></span><span> </span><span id="local-6989586621682660496"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660496"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660497"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660497"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660498"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660498"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660499"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660499"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3743"></span><span>  </span><span id="local-6989586621682660500"><span class="annot"><a href="#local-6989586621682660500"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-3744"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660500"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682660497"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span>
</span><span id="line-3745"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-type">genCtz64_32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660496"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660498"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660499"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-3746"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-type">genCtzGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660497"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660498"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660499"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-3747"></span><span>
</span><span id="line-3748"></span><span class="hs-comment">-- | Count trailing zeroes</span><span>
</span><span id="line-3749"></span><span class="hs-comment">--</span><span>
</span><span id="line-3750"></span><span class="hs-comment">-- 64-bit width on 32-bit architecture</span><span>
</span><span id="line-3751"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-type">genCtz64_32</span></a></span><span>
</span><span id="line-3752"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3753"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-3754"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3755"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3756"></span><span id="genCtz64_32"><span class="annot"><span class="annottext">genCtz64_32 :: Label -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-var hs-var">genCtz64_32</span></a></span></span><span> </span><span id="local-6989586621682660503"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660503"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660504"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660504"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660505"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660505"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3757"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660506"><span class="annot"><a href="#local-6989586621682660506"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682660507"><span class="annot"><a href="#local-6989586621682660507"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682660508"><span class="annot"><a href="#local-6989586621682660508"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660505"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3758"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660509"><span class="annot"><a href="#local-6989586621682660509"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660504"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3759"></span><span>  </span><span id="local-6989586621682660510"><span class="annot"><a href="#local-6989586621682660510"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-3760"></span><span>  </span><span id="local-6989586621682660511"><span class="annot"><a href="#local-6989586621682660511"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-3761"></span><span>  </span><span id="local-6989586621682660512"><span class="annot"><a href="#local-6989586621682660512"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-3762"></span><span>
</span><span id="line-3763"></span><span>  </span><span class="hs-comment">-- New CFG Edges:</span><span>
</span><span id="line-3764"></span><span>  </span><span class="hs-comment">--  bid -&gt; lbl2</span><span>
</span><span id="line-3765"></span><span>  </span><span class="hs-comment">--  bid -&gt; lbl1 -&gt; lbl2</span><span>
</span><span id="line-3766"></span><span>  </span><span class="hs-comment">--  We also changes edges originating at bid to start at lbl2 instead.</span><span>
</span><span id="line-3767"></span><span>  </span><span id="local-6989586621682660513"><span class="annot"><a href="#local-6989586621682660513"><span class="hs-identifier hs-var">weights</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-type">getCfgWeights</span></a></span><span>
</span><span id="line-3768"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660503"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660510"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><span class="hs-number">110</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span>
</span><span id="line-3769"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660510"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660511"><span class="hs-identifier hs-type">lbl2</span></a></span><span> </span><span class="annot"><span class="hs-number">110</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span>
</span><span id="line-3770"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addImmediateSuccessor"><span class="hs-identifier hs-type">addImmediateSuccessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660513"><span class="hs-identifier hs-type">weights</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660503"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660511"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3771"></span><span>
</span><span id="line-3772"></span><span>  </span><span class="hs-comment">-- The following instruction sequence corresponds to the pseudo-code</span><span>
</span><span id="line-3773"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3774"></span><span>  </span><span class="hs-comment">--  if (src) {</span><span>
</span><span id="line-3775"></span><span>  </span><span class="hs-comment">--    dst = src.lo32 ? BSF(src.lo32) : (BSF(src.hi32) + 32);</span><span>
</span><span id="line-3776"></span><span>  </span><span class="hs-comment">--  } else {</span><span>
</span><span id="line-3777"></span><span>  </span><span class="hs-comment">--    dst = 64;</span><span>
</span><span id="line-3778"></span><span>  </span><span class="hs-comment">--  }</span><span>
</span><span id="line-3779"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660515"><span class="annot"><a href="#local-6989586621682660515"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660506"><span class="hs-identifier hs-var">vcode</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3780"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660507"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660512"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3781"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>       </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660508"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660512"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3782"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660509"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3783"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span>    </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660511"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-3784"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660510"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-3785"></span><span>
</span><span id="line-3786"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span>   </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660510"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-3787"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660507"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660509"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3788"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660509"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3789"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660508"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660512"><span class="hs-identifier hs-var">tmp_r</span></a></span><span>
</span><span id="line-3790"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660512"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660509"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3791"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660511"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-3792"></span><span>
</span><span id="line-3793"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span>   </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660511"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-3794"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3795"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660515"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682660511"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3796"></span><span>
</span><span id="line-3797"></span><span class="hs-comment">-- | Count trailing zeroes</span><span>
</span><span id="line-3798"></span><span class="hs-comment">--</span><span>
</span><span id="line-3799"></span><span class="hs-comment">-- Generic case (width &lt;= word size)</span><span>
</span><span id="line-3800"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-type">genCtzGeneric</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3801"></span><span id="genCtzGeneric"><span class="annot"><span class="annottext">genCtzGeneric :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-var hs-var">genCtzGeneric</span></a></span></span><span> </span><span id="local-6989586621682660518"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660519"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660519"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660520"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660520"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3802"></span><span>  </span><span id="local-6989586621682660521"><span class="annot"><a href="#local-6989586621682660521"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660520"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3803"></span><span>  </span><span id="local-6989586621682660522"><span class="annot"><a href="#local-6989586621682660522"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-3804"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660523"><span class="annot"><a href="#local-6989586621682660523"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-3805"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660524"><span class="annot"><a href="#local-6989586621682660524"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660519"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-3806"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660522"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-3807"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3808"></span><span>      </span><span id="local-6989586621682660527"><span class="annot"><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660518"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3809"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660528"><span class="annot"><a href="#local-6989586621682660528"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-identifier hs-var">appOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660521"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr) -&gt; OrdList Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3810"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3811"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFFFF00</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3812"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3813"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-3814"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3815"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3816"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3817"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-3818"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660527"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3819"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660528"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-3820"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3821"></span><span>      </span><span class="hs-comment">-- The following insn sequence makes sure 'ctz 0' has a defined value.</span><span>
</span><span id="line-3822"></span><span>      </span><span class="hs-comment">-- starting with Haswell, one could use the TZCNT insn instead.</span><span>
</span><span id="line-3823"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660530"><span class="annot"><a href="#local-6989586621682660530"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-3824"></span><span>      </span><span id="local-6989586621682660531"><span class="annot"><a href="#local-6989586621682660531"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660530"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3825"></span><span>      </span><span id="local-6989586621682660532"><span class="annot"><a href="#local-6989586621682660532"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660530"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3826"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660533"><span class="annot"><a href="#local-6989586621682660533"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660521"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660531"><span class="hs-identifier hs-var">src_r</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3827"></span><span>               </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660531"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660531"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660518"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3828"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660530"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660531"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660532"><span class="hs-identifier hs-var">tmp_r</span></a></span><span>
</span><span id="line-3829"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660523"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3830"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660530"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660532"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660524"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-3831"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NB: We don't need to zero-extend the result for the</span><span>
</span><span id="line-3832"></span><span>                   </span><span class="hs-comment">-- W8/W16 cases because the 'MOV' insn already</span><span>
</span><span id="line-3833"></span><span>                   </span><span class="hs-comment">-- took care of implicitly clearing the upper bits</span><span>
</span><span id="line-3834"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660533"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-3835"></span><span>
</span><span id="line-3836"></span><span>
</span><span id="line-3837"></span><span>
</span><span id="line-3838"></span><span class="hs-comment">-- | Copy memory</span><span>
</span><span id="line-3839"></span><span class="hs-comment">--</span><span>
</span><span id="line-3840"></span><span class="hs-comment">-- Unroll memcpy calls if the number of bytes to copy isn't too large (cf</span><span>
</span><span id="line-3841"></span><span class="hs-comment">-- ncgInlineThresholdMemcpy).  Otherwise, call C's memcpy.</span><span>
</span><span id="line-3842"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-type">genMemCpy</span></a></span><span>
</span><span id="line-3843"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3844"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3845"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3846"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3847"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3848"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3849"></span><span id="genMemCpy"><span class="annot"><span class="annottext">genMemCpy :: Label
-&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-var hs-var">genMemCpy</span></a></span></span><span> </span><span id="local-6989586621682660534"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660534"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660535"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682660536"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660536"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660537"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660537"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660538"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660538"><span class="hs-identifier hs-var">arg_n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3850"></span><span>
</span><span id="line-3851"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660539"><span class="annot"><span class="annottext">libc_memcpy :: NatM (OrdList Instr)
</span><a href="#local-6989586621682660539"><span class="hs-identifier hs-var hs-var">libc_memcpy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660534"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memcpy&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660536"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660537"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660538"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3852"></span><span>
</span><span id="line-3853"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660538"><span class="hs-identifier hs-var">arg_n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3854"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682660540"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660540"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3855"></span><span>      </span><span class="hs-comment">-- try to inline it</span><span>
</span><span id="line-3856"></span><span>      </span><span id="local-6989586621682660541"><span class="annot"><a href="#local-6989586621682660541"><span class="hs-identifier hs-var">mcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; NatM (Maybe (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-var">genMemCpyInlineMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660535"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660536"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660537"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660540"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3857"></span><span>      </span><span class="hs-comment">-- if it didn't inline, call the C function</span><span>
</span><span id="line-3858"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660541"><span class="hs-identifier hs-type">mcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3859"></span><span>        </span><span class="annot"><span class="annottext">Maybe (OrdList Instr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM (OrdList Instr)
</span><a href="#local-6989586621682660539"><span class="hs-identifier hs-var">libc_memcpy</span></a></span><span>
</span><span id="line-3860"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660543"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660543"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660543"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-3861"></span><span>
</span><span id="line-3862"></span><span>    </span><span class="hs-comment">-- not a literal size argument: call the C function</span><span>
</span><span id="line-3863"></span><span>    </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM (OrdList Instr)
</span><a href="#local-6989586621682660539"><span class="hs-identifier hs-var">libc_memcpy</span></a></span><span>
</span><span id="line-3864"></span><span>
</span><span id="line-3865"></span><span>
</span><span id="line-3866"></span><span>
</span><span id="line-3867"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-type">genMemCpyInlineMaybe</span></a></span><span>
</span><span id="line-3868"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3869"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3870"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3871"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3872"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3873"></span><span id="genMemCpyInlineMaybe"><span class="annot"><span class="annottext">genMemCpyInlineMaybe :: Int
-&gt; CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; NatM (Maybe (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-var hs-var">genMemCpyInlineMaybe</span></a></span></span><span> </span><span id="local-6989586621682660544"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660544"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682660545"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660545"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660546"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660546"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660547"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660547"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3874"></span><span>  </span><span id="local-6989586621682660548"><span class="annot"><a href="#local-6989586621682660548"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3875"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3876"></span><span>    </span><span id="local-6989586621682660549"><span class="annot"><a href="#local-6989586621682660549"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660548"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3877"></span><span>    </span><span id="local-6989586621682660550"><span class="annot"><a href="#local-6989586621682660550"><span class="hs-identifier hs-var hs-var">maxAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Alignment
</span><a href="GHC.Platform.html#wordAlignment"><span class="hs-identifier hs-var">wordAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660549"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3878"></span><span>                   </span><span class="hs-comment">-- only machine word wide MOVs are supported</span><span>
</span><span id="line-3879"></span><span>    </span><span id="local-6989586621682660552"><span class="annot"><a href="#local-6989586621682660552"><span class="hs-identifier hs-var hs-var">effectiveAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Alignment -&gt; Alignment
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#alignmentOf"><span class="hs-identifier hs-var">alignmentOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660544"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682660550"><span class="hs-identifier hs-var">maxAlignment</span></a></span><span>
</span><span id="line-3880"></span><span>    </span><span id="local-6989586621682660555"><span class="annot"><a href="#local-6989586621682660555"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; (Int -&gt; Width) -&gt; Int -&gt; Format
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width
</span><a href="GHC.Cmm.Type.html#widthFromBytes"><span class="hs-identifier hs-var">widthFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Int
</span><a href="GHC.Types.Basic.html#alignmentBytes"><span class="hs-identifier hs-var">alignmentBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682660552"><span class="hs-identifier hs-var">effectiveAlignment</span></a></span><span>
</span><span id="line-3881"></span><span>
</span><span id="line-3882"></span><span>
</span><span id="line-3883"></span><span>  </span><span class="hs-comment">-- The size of each move, in bytes.</span><span>
</span><span id="line-3884"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682660558"><span class="hs-identifier hs-type">sizeBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3885"></span><span>      </span><span id="local-6989586621682660558"><span class="annot"><a href="#local-6989586621682660558"><span class="hs-identifier hs-var hs-var">sizeBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Int
</span><a href="GHC.CmmToAsm.Format.html#formatInBytes"><span class="hs-identifier hs-var">formatInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660555"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3886"></span><span>
</span><span id="line-3887"></span><span>  </span><span class="hs-comment">-- The number of instructions we will generate (approx). We need 2</span><span>
</span><span id="line-3888"></span><span>  </span><span class="hs-comment">-- instructions per move.</span><span>
</span><span id="line-3889"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660560"><span class="annot"><a href="#local-6989586621682660560"><span class="hs-identifier hs-var hs-var">insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660558"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660558"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3890"></span><span>
</span><span id="line-3891"></span><span>      </span><span class="annot"><a href="#local-6989586621682660562"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-3892"></span><span>      </span><span id="local-6989586621682660562"><span class="annot"><a href="#local-6989586621682660562"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682660563"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660564"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660565"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span id="local-6989586621682660566"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-3893"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660558"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3894"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660555"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660567"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3895"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660555"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660568"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3896"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660562"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660558"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3897"></span><span>          </span><span class="hs-comment">-- Deal with remaining bytes.</span><span>
</span><span id="line-3898"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- Will never happen on 32-bit</span><span>
</span><span id="line-3899"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660567"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3900"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660568"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3901"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660562"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-3902"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3903"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660567"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3904"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660568"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3905"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660562"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-3906"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3907"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660567"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3908"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660568"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3909"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660562"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660565"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-3910"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3911"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-3912"></span><span>          </span><span id="local-6989586621682660567"><span class="annot"><span class="annottext">src_addr :: AddrMode
</span><a href="#local-6989586621682660567"><span class="hs-identifier hs-var hs-var">src_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660564"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-3913"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3914"></span><span>
</span><span id="line-3915"></span><span>          </span><span id="local-6989586621682660568"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682660568"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660563"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-3916"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660566"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3917"></span><span>
</span><span id="line-3918"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660560"><span class="hs-identifier hs-type">insns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgInlineThresholdMemcpy"><span class="hs-identifier hs-var">ncgInlineThresholdMemcpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660548"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3919"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-3920"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3921"></span><span>      </span><span id="local-6989586621682660570"><span class="annot"><a href="#local-6989586621682660570"><span class="hs-identifier hs-var">code_dst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660545"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-3922"></span><span>      </span><span id="local-6989586621682660571"><span class="annot"><a href="#local-6989586621682660571"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660555"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3923"></span><span>      </span><span id="local-6989586621682660572"><span class="annot"><a href="#local-6989586621682660572"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660546"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-3924"></span><span>      </span><span id="local-6989586621682660573"><span class="annot"><a href="#local-6989586621682660573"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660555"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3925"></span><span>      </span><span id="local-6989586621682660574"><span class="annot"><a href="#local-6989586621682660574"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660555"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-3926"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660570"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660571"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660572"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660573"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3927"></span><span>                      </span><span class="annot"><a href="#local-6989586621682660562"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660571"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660573"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660574"><span class="hs-identifier hs-type">tmp_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682660547"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3928"></span><span>
</span><span id="line-3929"></span><span class="hs-comment">-- | Set memory to the given byte</span><span>
</span><span id="line-3930"></span><span class="hs-comment">--</span><span>
</span><span id="line-3931"></span><span class="hs-comment">-- Unroll memset calls if the number of bytes to copy isn't too large (cf</span><span>
</span><span id="line-3932"></span><span class="hs-comment">-- ncgInlineThresholdMemset).  Otherwise, call C's memset.</span><span>
</span><span id="line-3933"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-type">genMemSet</span></a></span><span>
</span><span id="line-3934"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3935"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3936"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3937"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3938"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3939"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3940"></span><span id="genMemSet"><span class="annot"><span class="annottext">genMemSet :: Label
-&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-var hs-var">genMemSet</span></a></span></span><span> </span><span id="local-6989586621682660575"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660575"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660576"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660576"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682660577"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660577"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660578"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660578"><span class="hs-identifier hs-var">arg_c</span></a></span></span><span> </span><span id="local-6989586621682660579"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660579"><span class="hs-identifier hs-var">arg_n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3941"></span><span>
</span><span id="line-3942"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660580"><span class="annot"><span class="annottext">libc_memset :: NatM (OrdList Instr)
</span><a href="#local-6989586621682660580"><span class="hs-identifier hs-var hs-var">libc_memset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660575"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memset&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660577"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660578"><span class="hs-identifier hs-var">arg_c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660579"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3943"></span><span>
</span><span id="line-3944"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660578"><span class="hs-identifier hs-var">arg_c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660579"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3945"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682660581"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660581"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682660582"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660582"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3946"></span><span>      </span><span class="hs-comment">-- try to inline it</span><span>
</span><span id="line-3947"></span><span>      </span><span id="local-6989586621682660583"><span class="annot"><a href="#local-6989586621682660583"><span class="hs-identifier hs-var">mcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM (Maybe (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-var">genMemSetInlineMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660576"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660577"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660581"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660582"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3948"></span><span>      </span><span class="hs-comment">-- if it didn't inline, call the C function</span><span>
</span><span id="line-3949"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660583"><span class="hs-identifier hs-type">mcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3950"></span><span>        </span><span class="annot"><span class="annottext">Maybe (OrdList Instr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM (OrdList Instr)
</span><a href="#local-6989586621682660580"><span class="hs-identifier hs-var">libc_memset</span></a></span><span>
</span><span id="line-3951"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660585"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660585"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660585"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-3952"></span><span>
</span><span id="line-3953"></span><span>    </span><span class="hs-comment">-- not literal size arguments: call the C function</span><span>
</span><span id="line-3954"></span><span>    </span><span class="annot"><span class="annottext">(CmmExpr, CmmExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM (OrdList Instr)
</span><a href="#local-6989586621682660580"><span class="hs-identifier hs-var">libc_memset</span></a></span><span>
</span><span id="line-3955"></span><span>
</span><span id="line-3956"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-type">genMemSetInlineMaybe</span></a></span><span>
</span><span id="line-3957"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3958"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3959"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3960"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3961"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3962"></span><span id="genMemSetInlineMaybe"><span class="annot"><span class="annottext">genMemSetInlineMaybe :: Int
-&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM (Maybe (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-var hs-var">genMemSetInlineMaybe</span></a></span></span><span> </span><span id="local-6989586621682660586"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660586"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682660587"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660587"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660588"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660588"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682660589"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660589"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3963"></span><span>  </span><span id="local-6989586621682660590"><span class="annot"><a href="#local-6989586621682660590"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3964"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3965"></span><span>    </span><span id="local-6989586621682660591"><span class="annot"><a href="#local-6989586621682660591"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660590"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3966"></span><span>    </span><span id="local-6989586621682660592"><span class="annot"><a href="#local-6989586621682660592"><span class="hs-identifier hs-var hs-var">maxAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Alignment
</span><a href="GHC.Platform.html#wordAlignment"><span class="hs-identifier hs-var">wordAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660591"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-comment">-- only machine word wide MOVs are supported</span><span>
</span><span id="line-3967"></span><span>    </span><span id="local-6989586621682660593"><span class="annot"><a href="#local-6989586621682660593"><span class="hs-identifier hs-var hs-var">effectiveAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Alignment -&gt; Alignment
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#alignmentOf"><span class="hs-identifier hs-var">alignmentOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660586"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682660592"><span class="hs-identifier hs-var">maxAlignment</span></a></span><span>
</span><span id="line-3968"></span><span>    </span><span id="local-6989586621682660594"><span class="annot"><a href="#local-6989586621682660594"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; (Int -&gt; Width) -&gt; Int -&gt; Format
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width
</span><a href="GHC.Cmm.Type.html#widthFromBytes"><span class="hs-identifier hs-var">widthFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Int
</span><a href="GHC.Types.Basic.html#alignmentBytes"><span class="hs-identifier hs-var">alignmentBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682660593"><span class="hs-identifier hs-var">effectiveAlignment</span></a></span><span>
</span><span id="line-3969"></span><span>    </span><span id="local-6989586621682660595"><span class="annot"><a href="#local-6989586621682660595"><span class="hs-identifier hs-var hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660588"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660588"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-3970"></span><span>    </span><span id="local-6989586621682660598"><span class="annot"><a href="#local-6989586621682660598"><span class="hs-identifier hs-var hs-var">c4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660595"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660595"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-3971"></span><span>    </span><span id="local-6989586621682660599"><span class="annot"><a href="#local-6989586621682660599"><span class="hs-identifier hs-var hs-var">c8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660598"><span class="hs-identifier hs-var">c4</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660598"><span class="hs-identifier hs-var">c4</span></a></span><span>
</span><span id="line-3972"></span><span>
</span><span id="line-3973"></span><span>    </span><span class="hs-comment">-- The number of instructions we will generate (approx). We need 1</span><span>
</span><span id="line-3974"></span><span>    </span><span class="hs-comment">-- instructions per move.</span><span>
</span><span id="line-3975"></span><span>    </span><span id="local-6989586621682660600"><span class="annot"><a href="#local-6989586621682660600"><span class="hs-identifier hs-var hs-var">insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660589"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660601"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660601"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span>
</span><span id="line-3976"></span><span>
</span><span id="line-3977"></span><span>    </span><span class="hs-comment">-- The size of each move, in bytes.</span><span>
</span><span id="line-3978"></span><span>    </span><span class="annot"><a href="#local-6989586621682660601"><span class="hs-identifier hs-type">sizeBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3979"></span><span>    </span><span id="local-6989586621682660601"><span class="annot"><a href="#local-6989586621682660601"><span class="hs-identifier hs-var hs-var">sizeBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Int
</span><a href="GHC.CmmToAsm.Format.html#formatInBytes"><span class="hs-identifier hs-var">formatInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660594"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3980"></span><span>
</span><span id="line-3981"></span><span>    </span><span class="hs-comment">-- Depending on size returns the widest MOV instruction and its</span><span>
</span><span id="line-3982"></span><span>    </span><span class="hs-comment">-- width.</span><span>
</span><span id="line-3983"></span><span>    </span><span class="annot"><a href="#local-6989586621682660602"><span class="hs-identifier hs-type">gen4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-3984"></span><span>    </span><span id="local-6989586621682660602"><span class="annot"><a href="#local-6989586621682660602"><span class="hs-identifier hs-var hs-var">gen4</span></a></span></span><span> </span><span id="local-6989586621682660603"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660603"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660604"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660604"><span class="hs-identifier hs-var">size</span></a></span></span><span>
</span><span id="line-3985"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660604"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3986"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660598"><span class="hs-identifier hs-var">c4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660603"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-3987"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660604"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3988"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660595"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660603"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-3989"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660604"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3990"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660588"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660603"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-3991"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-3992"></span><span>
</span><span id="line-3993"></span><span>    </span><span class="hs-comment">-- Generates a 64-bit wide MOV instruction from REG to MEM.</span><span>
</span><span id="line-3994"></span><span>    </span><span class="annot"><a href="#local-6989586621682660605"><span class="hs-identifier hs-type">gen8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3995"></span><span>    </span><span id="local-6989586621682660605"><span class="annot"><a href="#local-6989586621682660605"><span class="hs-identifier hs-var hs-var">gen8</span></a></span></span><span> </span><span id="local-6989586621682660606"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660606"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660607"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660607"><span class="hs-identifier hs-var">reg8byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3996"></span><span>      </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660594"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660607"><span class="hs-identifier hs-var">reg8byte</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660606"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3997"></span><span>
</span><span id="line-3998"></span><span>    </span><span class="hs-comment">-- Unrolls memset when the widest MOV is &lt;= 4 bytes.</span><span>
</span><span id="line-3999"></span><span>    </span><span class="annot"><a href="#local-6989586621682660608"><span class="hs-identifier hs-type">go4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4000"></span><span>    </span><span id="local-6989586621682660608"><span class="annot"><a href="#local-6989586621682660608"><span class="hs-identifier hs-var hs-var">go4</span></a></span></span><span> </span><span id="local-6989586621682660609"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660609"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660610"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660610"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4001"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660610"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-4002"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660611"><span class="hs-identifier hs-var">curMov</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660608"><span class="hs-identifier hs-var">go4</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660609"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660610"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660612"><span class="hs-identifier hs-var">curWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4003"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-4004"></span><span>        </span><span id="local-6989586621682660613"><span class="annot"><span class="annottext">possibleWidth :: Integer
</span><a href="#local-6989586621682660613"><span class="hs-identifier hs-var hs-var">possibleWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660610"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660601"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4005"></span><span>        </span><span id="local-6989586621682660615"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682660615"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660609"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660589"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660610"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4006"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682660611"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660611"><span class="hs-identifier hs-var">curMov</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660612"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660612"><span class="hs-identifier hs-var">curWidth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Integer -&gt; (OrdList Instr, Integer)
</span><a href="#local-6989586621682660602"><span class="hs-identifier hs-var">gen4</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660615"><span class="hs-identifier hs-var">dst_addr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660613"><span class="hs-identifier hs-var">possibleWidth</span></a></span><span>
</span><span id="line-4007"></span><span>
</span><span id="line-4008"></span><span>    </span><span class="hs-comment">-- Unrolls memset when the widest MOV is 8 bytes (thus another Reg</span><span>
</span><span id="line-4009"></span><span>    </span><span class="hs-comment">-- argument). Falls back to go4 when all 8 byte moves are</span><span>
</span><span id="line-4010"></span><span>    </span><span class="hs-comment">-- exhausted.</span><span>
</span><span id="line-4011"></span><span>    </span><span class="annot"><a href="#local-6989586621682660616"><span class="hs-identifier hs-type">go8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4012"></span><span>    </span><span id="local-6989586621682660616"><span class="annot"><a href="#local-6989586621682660616"><span class="hs-identifier hs-var hs-var">go8</span></a></span></span><span> </span><span id="local-6989586621682660617"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660617"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660618"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660618"><span class="hs-identifier hs-var">reg8byte</span></a></span></span><span> </span><span id="local-6989586621682660619"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660619"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4013"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660620"><span class="hs-identifier hs-var">possibleWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-4014"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660621"><span class="annot"><span class="annottext">curMov :: OrdList Instr
</span><a href="#local-6989586621682660621"><span class="hs-identifier hs-var hs-var">curMov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660605"><span class="hs-identifier hs-var">gen8</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660622"><span class="hs-identifier hs-var">dst_addr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660618"><span class="hs-identifier hs-var">reg8byte</span></a></span><span>
</span><span id="line-4015"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660621"><span class="hs-identifier hs-var">curMov</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660616"><span class="hs-identifier hs-var">go8</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660617"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660618"><span class="hs-identifier hs-var">reg8byte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660619"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-4016"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Integer -&gt; OrdList Instr
</span><a href="#local-6989586621682660608"><span class="hs-identifier hs-var">go4</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660617"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660619"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-4017"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-4018"></span><span>        </span><span id="local-6989586621682660620"><span class="annot"><span class="annottext">possibleWidth :: Integer
</span><a href="#local-6989586621682660620"><span class="hs-identifier hs-var hs-var">possibleWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660619"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660601"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4019"></span><span>        </span><span id="local-6989586621682660622"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682660622"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660617"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660589"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682660619"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4020"></span><span>
</span><span id="line-4021"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682660600"><span class="hs-identifier hs-type">insns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgInlineThresholdMemset"><span class="hs-identifier hs-var">ncgInlineThresholdMemset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660590"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-4022"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-4023"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4024"></span><span>        </span><span id="local-6989586621682660624"><span class="annot"><a href="#local-6989586621682660624"><span class="hs-identifier hs-var">code_dst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660587"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-4025"></span><span>        </span><span id="local-6989586621682660625"><span class="annot"><a href="#local-6989586621682660625"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660594"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4026"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660594"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682660589"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-4027"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4028"></span><span>            </span><span id="local-6989586621682660626"><span class="annot"><a href="#local-6989586621682660626"><span class="hs-identifier hs-var">code_imm8byte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660599"><span class="hs-identifier hs-type">c8</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4029"></span><span>            </span><span id="local-6989586621682660627"><span class="annot"><a href="#local-6989586621682660627"><span class="hs-identifier hs-var">imm8byte_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-4030"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660624"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660625"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4031"></span><span>                              </span><span class="annot"><a href="#local-6989586621682660626"><span class="hs-identifier hs-type">code_imm8byte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660627"><span class="hs-identifier hs-type">imm8byte_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4032"></span><span>                              </span><span class="annot"><a href="#local-6989586621682660616"><span class="hs-identifier hs-type">go8</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660625"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660627"><span class="hs-identifier hs-type">imm8byte_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682660589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4033"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-4034"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660624"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660625"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4035"></span><span>                              </span><span class="annot"><a href="#local-6989586621682660608"><span class="hs-identifier hs-type">go4</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660625"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682660589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4036"></span><span>
</span><span id="line-4037"></span><span>
</span><span id="line-4038"></span><span id="local-6989586621682656615"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-type">genMemMove</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682656615"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-4039"></span><span id="genMemMove"><span class="annot"><span class="annottext">genMemMove :: forall p.
Label -&gt; p -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-var hs-var">genMemMove</span></a></span></span><span> </span><span id="local-6989586621682660628"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660628"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660629"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621682660629"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span id="local-6989586621682660630"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660630"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660631"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660631"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660632"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660632"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4040"></span><span>  </span><span class="hs-comment">-- TODO: generate inline assembly when under a given threshold (similarly to</span><span>
</span><span id="line-4041"></span><span>  </span><span class="hs-comment">-- memcpy and memset)</span><span>
</span><span id="line-4042"></span><span>  </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660628"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memmove&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660630"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660631"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660632"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4043"></span><span>
</span><span id="line-4044"></span><span id="local-6989586621682656616"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-type">genMemCmp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682656616"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-4045"></span><span id="genMemCmp"><span class="annot"><span class="annottext">genMemCmp :: forall p.
Label
-&gt; p
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-var hs-var">genMemCmp</span></a></span></span><span> </span><span id="local-6989586621682660633"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660633"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660634"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621682660634"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span id="local-6989586621682660635"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660635"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682660636"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660636"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660637"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660637"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660638"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660638"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4046"></span><span>  </span><span class="hs-comment">-- TODO: generate inline assembly when under a given threshold (similarly to</span><span>
</span><span id="line-4047"></span><span>  </span><span class="hs-comment">-- memcpy and memset)</span><span>
</span><span id="line-4048"></span><span>  </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660633"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memcmp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660635"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660636"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660637"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660638"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4049"></span><span>
</span><span id="line-4050"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-type">genPrefetchData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4051"></span><span id="genPrefetchData"><span class="annot"><span class="annottext">genPrefetchData :: Int -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-var hs-var">genPrefetchData</span></a></span></span><span> </span><span id="local-6989586621682660639"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660639"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682660640"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660640"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4052"></span><span>  </span><span id="local-6989586621682660641"><span class="annot"><a href="#local-6989586621682660641"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4053"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4054"></span><span>    </span><span id="local-6989586621682660642"><span class="annot"><a href="#local-6989586621682660642"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660641"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-4055"></span><span>    </span><span class="hs-comment">-- need to know what register width for pointers!</span><span>
</span><span id="line-4056"></span><span>    </span><span id="local-6989586621682660643"><span class="annot"><a href="#local-6989586621682660643"><span class="hs-identifier hs-var hs-var">genPrefetch</span></a></span></span><span> </span><span id="local-6989586621682660644"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660644"><span class="hs-identifier hs-var">inRegSrc</span></a></span></span><span> </span><span id="local-6989586621682660645"><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682660645"><span class="hs-identifier hs-var">prefetchCTor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4057"></span><span>      </span><span id="local-6989586621682660646"><span class="annot"><a href="#local-6989586621682660646"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660644"><span class="hs-identifier hs-var">inRegSrc</span></a></span><span>
</span><span id="line-4058"></span><span>      </span><span id="local-6989586621682660647"><span class="annot"><a href="#local-6989586621682660647"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660642"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4059"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660646"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660647"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4060"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660645"><span class="hs-identifier hs-type">prefetchCTor</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span>
</span><span id="line-4061"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660647"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4062"></span><span>        </span><span class="hs-comment">-- prefetch always takes an address</span><span>
</span><span id="line-4063"></span><span>
</span><span id="line-4064"></span><span>  </span><span class="hs-comment">-- the c / llvm prefetch convention is 0, 1, 2, and 3</span><span>
</span><span id="line-4065"></span><span>  </span><span class="hs-comment">-- the x86 corresponding names are : NTA, 2 , 1, and 0</span><span>
</span><span id="line-4066"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660639"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4067"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682660643"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660640"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM (OrdList Instr))
-&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#NTA"><span class="hs-identifier hs-var">NTA</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660642"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-4068"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682660643"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660640"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM (OrdList Instr))
-&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl2"><span class="hs-identifier hs-var">Lvl2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660642"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-4069"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682660643"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660640"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM (OrdList Instr))
-&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl1"><span class="hs-identifier hs-var">Lvl1</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660642"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-4070"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682660643"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660640"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM (OrdList Instr))
-&gt; (Operand -&gt; Instr) -&gt; NatM (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl0"><span class="hs-identifier hs-var">Lvl0</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660642"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-4071"></span><span>      </span><span id="local-6989586621682660653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660653"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genPrefetchData: unexpected prefetch level&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682660653"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4072"></span><span>
</span><span id="line-4073"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-type">genByteSwap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4074"></span><span id="genByteSwap"><span class="annot"><span class="annottext">genByteSwap :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-var hs-var">genByteSwap</span></a></span></span><span> </span><span id="local-6989586621682660654"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660654"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660655"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660655"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660656"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660656"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4075"></span><span>  </span><span id="local-6989586621682660657"><span class="annot"><a href="#local-6989586621682660657"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4076"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660658"><span class="annot"><a href="#local-6989586621682660658"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660654"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4077"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660654"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4078"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660657"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4079"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660659"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660659"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660660"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660660"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660655"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4080"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660661"><span class="annot"><a href="#local-6989586621682660661"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682660662"><span class="annot"><a href="#local-6989586621682660662"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682660663"><span class="annot"><a href="#local-6989586621682660663"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660656"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4081"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660661"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4082"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660663"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660659"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4083"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660662"><span class="hs-identifier hs-type">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660660"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4084"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660659"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4085"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660660"><span class="hs-identifier hs-type">dst_lo</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-4086"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4087"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660665"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682660665"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660655"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4088"></span><span>        </span><span id="local-6989586621682660666"><span class="annot"><a href="#local-6989586621682660666"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660656"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4089"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660666"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660665"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4090"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660665"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4091"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-type">SHR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660665"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4092"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4093"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660667"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682660667"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660655"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4094"></span><span>        </span><span id="local-6989586621682660668"><span class="annot"><a href="#local-6989586621682660668"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660656"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4095"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660668"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660667"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660658"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660667"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4096"></span><span>
</span><span id="line-4097"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-type">genBitRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4098"></span><span id="genBitRev"><span class="annot"><span class="annottext">genBitRev :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-var hs-var">genBitRev</span></a></span></span><span> </span><span id="local-6989586621682660669"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660669"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660670"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660670"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660671"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660671"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660672"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660672"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4099"></span><span>  </span><span class="hs-comment">-- Here the C implementation (hs_bitrevN) is used as there is no x86</span><span>
</span><span id="line-4100"></span><span>  </span><span class="hs-comment">-- instruction to reverse a word's bit order.</span><span>
</span><span id="line-4101"></span><span>  </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660669"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#bRevLabel"><span class="hs-identifier hs-var">bRevLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660670"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660671"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660672"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4102"></span><span>
</span><span id="line-4103"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-type">genPopCnt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4104"></span><span id="genPopCnt"><span class="annot"><span class="annottext">genPopCnt :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-var hs-var">genPopCnt</span></a></span></span><span> </span><span id="local-6989586621682660674"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660674"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660675"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660675"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660676"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660676"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660677"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660677"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4105"></span><span>  </span><span id="local-6989586621682660678"><span class="annot"><a href="#local-6989586621682660678"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4106"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4107"></span><span>    </span><span id="local-6989586621682660679"><span class="annot"><a href="#local-6989586621682660679"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660678"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4108"></span><span>    </span><span id="local-6989586621682660680"><span class="annot"><a href="#local-6989586621682660680"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660675"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4109"></span><span>
</span><span id="line-4110"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-type">sse4_2Enabled</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-4111"></span><span>
</span><span id="line-4112"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4113"></span><span>      </span><span id="local-6989586621682660681"><span class="annot"><a href="#local-6989586621682660681"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660677"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4114"></span><span>      </span><span id="local-6989586621682660682"><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660680"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4115"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660683"><span class="annot"><a href="#local-6989586621682660683"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660679"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660676"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4116"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660681"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4117"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660675"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-4118"></span><span>               </span><span class="hs-comment">-- The POPCNT instruction doesn't take a r/m8</span><span>
</span><span id="line-4119"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4120"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#POPCNT"><span class="hs-identifier hs-type">POPCNT</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660683"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4121"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-4122"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#POPCNT"><span class="hs-identifier hs-type">POPCNT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660680"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660682"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660683"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4123"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660675"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682660675"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-4124"></span><span>               </span><span class="hs-comment">-- We used a 16-bit destination register above,</span><span>
</span><span id="line-4125"></span><span>               </span><span class="hs-comment">-- so zero-extend</span><span>
</span><span id="line-4126"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660683"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660683"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4127"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4128"></span><span>
</span><span id="line-4129"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4130"></span><span>      </span><span class="hs-comment">-- generate C call to hs_popcntN in ghc-prim</span><span>
</span><span id="line-4131"></span><span>      </span><span class="hs-comment">-- TODO: we could directly generate the assembly to index popcount_tab</span><span>
</span><span id="line-4132"></span><span>      </span><span class="hs-comment">-- here instead of doing it by calling a C function</span><span>
</span><span id="line-4133"></span><span>      </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660674"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#popCntLabel"><span class="hs-identifier hs-var">popCntLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660675"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660676"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660677"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4134"></span><span>
</span><span id="line-4135"></span><span>
</span><span id="line-4136"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-type">genPdep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4137"></span><span id="genPdep"><span class="annot"><span class="annottext">genPdep :: Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-var hs-var">genPdep</span></a></span></span><span> </span><span id="local-6989586621682660686"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660686"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660687"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660687"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660688"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660688"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660689"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660689"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660690"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660690"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4138"></span><span>  </span><span id="local-6989586621682660691"><span class="annot"><a href="#local-6989586621682660691"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4139"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4140"></span><span>    </span><span id="local-6989586621682660692"><span class="annot"><a href="#local-6989586621682660692"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682660691"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4141"></span><span>    </span><span id="local-6989586621682660693"><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660687"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4142"></span><span>
</span><span id="line-4143"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660691"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-4144"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4145"></span><span>      </span><span id="local-6989586621682660694"><span class="annot"><a href="#local-6989586621682660694"><span class="hs-identifier hs-var">code_src</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660689"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-4146"></span><span>      </span><span id="local-6989586621682660695"><span class="annot"><a href="#local-6989586621682660695"><span class="hs-identifier hs-var">code_mask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660690"><span class="hs-identifier hs-type">mask</span></a></span><span>
</span><span id="line-4147"></span><span>      </span><span id="local-6989586621682660696"><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-var">src_r</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4148"></span><span>      </span><span id="local-6989586621682660697"><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-var">mask_r</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4149"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660698"><span class="annot"><a href="#local-6989586621682660698"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660692"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660688"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4150"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660694"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660695"><span class="hs-identifier hs-type">code_mask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-type">mask_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4151"></span><span>          </span><span class="hs-comment">-- PDEP only supports &gt; 32 bit args</span><span>
</span><span id="line-4152"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660687"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682660687"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-4153"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4154"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-4155"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4156"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PDEP"><span class="hs-identifier hs-type">PDEP</span></a></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660698"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-4157"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660698"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660698"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Truncate to op width</span><span>
</span><span id="line-4158"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-4159"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-4160"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PDEP"><span class="hs-identifier hs-type">PDEP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660693"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660697"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660696"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660698"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4161"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-4162"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-4163"></span><span>      </span><span class="hs-comment">-- generate C call to hs_pdepN in ghc-prim</span><span>
</span><span id="line-4164"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660686"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#pdepLabel"><span class="hs-identifier hs-type">pdepLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660687"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660688"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660689"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660690"><span class="hs-identifier hs-type">mask</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4165"></span><span>
</span><span id="line-4166"></span><span>
</span><span id="line-4167"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-type">genPext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4168"></span><span id="genPext"><span class="annot"><span class="annottext">genPext :: Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-var hs-var">genPext</span></a></span></span><span> </span><span id="local-6989586621682660701"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660701"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660702"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660702"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660703"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660703"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660704"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660704"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682660705"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660705"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4169"></span><span>  </span><span id="local-6989586621682660706"><span class="annot"><a href="#local-6989586621682660706"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4170"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660706"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-4171"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660707"><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660702"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4173"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660708"><span class="annot"><a href="#local-6989586621682660708"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660703"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4174"></span><span>      </span><span id="local-6989586621682660709"><span class="annot"><a href="#local-6989586621682660709"><span class="hs-identifier hs-var">code_src</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660704"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-4175"></span><span>      </span><span id="local-6989586621682660710"><span class="annot"><a href="#local-6989586621682660710"><span class="hs-identifier hs-var">code_mask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660705"><span class="hs-identifier hs-type">mask</span></a></span><span>
</span><span id="line-4176"></span><span>      </span><span id="local-6989586621682660711"><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-var">src_r</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4177"></span><span>      </span><span id="local-6989586621682660712"><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-var">mask_r</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4178"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660709"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660710"><span class="hs-identifier hs-type">code_mask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-type">mask_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4179"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660702"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682660702"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-4180"></span><span>               </span><span class="hs-comment">-- The PEXT instruction doesn't take a r/m8 or 16</span><span>
</span><span id="line-4181"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4182"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-4183"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4184"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PEXT"><span class="hs-identifier hs-type">PEXT</span></a></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660708"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-4185"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660708"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660708"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Truncate to op width</span><span>
</span><span id="line-4186"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-4187"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-4188"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PEXT"><span class="hs-identifier hs-type">PEXT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660707"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660712"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660711"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660708"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4189"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-4190"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-4191"></span><span>      </span><span class="hs-comment">-- generate C call to hs_pextN in ghc-prim</span><span>
</span><span id="line-4192"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660701"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#pextLabel"><span class="hs-identifier hs-type">pextLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660702"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660703"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660704"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660705"><span class="hs-identifier hs-type">mask</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4193"></span><span>
</span><span id="line-4194"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-type">genClz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4195"></span><span id="genClz"><span class="annot"><span class="annottext">genClz :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-var hs-var">genClz</span></a></span></span><span> </span><span id="local-6989586621682660715"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660715"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660716"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660716"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660717"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660717"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660718"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660718"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4196"></span><span>  </span><span id="local-6989586621682660719"><span class="annot"><a href="#local-6989586621682660719"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4197"></span><span>  </span><span id="local-6989586621682660720"><span class="annot"><a href="#local-6989586621682660720"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-4198"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660719"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682660716"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span>
</span><span id="line-4199"></span><span>
</span><span id="line-4200"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-4201"></span><span>      </span><span class="hs-comment">-- Fallback to `hs_clz64` on i386</span><span>
</span><span id="line-4202"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660715"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#clzLabel"><span class="hs-identifier hs-type">clzLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660716"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660717"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660718"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4203"></span><span>
</span><span id="line-4204"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4205"></span><span>      </span><span id="local-6989586621682660722"><span class="annot"><a href="#local-6989586621682660722"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660718"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-4206"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660723"><span class="annot"><a href="#local-6989586621682660723"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660717"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4207"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660720"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-4208"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4209"></span><span>          </span><span id="local-6989586621682660724"><span class="annot"><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660716"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4210"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-identifier hs-type">appOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660722"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660724"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660716"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4211"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4212"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- zero-extend to 32 bit</span><span>
</span><span id="line-4213"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span>         </span><span class="hs-comment">-- lzcnt with extra 24 zeros</span><span>
</span><span id="line-4214"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- compensate for extra zeros</span><span>
</span><span id="line-4215"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-4216"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4217"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4218"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- zero-extend from 16 bit</span><span>
</span><span id="line-4219"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-4220"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660716"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660724"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660723"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4221"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4222"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660726"><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660716"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660716"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4223"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660727"><span class="annot"><a href="#local-6989586621682660727"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660716"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4224"></span><span>          </span><span id="local-6989586621682660728"><span class="annot"><a href="#local-6989586621682660728"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4225"></span><span>          </span><span id="local-6989586621682660729"><span class="annot"><a href="#local-6989586621682660729"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4226"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660722"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660728"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4227"></span><span>                   </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660728"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660728"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682660716"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-4228"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSR"><span class="hs-identifier hs-type">BSR</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660728"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660729"><span class="hs-identifier hs-type">tmp_r</span></a></span><span>
</span><span id="line-4229"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="hs-operator hs-type">*</span></span><span class="annot"><a href="#local-6989586621682660727"><span class="hs-identifier hs-type">bw</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660723"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4230"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-type">CMOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660729"><span class="hs-identifier hs-type">tmp_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660723"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-4231"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621682660726"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660727"><span class="hs-identifier hs-type">bw</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660723"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4232"></span><span>                    </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NB: We don't need to zero-extend the result for the</span><span>
</span><span id="line-4233"></span><span>                       </span><span class="hs-comment">-- W8/W16 cases because the 'MOV' insn already</span><span>
</span><span id="line-4234"></span><span>                       </span><span class="hs-comment">-- took care of implicitly clearing the upper bits</span><span>
</span><span id="line-4235"></span><span>
</span><span id="line-4236"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-type">genWordToFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4237"></span><span id="genWordToFloat"><span class="annot"><span class="annottext">genWordToFloat :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-var hs-var">genWordToFloat</span></a></span></span><span> </span><span id="local-6989586621682660731"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660731"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660732"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660732"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660733"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660733"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660734"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660734"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4238"></span><span>  </span><span class="hs-comment">-- TODO: generate assembly instead</span><span>
</span><span id="line-4239"></span><span>  </span><span class="annot"><span class="annottext">Label
-&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660731"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#word2FloatLabel"><span class="hs-identifier hs-var">word2FloatLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660732"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660733"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660734"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4240"></span><span>
</span><span id="line-4241"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-type">genAtomicRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MemoryOrdering"><span class="hs-identifier hs-type">MemoryOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4242"></span><span id="genAtomicRead"><span class="annot"><span class="annottext">genAtomicRead :: Width
-&gt; MemoryOrdering -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-var hs-var">genAtomicRead</span></a></span></span><span> </span><span id="local-6989586621682660736"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660736"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660737"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682660737"><span class="hs-identifier hs-var">_mord</span></a></span></span><span> </span><span id="local-6989586621682660738"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660738"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660739"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660739"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4243"></span><span>  </span><span id="local-6989586621682660740"><span class="annot"><a href="#local-6989586621682660740"><span class="hs-identifier hs-var">load_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660736"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660739"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-4244"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660740"><span class="hs-identifier hs-type">load_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-type">getLocalRegReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660738"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4245"></span><span>
</span><span id="line-4246"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-type">genAtomicWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MemoryOrdering"><span class="hs-identifier hs-type">MemoryOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4247"></span><span id="genAtomicWrite"><span class="annot"><span class="annottext">genAtomicWrite :: Width
-&gt; MemoryOrdering -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-var hs-var">genAtomicWrite</span></a></span></span><span> </span><span id="local-6989586621682660741"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660741"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660742"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682660742"><span class="hs-identifier hs-var">mord</span></a></span></span><span> </span><span id="local-6989586621682660743"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660743"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660744"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660744"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4248"></span><span>  </span><span id="local-6989586621682660745"><span class="annot"><a href="#local-6989586621682660745"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660741"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660743"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660744"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-4249"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660746"><span class="annot"><a href="#local-6989586621682660746"><span class="hs-identifier hs-var hs-var">needs_fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682660742"><span class="hs-identifier hs-var">mord</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4250"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderSeqCst"><span class="hs-identifier hs-var">MemOrderSeqCst</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-4251"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelease"><span class="hs-identifier hs-var">MemOrderRelease</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-4252"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderAcquire"><span class="hs-identifier hs-var">MemOrderAcquire</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genAtomicWrite: acquire ordering on write&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-4253"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelaxed"><span class="hs-identifier hs-var">MemOrderRelaxed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-4254"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682660746"><span class="hs-identifier hs-type">needs_fence</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682660745"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MFENCE"><span class="hs-identifier hs-type">MFENCE</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682660745"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4255"></span><span>
</span><span id="line-4256"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-type">genCmpXchg</span></a></span><span>
</span><span id="line-4257"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-4258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4259"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4260"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4261"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4262"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4263"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4264"></span><span id="genCmpXchg"><span class="annot"><span class="annottext">genCmpXchg :: Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-var hs-var">genCmpXchg</span></a></span></span><span> </span><span id="local-6989586621682660752"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682660752"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682660753"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660753"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660754"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660754"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660755"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660755"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660756"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660756"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621682660757"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660757"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4265"></span><span>  </span><span id="local-6989586621682660758"><span class="annot"><a href="#local-6989586621682660758"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4266"></span><span>  </span><span class="hs-comment">-- On x86 we don't have enough registers to use cmpxchg with a</span><span>
</span><span id="line-4267"></span><span>  </span><span class="hs-comment">-- complicated addressing mode, so on that architecture we</span><span>
</span><span id="line-4268"></span><span>  </span><span class="hs-comment">-- pre-compute the address first.</span><span>
</span><span id="line-4269"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660758"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682660753"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4270"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4271"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660759"><span class="annot"><a href="#local-6989586621682660759"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660753"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4272"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682660760"><span class="annot"><a href="#local-6989586621682660760"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682660761"><span class="annot"><a href="#local-6989586621682660761"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660755"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-4273"></span><span>      </span><span id="local-6989586621682660762"><span class="annot"><a href="#local-6989586621682660762"><span class="hs-identifier hs-var">newval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660759"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4274"></span><span>      </span><span id="local-6989586621682660763"><span class="annot"><a href="#local-6989586621682660763"><span class="hs-identifier hs-var">newval_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660757"><span class="hs-identifier hs-type">new</span></a></span><span>
</span><span id="line-4275"></span><span>      </span><span id="local-6989586621682660764"><span class="annot"><a href="#local-6989586621682660764"><span class="hs-identifier hs-var">oldval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660759"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4276"></span><span>      </span><span id="local-6989586621682660765"><span class="annot"><a href="#local-6989586621682660765"><span class="hs-identifier hs-var">oldval_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660756"><span class="hs-identifier hs-type">old</span></a></span><span>
</span><span id="line-4277"></span><span>      </span><span id="local-6989586621682660766"><span class="annot"><a href="#local-6989586621682660766"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-4278"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660767"><span class="annot"><a href="#local-6989586621682660767"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660766"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660754"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4279"></span><span>          </span><span id="local-6989586621682660768"><span class="annot"><a href="#local-6989586621682660768"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4280"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660759"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660764"><span class="hs-identifier hs-var">oldval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4281"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-var">CMPXCHG</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660759"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660762"><span class="hs-identifier hs-var">newval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660760"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4282"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660759"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660767"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4283"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-4284"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660761"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660763"><span class="hs-identifier hs-type">newval_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660762"><span class="hs-identifier hs-type">newval</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660765"><span class="hs-identifier hs-type">oldval_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660764"><span class="hs-identifier hs-type">oldval</span></a></span><span>
</span><span id="line-4285"></span><span>          </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660768"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4286"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-4287"></span><span>      </span><span class="hs-comment">-- generate C call to hs_cmpxchgN in ghc-prim</span><span>
</span><span id="line-4288"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660752"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#cmpxchgLabel"><span class="hs-identifier hs-type">cmpxchgLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660753"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660754"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660755"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660756"><span class="hs-identifier hs-type">old</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682660757"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4289"></span><span>      </span><span class="hs-comment">-- TODO: implement cmpxchg8b instruction</span><span>
</span><span id="line-4290"></span><span>
</span><span id="line-4291"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-type">genXchg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4292"></span><span id="genXchg"><span class="annot"><span class="annottext">genXchg :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-var hs-var">genXchg</span></a></span></span><span> </span><span id="local-6989586621682660770"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660770"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660771"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660771"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660772"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660772"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682660773"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660773"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4293"></span><span>  </span><span id="local-6989586621682660774"><span class="annot"><a href="#local-6989586621682660774"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4294"></span><span>
</span><span id="line-4295"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660774"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682660770"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-4296"></span><span>    </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-type">panic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genXchg: 64bit atomic exchange not supported on 32bit platforms&quot;</span></span><span>
</span><span id="line-4297"></span><span>
</span><span id="line-4298"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682660775"><span class="annot"><a href="#local-6989586621682660775"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682660776"><span class="annot"><a href="#local-6989586621682660776"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660772"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-4299"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660777"><span class="annot"><a href="#local-6989586621682660777"><span class="hs-identifier hs-var">newval</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660778"><span class="annot"><a href="#local-6989586621682660778"><span class="hs-identifier hs-var">newval_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660773"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-4300"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660779"><span class="annot"><a href="#local-6989586621682660779"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660770"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4301"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660780"><span class="annot"><a href="#local-6989586621682660780"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660771"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4302"></span><span>  </span><span class="hs-comment">-- Copy the value into the target register, perform the exchange.</span><span>
</span><span id="line-4303"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660781"><span class="annot"><a href="#local-6989586621682660781"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4304"></span><span>                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660779"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660777"><span class="hs-identifier hs-var">newval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660780"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4305"></span><span>                  </span><span class="hs-comment">-- On X86 xchg implies a lock prefix if we use a memory argument.</span><span>
</span><span id="line-4306"></span><span>                  </span><span class="hs-comment">-- so this is atomic.</span><span>
</span><span id="line-4307"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XCHG"><span class="hs-identifier hs-var">XCHG</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660779"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682660775"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660780"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4308"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-4309"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660776"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660778"><span class="hs-identifier hs-type">newval_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660781"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4310"></span><span>
</span><span id="line-4311"></span><span>
</span><span id="line-4312"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-type">genFloatAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4313"></span><span id="genFloatAbs"><span class="annot"><span class="annottext">genFloatAbs :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var hs-var">genFloatAbs</span></a></span></span><span> </span><span id="local-6989586621682660783"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660783"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660784"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660784"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660785"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660785"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4314"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4315"></span><span>    </span><span id="local-6989586621682660786"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682660786"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660783"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4316"></span><span>    </span><span id="local-6989586621682660787"><span class="annot"><span class="annottext">const :: CmmLit
</span><a href="#local-6989586621682660787"><span class="hs-identifier hs-var hs-var hs-var">const</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660783"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4317"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x7fffffff</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-4318"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x7fffffffffffffff</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-4319"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; CmmLit
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFloatAbs: invalid width&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660783"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4320"></span><span>  </span><span id="local-6989586621682660788"><span class="annot"><a href="#local-6989586621682660788"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660785"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4321"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682660789"><span class="annot"><a href="#local-6989586621682660789"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682660790"><span class="annot"><a href="#local-6989586621682660790"><span class="hs-identifier hs-var">amode_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660783"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660787"><span class="hs-identifier hs-type">const</span></a></span><span>
</span><span id="line-4322"></span><span>  </span><span id="local-6989586621682660791"><span class="annot"><a href="#local-6989586621682660791"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660786"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4323"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660792"><span class="annot"><a href="#local-6989586621682660792"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660784"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4324"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660788"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660792"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660790"><span class="hs-identifier hs-type">amode_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4325"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660786"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660789"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660791"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4326"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-type">AND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660786"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660791"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660792"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4327"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-4328"></span><span>
</span><span id="line-4329"></span><span>
</span><span id="line-4330"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-type">genFloatSqrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4331"></span><span id="genFloatSqrt"><span class="annot"><span class="annottext">genFloatSqrt :: Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var hs-var">genFloatSqrt</span></a></span></span><span> </span><span id="local-6989586621682660793"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660793"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621682660794"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660794"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660795"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660795"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4332"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660796"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682660796"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660794"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4333"></span><span>  </span><span id="local-6989586621682660797"><span class="annot"><a href="#local-6989586621682660797"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660795"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4334"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660797"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660796"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SQRT"><span class="hs-identifier hs-type">SQRT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660793"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660796"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660796"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-4335"></span><span>
</span><span id="line-4336"></span><span>
</span><span id="line-4337"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-type">genAddSubRetCarry</span></a></span><span>
</span><span id="line-4338"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4339"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4340"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4341"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span>
</span><span id="line-4342"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4343"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4344"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4345"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4346"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4347"></span><span id="genAddSubRetCarry"><span class="annot"><span class="annottext">genAddSubRetCarry :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var hs-var">genAddSubRetCarry</span></a></span></span><span> </span><span id="local-6989586621682660799"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660799"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660800"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660800"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682660801"><span class="annot"><span class="annottext">Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682660801"><span class="hs-identifier hs-var">mrevinstr</span></a></span></span><span> </span><span id="local-6989586621682660802"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660802"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682660803"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660803"><span class="hs-identifier hs-var">res_r</span></a></span></span><span> </span><span id="local-6989586621682660804"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660804"><span class="hs-identifier hs-var">res_c</span></a></span></span><span> </span><span id="local-6989586621682660805"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660805"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682660806"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660806"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4348"></span><span>  </span><span id="local-6989586621682660807"><span class="annot"><a href="#local-6989586621682660807"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4349"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660808"><span class="annot"><a href="#local-6989586621682660808"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660799"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4350"></span><span>  </span><span id="local-6989586621682660809"><span class="annot"><a href="#local-6989586621682660809"><span class="hs-identifier hs-var">rCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660799"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660800"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660808"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4351"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682660801"><span class="hs-identifier hs-type">mrevinstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660808"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660805"><span class="hs-identifier hs-type">arg_x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660806"><span class="hs-identifier hs-type">arg_y</span></a></span><span>
</span><span id="line-4352"></span><span>  </span><span id="local-6989586621682660810"><span class="annot"><a href="#local-6989586621682660810"><span class="hs-identifier hs-var">reg_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-4353"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660811"><span class="annot"><a href="#local-6989586621682660811"><span class="hs-identifier hs-var hs-var">reg_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660807"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660804"><span class="hs-identifier hs-var">res_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4354"></span><span>      </span><span id="local-6989586621682660812"><span class="annot"><a href="#local-6989586621682660812"><span class="hs-identifier hs-var hs-var">reg_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682660807"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660803"><span class="hs-identifier hs-var">res_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4355"></span><span>      </span><span id="local-6989586621682660813"><span class="annot"><a href="#local-6989586621682660813"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660809"><span class="hs-identifier hs-var">rCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660812"><span class="hs-identifier hs-var">reg_r</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4356"></span><span>             </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682660802"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660810"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4357"></span><span>             </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660810"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660811"><span class="hs-identifier hs-var">reg_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4358"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660813"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4359"></span><span>
</span><span id="line-4360"></span><span>
</span><span id="line-4361"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-type">genAddWithCarry</span></a></span><span>
</span><span id="line-4362"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4363"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4364"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4365"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4366"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4367"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4368"></span><span id="genAddWithCarry"><span class="annot"><span class="annottext">genAddWithCarry :: Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-var hs-var">genAddWithCarry</span></a></span></span><span> </span><span id="local-6989586621682660814"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660814"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660815"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660815"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682660816"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660816"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682660817"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660817"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682660818"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660818"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4369"></span><span>  </span><span id="local-6989586621682660819"><span class="annot"><a href="#local-6989586621682660819"><span class="hs-identifier hs-var">hCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660814"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4370"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660820"><span class="annot"><a href="#local-6989586621682660820"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660814"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4371"></span><span>  </span><span id="local-6989586621682660821"><span class="annot"><a href="#local-6989586621682660821"><span class="hs-identifier hs-var">lCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660814"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-type">ADD_CC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660820"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4372"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-type">ADD_CC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660820"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682660817"><span class="hs-identifier hs-type">arg_x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660818"><span class="hs-identifier hs-type">arg_y</span></a></span><span>
</span><span id="line-4373"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660822"><span class="annot"><a href="#local-6989586621682660822"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660816"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-4374"></span><span>      </span><span id="local-6989586621682660823"><span class="annot"><a href="#local-6989586621682660823"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660815"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-4375"></span><span>      </span><span id="local-6989586621682660824"><span class="annot"><a href="#local-6989586621682660824"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660819"><span class="hs-identifier hs-var">hCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660823"><span class="hs-identifier hs-var">reg_h</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4376"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660821"><span class="hs-identifier hs-var">lCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660822"><span class="hs-identifier hs-var">reg_l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4377"></span><span>             </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660820"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660823"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4378"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660824"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4379"></span><span>
</span><span id="line-4380"></span><span>
</span><span id="line-4381"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-type">genSignedLargeMul</span></a></span><span>
</span><span id="line-4382"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4383"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4384"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4385"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4386"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4387"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4388"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4389"></span><span id="genSignedLargeMul"><span class="annot"><span class="annottext">genSignedLargeMul :: Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-var hs-var">genSignedLargeMul</span></a></span></span><span> </span><span id="local-6989586621682660825"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660825"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660826"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660826"><span class="hs-identifier hs-var">res_c</span></a></span></span><span> </span><span id="local-6989586621682660827"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660827"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682660828"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660828"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682660829"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660829"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682660830"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660830"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4390"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660831"><span class="annot"><a href="#local-6989586621682660831"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660832"><span class="annot"><a href="#local-6989586621682660832"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660830"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-4391"></span><span>  </span><span id="local-6989586621682660833"><span class="annot"><a href="#local-6989586621682660833"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660829"><span class="hs-identifier hs-type">arg_x</span></a></span><span>
</span><span id="line-4392"></span><span>  </span><span id="local-6989586621682660834"><span class="annot"><a href="#local-6989586621682660834"><span class="hs-identifier hs-var">reg_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-4393"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660835"><span class="annot"><a href="#local-6989586621682660835"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660825"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4394"></span><span>      </span><span id="local-6989586621682660836"><span class="annot"><a href="#local-6989586621682660836"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660827"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-4395"></span><span>      </span><span id="local-6989586621682660837"><span class="annot"><a href="#local-6989586621682660837"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660828"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-4396"></span><span>      </span><span id="local-6989586621682660838"><span class="annot"><a href="#local-6989586621682660838"><span class="hs-identifier hs-var hs-var">reg_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660826"><span class="hs-identifier hs-var">res_c</span></a></span><span>
</span><span id="line-4397"></span><span>      </span><span id="local-6989586621682660839"><span class="annot"><a href="#local-6989586621682660839"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660832"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4398"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660833"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4399"></span><span>             </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660835"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660831"><span class="hs-identifier hs-var">y_reg</span></a></span><span>
</span><span id="line-4400"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660835"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660836"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4401"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660835"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660837"><span class="hs-identifier hs-var">reg_l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4402"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660834"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4403"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660834"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660838"><span class="hs-identifier hs-var">reg_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4404"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4405"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660839"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4406"></span><span>
</span><span id="line-4407"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-type">genUnsignedLargeMul</span></a></span><span>
</span><span id="line-4408"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4409"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4410"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4411"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4412"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4413"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4414"></span><span id="genUnsignedLargeMul"><span class="annot"><span class="annottext">genUnsignedLargeMul :: Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-var hs-var">genUnsignedLargeMul</span></a></span></span><span> </span><span id="local-6989586621682660841"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660841"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660842"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660842"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682660843"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660843"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682660844"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660844"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682660845"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660845"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4415"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682660846"><span class="annot"><a href="#local-6989586621682660846"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660847"><span class="annot"><a href="#local-6989586621682660847"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660845"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-4416"></span><span>  </span><span id="local-6989586621682660848"><span class="annot"><a href="#local-6989586621682660848"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660844"><span class="hs-identifier hs-type">arg_x</span></a></span><span>
</span><span id="line-4417"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660849"><span class="annot"><a href="#local-6989586621682660849"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660841"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4418"></span><span>      </span><span id="local-6989586621682660850"><span class="annot"><a href="#local-6989586621682660850"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660842"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-4419"></span><span>      </span><span id="local-6989586621682660851"><span class="annot"><a href="#local-6989586621682660851"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660843"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-4420"></span><span>      </span><span id="local-6989586621682660852"><span class="annot"><a href="#local-6989586621682660852"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682660847"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4421"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682660848"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4422"></span><span>             </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660849"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682660846"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4423"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660849"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660850"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4424"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660849"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660851"><span class="hs-identifier hs-var">reg_l</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-4425"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682660852"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4426"></span><span>
</span><span id="line-4427"></span><span>
</span><span id="line-4428"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-type">genQuotRem</span></a></span><span>
</span><span id="line-4429"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4430"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-4431"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4432"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4433"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4434"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4435"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4436"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4437"></span><span id="genQuotRem"><span class="annot"><span class="annottext">genQuotRem :: Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var hs-var">genQuotRem</span></a></span></span><span> </span><span id="local-6989586621682660853"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660853"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682660854"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660854"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682660855"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660855"><span class="hs-identifier hs-var">res_q</span></a></span></span><span> </span><span id="local-6989586621682660856"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660856"><span class="hs-identifier hs-var">res_r</span></a></span></span><span> </span><span id="local-6989586621682660857"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682660857"><span class="hs-identifier hs-var">m_arg_x_high</span></a></span></span><span> </span><span id="local-6989586621682660858"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660858"><span class="hs-identifier hs-var">arg_x_low</span></a></span></span><span> </span><span id="local-6989586621682660859"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660859"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4438"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660853"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4439"></span><span>    </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4440"></span><span>      </span><span class="hs-comment">-- See Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-4441"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660860"><span class="annot"><span class="annottext">widen :: MachOp
</span><a href="#local-6989586621682660860"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660854"><span class="hs-identifier hs-var">signed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-4442"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-4443"></span><span>          </span><span id="local-6989586621682660861"><span class="annot"><span class="annottext">arg_x_low_16 :: CmmExpr
</span><a href="#local-6989586621682660861"><span class="hs-identifier hs-var hs-var">arg_x_low_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682660860"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660858"><span class="hs-identifier hs-var">arg_x_low</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4444"></span><span>          </span><span id="local-6989586621682660862"><span class="annot"><span class="annottext">arg_y_16 :: CmmExpr
</span><a href="#local-6989586621682660862"><span class="hs-identifier hs-var hs-var">arg_y_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682660860"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660859"><span class="hs-identifier hs-var">arg_y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4445"></span><span>          </span><span id="local-6989586621682660863"><span class="annot"><span class="annottext">m_arg_x_high_16 :: Maybe CmmExpr
</span><a href="#local-6989586621682660863"><span class="hs-identifier hs-var hs-var">m_arg_x_high_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682660864"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660864"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682660860"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660864"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; Maybe CmmExpr -&gt; Maybe CmmExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682660857"><span class="hs-identifier hs-var">m_arg_x_high</span></a></span><span>
</span><span id="line-4446"></span><span>      </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660854"><span class="hs-identifier hs-var">signed</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660855"><span class="hs-identifier hs-var">res_q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660856"><span class="hs-identifier hs-var">res_r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682660863"><span class="hs-identifier hs-var">m_arg_x_high_16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660861"><span class="hs-identifier hs-var">arg_x_low_16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660862"><span class="hs-identifier hs-var">arg_y_16</span></a></span><span>
</span><span id="line-4447"></span><span>
</span><span id="line-4448"></span><span>    </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4449"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660865"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682660865"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682660853"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4450"></span><span>          </span><span id="local-6989586621682660866"><span class="annot"><span class="annottext">reg_q :: Reg
</span><a href="#local-6989586621682660866"><span class="hs-identifier hs-var hs-var hs-var">reg_q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660855"><span class="hs-identifier hs-var">res_q</span></a></span><span>
</span><span id="line-4451"></span><span>          </span><span id="local-6989586621682660867"><span class="annot"><span class="annottext">reg_r :: Reg
</span><a href="#local-6989586621682660867"><span class="hs-identifier hs-var hs-var hs-var">reg_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660856"><span class="hs-identifier hs-var">res_r</span></a></span><span>
</span><span id="line-4452"></span><span>          </span><span id="local-6989586621682660868"><span class="annot"><span class="annottext">widen :: Instr
</span><a href="#local-6989586621682660868"><span class="hs-identifier hs-var hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660854"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660865"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-4453"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682660865"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4454"></span><span>          </span><span id="local-6989586621682660869"><span class="annot"><span class="annottext">instr :: Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682660869"><span class="hs-identifier hs-var hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682660854"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a></span><span>
</span><span id="line-4455"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span>
</span><span id="line-4456"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682660870"><span class="annot"><a href="#local-6989586621682660870"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682660871"><span class="annot"><a href="#local-6989586621682660871"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660859"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-4457"></span><span>      </span><span id="local-6989586621682660872"><span class="annot"><a href="#local-6989586621682660872"><span class="hs-identifier hs-var">x_low_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660858"><span class="hs-identifier hs-type">arg_x_low</span></a></span><span>
</span><span id="line-4458"></span><span>      </span><span id="local-6989586621682660873"><span class="annot"><a href="#local-6989586621682660873"><span class="hs-identifier hs-var">x_high_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682660857"><span class="hs-identifier hs-type">m_arg_x_high</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4459"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682660874"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660874"><span class="hs-identifier hs-var">arg_x_high</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4460"></span><span>                         </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660874"><span class="hs-identifier hs-var">arg_x_high</span></a></span><span>
</span><span id="line-4461"></span><span>                     </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4462"></span><span>                         </span><span class="annot"><span class="annottext">(Reg -&gt; OrdList Instr) -&gt; NatM (Reg -&gt; OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; OrdList Instr) -&gt; NatM (Reg -&gt; OrdList Instr))
-&gt; (Reg -&gt; OrdList Instr) -&gt; NatM (Reg -&gt; OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Reg -&gt; OrdList Instr
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; Reg -&gt; OrdList Instr)
-&gt; OrdList Instr -&gt; Reg -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682660868"><span class="hs-identifier hs-var">widen</span></a></span><span>
</span><span id="line-4463"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660871"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4464"></span><span>               </span><span class="annot"><a href="#local-6989586621682660872"><span class="hs-identifier hs-type">x_low_code</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4465"></span><span>               </span><span class="annot"><a href="#local-6989586621682660873"><span class="hs-identifier hs-type">x_high_code</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-type">rdx</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-4466"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682660869"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660865"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660870"><span class="hs-identifier hs-type">y_reg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4467"></span><span>                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660865"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660866"><span class="hs-identifier hs-type">reg_q</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4468"></span><span>                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660865"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-type">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660867"><span class="hs-identifier hs-type">reg_r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-4469"></span><span>
</span><span id="line-4470"></span><span>
</span><span id="line-4471"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-4472"></span><span class="hs-comment">-- The following functions implement certain 64-bit MachOps inline for 32-bit</span><span>
</span><span id="line-4473"></span><span class="hs-comment">-- architectures. On 64-bit architectures, those MachOps aren't supported and</span><span>
</span><span id="line-4474"></span><span class="hs-comment">-- calling these functions for a 64-bit target platform is considered an error</span><span>
</span><span id="line-4475"></span><span class="hs-comment">-- (hence the use of `expect32BitPlatform`).</span><span>
</span><span id="line-4476"></span><span class="hs-comment">--</span><span>
</span><span id="line-4477"></span><span class="hs-comment">-- On 64-bit platforms, generic MachOps should be used instead of these 64-bit</span><span>
</span><span id="line-4478"></span><span class="hs-comment">-- specific ones (e.g. use MO_Add instead of MO_x64_Add). This MachOp selection</span><span>
</span><span id="line-4479"></span><span class="hs-comment">-- is done by StgToCmm.</span><span>
</span><span id="line-4480"></span><span>
</span><span id="line-4481"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genInt64ToInt"><span class="hs-identifier hs-type">genInt64ToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4482"></span><span id="genInt64ToInt"><span class="annot"><span class="annottext">genInt64ToInt :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genInt64ToInt"><span class="hs-identifier hs-var hs-var">genInt64ToInt</span></a></span></span><span> </span><span id="local-6989586621682660875"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660875"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660876"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660876"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4483"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genInt64ToInt&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4484"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660877"><span class="annot"><a href="#local-6989586621682660877"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660878"><span class="annot"><a href="#local-6989586621682660878"><span class="hs-identifier hs-var">_src_hi</span></a></span></span><span> </span><span id="local-6989586621682660879"><span class="annot"><a href="#local-6989586621682660879"><span class="hs-identifier hs-var">src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660876"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4485"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660880"><span class="annot"><a href="#local-6989586621682660880"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660875"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660877"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660879"><span class="hs-identifier hs-type">src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660880"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4487"></span><span>
</span><span id="line-4488"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genWord64ToWord"><span class="hs-identifier hs-type">genWord64ToWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4489"></span><span id="genWord64ToWord"><span class="annot"><span class="annottext">genWord64ToWord :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWord64ToWord"><span class="hs-identifier hs-var hs-var">genWord64ToWord</span></a></span></span><span> </span><span id="local-6989586621682660881"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660881"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660882"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660882"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4490"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genWord64ToWord&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4491"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660883"><span class="annot"><a href="#local-6989586621682660883"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660884"><span class="annot"><a href="#local-6989586621682660884"><span class="hs-identifier hs-var">_src_hi</span></a></span></span><span> </span><span id="local-6989586621682660885"><span class="annot"><a href="#local-6989586621682660885"><span class="hs-identifier hs-var">src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660882"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4492"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660886"><span class="annot"><a href="#local-6989586621682660886"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660881"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4493"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660883"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660885"><span class="hs-identifier hs-type">src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660886"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4494"></span><span>
</span><span id="line-4495"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genIntToInt64"><span class="hs-identifier hs-type">genIntToInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4496"></span><span id="genIntToInt64"><span class="annot"><span class="annottext">genIntToInt64 :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genIntToInt64"><span class="hs-identifier hs-var hs-var">genIntToInt64</span></a></span></span><span> </span><span id="local-6989586621682660887"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660887"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660888"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660888"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4497"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genIntToInt64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4498"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660889"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660889"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660890"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660890"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660887"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4499"></span><span>  </span><span id="local-6989586621682660891"><span class="annot"><a href="#local-6989586621682660891"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660888"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4500"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660891"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4501"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-comment">-- sign extend EAX in EDX:EAX</span><span>
</span><span id="line-4502"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660890"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4503"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-type">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660889"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4504"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4505"></span><span>
</span><span id="line-4506"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToWord64"><span class="hs-identifier hs-type">genWordToWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4507"></span><span id="genWordToWord64"><span class="annot"><span class="annottext">genWordToWord64 :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToWord64"><span class="hs-identifier hs-var hs-var">genWordToWord64</span></a></span></span><span> </span><span id="local-6989586621682660892"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660892"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660893"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660893"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4508"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genWordToWord64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4509"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660894"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660894"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660895"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660895"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660892"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4510"></span><span>  </span><span id="local-6989586621682660896"><span class="annot"><a href="#local-6989586621682660896"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg -&gt; OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660893"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4511"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660896"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660895"><span class="hs-identifier hs-type">dst_lo</span></a></span><span>
</span><span id="line-4512"></span><span>          </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660894"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660894"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4513"></span><span>
</span><span id="line-4514"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genNeg64"><span class="hs-identifier hs-type">genNeg64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4515"></span><span id="genNeg64"><span class="annot"><span class="annottext">genNeg64 :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNeg64"><span class="hs-identifier hs-var hs-var">genNeg64</span></a></span></span><span> </span><span id="local-6989586621682660897"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660897"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660898"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660898"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4516"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genNeg64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4517"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660899"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660899"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660900"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660900"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660897"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4518"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660901"><span class="annot"><a href="#local-6989586621682660901"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682660902"><span class="annot"><a href="#local-6989586621682660902"><span class="hs-identifier hs-var">src_hi</span></a></span></span><span> </span><span id="local-6989586621682660903"><span class="annot"><a href="#local-6989586621682660903"><span class="hs-identifier hs-var">src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660898"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4519"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660901"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4520"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660903"><span class="hs-identifier hs-type">src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660900"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4521"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660902"><span class="hs-identifier hs-type">src_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660899"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4522"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-type">NEGI</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660900"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4523"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-type">ADC</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660899"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4524"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-type">NEGI</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660899"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4525"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4526"></span><span>
</span><span id="line-4527"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAdd64"><span class="hs-identifier hs-type">genAdd64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4528"></span><span id="genAdd64"><span class="annot"><span class="annottext">genAdd64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAdd64"><span class="hs-identifier hs-var hs-var">genAdd64</span></a></span></span><span> </span><span id="local-6989586621682660904"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660904"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660905"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660905"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660906"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660906"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4529"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genAdd64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4530"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660907"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660907"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660908"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660908"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660904"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4531"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660909"><span class="annot"><a href="#local-6989586621682660909"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660910"><span class="annot"><a href="#local-6989586621682660910"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660911"><span class="annot"><a href="#local-6989586621682660911"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660905"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4532"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660912"><span class="annot"><a href="#local-6989586621682660912"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660913"><span class="annot"><a href="#local-6989586621682660913"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660914"><span class="annot"><a href="#local-6989586621682660914"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660906"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4533"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660909"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660912"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4534"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660911"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660908"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4535"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660910"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660907"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4536"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-type">ADD</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660914"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660908"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4537"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-type">ADC</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660913"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660907"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4538"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4539"></span><span>
</span><span id="line-4540"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSub64"><span class="hs-identifier hs-type">genSub64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4541"></span><span id="genSub64"><span class="annot"><span class="annottext">genSub64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSub64"><span class="hs-identifier hs-var hs-var">genSub64</span></a></span></span><span> </span><span id="local-6989586621682660915"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660915"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660916"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660916"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660917"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660917"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4542"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genSub64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4543"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660918"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660918"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660919"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660919"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660915"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4544"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660920"><span class="annot"><a href="#local-6989586621682660920"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660921"><span class="annot"><a href="#local-6989586621682660921"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660922"><span class="annot"><a href="#local-6989586621682660922"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660916"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4545"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660923"><span class="annot"><a href="#local-6989586621682660923"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660924"><span class="annot"><a href="#local-6989586621682660924"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660925"><span class="annot"><a href="#local-6989586621682660925"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660917"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4546"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660920"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660923"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4547"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660922"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660919"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4548"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660921"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660918"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4549"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660925"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660919"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4550"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-type">SBB</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660924"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660918"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4551"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4552"></span><span>
</span><span id="line-4553"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAnd64"><span class="hs-identifier hs-type">genAnd64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4554"></span><span id="genAnd64"><span class="annot"><span class="annottext">genAnd64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAnd64"><span class="hs-identifier hs-var hs-var">genAnd64</span></a></span></span><span> </span><span id="local-6989586621682660926"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660926"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660927"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660927"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660928"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660928"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4555"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genAnd64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4556"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660929"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660929"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660930"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660930"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660926"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4557"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660931"><span class="annot"><a href="#local-6989586621682660931"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660932"><span class="annot"><a href="#local-6989586621682660932"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660933"><span class="annot"><a href="#local-6989586621682660933"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660927"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4558"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660934"><span class="annot"><a href="#local-6989586621682660934"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660935"><span class="annot"><a href="#local-6989586621682660935"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660936"><span class="annot"><a href="#local-6989586621682660936"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660928"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4559"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660931"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660934"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4560"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660933"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660930"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4561"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660932"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660929"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4562"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-type">AND</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660936"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660930"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4563"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-type">AND</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660935"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660929"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4564"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4565"></span><span>
</span><span id="line-4566"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genOr64"><span class="hs-identifier hs-type">genOr64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4567"></span><span id="genOr64"><span class="annot"><span class="annottext">genOr64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genOr64"><span class="hs-identifier hs-var hs-var">genOr64</span></a></span></span><span> </span><span id="local-6989586621682660937"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660937"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660938"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660938"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660939"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660939"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4568"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genOr64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4569"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660940"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660940"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660941"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660941"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660937"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4570"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660942"><span class="annot"><a href="#local-6989586621682660942"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660943"><span class="annot"><a href="#local-6989586621682660943"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660944"><span class="annot"><a href="#local-6989586621682660944"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660938"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4571"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660945"><span class="annot"><a href="#local-6989586621682660945"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660946"><span class="annot"><a href="#local-6989586621682660946"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660947"><span class="annot"><a href="#local-6989586621682660947"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660939"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4572"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660942"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660945"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4573"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660944"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660941"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4574"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660943"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660940"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4575"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-type">OR</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660947"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660941"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4576"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-type">OR</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660946"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660940"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4577"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4578"></span><span>
</span><span id="line-4579"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genXor64"><span class="hs-identifier hs-type">genXor64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4580"></span><span id="genXor64"><span class="annot"><span class="annottext">genXor64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXor64"><span class="hs-identifier hs-var hs-var">genXor64</span></a></span></span><span> </span><span id="local-6989586621682660948"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660948"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660949"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660949"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660950"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660950"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4581"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genXor64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4582"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660951"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660951"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660952"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660952"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660948"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4583"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660953"><span class="annot"><a href="#local-6989586621682660953"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660954"><span class="annot"><a href="#local-6989586621682660954"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660955"><span class="annot"><a href="#local-6989586621682660955"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660949"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4584"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660956"><span class="annot"><a href="#local-6989586621682660956"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660957"><span class="annot"><a href="#local-6989586621682660957"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660958"><span class="annot"><a href="#local-6989586621682660958"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660950"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4585"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660953"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660956"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4586"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660955"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660952"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4587"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660954"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660951"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4588"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660958"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660952"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4589"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660957"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660951"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4590"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4591"></span><span>
</span><span id="line-4592"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genNot64"><span class="hs-identifier hs-type">genNot64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4593"></span><span id="genNot64"><span class="annot"><span class="annottext">genNot64 :: LocalReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNot64"><span class="hs-identifier hs-var hs-var">genNot64</span></a></span></span><span> </span><span id="local-6989586621682660959"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660959"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660960"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660960"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4594"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genNot64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4595"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660961"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660961"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682660962"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682660962"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660959"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4596"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660963"><span class="annot"><a href="#local-6989586621682660963"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span id="local-6989586621682660964"><span class="annot"><a href="#local-6989586621682660964"><span class="hs-identifier hs-var">src_hi</span></a></span></span><span> </span><span id="local-6989586621682660965"><span class="annot"><a href="#local-6989586621682660965"><span class="hs-identifier hs-var">src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660960"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4597"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660963"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4598"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660965"><span class="hs-identifier hs-type">src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660962"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4599"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660964"><span class="hs-identifier hs-type">src_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660961"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4600"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-type">NOT</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660962"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4601"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-type">NOT</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660961"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4602"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4603"></span><span>
</span><span id="line-4604"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genEq64"><span class="hs-identifier hs-type">genEq64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4605"></span><span id="genEq64"><span class="annot"><span class="annottext">genEq64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genEq64"><span class="hs-identifier hs-var hs-var">genEq64</span></a></span></span><span> </span><span id="local-6989586621682660966"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660966"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660967"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660968"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660968"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4606"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genEq64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4607"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660969"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682660969"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660966"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4608"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660970"><span class="annot"><a href="#local-6989586621682660970"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660971"><span class="annot"><a href="#local-6989586621682660971"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660972"><span class="annot"><a href="#local-6989586621682660972"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660967"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4609"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660973"><span class="annot"><a href="#local-6989586621682660973"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660974"><span class="annot"><a href="#local-6989586621682660974"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660975"><span class="annot"><a href="#local-6989586621682660975"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660968"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4610"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660976"><span class="annot"><a href="#local-6989586621682660976"><span class="hs-identifier hs-var">tmp_hi</span></a></span></span><span> </span><span id="local-6989586621682660977"><span class="annot"><a href="#local-6989586621682660977"><span class="hs-identifier hs-var">tmp_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-4611"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660970"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660973"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4612"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660972"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660977"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4613"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660971"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660976"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4614"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660975"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660977"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4615"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660974"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660976"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4616"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-type">OR</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660977"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660976"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4617"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-type">SETCC</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-type">EQQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660969"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4618"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660969"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660969"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4619"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4620"></span><span>
</span><span id="line-4621"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genNe64"><span class="hs-identifier hs-type">genNe64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4622"></span><span id="genNe64"><span class="annot"><span class="annottext">genNe64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genNe64"><span class="hs-identifier hs-var hs-var">genNe64</span></a></span></span><span> </span><span id="local-6989586621682660978"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660978"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660979"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660980"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660980"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4623"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genNe64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4624"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682660981"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682660981"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660978"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4625"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660982"><span class="annot"><a href="#local-6989586621682660982"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682660983"><span class="annot"><a href="#local-6989586621682660983"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682660984"><span class="annot"><a href="#local-6989586621682660984"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660979"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4626"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682660985"><span class="annot"><a href="#local-6989586621682660985"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682660986"><span class="annot"><a href="#local-6989586621682660986"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682660987"><span class="annot"><a href="#local-6989586621682660987"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660980"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4627"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682660988"><span class="annot"><a href="#local-6989586621682660988"><span class="hs-identifier hs-var">tmp_hi</span></a></span></span><span> </span><span id="local-6989586621682660989"><span class="annot"><a href="#local-6989586621682660989"><span class="hs-identifier hs-var">tmp_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-4628"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682660982"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660985"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4629"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660984"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660989"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4630"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660983"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660988"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4631"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660987"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660989"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4632"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660986"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660988"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4633"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-type">OR</span></a></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660989"><span class="hs-identifier hs-type">tmp_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660988"><span class="hs-identifier hs-type">tmp_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4634"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-type">SETCC</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660981"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4635"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660981"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682660981"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4636"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4637"></span><span>
</span><span id="line-4638"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtWord64"><span class="hs-identifier hs-type">genGtWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4639"></span><span id="genGtWord64"><span class="annot"><span class="annottext">genGtWord64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtWord64"><span class="hs-identifier hs-var hs-var">genGtWord64</span></a></span></span><span> </span><span id="local-6989586621682660990"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660990"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660991"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660991"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660992"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660992"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4640"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genGtWord64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4641"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660990"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660992"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660991"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4642"></span><span>
</span><span id="line-4643"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtWord64"><span class="hs-identifier hs-type">genLtWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4644"></span><span id="genLtWord64"><span class="annot"><span class="annottext">genLtWord64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtWord64"><span class="hs-identifier hs-var hs-var">genLtWord64</span></a></span></span><span> </span><span id="local-6989586621682660994"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660994"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660995"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660995"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660996"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660996"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4645"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genLtWord64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4646"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660994"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660995"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660996"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4647"></span><span>
</span><span id="line-4648"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeWord64"><span class="hs-identifier hs-type">genGeWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4649"></span><span id="genGeWord64"><span class="annot"><span class="annottext">genGeWord64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeWord64"><span class="hs-identifier hs-var hs-var">genGeWord64</span></a></span></span><span> </span><span id="local-6989586621682660997"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660997"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682660998"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660998"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682660999"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660999"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4650"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genGeWord64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4651"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682660997"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660998"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682660999"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4652"></span><span>
</span><span id="line-4653"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeWord64"><span class="hs-identifier hs-type">genLeWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4654"></span><span id="genLeWord64"><span class="annot"><span class="annottext">genLeWord64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeWord64"><span class="hs-identifier hs-var hs-var">genLeWord64</span></a></span></span><span> </span><span id="local-6989586621682661000"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661000"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661001"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661001"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661002"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661002"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4655"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genLeWord64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4656"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661000"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661002"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661001"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4657"></span><span>
</span><span id="line-4658"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtInt64"><span class="hs-identifier hs-type">genGtInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4659"></span><span id="genGtInt64"><span class="annot"><span class="annottext">genGtInt64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGtInt64"><span class="hs-identifier hs-var hs-var">genGtInt64</span></a></span></span><span> </span><span id="local-6989586621682661003"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661003"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661004"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661004"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661005"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661005"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4660"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genGtInt64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4661"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661003"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661005"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661004"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4662"></span><span>
</span><span id="line-4663"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtInt64"><span class="hs-identifier hs-type">genLtInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4664"></span><span id="genLtInt64"><span class="annot"><span class="annottext">genLtInt64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLtInt64"><span class="hs-identifier hs-var hs-var">genLtInt64</span></a></span></span><span> </span><span id="local-6989586621682661006"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661006"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661007"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661007"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661008"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661008"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4665"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genLtInt64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4666"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661006"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661007"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661008"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4667"></span><span>
</span><span id="line-4668"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeInt64"><span class="hs-identifier hs-type">genGeInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4669"></span><span id="genGeInt64"><span class="annot"><span class="annottext">genGeInt64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genGeInt64"><span class="hs-identifier hs-var hs-var">genGeInt64</span></a></span></span><span> </span><span id="local-6989586621682661009"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661009"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661010"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661010"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661011"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661011"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4670"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genGeInt64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4671"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661009"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661010"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661011"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4672"></span><span>
</span><span id="line-4673"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeInt64"><span class="hs-identifier hs-type">genLeInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4674"></span><span id="genLeInt64"><span class="annot"><span class="annottext">genLeInt64 :: LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLeInt64"><span class="hs-identifier hs-var hs-var">genLeInt64</span></a></span></span><span> </span><span id="local-6989586621682661012"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661012"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661013"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661013"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661014"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661014"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4675"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; NatM ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#expect32BitPlatform"><span class="hs-identifier hs-var">expect32BitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genLeInt64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-4676"></span><span>  </span><span class="annot"><span class="annottext">Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var">genPred64</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661012"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661014"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661013"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4677"></span><span>
</span><span id="line-4678"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-type">genPred64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4679"></span><span id="genPred64"><span class="annot"><span class="annottext">genPred64 :: Cond -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPred64"><span class="hs-identifier hs-var hs-var">genPred64</span></a></span></span><span> </span><span id="local-6989586621682661015"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682661015"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682661016"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661016"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682661017"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661017"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682661018"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661018"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4680"></span><span>  </span><span class="hs-comment">-- we can only rely on CF/SF/OF flags!</span><span>
</span><span id="line-4681"></span><span>  </span><span class="hs-comment">-- Not on ZF, which doesn't take into account the lower parts.</span><span>
</span><span id="line-4682"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; NatM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682661015"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Cond -&gt; [Cond] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-4683"></span><span>
</span><span id="line-4684"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682661019"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682661019"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682661016"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4685"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682661020"><span class="annot"><a href="#local-6989586621682661020"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span id="local-6989586621682661021"><span class="annot"><a href="#local-6989586621682661021"><span class="hs-identifier hs-var">x_hi</span></a></span></span><span> </span><span id="local-6989586621682661022"><span class="annot"><a href="#local-6989586621682661022"><span class="hs-identifier hs-var">x_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
CmmExpr -&gt; NatM (RegCode64 (OrdList Instr))
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682661017"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4686"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682661023"><span class="annot"><a href="#local-6989586621682661023"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span id="local-6989586621682661024"><span class="annot"><a href="#local-6989586621682661024"><span class="hs-identifier hs-var">y_hi</span></a></span></span><span> </span><span id="local-6989586621682661025"><span class="annot"><a href="#local-6989586621682661025"><span class="hs-identifier hs-var">y_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661018"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4687"></span><span>  </span><span class="hs-comment">-- Basically we perform a subtraction with borrow.</span><span>
</span><span id="line-4688"></span><span>  </span><span class="hs-comment">-- As we don't need to result, we can use CMP instead of SUB for the low part</span><span>
</span><span id="line-4689"></span><span>  </span><span class="hs-comment">-- (it sets the borrow flag just like SUB does)</span><span>
</span><span id="line-4690"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682661020"><span class="hs-identifier hs-type">x_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661023"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4691"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661021"><span class="hs-identifier hs-type">x_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661019"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4692"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-type">CMP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661025"><span class="hs-identifier hs-type">y_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661022"><span class="hs-identifier hs-type">x_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4693"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-type">SBB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661024"><span class="hs-identifier hs-type">y_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661019"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4694"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-type">SETCC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661015"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661019"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4695"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661019"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682661019"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4696"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-4697"></span></pre></body></html>